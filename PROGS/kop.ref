***
*** main.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
CLEAR
CLOSE ALL
CLEAR ALL
RELEASE ALL
SET LOCK ON
SET MULTILOCKS ON
SET REFRESH TO 0
SET EXCLUSIVE OFF
SET REPROCESS TO 5 SECONDS
SET TALK OFF
SET UNIQUE OFF
SET NEAR OFF
SET ESCAPE OFF
SET STATUS ON
SET STATUS BAR ON
SET SAFETY OFF
SET NOTIFY OFF
SET DEBUG ON
SET EXACT OFF
SET DELETED ON
SET CONFIRM ON
SET DATE ITALIAN
SET CENTURY ON
SET CLOCK STATUS
SET HOURS TO 24
SET SEPARATOR TO ","
SET POINT TO "."
SET CPDIALOG OFF
SET NULLDISPLAY TO "0"
MPRINTNAME = SET("Printer", 2)
SET PRINTER TO &MPRINTNAME
CLOSE DATABASES
CLOSE ALL
CLEAR ALL
ON ERROR DO ERRHANDLER WITH  ERROR( ), MESSAGE( ), MESSAGE(1), PROGRAM( ), LINENO( )
ON ERROR
PUBLIC DEFAICON
PUBLIC DIRCURR
PUBLIC GDATAX, GDTEMP
PUBLIC OXMENU, _AKSESOKE, _MULAI, _USERS, _PASWD, _TYPEUSER, _USERID
PUBLIC GICON, GHAND, GBGROUND, _ASEARCHING, GTITLE, GFOOTTITLE
PUBLIC GRND1, GRND2, GITALFORMAT
PUBLIC _ASEARCHING
PUBLIC GKOPN
PUBLIC GEXCEL
PUBLIC TGLNOW, DEFACONNECT, DEFANOMISMK, DEFAICON
PUBLIC DEFAUSERID, DEFAHAKMENU
PUBLIC DEFAHAKANGG, DEFAHAKSIMP, DEFAHAKPINJ, DEFAHAKKAS, DEFAHAKAKT, DEFAHAKCOL, DEFAHAKUSER, DEFAHAKSET
PUBLIC DEFAHAKREPT, DEFAAUTOBERKAS
PUBLIC DEFANAMA, DEFAALAMAT, DEFAKOTA, DEFAPHONE, DEFAID, DEFAPIMPINAN, DEFAJABATAN, DEFAPENGADILAN, DEFAKANTOR
PUBLIC DEFAIDUSER, DEFABATASKAS, DEFAIDGROUP
PUBLIC DEFAMASUK, DEFADBFSMS, TGLLAPORAN
PUBLIC DEFAREGASET, DEFAREGKANTOR, DEFAREGTGLJT, DEFAREGSTAT
PUBLIC DEFATGLKAS, DEFAMODELNRC, DEFAKETERANGAN
PUBLIC CSQL
STORE '222222' TO DEFAHAKMENU, DEFAHAKREPT
STORE '0000000000' TO DEFAHAKANGG, DEFAHAKSIMP, DEFAHAKPINJ, DEFAHAKKAS, DEFAHAKAKT, DEFAHAKCOL, DEFAHAKUSER, DEFAHAKSET
DEFATGLKAS = DATE()
DEFAAUTOBERKAS = 'T'
DEFAMASUK = .F.
PUBLIC OODBC
OODBC = 0
IF  .NOT. ((SYSMETRIC(1)>=800) .AND. (SYSMETRIC(2)>=600))
_SCREEN.VISIBLE = .F.
MESSAGEBOX('Resolusi Harus 800×600', 48, 'Error!')
_SCREEN.VISIBLE = .T.
CANCEL
ENDIF
_SCREEN.VISIBLE = .F.
STORE 1 TO GNX
MDIR = ''
DO WHILE LEN(SYS(16, GNX))<>0
MDIR = JUSTPATH(SYS(16, GNX))
STORE GNX+1 TO GNX
ENDDO
SET DEFAULT TO (MDIR)
SET CLASSLIB TO .\vcx\vfxoffce, .\vcx\mylib, .\vcx\myclassbutton, .\vcx\mybacaini
SET PROCEDURE TO .\prg\pros, .\prg\pros_proses, .\prg\pros_menu, .\prg\pros1, .\prg\pros2, .\prg\pros_krd, .\prg\pros_simp, .\prg\buatini
SET PATH TO .\data;.\etmp\.;.\excel;.\form;.\image;,.\prg;.\report
DIRCURR = MDIR
LOSERVER = READINI2("CONECTION", "SERVER", "", "TERRA.INI")
LONMDB = READINI2("CONECTION", "DATABASED", "", "TERRA.INI")
LODBUNAME = READINI2("CONECTION", "USER", "", "TERRA.INI")
LODBPWD = READINI2("CONECTION", "PASSWORD", "", "TERRA.INI")
DEFADBFSMS = READINI2("CONECTION", "SMSGATEWAY", "", "TERRA.INI")
GICON = ".\image\terra.ico"
GTITLE = READINI2("IMAGE", "TITLE", "", "TERRA.INI")
GHAND = READINI2("IMAGE", "CURSOR", "", "TERRA.INI")
GBGROUND = READINI2("IMAGE", "BACKGROUND", "", "TERRA.INI")
GIMAGEKOP = READINI2("IMAGE", "KOPIMAGE", "", "TERRA.INI")
GFOOTTITLE = READINI2("IMAGE", "FOOT", "", "TERRA.INI")
DEFAKANTOR = READINI2("USERPROFIL", "IDKANTOR", "", "TERRA.INI")
DEFAIDUSER = READINI2("USERPROFIL", "IDPENGGUNA", "", "TERRA.INI")
DEFAICON = GICON
PUBLIC LCCON
LCCON = "DRIVER={MySQL ODBC 5.1 Driver};DESC=;DATABASE="+LONMDB+";SERVER="+LOSERVER+";UID="+LODBUNAME+";PASSWORD="+LODBPWD+";PORT=3306;OPTION=;STMT=;"
DEFACONNECT = LCCON
OODBC = SQLSTRINGCONNECT(DEFACONNECT)
CSQL = "select COUNT(nama) as jml from user"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Mohon dicek kembali file config.ini", 64, "")
RETURN
ELSE
MJML = VAL(JML)
USE
IF MJML=0
DEFAHAKUSER = '11111111'
ENDIF
ENDIF
CSQL = "select * from batastanggal where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF TGLUPDATE<DATE()
CSQL = "update batastanggal set tglakhir='"+SQLDATE(DATE())+"' where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDMB = ID_MATHERBOARD()
DO DECLAREAPIS
CEKVERSIDBF()
STORE .F. TO GL2, INV2, AP2, CO2, AR2, UT2, GSITE
_USERS = ""
_PASWD = ""
_TYPEUSER = ""
_AKSESOKE = .F.
_MULAI = .F.
_ASEARCHING = ""
IF _MULAI=.F.
_MULAI = .T.
IF _MULAI=.T.
OXMENU = CREATEOBJECT('xFormsSet')
OXMENU.SHOW
DO FORM frm_login
IF DEFAHAKMENU='111111'
CEKJURNALPUBLIC()
IF .F.
IF LEFT(DEFAREGKANTOR, 1)<>'8'
DO FORM reg_habis WITH 1
ENDIF
IF DEFAREGSTAT='2' .AND. (DEFAREGTGLJT+90)-TGLNOW<7
DO FORM reg_habis WITH 2
ENDIF
IF DEFAREGSTAT='3' .AND. DEFAREGTGLJT-TGLNOW<-30
DO FORM reg_habis WITH 3
ENDIF
ENDIF
CSQL = "select MAX(tglproses) as tgl from log_proses"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MTGL = TGL
USE
IF MTGL<TGLNOW
DO FORM proses_harian2 WITH 0
ENDIF
ENDIF
READ EVENTS
ELSE
CLOSE DATABASES
CLOSE ALL
CLEAR ALL
CLEAR EVENTS
ENDIF
ENDIF
ENDPROC
**
DEFINE CLASS xformsSet AS formset
AUTORELEASE = .T.
WINDOWTYPE = 0
MAINFORMCLOSE = .F.
ADD OBJECT XMFORM AS MAINFORM
ENDDEFINE
**
DEFINE CLASS mainform AS FORM
AUTOCENTER = .T.
BORDERSTYLE = 0
CAPTION = GTITLE
CLOSABLE = .T.
DESKTOP = .T.
ICON = GICON
HEIGHT = SYSMETRIC(2)-25
MAXBUTTON = .T.
MDIFORM = .T.
SHOWWINDOW = 2
SHOWTIPS = .T.
WIDTH = SYSMETRIC(1)
WINDOWTYPE = 1
WINDOWSTATE = 2
BACKCOLOR = RGB(12, 124, 14)
ADD OBJECT BACKGROUND AS IMAGE WITH BORDERSTYLE = 0, TOP = 0, LEFT = 0, WIDTH = SYSMETRIC(1), HEIGHT = SYSMETRIC(2), STRETCH = 2, PICTURE = GBGROUND, VISIBLE = IIF(FILE(GBGROUND), .T., .F.)
ADD OBJECT SHAPE0 AS IMAGE WITH BORDERSTYLE = 0, TOP = 0, LEFT = 0, WIDTH = SYSMETRIC(1), HEIGHT = 140, PICTURE = "", STRETCH = 1, VISIBLE = .F.
ADD OBJECT SHAPE_BAWAH AS SHAPE WITH BORDERSTYLE = 0, BACKCOLOR = RGB(128, 128, 0), TOP = SYSMETRIC(2)-65, LEFT = 0, WIDTH = SYSMETRIC(1), HEIGHT = 65
**
PROCEDURE init
THISFORM.ADDPROPERTY("posx")
THISFORM.ADDPROPERTY("posy")
MAIN_MENU()
ENDPROC
**
PROCEDURE background.rightClick
THISFORM.RIGHTMENU()
ENDPROC
**
PROCEDURE rightClick
THISFORM.RIGHTMENU()
ENDPROC
**
PROCEDURE rightmenu
POSX = THISFORM.POSX
POSY = THISFORM.POSY
MPICT = ''
DEFINE POPUP MYMENU FROM POSY/15, POSX/5 FONT "Times New Roman", 12 SHADOW
DEFINE BAR 1 OF MYMENU PROMPT "Ubah Tampilan Display Background          "
DEFINE BAR 2 OF MYMENU PROMPT "Ubah Tampilan Display Kop "
ON SELECTION BAR 1 OF MYMENU DO FORM GET_IMAGE WITH GBGROUND TO MPICT 
ON SELECTION BAR 2 OF MYMENU RETURN 
ACTIVATE POPUP MYMENU
IF  .NOT. EMPTY(MPICT)
GBGROUND = MPICT
THISFORM.TAMPILAWAL()
ENDIF
ENDPROC
**
PROCEDURE background.mousemove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THISFORM.POSX = NXCOORD
THISFORM.POSY = NYCOORD
ENDPROC
**
PROCEDURE mousemove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THISFORM.POSX = NXCOORD
THISFORM.POSY = NYCOORD
ENDPROC
**
PROCEDURE tampilawal
IF  .NOT. EMPTY(GBGROUND) .AND. FILE(GBGROUND)
THISFORM.BACKGROUND.PICTURE = GBGROUND
THISFORM.BACKGROUND.VISIBLE = .T.
ELSE
THISFORM.BACKGROUND.VISIBLE = .F.
ENDIF
THISFORM.SHAPE_BAWAH.VISIBLE = .F.
IF EMPTY(GIMAGEKOP)
THISFORM.SHAPE0.VISIBLE = .F.
ELSE
THISFORM.SHAPE0.VISIBLE = .T.
ENDIF
ENDPROC
**
PROCEDURE Load
_SCREEN.VISIBLE = .F.
ENDPROC
**
PROCEDURE destroy
THISFORMSET.MAINFORMCLOSE = .T.
CLOSE TABLE ALL
RELEASE MENU EXTENDED XMFORM
CLEAR EVENTS
ENDPROC
**
ENDDEFINE
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** kasir.scx
***
*
*
*  kasir.scx::Form
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
CSQL = "select * from kasir where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(DEFATGLKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
JMLDATA = RECCOUNT()
GOTO TOP
IF IJINMODUL("KAS", "HAPUS")
IF JMLDATA>0
THISFORM.PAGEFRAME1.PAGE1.COMMAND5.VISIBLE = .T.
ELSE
THISFORM.PAGEFRAME1.PAGE1.COMMAND5.VISIBLE = .F.
ENDIF
ENDIF
IF IJINMODUL("KAS", "CETAK")
IF JMLDATA>0
THISFORM.PAGEFRAME1.PAGE1.COMMAND6.VISIBLE = .T.
ELSE
THISFORM.PAGEFRAME1.PAGE1.COMMAND6.VISIBLE = .F.
ENDIF
ENDIF
IF IJINMODUL("KAS", "CATATAN")
IF JMLDATA>0
THISFORM.PAGEFRAME1.PAGE1.COMMAND7.VISIBLE = .T.
ELSE
THISFORM.PAGEFRAME1.PAGE1.COMMAND7.VISIBLE = .F.
ENDIF
ENDIF
MDATA2 = THISFORM.DATA2
CSQL = "select * from nonkas where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(DEFATGLKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDATA2)
JMLDATA = RECCOUNT()
GOTO TOP
IF IJINMODUL("KAS", "HAPUS")
IF JMLDATA>0
THISFORM.PAGEFRAME1.PAGE2.COMMAND5.VISIBLE = .T.
ELSE
THISFORM.PAGEFRAME1.PAGE2.COMMAND5.VISIBLE = .F.
ENDIF
ENDIF
IF IJINMODUL("KAS", "CETAK")
IF JMLDATA>0
THISFORM.PAGEFRAME1.PAGE2.COMMAND6.VISIBLE = .T.
ELSE
THISFORM.PAGEFRAME1.PAGE2.COMMAND6.VISIBLE = .F.
ENDIF
ENDIF
IF IJINMODUL("KAS", "CATATAN")
IF JMLDATA>0
THISFORM.PAGEFRAME1.PAGE2.COMMAND7.VISIBLE = .T.
ELSE
THISFORM.PAGEFRAME1.PAGE2.COMMAND7.VISIBLE = .F.
ENDIF
ENDIF
ENDPROC
**
PROCEDURE tampilkan
THISFORM.LABEL1.CAPTION = NAMAHARI(DEFATGLKAS)+", "+URAITGL(DEFATGLKAS)
CSQL = "select saldo from neraca where kantor='"+ALLTRIM(DEFAKANTOR)+"' and noper='"+ALLTRIM(DEFANOPERKAS)+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+ALLTRIM(DEFAKANTOR)+"' and noper='"+ALLTRIM(DEFANOPERKAS)+"' and tanggal<'"+SQLDATE(DEFATGLKAS)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Data neraca tidak terbaca")
ENDIF
THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE = SALDO
USE
SELECT (THISFORM.DATA1)
JDEBET = 0
JKREDIT = 0
SUM DEBET, KREDIT TO JDEBET, JKREDIT 
THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE = JDEBET
THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE = JKREDIT
THISFORM.PAGEFRAME1.PAGE1.TEXT4.VALUE = THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE+JDEBET-JKREDIT
MDATA = THISFORM.DATA1
SELECT (MDATA)
WITH THISFORM.PAGEFRAME1.PAGE1.GRID1
.RECORDSOURCE = MDATA
.COLUMNCOUNT = 7
.COLUMN1.WIDTH = 40
.COLUMN1.CONTROLSOURCE = "CSR"
.COLUMN1.HEADER1.CAPTION = "CSR"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN1.HEADER1.FONTNAME = "Cambria"
.COLUMN2.WIDTH = 80
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN2.HEADER1.FONTNAME = "Cambria"
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KODE"
.COLUMN3.HEADER1.CAPTION = "TR"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN3.HEADER1.FONTNAME = "Cambria"
.COLUMN4.WIDTH = 300
.COLUMN4.CONTROLSOURCE = "KETERANGAN"
.COLUMN4.HEADER1.CAPTION = "KETERANGAN"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN4.HEADER1.FONTNAME = "Cambria"
.COLUMN4.TEXT1.ANCHOR = 10
.COLUMN5.WIDTH = 125
.COLUMN5.CONTROLSOURCE = "DEBET"
.COLUMN5.HEADER1.CAPTION = "DEBET"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN5.INPUTMASK = '999,999,999,999'
.COLUMN5.HEADER1.FONTNAME = "Cambria"
.COLUMN6.WIDTH = 125
.COLUMN6.ALIGNMENT = 1
.COLUMN6.CONTROLSOURCE = "KREDIT"
.COLUMN6.HEADER1.CAPTION = "KREDIT"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN6.TEXT1.FORMAT = 'R'
.COLUMN6.INPUTMASK = '999,999,999,999'
.COLUMN6.HEADER1.FONTNAME = "Cambria"
.COLUMN7.WIDTH = 30
.COLUMN7.CONTROLSOURCE = "OPT"
.COLUMN7.HEADER1.CAPTION = "OPT"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN7.HEADER1.FONTNAME = "Cambria"
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
SELECT (THISFORM.DATA2)
JDEBET = 0
JKREDIT = 0
SUM DEBET, KREDIT TO JDEBET, JKREDIT 
THISFORM.PAGEFRAME1.PAGE2.TEXT1.VALUE = JDEBET
THISFORM.PAGEFRAME1.PAGE2.TEXT2.VALUE = JKREDIT
THISFORM.PAGEFRAME1.PAGE2.TEXT4.VALUE = THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE+JDEBET-JKREDIT
MDATA2 = THISFORM.DATA2
SELECT (MDATA2)
WITH THISFORM.PAGEFRAME1.PAGE2.GRID1
.RECORDSOURCE = MDATA2
.COLUMNCOUNT = 8
.COLUMN1.WIDTH = 40
.COLUMN1.CONTROLSOURCE = "CSR"
.COLUMN1.HEADER1.CAPTION = "CSR"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN1.HEADER1.FONTNAME = "Cambria"
.COLUMN2.WIDTH = 80
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN2.HEADER1.FONTNAME = "Cambria"
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KODE"
.COLUMN3.HEADER1.CAPTION = "TR"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN3.HEADER1.FONTNAME = "Cambria"
.COLUMN4.WIDTH = 70
.COLUMN4.CONTROLSOURCE = "KODEBANK"
.COLUMN4.HEADER1.CAPTION = "KODE BANK"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN4.HEADER1.FONTNAME = "Cambria"
.COLUMN5.WIDTH = 300
.COLUMN5.CONTROLSOURCE = "KETERANGAN"
.COLUMN5.HEADER1.CAPTION = "KETERANGAN"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN5.HEADER1.FONTNAME = "Cambria"
.COLUMN6.WIDTH = 125
.COLUMN6.CONTROLSOURCE = "DEBET"
.COLUMN6.HEADER1.CAPTION = "DEBET"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN6.INPUTMASK = '999,999,999,999'
.COLUMN6.HEADER1.FONTNAME = "Cambria"
.COLUMN7.WIDTH = 125
.COLUMN7.ALIGNMENT = 1
.COLUMN7.CONTROLSOURCE = "KREDIT"
.COLUMN7.HEADER1.CAPTION = "KREDIT"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN7.TEXT1.FORMAT = 'R'
.COLUMN7.INPUTMASK = '999,999,999,999'
.COLUMN7.HEADER1.FONTNAME = "Cambria"
.COLUMN8.WIDTH = 30
.COLUMN8.CONTROLSOURCE = "OPT"
.COLUMN8.HEADER1.CAPTION = "OPT"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN8.HEADER1.FONTNAME = "Cambria"
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
SELECT (THISFORM.DATA1)
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
ELSE
SELECT (THISFORM.DATA1)
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETFOCUS
ENDIF
ENDPROC
**
PROCEDURE Init
MOLDSELECT = SELECT()
USE
THISFORM.DATA1 = SYS(2015)
THISFORM.DATA2 = SYS(2015)
THISFORM.PAGEFRAME1.PAGE1.COMMAND1.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE1.COMMAND2.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE1.COMMAND3.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE1.COMMAND4.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE1.COMMAND8.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE1.COMMAND9.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE1.COMMAND5.VISIBLE = IJINMODUL("KAS", "HAPUS")
THISFORM.PAGEFRAME1.PAGE1.COMMAND6.VISIBLE = IJINMODUL("KAS", "CETAK")
THISFORM.PAGEFRAME1.PAGE1.COMMAND7.VISIBLE = IJINMODUL("KAS", "CATATAN")
THISFORM.PAGEFRAME1.PAGE1.CMDSETTING.VISIBLE = IJINMODUL("KAS", "ADMIN")
THISFORM.PAGEFRAME1.PAGE2.COMMAND1.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE2.COMMAND2.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE2.COMMAND3.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE2.COMMAND4.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE2.COMMAND8.VISIBLE = IJINMODUL("KAS", "INPUT")
THISFORM.PAGEFRAME1.PAGE2.COMMAND5.VISIBLE = IJINMODUL("KAS", "HAPUS")
THISFORM.PAGEFRAME1.PAGE2.COMMAND6.VISIBLE = IJINMODUL("KAS", "CETAK")
THISFORM.PAGEFRAME1.PAGE2.COMMAND7.VISIBLE = IJINMODUL("KAS", "CATATAN")
SELECT (MOLDSELECT)
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Activate
IF THISFORM.MPOPUP
SHOW POPUP MYMENU
ENDIF
ENDPROC
**
PROCEDURE Deactivate
IF THISFORM.MPOPUP
HIDE POPUP MYMENU
ENDIF
ENDPROC
**
*
*  kasir.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kasir.scx::Pageframe1
**
PROCEDURE Page1.Activate
SELECT (THISFORM.DATA1)
ENDPROC
**
PROCEDURE Page2.Activate
SELECT (THISFORM.DATA2)
ENDPROC
**
*
*  kasir.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
MKODE = KODE
DO CASE
CASE MKODE='01'
DO FORM kas_anggota WITH "TAMPIL"
CASE MKODE='02'
DO FORM kas_simpanan WITH "TAMPIL"
CASE MKODE='03'
DO FORM kas_pinjaman WITH "TAMPIL"
CASE MKODE='04'
DO FORM kas_kolektif WITH "TAMPIL", "KAS"
CASE MKODE='05'
DO FORM kas_instansi WITH "TAMPIL", "KAS"
CASE MKODE='99'
DO FORM kas_lainnya WITH "TAMPIL"
ENDCASE
ENDIF
IF NKEYCODE=49 .OR. NKEYCODE=50 .OR. NKEYCODE=51 .OR. NKEYCODE=52 .OR. NKEYCODE=53 .OR. NKEYCODE=54
DO CASE
CASE NKEYCODE=49
DO FORM kas_anggota WITH "INPUT"
CASE NKEYCODE=50
DO FORM kas_simpanan WITH "INPUT"
CASE NKEYCODE=51
DO FORM kas_pinjaman WITH "INPUT"
CASE NKEYCODE=52
CASE NKEYCODE=53
CASE NKEYCODE=54
DO FORM kas_lainnya WITH "INPUT"
ENDCASE
ENDIF
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE DblClick
SELECT (THISFORM.DATA1)
MKODE = KODE
DO CASE
CASE MKODE='01'
DO FORM kas_anggota WITH "TAMPIL"
CASE MKODE='02'
DO FORM kas_simpanan WITH "TAMPIL"
CASE MKODE='03'
DO FORM kas_pinjaman WITH "TAMPIL"
CASE MKODE='04'
DO FORM kas_kolektif WITH "TAMPIL", "KAS"
CASE MKODE='05'
DO FORM kas_instansi WITH "TAMPIL", "KAS"
CASE MKODE='99'
DO FORM kas_lainnya WITH "TAMPIL"
ENDCASE
ENDPROC
**
*
*  kasir.scx::Command1
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
SELECT (THISFORM.DATA1)
DO FORM kas_anggota WITH 'INPUT', "KAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command2
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_simpanan
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command3
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_pinjaman
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command4
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_kolektif WITH "INPUT", "KAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command5
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
MKODE = KODE
DO CASE
CASE MKODE='01'
DO FORM kas_anggota WITH "HAPUS", "KAS"
CASE MKODE='02'
DO FORM kas_simpanan WITH "HAPUS", "KAS"
CASE MKODE='03'
DO FORM kas_pinjaman WITH "HAPUS", "KAS"
CASE MKODE='04'
DO FORM kas_kolektif WITH "HAPUS", "KAS"
CASE MKODE='05'
DO FORM kas_instansi WITH "HAPUS", "KAS"
CASE MKODE='99'
DO FORM kas_lainnya WITH "HAPUS", "KAS"
ENDCASE
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command6
**
PROCEDURE LostFocus
TGLNOW = THISFORM.OLDTGL
ENDPROC
**
PROCEDURE RightClick
SELECT (THISFORM.DATA1)
DO FORM set_laporan WITH "KAS"
SELECT (THISFORM.DATA1)
ENDPROC
**
PROCEDURE Click
LOCAL OLDSELECT
THISFORM.MPOPUP = .T.
TGLNOW = DEFATGLKAS
OLDSELECT = SELECT()
MKEY = SQLDATE(DEFATGLKAS)
OLDSELECT = SELECT()
MDEPT = "KAS"
MKEL = '1'
DEFINE POPUP MYMENU FROM 6, 95 FONT "Cambria", 10 TITLE "CETAK LAPORAN" SHADOW MARGIN
DEFINE BAR 1 OF MYMENU PROMPT "1. LAPORAN INTERN (CUSTOMIZE)"
DEFINE BAR 2 OF MYMENU PROMPT "2. LAPORAN KAS HARIAN"
DEFINE BAR 3 OF MYMENU PROMPT "3. LAPORAN RINCIAN KAS"
DEFINE BAR 4 OF MYMENU PROMPT "4. LAPORAN REKAP TRANSAKSI"
CSQL = "select * from set_print where dept='"+MDEPT+"' and kel='"+MKEL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
ON BAR 1 OF MYMENU ACTIVATE POPUP NAMAMENU
DEFINE POPUP NAMAMENU TITLE "CUSTOM REPORT" RELATIVE SCROLL
A = 1
DO WHILE  .NOT. EOF()
AA = "DEFINE BAR "+STR(A)+" OF NamaMenu PROMPT '"+ALLTRIM(STR(A))+". "+UPPER(NAMA_MENU)+"'"
&AA
BB = "ON SELECTION BAR "+STR(A)+" OF NamaMenu cetaktemp('"+TEMPLATE_ID+"','"+NAMA_MENU+"','"+MKEY+"')"
&BB
A = A+1
SKIP
ENDDO
ENDIF
USE
SELECT (OLDSELECT)
MSLD = THISFORM.PAGEFRAME1.PAGE1.TEXT4.VALUE
ON SELECTION BAR 2 OF MYMENU DO FORM KAS_LAP WITH 1
ON SELECTION BAR 3 OF MYMENU DO FORM KAS_RINCIAN WITH MSLD
ON SELECTION BAR 4 OF MYMENU DO FORM KAS_LAP WITH 5
ACTIVATE POPUP MYMENU
THISFORM.MPOPUP = .F.
ENDPROC
**
*
*  kasir.scx::Command7
**
PROCEDURE Click
DO FORM catatan WITH "KAS", ""
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command8
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_lainnya
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command9
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_instansi WITH "INPUT", "KAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::cmdsetting
**
PROCEDURE Click
DO FORM kas_setting
CSQL = "select saldo from neraca where noper='"+DEFANOPERKAS+"' and tanggal=(select MAX(tanggal) from neraca where noper='"+DEFANOPERKAS+"' and tanggal<'"+SQLDATE(DEFATGLKAS)+")')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Data neraca tidak terbaca")
ENDIF
THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE = SALDO
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command1
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_anggota WITH 'INPUT', "NONKAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command2
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_simpanan WITH "INPUT", "NONKAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command3
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_pinjaman WITH "INPUT", "NONKAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command4
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_kolektif WITH "INPUT", "NONKAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command5
**
PROCEDURE Click
MKODE = KODE
DO CASE
CASE MKODE='01'
DO FORM kas_anggota WITH "HAPUS"
CASE MKODE='02'
DO FORM kas_simpanan WITH "HAPUS"
CASE MKODE='03'
DO FORM kas_pinjaman WITH "HAPUS"
CASE MKODE='04'
CASE MKODE='05'
DO FORM kas_lainnya WITH "HAPUS"
ENDCASE
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command6
**
PROCEDURE Click
MKEY = SQLDATE(DEFATGLKAS)
OLDSELECT = SELECT()
MDEPT = "KAS"
MKEL = '1'
CSQL = "select * from set_print where dept='"+MDEPT+"' and kel='"+MKEL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
DEFINE POPUP NAMAMENU FROM 7, 97 FONT "Cambria", 12
A = 1
DO WHILE  .NOT. EOF()
AA = "DEFINE BAR "+STR(A)+" OF NamaMenu PROMPT '"+NAMA_MENU+"'"
&AA
BB = "ON SELECTION BAR "+STR(A)+" OF NamaMenu cetaktemp('"+TEMPLATE_ID+"','"+NAMA_MENU+"','"+MKEY+"')"
&BB
A = A+1
SKIP
ENDDO
ACTIVATE POPUP NAMAMENU
ELSE
MESSAGEBOX("Setting Laporan belum terisi, tekan klik kanan", 32, "PERINGATAN")
ENDIF
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE RightClick
DO FORM set_laporan WITH "KAS"
ENDPROC
**
*
*  kasir.scx::Command7
**
PROCEDURE Click
DO FORM kas_pinjaman
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command8
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_lainnya WITH "INPUT", "NONKAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  kasir.scx::Command9
**
PROCEDURE Click
MVALID = CEKTANGGAL(DEFATGLKAS)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM kas_kolektif WITH "INPUT", "NONKAS"
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
***
*** kasir.sct
***
*
***
*** utilitas.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
FUNCTION BilSay
PARAMETER _VALUE
PS = ' '
DIMENSION BIL(11)
BIL[1] = 'SATU '
BIL[2] = 'DUA '
BIL[3] = 'TIGA '
BIL[4] = 'EMPAT '
BIL[5] = 'LIMA '
BIL[6] = 'ENAM '
BIL[7] = 'TUJUH '
BIL[8] = 'DELAPAN '
BIL[9] = 'SEMBILAN '
BIL[10] = 'SEPULUH '
BIL[11] = 'SEBELAS '
MIN_ = .F.
IF _VALUE<0
MIN_ = .T.
_VALUE = -(_VALUE)
ENDIF
A = STR(_VALUE, 15, 2)
MILYAR = SUBSTR(A, 1, 3)
JUTA = SUBSTR(A, 4, 3)
RIBU = SUBSTR(A, 7, 3)
RATUS = SUBSTR(A, 10, 3)
SEN = SUBSTR(A, 14, 2)
PS = IIF( .NOT. EMPTY(MILYAR) .AND. MILYAR<>'000', PROCTES(MILYAR)+'MILYAR ', PS)
PS = IIF( .NOT. EMPTY(JUTA) .AND. JUTA<>'000', PROCTES(JUTA)+'JUTA ', PS)
BIL[1] = IIF(LEN(ALLTRIM(RIBU))=1, 'SE', BIL(1))
PS = IIF( .NOT. EMPTY(RIBU) .AND. RIBU<>'000', PROCTES(RIBU)+'RIBU ', PS)
BIL[1] = 'SATU'
PS = IIF( .NOT. EMPTY(RATUS) .AND. RATUS<>'000', PROCTES(RATUS), PS)
PS = ALLTRIM(PS)+IIF(EMPTY(PS), ' ', ' RUPIAH ')
PS = IIF( .NOT. EMPTY(SEN) .AND. SEN<>'00', PROCTES('0'+SEN)+' SEN', PS)
IF MIN_
PS = '(Min) '+PS
ENDIF
RETURN PS
ENDFUNC
**
FUNCTION proctes
PARAMETER X
FOR I = 1 TO 3
CHR = SUBSTR(X, I, 1)
IF CHR='0' .OR. CHR=' '
LOOP
ENDIF
IF I=1
PS = PS+IIF(CHR='1', 'SERATUS ', BIL(VAL(CHR))+'RATUS ')
ENDIF
IF I=2
IF CHR='1'
PS = PS+IIF(SUBSTR(X, I+1, 1)='0' .OR. SUBSTR(X, I+1, 1)='1', BIL(VAL(SUBSTR(X, 2, 2))), BIL(VAL(SUBSTR(X, I+1, 1)))+'BELAS ')
EXIT
ELSE
PS = PS+BIL(VAL(CHR))+'PULUH '
ENDIF
ENDIF
PS = IIF(I=3, PS+BIL(VAL(CHR)), PS)
ENDFOR
RETURN PS
ENDFUNC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** pros.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
PROCEDURE varpublic
LOCAL OLDSELE
PUBLIC DEFANAMA, DEFAALAMAT, DEFAKOTA, DEFAPHONE, DEFAIDLEMBAGA, DEFAPIMPINAN, DEFAJABATAN, DEFAPENGADILAN
PUBLIC DEFAFMTANGG, DEFAFMTSIMP, DEFAFMTPINJ, DEFAFMTPK, DEFAFMTAKT
PUBLIC DEFANOPERKAS, DEFANOPERMATERAI, DEFANOPERNOTARIS, DEFANOPERPREMI, DEFANOPERTRANS, DEFANOPERSURVEI, DEFANOPERTTPDEP
PUBLIC DEFANOPERSIMPK, DEFANOPERSIMSMK, DEFANOPERSIMWJB, DEFANOPERPENYERT, DEFANOPERSERTA
PUBLIC DEFAPROSESADM, DEFAPROSESPROVISI, DEFAPROSENDENDA, DEFATENORDENDA, DEFAKETLAIN, DEFAPROSENLAIN
PUBLIC DEFANOMIPOKOK, DEFANOMIWAJIB, DEFANOMISMK, DEFATGLBUNGASIMP, DEFASYSTEMAKT, DEFAAKRUSIMPANAN, DEFAAKRUPINJAMAN, DEFAAKRUADM, DEFAAKRUBIAYA
PUBLIC DEFAKANTORASAL
PUBLIC DEFAVALIDASI, DEFANOTIFIKASI, DEFASMSGATEWAY
PUBLIC DEFANOPERAKA, DEFANOPERAKP
PUBLIC DEFASHU_RAT, DEFASHU_THR, DEFASHU_OPER, DEFASHU_SRG, DEFASHU_BEA, DEFASHU_DOOR
PUBLIC DEFASHU_TRAN, DEFASHU_TALI, DEFASHU_TUNJ1, DEFASHU_TUNJ2, DEFASHU_TUNJ3
PUBLIC DEFASHU_TUNJ4, DEFASHU_DPLK, DEFASHU_PEMEL, DEFASHU_LEMB
PUBLIC DEFAJURSHU_RAT, DEFAJURSHU_THR, DEFAJURSHU_OPER, DEFAJURSHU_SRG, DEFAJURSHU_BEA, DEFAJURSHU_DOOR
PUBLIC DEFAJURSHU_TRAN, DEFAJURSHU_TALI, DEFAJURSHU_TUNJ1, DEFAJURSHU_TUNJ2, DEFAJURSHU_TUNJ3
PUBLIC DEFAJURSHU_TUNJ4, DEFAJURSHU_DPLK, DEFAJURSHU_PEMEL, DEFAJURSHU_LEMB
PUBLIC DEFANOPERFORMULA, DEFANOPERPHUNOW, DEFANOPERPHULALU
PUBLIC DEFATABSTOR, DEFATABAMB, DEFATABPBK, DEFATABBG, DEFATABEDT, DEFATABSLD, DEFATABPJK, DEFATABADM, DEFATABBGDEP
PUBLIC DEFADEPSTOR, DEFADEPBG, DEFADEPPJK, DEFADEPAMBPK, DEFADEPAMBBG, DEFADEPPBKBG, DEFADEPPBKPK1, DEFADEPPBKPK2
PUBLIC DEFAPINSTOR, DEFAPINPBK, DEFAPINPOT, DEFAPINTRK, DEFAPINPBK2, DEFAPINJASA
PUBLIC DEFAAUTONOREK, DEFAPROSMIGRASI, DEFAJENISKOP
STORE 0 TO DEFASHU_RAT, DEFASHU_THR, DEFASHU_OPER, DEFASHU_SRG, DEFASHU_BEA, DEFASHU_DOOR
STORE 0 TO DEFASHU_TRAN, DEFASHU_TALI, DEFASHU_TUNJ1, DEFASHU_TUNJ2, DEFASHU_TUNJ3
STORE 0 TO DEFASHU_TUNJ4, DEFASHU_DPLK, DEFASHU_PEMEL, DEFASHU_LEMB
STORE '' TO DEFAJURSHU_RAT, DEFAJURSHU_THR, DEFAJURSHU_OPER, DEFAJURSHU_SRG, DEFAJURSHU_BEA, DEFAJURSHU_DOOR
STORE '' TO DEFAJURSHU_TRAN, DEFAJURSHU_TALI, DEFAJURSHU_TUNJ1, DEFAJURSHU_TUNJ2, DEFAJURSHU_TUNJ3
STORE '' TO DEFAJURSHU_TUNJ4, DEFAJURSHU_DPLK, DEFAJURSHU_PEMEL, DEFAJURSHU_LEMB
STORE '0' TO DEFAVALIDASI, DEFANOTIFIKASI, DEFASMSGATEWAY
STORE '01' TO DEFATABSTOR, DEFADEPSTOR, DEFAPINSTOR
STORE '02' TO DEFATABAMB, DEFADEPBG, DEFAPINPBK
STORE '03' TO DEFATABPBK, DEFADEPPJK, DEFAPINPOT
STORE '04' TO DEFATABBG, DEFADEPAMBPK, DEFAPINTRK
STORE '05' TO DEFATABEDT, DEFADEPAMBBG, DEFAPINPBK2
STORE '06' TO DEFATABSLD, DEFADEPPBKBG, DEFAPINJASA
STORE '07' TO DEFATABPJK, DEFADEPPBKPK1
STORE '08' TO DEFATABADM, DEFADEPPBKPK2
STORE '09' TO DEFATABBGDEP
DEFAAUTONOREK = 1
DEFAPROSMIGRASI = 0
DEFANOPERAKP = ''
DEFANOPERAKA = ''
DEFAKANTORASAL = ''
DEFAPROSENDENDA = 6
DEFATENORDENDA = 3
DEFAJENISKOP = "KSP KONVENSIONAL"
TGLNOW = DATE()
DEFASETNOREK = "1"
DEFAAUTOBERKAS = 'Y'
OLDSELE = SELECT()
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DEFAPROSMIGRASI = CARIPUBLIC("PROS_MIGRASI")
DEFAMODELNRC = VAL(CARIPUBLIC("NRC_MODEL"))
DEFANAMA = CARIPUBLIC("NAMA")
DEFAALAMAT = CARIPUBLIC("ALAMAT")
DEFAKOTA = CARIPUBLIC("KOTA")
DEFAPHONE = CARIPUBLIC("PHONE")
DEFAIDLEMBAGA = CARIPUBLIC("IDLEMBAGA")
DEFAPIMPINAN = CARIPUBLIC("PIMPINAN")
DEFAJABATAN = CARIPUBLIC("JABATAN")
DEFAPENGADILAN = CARIPUBLIC("PENGADILAN")
DEFAJENISKOP = CARIPUBLIC("JENISKOP")
DEFAFMTANGG = CARIPUBLIC("FMTANGG")
DEFAFMTSIMP = CARIPUBLIC("FMTSIMP")
DEFAFMTPINJ = CARIPUBLIC("FMTPINJ")
DEFAFMTPK = CARIPUBLIC("FMTPK")
DEFAFMTAKT = CARIPUBLIC("FMTAKT")
DEFANOPERKAS = CARIPUBLIC("NOPERKAS")
DEFANOPERMATERAI = CARIPUBLIC("NOPERMATERAI")
DEFANOPERNOTARIS = CARIPUBLIC("NOPERNOTARIS")
DEFANOPERPREMI = CARIPUBLIC("NOPERPREMI")
DEFANOPERTRANS = CARIPUBLIC("NOPERBIAYA")
DEFANOPERSURVEI = CARIPUBLIC("NOPERSURVEI")
DEFANOPERTTPDEP = CARIPUBLIC("NOPERTTPDEP")
DEFANOPERAKA = CARIPUBLIC("NOPERAKA")
DEFANOPERAKP = CARIPUBLIC("NOPERAKP")
DEFANOPERSIMPK = CARIPUBLIC("NOPERSIMPK")
DEFANOPERSIMWJB = CARIPUBLIC("NOPERSIMWJB")
DEFANOPERSIMSMK = CARIPUBLIC("NOPERSIMSMK")
DEFANOPERPENYERT = CARIPUBLIC("NOPERPENYERT")
DEFANOPERSERTA = CARIPUBLIC("NOPERSERTA")
DEFANOPERPHULALU = CARIPUBLIC("NOPERLABALALU")
DEFANOPERPHUNOW = CARIPUBLIC("NOPERLABANOW")
DEFANOPERFORMULA = CARIPUBLIC("NOPERFORMULA")
DEFAPROSESADM = VAL(CARIPUBLIC("PROSENADM"))
DEFAPROSESPROVISI = VAL(CARIPUBLIC("PROSENPROVISI"))
DEFAPROSENDENDA = VAL(CARIPUBLIC("PROSENDENDA"))
DEFATENORDENDA = VAL(CARIPUBLIC("TENORDENDA"))
DEFAKETLAIN = CARIPUBLIC("KETLAIN")
DEFAPROSENLAIN = VAL(CARIPUBLIC("PROSENLAIN"))
DEFANOMIPOKOK = VAL(CARIPUBLIC("NOMIPOKOK"))
DEFANOMIWAJIB = VAL(CARIPUBLIC("NOMIWAJIB"))
DEFANOMISMK = VAL(CARIPUBLIC("NOMISMK"))
DEFAVALIDASI = CARIPUBLIC("CTKVALIDASI")
DEFASMSGATEWAY = DEFADBFSMS
DEFANOTIFIKASI = IIF(EMPTY(ALLTRIM(DEFASMSGATEWAY)), '0', '1')
DEFATABSTOR = CARIPUBLIC("TABSTOR")
DEFATABAMB = CARIPUBLIC("TABAMB")
DEFATABPBK = CARIPUBLIC("TABPBK")
DEFATABBG = CARIPUBLIC("TABBG")
DEFATABEDT = CARIPUBLIC("TABEDT")
DEFATABSLD = CARIPUBLIC("TABSLD")
DEFATABPJK = CARIPUBLIC("TABPJK")
DEFATABADM = CARIPUBLIC("TABADM")
DEFATABBGDEP = CARIPUBLIC("TABBGDEP")
DEFADEPSTOR = CARIPUBLIC("DEPSTOR")
DEFADEPBG = CARIPUBLIC("DEPBG")
DEFADEPPJK = CARIPUBLIC("DEPPJK")
DEFADEPAMBPK = CARIPUBLIC("DEPAMBPK")
DEFADEPAMBBG = CARIPUBLIC("DEPAMBBG")
DEFADEPPBKBG = CARIPUBLIC("DEPPBKBG")
DEFADEPPBKPK1 = CARIPUBLIC("DEPPBKPK1")
DEFADEPPBKPK2 = CARIPUBLIC("DEPPBKPK2")
DEFAPINSTOR = CARIPUBLIC("PINSTOR")
DEFAPINPBK = CARIPUBLIC("PINPBK")
DEFAPINPOT = CARIPUBLIC("PINPOT")
DEFAPINTRK = CARIPUBLIC("PINTRK")
DEFAPINPBK = CARIPUBLIC("PINPBK2")
DEFAPINJASA = CARIPUBLIC("PINJASA")
DEFATGLBUNGASIMP = VAL(CARIPUBLIC("TGLBUNGASIMP"))
DEFASYSTEMAKT = VAL(CARIPUBLIC("AKT_SYSTEM"))
DEFAAKRUSIMPANAN = VAL(CARIPUBLIC("AKRU_SIMPANAN"))
DEFAAKRUPINJAMAN = VAL(CARIPUBLIC("AKRU_PINJAMAN"))
DEFAAKRUADM = VAL(CARIPUBLIC("AKRU_ADM"))
DEFAAKRUBIAYA = VAL(CARIPUBLIC("AKRU_BIAYA"))
DEFASHU_RAT = VAL(CARIPUBLIC("SHU_RAT"))
DEFASHU_THR = VAL(CARIPUBLIC("SHU_THR"))
DEFASHU_OPER = VAL(CARIPUBLIC("SHU_OPER"))
DEFASHU_SRG = VAL(CARIPUBLIC("SHU_SRG"))
DEFASHU_BEA = VAL(CARIPUBLIC("SHU_BEA"))
DEFASHU_DOOR = VAL(CARIPUBLIC("SHU_DOOR"))
DEFASHU_TRAN = VAL(CARIPUBLIC("SHU_TRAN"))
DEFASHU_TALI = VAL(CARIPUBLIC("SHU_TALI"))
DEFASHU_TUNJ1 = VAL(CARIPUBLIC("SHU_TUNJ1"))
DEFASHU_TUNJ2 = VAL(CARIPUBLIC("SHU_TUNJ2"))
DEFASHU_TUNJ3 = VAL(CARIPUBLIC("SHU_TUNJ3"))
DEFASHU_TUNJ4 = VAL(CARIPUBLIC("SHU_TUNJ4"))
DEFASHU_DPLK = VAL(CARIPUBLIC("SHU_DPLK"))
DEFASHU_PEMEL = VAL(CARIPUBLIC("SHU_PEMEL"))
DEFASHU_LEMB = VAL(CARIPUBLIC("SHU_LEMB"))
DEFAJURSHU_RAT = VAL(CARIPUBLIC("JurSHU_RAT"))
DEFAJURSHU_THR = VAL(CARIPUBLIC("JurSHU_THR"))
DEFAJURSHU_OPER = VAL(CARIPUBLIC("JurSHU_OPER"))
DEFAJURSHU_SRG = VAL(CARIPUBLIC("JurSHU_SRG"))
DEFAJURSHU_BEA = VAL(CARIPUBLIC("JurSHU_BEA"))
DEFAJURSHU_DOOR = VAL(CARIPUBLIC("JurSHU_DOOR"))
DEFAJURSHU_TRAN = VAL(CARIPUBLIC("JurSHU_TRAN"))
DEFAJURSHU_TALI = VAL(CARIPUBLIC("JurSHU_TALI"))
DEFAJURSHU_TUNJ1 = VAL(CARIPUBLIC("JurSHU_TUNJ1"))
DEFAJURSHU_TUNJ2 = VAL(CARIPUBLIC("JurSHU_TUNJ2"))
DEFAJURSHU_TUNJ3 = VAL(CARIPUBLIC("JurSHU_TUNJ3"))
DEFAJURSHU_TUNJ4 = VAL(CARIPUBLIC("JurSHU_TUNJ4"))
DEFAJURSHU_DPLK = VAL(CARIPUBLIC("JurSHU_DPLK"))
DEFAJURSHU_PEMEL = VAL(CARIPUBLIC("JurSHU_PEMEL"))
DEFAJURSHU_LEMB = VAL(CARIPUBLIC("JurSHU_LEMB"))
DEFAUSERID = ''
DEFAFMTANGG = IIF(LEN(DEFAFMTANGG)<1, "!!!!!!", DEFAFMTANGG)
DEFAFMTAKT = IIF(LEN(DEFAFMTAKT)<1, "!!!!.!!!!", DEFAFMTAKT)
USE
SELECT (OLDSELE)
RETURN
ENDPROC
**
FUNCTION caripublic
LPARAMETERS MDATA
LOCATE FOR KET2=MDATA
IF FOUND()
RETURN KETERANGAN
ENDIF
RETURN ""
ENDFUNC
**
PROCEDURE cekjurnalpublic
IF EMPTY(DEFANOPERKAS) .OR. EMPTY(DEFANOPERMATERAI) .OR. EMPTY(DEFANOPERNOTARIS) .OR. EMPTY(DEFANOPERPREMI) .OR. EMPTY(DEFANOPERTRANS) .OR. EMPTY(DEFANOPERSURVEI) .OR. EMPTY(DEFANOPERAKA) .OR. EMPTY(DEFANOPERAKP) .OR. EMPTY(DEFANOPERSIMPK) .OR. EMPTY(DEFANOPERSIMWJB) .OR. EMPTY(DEFANOPERSIMSMK) .OR. EMPTY(DEFANOPERPENYERT)
DO FORM setting2
ENDIF
CSQL = "select * from setsandi_pinj where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
MKOSONG = .T.
ELSE
MKOSONG = .F.
ENDIF
GOTO TOP
DO WHILE  .NOT. EOF()
IF EMPTY(JURNAL_POKOK) .OR. EMPTY(JURNAL_JASA) .OR. EMPTY(JURNAL_DENDA) .OR. EMPTY(JURNAL_ADM) .OR. EMPTY(JURNAL_PROV) .OR. EMPTY(JURNAL_YADIT) .OR. EMPTY(JURNAL_PPAP)
MKOSONG = .T.
EXIT
ENDIF
SKIP
ENDDO
IF MKOSONG
MESSAGEBOX("SETTING JURNAL KREDIT HARAP DILENGKAPI TERLEBIH DAHULU", 0, "")
ENDIF
USE
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' "
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
MKOSONG = .T.
ELSE
MKOSONG = .F.
ENDIF
GOTO TOP
DO WHILE  .NOT. EOF()
IF EMPTY(JURNALTAB) .OR. EMPTY(JURNALUTANGBG) .OR. EMPTY(JURNALBUNGA) .OR. EMPTY(JURNALADM) .OR. EMPTY(JURNALADMTUTUP) .OR. EMPTY(JURNALPAJAK) .OR. EMPTY(JURNALKSD)
MKOSONG = .T.
EXIT
ENDIF
SKIP
ENDDO
IF MKOSONG
MESSAGEBOX("SETTING JURNAL SIMPANAN HARAP DILENGKAPI TERLEBIH DAHULU", 0, "")
ENDIF
USE
ENDPROC
**
FUNCTION readini2
PARAMETER PRMPARENTSECTION, PRMCHILDSECTION, PRMDEFAULTVALUE, PRMFILEINI
DECLARE INTEGER GetPrivateProfileString IN Win32API AS GetPrivStr STRING, STRING, STRING, STRING @, INTEGER, STRING
LOCAL FILEHANDLER, RETURNVALUE
WINDINIPATH = "C:\WINDOWS\"+PRMFILEINI
IF FILE(WINDINIPATH)
FILEHANDLER = FOPEN(WINDINIPATH, 0)
PRMFILEINILOC = "C:\WINDOWS\"+PRMFILEINI
ELSE
IF FILE(PRMFILEINI)
FILEHANDLER = FOPEN(PRMFILEINI, 0)
PRMFILEINILOC = CURDIR()+PRMFILEINI
ELSE
RETURNVALUE = PRMDEFAULTVALUE
RETURN RETURNVALUE
ENDIF
ENDIF
IF FILEHANDLER<0
WAIT WINDOW NOWAIT "Gagal akses INI File."
= FCLOSE(FILEHANDLER)
RETURNVALUE = PRMDEFAULTVALUE
RETURN RETURNVALUE
ELSE
= FCLOSE(FILEHANDLER)
ENDIF
LOCAL LCBUFFER
LCBUFFER = SPACE(500)+CHR(0)
= GETPRIVSTR(PRMPARENTSECTION, PRMCHILDSECTION, PRMDEFAULTVALUE, @LCBUFFER, LEN(LCBUFFER), PRMFILEINILOC)
LCBUFFER = ALLTRIM(STRTRAN(LCBUFFER, CHR(0), ""))
RETURN LCBUFFER
ENDFUNC
**
PROCEDURE id_hardisk
LOCAL LCCOMPUTERNAME, LOWMI, LOWMIWIN32OBJECTS, LOWMIWIN32OBJECT, HDDID
LCCOMPUTERNAME = GETWORDNUM(SYS(0), 1)
LOWMI = GETOBJECT("WinMgmts://"+LCCOMPUTERNAME)
LOWMIWIN32OBJECTS = LOWMI.INSTANCESOF('Win32_LogicalDisk')
FOR EACH LOWMIWIN32OBJECT IN LOWMIWIN32OBJECTS
WITH LOWMIWIN32OBJECT
? .NAME
? .VOLUMESERIALNUMBER
ENDWITH
ENDFOR
ENDPROC
**
FUNCTION id_matherboard
LOCAL LCCOMPUTERNAME, LOWMI, LOWMIWIN32OBJECTS, LOWMIWIN32OBJECT, BASEBOARDID
LCCOMPUTERNAME = GETWORDNUM(SYS(0), 1)
LOWMI = GETOBJECT("WinMgmts://"+LCCOMPUTERNAME)
LOWMIWIN32OBJECTS = LOWMI.INSTANCESOF("Win32_BaseBoard")
FOR EACH LOWMIWIN32OBJECT IN LOWMIWIN32OBJECTS
WITH LOWMIWIN32OBJECT
BASEBOARDID = TRANSFORM(.SERIALNUMBER)
ENDWITH
ENDFOR
RETURN BASEBOARDID
ENDFUNC
**
FUNCTION GetIP
OWS = CREATEOBJECT("MSWinSock.Winsock")
LCLOCALIP = OWS.LOCALIP
OWS = ""
RETURN LCLOCALIP
ENDFUNC
**
FUNCTION MacAdress
LOCAL PGUID, RGUID, LNSIZE
DECLARE INTEGER CoCreateGuid IN 'OLE32.dll' STRING @
DECLARE INTEGER StringFromGUID2 IN 'OLE32.dll' STRING, STRING @, INTEGER
PGUID = REPLICATE(CHR(0), 16)
RGUID = REPLICATE(CHR(0), 80)
IF "5."$OS()
DECLARE INTEGER UuidCreateSequential IN 'RPCRT4.dll' STRING @
RETURN SUBSTR(IIF(UUIDCREATESEQUENTIAL(@PGUID)=0 .AND. STRINGFROMGUID2(PGUID, @RGUID, 40)<>0, STRCONV(LEFT(RGUID, 76), 6), ""), 26, 12)
ELSE
RETURN SUBSTR(IIF(COCREATEGUID(@PGUID)=0 .AND. STRINGFROMGUID2(PGUID, @RGUID, 40)<>0, STRCONV(LEFT(RGUID, 76), 6), ""), 26, 12)
ENDIF
ENDFUNC
**
PROCEDURE savelog
CSQL = "insert into mylog (userid,alamat) value "+"('"+DEFAUSERID+"',inet_aton('"+GETIP()+"'))"
ENDPROC
**
PROCEDURE errHandler
PARAMETER MERROR, MESS, MESS1, MPROG, MLINENO
CLEAR
? 'Error number: '+LTRIM(STR(MERROR))
? 'Error message: '+MESS
? 'Line of code with error: '+MESS1
? 'Line number of error: '+LTRIM(STR(MLINENO))
? 'Program with error: '+MPROG
ENDPROC
**
FUNCTION script1
PARAMETER P_KATA
LOCAL L_HASIL, L_ACAK, L_INDEX, I
L_ACAK = "MULYONO RAFIANTO"
L_HASIL = ""
L_INDEX = 1
FOR I = 1 TO LEN(ALLTRIM(P_KATA))
L_HASIL = L_HASIL+CHR(ASC(SUBSTR(P_KATA, I, 1))+ASC(SUBSTR(L_ACAK, L_INDEX, 1)))
L_INDEX = L_INDEX+1
IF L_INDEX>LEN(L_ACAK)
L_INDEX = 1
ENDIF
ENDFOR
RETURN L_HASIL
ENDFUNC
**
FUNCTION script2
PARAMETER P_KATA
IF EMPTY(P_KATA)
RETURN ""
ENDIF
LOCAL L_HASIL, L_ACAK, L_INDEX, I
L_ACAK = "MULYONO RAFIANTO"
L_HASIL = ""
L_INDEX = 1
FOR I = 1 TO LEN(ALLTRIM(P_KATA))
L_HASIL = L_HASIL+CHR(ASC(SUBSTR(P_KATA, I, 1))-ASC(SUBSTR(L_ACAK, L_INDEX, 1)))
L_INDEX = L_INDEX+1
IF L_INDEX>LEN(L_ACAK)
L_INDEX = 1
ENDIF
ENDFOR
MESSAGEBOX(L_HASIL)
RETURN L_HASIL
ENDFUNC
**
FUNCTION urutbukti
PARAMETER MKAS
OLDSELECT = SELECT()
MIP = MYIPADDRESS()
IF MKAS="NONKAS"
CSQL = "select nomorbukti from urutnota where komputer='"+MIP+"' and kas='NONKAS' and statusnomor='1'"
LCEK = SQLEXEC(OODBC, CSQL, "nomornota")
IF  .NOT. ISNULL(NOMORBUKTI) .AND.  .NOT. EMPTY(NOMORBUKTI)
RETURN NOMORBUKTI
ENDIF
CSQL = "select MIN(nomorbukti) as nomorbukti from urutnota where kas='NONKAS' and statusnomor='3'"
LCEK = SQLEXEC(OODBC, CSQL, "nomornota")
IF ISNULL(NOMORBUKTI) .OR. EMPTY(NOMORBUKTI)
CSQL = "select MAX(nomorbukti) as nomorbukti from urutnota where kas='NONKAS'"
LCEK = SQLEXEC(OODBC, CSQL, "nomornota")
MBUKTI = IIF(ISNULL(NOMORBUKTI), '00000000', NOMORBUKTI)
MBUKTI = NOTABARU(MBUKTI)
CSQL = "insert into urutnota (kantor,komputer,nomorbukti,kas,statusnomor) value (?defakantor,?mip,?mbukti,'NONKAS','1')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
MBUKTI = NOMORBUKTI
CSQL = "update urutnota set statusnomor='1', komputer=?mip where nomorbukti='"+MBUKTI+"' and kas='NONKAS'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ELSE
CSQL = "select nomorbukti from urutnota where komputer='"+MIP+"' and kas='KAS' and statusnomor='1'"
LCEK = SQLEXEC(OODBC, CSQL, "nomornota")
IF  .NOT. ISNULL(NOMORBUKTI) .AND.  .NOT. EMPTY(NOMORBUKTI)
RETURN NOMORBUKTI
ENDIF
CSQL = "select MIN(nomorbukti) as nomorbukti from urutnota where kas='KAS' and statusnomor='3'"
LCEK = SQLEXEC(OODBC, CSQL, "nomornota")
IF ISNULL(NOMORBUKTI) .OR. EMPTY(NOMORBUKTI)
CSQL = "select MAX(nomorbukti) as nomorbukti from urutnota where kas='KAS'"
LCEK = SQLEXEC(OODBC, CSQL, "nomornota")
MBUKTI = IIF(ISNULL(NOMORBUKTI), '00000000', NOMORBUKTI)
MBUKTI = NOTABARU(MBUKTI)
CSQL = "insert into urutnota (kantor,komputer,nomorbukti,kas,statusnomor) value "+"(?defakantor,'"+MIP+"',?mbukti,'KAS','1')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
MBUKTI = NOMORBUKTI
CSQL = "update urutnota set statusnomor='1', komputer='"+MIP+"' where nomorbukti='"+MBUKTI+"' and kas='KAS'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
SELECT (OLDSELECT)
RETURN MBUKTI
ENDFUNC
**
FUNCTION notabaru
PARAMETER MBUKTI
MANGKA = ALLTRIM(STR(VAL(MBUKTI)))
IF MANGKA='0'
MBUKTI = '0000000001'
ELSE
MKE = AT(MANGKA, MBUKTI)+LEN(MANGKA)
AKHIRAN = ALLTRIM(SUBSTR(MBUKTI, MKE))
MBUKTI1 = '0000000000'+ALLTRIM(STR(VAL(MANGKA)+1))+AKHIRAN
MBUKTI = RIGHT(MBUKTI1, 10)
ENDIF
RETURN MBUKTI
ENDFUNC
**
PROCEDURE updatenota
PARAMETER MSTATUS, MKAS, MBUKTI
MIP = MYIPADDRESS()
IF MSTATUS='2'
CSQL = "SELECT * FROM urutnota WHERE statusnomor='0' and kas='KAS'"
LCEK = SQLEXEC(OODBC, CSQL, "nomornota")
IF RECCOUNT()=0
CSQL = "insert into urutnota (kantor,komputer,nomorbukti,kas,statusnomor) "+"value ('"+DEFAKANTOR+"','0.0.0.0','0','KAS','0')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "SELECT * FROM urutnota WHERE statusnomor='0' and kas='NONKAS'"
LCEK = SQLEXEC(OODBC, CSQL, "nomornota")
IF RECCOUNT()=0
CSQL = "insert into urutnota (kantor,komputer,nomorbukti,kas,statusnomor) "+"value ('"+DEFAKANTOR+"','0.0.0.0','0','NONKAS','0')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "update urutnota set nomorbukti='"+MBUKTI+"' where kas='"+MKAS+"' and statusnomor='0'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from urutnota where kas='"+MKAS+"' and statusnomor='1' and komputer=?mip"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF MSTATUS='3'
CSQL = "update urutnota set statusnomor='3' where kas='"+MKAS+"' and statusnomor='1' and komputer=?mIp"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
RETURN
ENDPROC
**
PROCEDURE cekurutnota
PARAMETER MKAS, MTANGGAL, MBUKTI
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(MTANGGAL)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "ceknota")
IF ALLTRIM(BUKTI)=ALLTRIM(MBUKTI)
UPDATENOTA('2', MKAS, MBUKTI)
ELSE
UPDATENOTA('3', MKAS, MBUKTI)
ENDIF
ENDPROC
**
PROCEDURE id_hardisk
LOCAL LCCOMPUTERNAME, LOWMI, LOWMIWIN32OBJECTS, LOWMIWIN32OBJECT, HDDID
LCCOMPUTERNAME = GETWORDNUM(SYS(0), 1)
LOWMI = GETOBJECT("WinMgmts://"+LCCOMPUTERNAME)
LOWMIWIN32OBJECTS = LOWMI.INSTANCESOF('Win32_LogicalDisk')
FOR EACH LOWMIWIN32OBJECT IN LOWMIWIN32OBJECTS
WITH LOWMIWIN32OBJECT
? .NAME
? .VOLUMESERIALNUMBER
ENDWITH
ENDFOR
ENDPROC
**
FUNCTION id_matherboard
LOCAL LCCOMPUTERNAME, LOWMI, LOWMIWIN32OBJECTS, LOWMIWIN32OBJECT, BASEBOARDID
LCCOMPUTERNAME = GETWORDNUM(SYS(0), 1)
LOWMI = GETOBJECT("WinMgmts://"+LCCOMPUTERNAME)
LOWMIWIN32OBJECTS = LOWMI.INSTANCESOF("Win32_BaseBoard")
FOR EACH LOWMIWIN32OBJECT IN LOWMIWIN32OBJECTS
WITH LOWMIWIN32OBJECT
BASEBOARDID = TRANSFORM(.SERIALNUMBER)
ENDWITH
ENDFOR
RETURN BASEBOARDID
ENDFUNC
**
FUNCTION MyGetDiskVolume
LPARAMETERS CDRIVE
DECLARE GetVolumeInformation IN win32api STRING, STRING @, INTEGER, INTEGER @, INTEGER @, INTEGER @, STRING @, INTEGER
LOCAL CVOLSERIALNUMBER
IF EMPTY(CDRIVE)
CDRIVE = SYS(5)+"\"
ENDIF
M.ROOTPATH = CDRIVE
M.VOLNAME = SPACE(255)
M.VOLNAMELEN = LEN(M.VOLNAME)
M.VOLUMESERIALNUMBER = 0
M.MAXFILENAMELEN = 0
M.FILESYSTEMFLAGS = 0
M.FILESYSTEMNAME = SPACE(255)
M.FSNAMELEN = LEN(M.FILESYSTEMNAME)
= GETVOLUMEINFORMATION(M.ROOTPATH, @M.VOLNAME, M.VOLNAMELEN, @M.VOLUMESERIALNUMBER, @M.MAXFILENAMELEN, @M.FILESYSTEMFLAGS, @M.FILESYSTEMNAME, M.FSNAMELEN)
M.VOLNAME = LEFT(M.VOLNAME, AT(CHR(0), M.VOLNAME)-1)
CVOLSERIALNUMBER = M.VOLNAME+";"+LTRIM(STR(M.VOLUMESERIALNUMBER))
RETURN CVOLSERIALNUMBER
ENDFUNC
**
FUNCTION userwindows
DECLARE INTEGER GetUserName IN advapi32 STRING @, INTEGER @
NSIZE = 250
CBUFFER = REPLICATE(CHR(0), NSIZE)
= GETUSERNAME(@CBUFFER, @NSIZE)
CBUFFER = STRTRAN(CBUFFER, CHR(0), "")
RETURN CBUFFER
ENDFUNC
**
FUNCTION pembulatan
LPARAMETERS ANGKA, BLT
LOCAL DGT, ANGKA1, ANGKA2, HSL
ANGKA = ROUND(ANGKA, 0)
IF BLT<=1
RETURN ANGKA
ENDIF
DGT = ALLTRIM(STR(BLT))
DGT = LEN(DGT)
ANGKA1 = ALLTRIM(STR(ANGKA))
ANGKA1 = LEFT(ANGKA1, LEN(ANGKA1)-DGT)+REPLICATE('0', DGT)
ANGKA1 = VAL(ANGKA1)
ANGKA2 = ALLTRIM(STR(ANGKA))
ANGKA2 = RIGHT(ANGKA2, DGT)
ANGKA2 = VAL(ANGKA2)
HSL = ANGKA2/BLT
HSL = INT(HSL)+IIF(HSL=INT(HSL), 0, 1)
ANGKA2 = HSL*BLT
ANGKAHSL = ANGKA1+ANGKA2
RETURN ANGKAHSL
ENDFUNC
**
FUNCTION TERBILANG
LPARAMETERS XJML
DIMENSION ANGKA0(4), ANGKA(9), ARRANGK(12)
ANGKA0(1) = ""
ANGKA0(2) = " Ribu"
ANGKA0(3) = " Juta"
ANGKA0(4) = " Milyar"
ANGKA(1) = " Satu"
ANGKA(2) = " Dua"
ANGKA(3) = " Tiga"
ANGKA(4) = " Empat"
ANGKA(5) = " Lima"
ANGKA(6) = " Enam"
ANGKA(7) = " Tujuh"
ANGKA(8) = " Delapan"
ANGKA(9) = " Sembilan"
CHRJML = ALLTRIM(STR(XJML))
POSDES = RAT(".", CHRJML)
ANGKADES = ''
IF POSDES>0
ANGKADES = SUBSTR(CHRJML, POSDES+1)
ANGKADES = " "+ALLTRIM(STR(VAL(ANGKADES)))
CHRJML = SUBSTR(CHRJML, 1, POSDES-1)
ENDIF
LCHRJML = LEN(CHRJML)
IF (LCHRJML==1)
DNGHRF = IIF(CHRJML="0", "", ANGKA(VAL(CHRJML)))
ELSE
ARRANGK(1) = " "
ARRANGK(2) = " "
ARRANGK(3) = " "
ARRANGK(4) = " "
ARRANGK(5) = " "
ARRANGK(6) = " "
ARRANGK(7) = " "
ARRANGK(8) = " "
ARRANGK(9) = " "
ARRANGK(10) = " "
ARRANGK(11) = " "
ARRANGK(12) = " "
ANGKAKE = 0
FOR K = 1 TO LCHRJML
ARRANGK(K) = SUBSTR(CHRJML, LCHRJML-ANGKAKE, 1)
ANGKAKE = ANGKAKE+1
ENDFOR
ANGKAKE = 0
DNGHRF = ""
FOR K = 1 TO LCHRJML
CHRANGKA = SUBSTR(CHRJML, LCHRJML-ANGKAKE, 1)
IF (MOD(K, 3)=1)
DO CASE
CASE ARRANGK(K+1)="1"
CASE CHRANGKA="1" .AND. K=4 .AND. LCHRJML=4
DNGHRF = " Se"+LTRIM(ANGKA0(INT(K/3)+1))+DNGHRF
CASE CHRANGKA="1" .AND. LCHRJML>6 .AND. ARRANGK(K+1)+ARRANGK(K+2)="00" .AND. K=4
DNGHRF = " Se"+LTRIM(ANGKA0(INT(K/3)+1))+DNGHRF
CASE CHRANGKA>"0" .AND. ARRANGK(K+1)<>"1" .AND. LCHRJML>K
DNGHRF = ANGKA(VAL(CHRANGKA))+ANGKA0(INT(K/3)+1)+DNGHRF
CASE CHRANGKA>"0"
DNGHRF = ANGKA(VAL(CHRANGKA))+ANGKA0(INT(K/3)+1)+DNGHRF
ENDCASE
ELSE
IF (MOD(K, 3)=2)
DO CASE
CASE CHRANGKA="0"
CASE CHRANGKA="1" .AND. ARRANGK(K-1)="1"
DNGHRF = " Sebelas"+ANGKA0(INT(K/3)+1)+DNGHRF
CASE CHRANGKA="1" .AND. ARRANGK(K-1)="0"
DNGHRF = " Sepuluh"+ANGKA0(INT(K/3)+1)+DNGHRF
CASE CHRANGKA="1" .AND. ARRANGK(K-1)>"0"
DNGHRF = ANGKA(VAL(ARRANGK(K-1)))+" Belas"+ANGKA0(INT(K/3)+1)+DNGHRF
CASE CHRANGKA>"1" .AND. ARRANGK(K-1)="0"
DNGHRF = ANGKA(VAL(CHRANGKA))+" Puluh"+ANGKA0(INT(K/3)+1)+DNGHRF
CASE CHRANGKA>"1" .AND. ARRANGK(K-1)>"0"
DNGHRF = ANGKA(VAL(CHRANGKA))+" Puluh"+DNGHRF
ENDCASE
ELSE
IF (MOD(K, 3)=0)
DO CASE
CASE CHRANGKA="0"
CASE CHRANGKA="1" .AND. ARRANGK(K-1)<>"0"
DNGHRF = " Seratus"+DNGHRF
CASE CHRANGKA="1" .AND. ARRANGK(K-1)+ARRANGK(K-2)="00" .AND. K>3
DNGHRF = " Seratus"+ANGKA0(INT(K/3))+DNGHRF
CASE CHRANGKA="1"
DNGHRF = " Seratus"+DNGHRF
CASE CHRANGKA>"1" .AND. ARRANGK(K-1)<>"0"
DNGHRF = ANGKA(VAL(CHRANGKA))+" Ratus"+DNGHRF
CASE CHRANGKA>"1" .AND. ARRANGK(K-1)+ARRANGK(K-2)="00" .AND. K>3
DNGHRF = ANGKA(VAL(CHRANGKA))+" Ratus"+ANGKA0(INT(K/3))+DNGHRF
CASE CHRANGKA>"1" .AND. ARRANGK(K-1)="0" .AND. K>3
DNGHRF = ANGKA(VAL(CHRANGKA))+" Ratus"+DNGHRF
CASE CHRANGKA>"1" .AND. K=3
DNGHRF = ANGKA(VAL(CHRANGKA))+" Ratus"+DNGHRF
ENDCASE
ENDIF
ENDIF
ENDIF
ANGKAKE = ANGKAKE+1
ENDFOR
ENDIF
IF (VAL(CHRJML)=0 .AND. VAL(ANGKADES)=0)
DNGHRF = ""
ELSE
IF (VAL(CHRJML)<>0 .AND. VAL(ANGKADES)=0)
ELSE
IF (VAL(CHRJML)=0 .AND. VAL(ANGKADES)<>0)
ELSE
ANGKADES = ALLTRIM(ANGKADES)
DO WHILE .T.
IF RIGHT(ANGKADES, 1)<>'0'
EXIT
ENDIF
ANGKADES = LEFT(ANGKADES, LEN(ANGKADES)-1)
ENDDO
ANGKADES = VAL(ANGKADES)
DNGHRF = DNGHRF+" Koma "+TERBILANG(ANGKADES)
ENDIF
ENDIF
ENDIF
RETURN DNGHRF
ENDFUNC
**
FUNCTION harikerja
PARAMETER XTGL
LOCAL VTGL, JHARI, JHR
VTGL = AWALBLN(XTGL)
JHARI = 0
JHR = 0
DO WHILE .T.
IF VTGL>AKHIRBLN(XTGL)
EXIT
ENDIF
JHR = JHR+1
IF  .NOT. (NAMAHARI(VTGL)='SABTU' .OR. NAMAHARI(VTGL)='MINGGU')
JHARI = JHARI+1
ENDIF
VTGL = VTGL+1
ENDDO
RETURN JHR
ENDFUNC
**
FUNCTION hrdalambln
PARAMETER MTGL
RETURN AKHIRBLN(MTGL)-(AWALBLN(MTGL)-1)
ENDFUNC
**
FUNCTION awalbln
PARAMETER MTGL
LOCAL XTGLAWAL
XTGLAWAL = CTOD('01-'+STR(MONTH(MTGL), 2)+'-'+STR(YEAR(MTGL), 4))
RETURN XTGLAWAL
ENDFUNC
**
FUNCTION akhirbln
PARAMETER MTGL
LOCAL XTGLAKHIR
SET CENTURY ON
XTGLAKHIR = CTOD('26-'+STR(MONTH(MTGL), 2)+'-'+STR(YEAR(MTGL), 4))
A = 1
DO WHILE .T.
A = A+1
IF A>50
EXIT
ENDIF
IF MONTH(XTGLAKHIR)<>MONTH(XTGLAKHIR+1)
EXIT
ENDIF
XTGLAKHIR = XTGLAKHIR+1
ENDDO
RETURN XTGLAKHIR
ENDFUNC
**
FUNCTION maju1bln
PARAMETER MTGL, MTGL1
LOCAL XTGL, XTGLASAL
MTGL1 = IIF(EMPTY(MTGL1), MTGL, MTGL1)
XTGL = MTGL+27
DO WHILE .T.
IF MONTH(XTGL)<>MONTH(MTGL)
EXIT
ENDIF
XTGL = XTGL+1
ENDDO
XTGLASAL = XTGL
DO WHILE .T.
IF DAY(XTGL)=DAY(MTGL1) .OR. (MONTH(XTGL)<>MONTH(XTGLASAL))
EXIT
ENDIF
XTGL = XTGL+1
ENDDO
IF MONTH(XTGL)<>MONTH(XTGLASAL)
XTGL = XTGL-1
ENDIF
RETURN XTGL
ENDFUNC
**
PROCEDURE majubulan
PARAMETER MTGL, MKALI, MTGLASAL
FOR I = 1 TO MKALI
MAJU1BLN(MTGL, MTGLASAL)
ENDFOR
RETURN
ENDPROC
**
FUNCTION NAMAHARI
LPARAMETERS VTGL
LOCAL HARI, NMHARI
HARI = DOW(VTGL)
DO CASE
CASE HARI=1
NMHARI = "MINGGU"
CASE HARI=2
NMHARI = "SENIN"
CASE HARI=3
NMHARI = "SELASA"
CASE HARI=4
NMHARI = "RABU"
CASE HARI=5
NMHARI = "KAMIS"
CASE HARI=6
NMHARI = "JUMAT"
CASE HARI=7
NMHARI = "SABTU"
ENDCASE
RETURN NMHARI
ENDFUNC
**
FUNCTION namabulan
LPARAMETERS BLN
LOCAL MBLN
MBLN = IIF(VARTYPE(BLN)="D", MONTH(BLN), IIF(VARTYPE(BLN)="C", 1, BLN))
DO CASE
CASE MBLN=1
NAMABULAN = 'Januari'
CASE MBLN=2
NAMABULAN = 'Februari'
CASE MBLN=3
NAMABULAN = 'Maret'
CASE MBLN=4
NAMABULAN = 'April'
CASE MBLN=5
NAMABULAN = 'Mei'
CASE MBLN=6
NAMABULAN = 'Juni'
CASE MBLN=7
NAMABULAN = 'Juli'
CASE MBLN=8
NAMABULAN = 'Agustus'
CASE MBLN=9
NAMABULAN = 'September'
CASE MBLN=10
NAMABULAN = 'Oktober'
CASE MBLN=11
NAMABULAN = 'Nopember'
CASE MBLN=12
NAMABULAN = 'Desember'
OTHERWISE
NAMABULAN = ' '
ENDCASE
RETURN NAMABULAN
ENDFUNC
**
FUNCTION UraiTgl
PARAMETER VTGL
RETURN STR(DAY(VTGL), 2)+' '+NAMABULAN(VTGL)+' '+STR(YEAR(VTGL), 4)
ENDFUNC
**
FUNCTION haritgl
LPARAMETERS VTGL
RETURN NAMAHARI(VTGL)+', '+URAITGL(VTGL)
ENDFUNC
**
FUNCTION jmlhari
LPARAMETERS XXTGL1, XXTGL2
LOCAL BLN
DIMENSION HARIBLN[2]
BLN = 0
IF XXTGL1<XXTGL2 .OR. EMPTY(XXTGL1) .OR. EMPTY(XXTGL2)
HARIBLN[1] = 0
HARIBLN[2] = 0
RETURN HARIBLN
ENDIF
MTGL2 = XXTGL2
DO WHILE .T.
IF MAJU1BLN(MTGL2)>XXTGL1
EXIT
ENDIF
BLN = BLN+1
MTGL2 = MAJU1BLN(MTGL2)
ENDDO
HARIBLN[1] = BLN
HARIBLN[2] = XXTGL1-MTGL2
RETURN HARIBLN
ENDFUNC
**
FUNCTION hitjt
PARAMETER MPERIODE, MLAMA, MTGLAWAL
LOCAL I, MTGLASAL
MTGLASAL = MTGLAWAL
MTGJT = MTGLAWAL
DO CASE
CASE MPERIODE='HARIAN'
FOR I = 1 TO MLAMA-1
MTGJT = MTGJT+1
ENDFOR
CASE MPERIODE='MINGGUAN'
FOR I = 1 TO MLAMA-1
MTGJT = MTGJT+7
ENDFOR
CASE MPERIODE='PASARAN'
FOR I = 1 TO MLAMA-1
MTGJT = MTGJT+5
ENDFOR
OTHERWISE
FOR I = 1 TO MLAMA-1
MTGJT = MAJU1BLN(MTGJT, MTGLASAL)
ENDFOR
ENDCASE
MTGLJTEMPO = MTGJT
RETURN MTGLJTEMPO
ENDFUNC
**
FUNCTION sqldate
LPARAMETERS MTGL
LOCAL MTGL1, MTGL2, MTGL3, MTGL4
IF (VARTYPE(MTGL)="D" .OR. VARTYPE(MTGL)="T") .AND.  .NOT. EMPTY(MTGL) .AND.  .NOT. ISNULL(MTGL)
MTGL1 = TRANSFORM(YEAR(MTGL), '9999')
MTGL2 = ALLTRIM(TRANSFORM(MONTH(MTGL), '99'))
MTGL3 = ALLTRIM(TRANSFORM(DAY(MTGL), '99'))
MTGL4 = RIGHT('0000'+MTGL1, 4)+'-'+RIGHT('00'+MTGL2, 2)+'-'+RIGHT('00'+MTGL3, 2)
ELSE
MTGL4 = "0000-00-00"
ENDIF
RETURN MTGL4
ENDFUNC
**
FUNCTION sqldatetime
LPARAMETERS MTGL, MJAM
LOCAL MTGL1, MTGL2, MTGL3, MTGL4
IF VARTYPE(MTGL)="D" .AND.  .NOT. EMPTY(MTGL) .AND.  .NOT. ISNULL(MTGL)
MTGL1 = TRANSFORM(YEAR(MTGL), '9999')
MTGL2 = ALLTRIM(TRANSFORM(MONTH(MTGL), '99'))
MTGL3 = ALLTRIM(TRANSFORM(DAY(MTGL), '99'))
MTGL4 = RIGHT('0000'+MTGL1, 4)+'-'+RIGHT('00'+MTGL2, 2)+'-'+RIGHT('00'+MTGL3, 2)
ELSE
MTGL4 = "0000-00-00"
ENDIF
IF VARTYPE(MJAM)="X" .OR. VARTYPE(MJAM)="L"
MJAM = TIME()
ENDIF
MTGL4 = MTGL4+' '+MJAM
RETURN MTGL4
ENDFUNC
**
FUNCTION sql2date
LPARAMETERS MTGL
LOCAL MTGL1, MTGL2, MTGL3, MTGL4
MTGL1 = LEFT(MTGL, 4)
MTGL2 = SUBSTR(MTGL, 6, 2)
MTGL3 = SUBSTR(MTGL, 9, 2)
RETURN CTOD(MTGL1+'-'+MTGL2+'-'+MTGL3)
ENDFUNC
**
FUNCTION Flat2eff
LPARAMETERS MRATE, MLAMA, MADV
LOCAL LOCAL1, LOCAL2, LOCAL3, LOCAL4, LOCAL5, LOCAL6, LOCAL7
IF (MRATE<>0)
F_ADV1 = IIF(MADV="Y", 1, 0)
IF (F_ADV1==1)
LOCAL5 = 10000000.0 
LOCAL6 = MRATE/100*LOCAL5/12*MLAMA
LOCAL7 = (LOCAL5+LOCAL6)/MLAMA
MRATE = LOCAL6/(LOCAL5-LOCAL7)/(MLAMA-1)*1200
ENDIF
MRATE = MRATE/1200
LOCAL1 = MRATE+1/(MLAMA-F_ADV1)
LOCAL2 = MRATE+0.01 
LOCAL3 = 000000.000000001000000000 
F_EFEK = 0
DO WHILE (ABS(F_EFEK-LOCAL2)>LOCAL3 .AND. MRATE<>0)
IF (F_EFEK<>0)
LOCAL2 = F_EFEK
ENDIF
LOCAL4 = (LOCAL2+1)**(MLAMA-F_ADV1)
F_EFEK = LOCAL1*(LOCAL4-1)/LOCAL4
ENDDO
ELSE
F_EFEK = 0
ENDIF
RETURN F_EFEK*1200
ENDFUNC
**
FUNCTION Eff2Flat
LPARAMETERS XEFF, LAMA
FLAT = (((1*XEFF/1200*(1+XEFF/1200)**LAMA)/(((1+XEFF/1200)**LAMA)-1)*LAMA)-1)/1*100/(LAMA/12)
RETURN FLAT
ENDFUNC
**
PROCEDURE _passprm
PARAMETER _LONMCLASS, _LCMD
LOCAL _CNTCLASS
FOR _CNTCLASS = 1 TO _SCREEN.FORMCOUNT
IF _SCREEN.FORMS(_CNTCLASS).BASECLASS="Form" .AND. UPPER(_SCREEN.FORMS(_CNTCLASS).NAME)==UPPER(_LONMCLASS)
_SCREEN.FORMS[_CNTCLASS].&_LCMD.
EXIT
ENDIF
ENDFOR
ENDPROC
**
PROCEDURE _openfile
PARAMETER _LPNMFILE
DECLARE INTEGER ShellExecute IN shell32.DLL INTEGER, STRING, STRING, STRING, STRING, INTEGER
CACTION = "open"
SHELLEXECUTE(0, CACTION, _LPNMFILE, "", "", 1)
ENDPROC
**
FUNCTION ROUNDUP
LPARAMETERS NANGKA
RETURN CEILING(NANGKA/10)*10
ENDFUNC
**
FUNCTION duit
PARAMETER ARTO
PUBLIC DUITEN
X_STR = INT(ARTO)
T_STR = ALLTRIM(STR(INT(X_STR)))
Y_STR = TRANSFORM(ARTO, '#########.##')
IF T_STR="0"
DUITEN = '-'
RETURN (DUITEN)
ENDIF
KALIMAT = ''
DIMENSION SEP[5]
SEP[1] = ''
SEP[2] = ' Ribu'
SEP[3] = ' Juta'
SEP[4] = ' Miliyard'
SEP[5] = ' Triliyun'
NIL0 = ' Puluh'
NIL = ' '
NIL1 = ' Satu'
NIL2 = ' Dua'
NIL3 = ' Tiga'
NIL4 = ' Empat'
NIL5 = ' Lima'
NIL6 = ' Enam'
NIL7 = ' Tujuh'
NIL8 = ' Delapan'
NIL9 = ' Sembilan'
Z = RIGHT(Y_STR, 2)
Z1 = IIF(SUBSTR(Z, 1, 1)='0', ' ', SUBSTR(Z, 1, 1))
Z2 = SUBSTR(Z, 2, 1)
IF VAL(Z)>0
Z3=' Koma'+NIL&Z1+NIL&Z2
ELSE
Z3 = ''
ENDIF
NIL0 = ''
T_BAGI_3 = INT(LEN(T_STR)/3)
IF T_BAGI_3<>0
IF MOD(LEN(T_STR), 3)=0
T_NIL_SEP = T_BAGI_3
ELSE
T_NIL_SEP = T_BAGI_3+1
T_STR = STUFF(T_STR, 1, 0, REPLICATE('0', 3-(MOD(LEN(T_STR), 3))))
ENDIF
ELSE
T_STR = STUFF(T_STR, 1, 0, REPLICATE('0', 3-(MOD(LEN(T_STR), 3))))
T_NIL_SEP = 1
ENDIF
T_COUNTER = 1
T_BACA = 1
T_BACA_TEMP = SPACE(3)
DO WHILE T_NIL_SEP>=1
T_BACA_TEMP = SUBSTR(T_STR, T_BACA, 3)
COU = 1
DO WHILE COU<=3
XCOU = LTRIM(STR(COU))
BACA&XCOU=SUBS(T_BACA_TEMP,COU,1)
COU = COU+1
ENDDO
DO CASE
CASE BACA1='0'
KALIMAT=KALIMAT+NIL&BACA1
CASE BACA1='1'
KALIMAT = KALIMAT+' Seratus'
CASE BACA1<>'1' .AND. BACA1<>'0'
KALIMAT=KALIMAT+NIL&BACA1+' Ratus'
ENDCASE
DO CASE
CASE BACA2='1' .AND. BACA3='0'
KALIMAT = KALIMAT+' Sepuluh'
CASE BACA2='1' .AND. BACA3='1'
KALIMAT = KALIMAT+' Sebelas'
CASE BACA2='1' .AND. BACA3>'1'
KALIMAT=KALIMAT+NIL&BACA3+' Belas'
CASE BACA2>'1' .AND. BACA3='0'
KALIMAT=KALIMAT+NIL&BACA2+' Puluh'
CASE BACA2>'1' .AND. BACA3>'0'
KALIMAT=KALIMAT+NIL&BACA2+' Puluh'+NIL&BACA3
CASE BACA2='0'
IF T_NIL_SEP=2 .AND. BACA3='1'
IF BACA1<>'0'
KALIMAT = KALIMAT+' Satu Ribu'
ELSE
KALIMAT = KALIMAT+' Seribu'
ENDIF
T_NIL_SEP = T_NIL_SEP-1
T_BACA = T_BACA+3
LOOP
ELSE
KALIMAT=KALIMAT+NIL&BACA3
ENDIF
ENDCASE
IF T_BAGI_3=0
EXIT
ENDIF
IF T_BACA_TEMP<>'000'
KALIMAT = KALIMAT+SEP(T_NIL_SEP)
ENDIF
T_NIL_SEP = T_NIL_SEP-1
T_BACA = T_BACA+3
ENDDO
DUITEN = ALLTRIM(KALIMAT)+Z3+' Rupiah'
RETURN (DUITEN)
ENDFUNC
**
PROCEDURE RepWind
LPARAMETERS NMREPFORM, CAPREPFORM, FRMTARGET, FRMTIPE
LOCAL REPFORM AS FORM
REPFORM = CREATEOBJECT("Form")
WITH REPFORM
.CAPTION = CAPREPFORM
.NAME = NMREPFORM
.WIDTH = SYSMETRIC(1)-15
.HEIGHT = SYSMETRIC(2)-50
.AUTOCENTER = .T.
.MAXBUTTON = .F.
.ALWAYSONTOP = .T.
.HALFHEIGHTCAPTION = .T.
ENDWITH
DO CASE
CASE FRMTIPE=1
REPORT FORM &FRMTARGET. TO PRINTER PROMPT
CASE FRMTIPE=2
REPORT FORM &FRMTARGET. TO PRINTER PROMPT PREVIEW WINDOW &NMREPFORM. 
CASE FRMTIPE=3
REPORT FORM &FRMTARGET. PREVIEW WINDOW &NMREPFORM. NOWAIT
CASE FRMTIPE=4
REPORT FORM &FRMTARGET. PREVIEW WINDOW &NMREPFORM. 
ENDCASE
RELEASE REPFORM
RETURN
ENDPROC
**
FUNCTION alamatIP
IPCOMP = CREATEOBJECT('MSWinsock.Winsock.1')
RETURN IPCOMP.LOCALIP
ENDFUNC
**
PROCEDURE chk_err
_OK = .F.
RETURN
ENDPROC
**
PROCEDURE wait_nowait
PARAMETER WAIT_TEXT
WAIT WINDOW AT SROWS()/2.7 , SCOLS()/3 TIMEOUT 5 WAIT_TEXT
RETURN
ENDPROC
**
PROCEDURE BacaExcell
LPARAMETERS CFILE
LOCAL LCFILE
LOCAL LCPATH, LCJUSTNAME, LCSTEM, OCN, LCCON, LLERR
NAMACURSOR = "curTemp"
LCFILE = CFILE
LCPATH = JUSTPATH(LCFILE)
LCJUSTFNAME = JUSTFNAME(LCFILE)
LCSTEM = JUSTSTEM(LCJUSTFNAME)
OCN = CREATEOBJECT("ADODB.CONNECTION")
LCCON = "Driver={Microsoft Excel Driver (*.xls)};"+"DriverId=790;"+"Dbq="+LCJUSTFNAME+";"+"DefaultDir="+LCPATH+";"
OCN.OPEN(LCCON)
ORS = OCN.EXECUTE("SELECT * FROM ["+LCSTEM+"$]")
BB = ORS.FIELDS.COUNT-1
FF = ''
DIMENSION CC(BB+1), HH(BB+1)
FOR I = 0 TO BB
CC(I+1) = ORS.FIELDS(I).NAME
DD = ORS.FIELDS(I).TYPE
DO CASE
CASE DD=5
EE = CC(I+1)+" "+"N(20.2)"
HH(I+1) = 0.00 
CASE DD=200
EE = CC(I+1)+" "+"C(150)"
HH(I+1) = ''
CASE DD=135
EE = CC(I+1)+" "+"D(8)"
HH(I+1) = CTOD('01/01/1990')
CASE DD=11
EE = CC(I+1)+" "+"L(1)"
HH(I+1) = .F.
ENDCASE
ENDFOR
ENDPROC
**
FUNCTION aadd
LPARAMETERS ANAME, AISI
AA = ALEN(ANAME)
DIMENSION AA(2)
DIMENSION ANAME(ALEN(ANAME)+1)
ANAME[ALEN(ANAME)+1] = AISI
RETURN ANAME
ENDFUNC
**
PROCEDURE asistenku
LPARAMETERS KATA1, KATA2, KATA3
PUBLIC GNUPPER
NAVLAGENT = ADIR(CAVLAGENT, GETENV("windir")+'\msagent\chars\*.acs')
IF NAVLAGENT>0
OAGENT = CREATEOBJECT("Agent.Control.1")
OAGENT.CONNECTED = .T.
GNLOWER = 1
GNUPPER = NAVLAGENT
XAGENT = IIF(MONTH(DATE())<GNUPPER, CAVLAGENT(MONTH(DATE()), 1), CAVLAGENT(INT((GNUPPER-GNLOWER+1)*RAND()+GNLOWER), 1))
OAGENT.CHARACTERS.LOAD(ALLTRIM(XAGENT), GETENV("windir")+'\msagent\chars\'+ALLTRIM(XAGENT))
OCHAR = OAGENT.CHARACTERS(ALLTRIM(XAGENT))
OCHAR.MOVETO(RAND()*600, RAND()*600)
OCHAR.SHOW
OCHAR.SPEAK(KATA1)
OCHAR.SPEAK(KATA2)
OCHAR.SPEAK(KATA3)
GNUPPER = 0
FOR EACH ANIMATION IN OCHAR.ANIMATIONNAMES
GNUPPER = GNUPPER+1
DIMENSION DTARRAY(GNUPPER) AS CHARACTER
DTARRAY(GNUPPER) = ANIMATION
ENDFOR
XAGENT = IIF(MONTH(DATE())<GNUPPER, DTARRAY(MONTH(DATE())), DTARRAY(INT((GNUPPER-GNLOWER+1)*RAND()+GNLOWER)))
X = 'oChar.Play("'+XAGENT+'")'
&X
WAIT ""
ENDIF
RETURN
ENDPROC
**
FUNCTION ErrorMsg
LPARAMETERS TCMESSAGETEXT, TNDIALOGTYPE, TCMESSAGETITLE
LOCAL LNANSWER
IF EMPTY(TCMESSAGETEXT)
TCMESSAGETEXT = "Syntax Error: ErrorMsg(tcMessageText, tnDialogType, tcMessageTitle)"
ENDIF
IF EMPTY(TNDIALOGTYPE)
TNDIALOGTYPE = 016
ENDIF
IF EMPTY(TCMESSAGETITLE)
TCMESSAGETITLE = "Perhatian!!"
ENDIF
IF TNDIALOGTYPE==3
LNANSWER = MYMESSAGEBOX(TCMESSAGETEXT, TNDIALOGTYPE, TCMESSAGETITLE)
ENDIF
IF TNDIALOGTYPE==4
LNANSWER = MYMESSAGEBOX(TCMESSAGETEXT, TNDIALOGTYPE, TCMESSAGETITLE)
ELSE
LNANSWER = MESSAGEBOX(TCMESSAGETEXT, TNDIALOGTYPE, TCMESSAGETITLE)
ENDIF
RETURN LNANSWER
ENDFUNC
**
FUNCTION MyMessageBox
LPARAMETERS TCMESSAGE, TNDIALOGTYPE, TCCAPTION
LOCAL NRETVAL, LOFORM
IF TNDIALOGTYPE=4
LOFORM = CREATEOBJECT('MyYaTidak', TCMESSAGE, TCCAPTION)
ENDIF
IF TNDIALOGTYPE=3
LOFORM = CREATEOBJECT('MyYaTidakBatal', TCMESSAGE, TCCAPTION)
ENDIF
IF EMPTY(TNDIALOGTYPE)
ERRORMSG(TCMESSAGE)
ENDIF
LOFORM.SHOW()
NRETVAL = -1
NRETVAL = LOFORM.URETCODE
LOFORM.RELEASE()
RETURN NRETVAL
ENDFUNC
**
FUNCTION PrintMerge
LPARAMETERS TCFILE, TCREC
OWORD = CREATEOBJECT("Word.Application")
OWORD.VISIBLE = .F.
OWORD.WINDOWSTATE = 2
WCONN = GCDOCPATH+'\'+'connloanapp.odc'
OWORD.DOCUMENTS.OPEN(TCFILE)
OWORD.ACTIVEDOCUMENT.MAILMERGE.OPENDATASOURCE(WCONN)
IF OWORD.ACTIVEDOCUMENT.MAILMERGE.STATE=2
WAIT WINDOW 'in if '+STR(TCREC)
OWORD.ACTIVEDOCUMENT.MAILMERGE.DATASOURCE.ACTIVERECORD = TCREC
WAIT WINDOW 'after active record'
OWORD.ACTIVEDOCUMENT.MAILMERGE.DESTINATION = 1
OWORD.ACTIVEDOCUMENT.MAILMERGE.DATASOURCE.FIRSTRECORD = OWORD.ACTIVEDOCUMENT.MAILMERGE.DATASOURCE.ACTIVERECORD
OWORD.ACTIVEDOCUMENT.MAILMERGE.DATASOURCE.LASTRECORD = OWORD.ACTIVEDOCUMENT.MAILMERGE.DATASOURCE.ACTIVERECORD
OWORD.ACTIVEDOCUMENT.MAILMERGE.EXECUTE
ENDIF
OWORD.QUIT(0)
RELEASE OWORD
RETURN .T.
ENDFUNC
**
FUNCTION TglToStr
LPARAMETERS DTANGGAL
RETURN "01-januari-2008"
LOCAL RET_VAL
RET_VAL = STR(DAY(DTANGGAL), 2)+" "+TGLTOBLN(DTANGGAL)+" "+STR(YEAR(DTANGGAL), 4)
RETURN RET_VAL
ENDFUNC
**
PROCEDURE tgltobln
RETURN
ENDPROC
**
FUNCTION hitungjam
LPARAMETERS MJAM1, MJAM2
JAM1 = VAL(LEFT(MJAM1, 2))*3600
MNT1 = VAL(SUBSTR(MJAM1, 4, 2))*60
DTK1 = VAL(SUBSTR(MJAM1, 7, 2))
JDTK1 = JAM1+MNT1+DTK1
JAM2 = VAL(LEFT(MJAM2, 2))*3600
MNT2 = VAL(SUBSTR(MJAM2, 4, 2))*60
DTK2 = VAL(SUBSTR(MJAM2, 7, 2))
JDTK2 = JAM2+MNT2+DTK2
DTK = ABS(JDTK1-JDTK2)
RETURN DTK
ENDFUNC
**
FUNCTION MySqlExec
LPARAMETERS MYODBC, MSQL, MHASIL
LOCAL LCEK
LCEK = SQLEXEC(MYODBC, MSQL, MHASIL)
IF LCEK<1
MESSAGEBOX("Query gagal, cek program atau koneksi jaringan", 048)
RETURN .F.
ENDIF
RETURN .T.
ENDFUNC
**
FUNCTION hitungjam
LPARAMETERS JAM1, JAM2
DETIK1 = JAM2DETIK(JAM1)
DETIK2 = JAM2DETIK(JAM2)
DETIK = DETIK2-DETIK1
HASIL = DETIK2JAM(DETIK)
RETURN HASIL
ENDFUNC
**
FUNCTION jam2detik
LPARAMETERS JAM
LOCAL JM, DETIK, MN, DT
JM = LEFT(JAM, AT(":", JAM))
DETIK = VAL(JM)*60*60
MN = SUBSTR(JAM, 4, 2)
DETIK = DETIK+(VAL(MN)*60)
DT = SUBSTR(JAM, 7, 2)
DETIK = DETIK+VAL(DT)
RETURN DETIK
ENDFUNC
**
FUNCTION detik2jam
LPARAMETERS DETIK
LOCAL JM, MN, HASIL
JM = INT(DETIK/3600)
DETIK = DETIK-(JM*3600)
MN = INT(DETIK/60)
DETIK = DETIK-(MN*60)
HASIL = ALLTRIM(STR(JM))+":"+TRANSFORM(MN, '99')+":"+TRANSFORM(DETIK, '99')
RETURN HASIL
ENDFUNC
**
FUNCTION jam2angka
LPARAMETERS MJAM
LOCAL MTH, MBL, MHR, MJM, MMN, MDT
MTH = TRANSFORM(YEAR(MJAM), '9999')
MBL = RIGHT('00'+ALLTRIM(TRANSFORM(MONTH(MJAM), '99')), 2)
MHR = RIGHT('00'+ALLTRIM(TRANSFORM(DAY(MJAM), '99')), 2)
MJM = RIGHT('00'+ALLTRIM(TRANSFORM(HOUR(MJAM), '99')), 2)
MMN = RIGHT('00'+ALLTRIM(TRANSFORM(MINUTE(MJAM), '99')), 2)
MDT = RIGHT('00'+ALLTRIM(TRANSFORM(SEC(MJAM), '99')), 2)
RETURN MTH+MBL+MHR+MJM+MMN+MDT
ENDFUNC
**
FUNCTION ganti
PARAMETER MKATA, MASAL, MGANTI
IF AT(MASAL, MKATA)=0
RETURN MKATA
ENDIF
KATA1 = LEFT(MKATA, AT(MASAL, MKATA)-1)
KATA2 = SUBSTR(MKATA, AT(MASAL, MKATA)+LEN(MASAL))
KATA3 = KATA1+MGANTI+KATA2
RETURN KATA3
ENDFUNC
**
PROCEDURE keluar
FOR X = 1 TO _SCREEN.FORMCOUNT
IF UPPER(_SCREEN.FORMS(X).NAME)="AWAL"
SET SYSMENU OFF
_SCREEN.FORMS[X].SHOW
ENDIF
ENDFOR
RETURN
ENDPROC
**
PROCEDURE errhand
PARAMETER ERRNUM, ERRMESSAGE, BARISSALAH, MPROG, BARISPROG
CSQL = "select COUNT(barissalah) as ada from log_error"
LCEK = SQLEXEC(OODBC, CSQL, "SALAH")
IF LCEK<1
GAGALSQL("Gagal baca LOG_ERROR")
ENDIF
MADA = SALAH.ADA
IF VARTYPE(SALAH.ADA)="C"
MADA = VAL(SALAH.ADA)
ENDIF
IF MADA>0
USE
ELSE
USE
CSQL = "INSERT into log_error (tanggal,nomorerror,pesansalah,barissalah,program,barisprog) values "+"('"+SQLDATE(TGLNOW)+"','"+STR(ERRNUM)+"','"+CEKKATA(ERRMESSAGE)+"','"+CEKKATA(BARISSALAH)+"','"+CEKKATA(MPROG)+"','"+STR(BARISPROG)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
GAGALSQL("Gagal baca LOG_ERROR 000000")
ENDIF
ENDIF
RETURN
ENDPROC
**
PROCEDURE gagalsql
PARAMETER PESAN
MESSAGEBOX(PESAN)
RETURN
ENDPROC
**
FUNCTION emptychk
PARAMETER PCDOC
IF  .NOT. EMPTY(PCDOC)
RETURN .T.
ELSE
WAIT WINDOW "Enter a name for the Word Document"
RETURN 0
ENDIF
ENDFUNC
**
FUNCTION haribulan
PARAMETER MTGL
RETURN DAY(AKHIRBLN(MTGL))
ENDFUNC
**
FUNCTION jangkawaktu
PARAMETER ARG1, ARG2
LOCAL LAMA
LAMA = ((YEAR(ARG2)-YEAR(ARG1))*12)+(MONTH(ARG2)-MONTH(ARG1))+1
RETURN LAMA
ENDFUNC
**
PROCEDURE hitungnrc
PARAMETER MTGL1, MTGL2
HITUNG = SYS(2015)
CREATE CURSOR HITUNGNRC (MTGL DATE, TANGGAL DATE, NOPER C (10), SALDOAWAL N (15), MUTASIDEBET N (15), MUTASIKREDIT N (15), SALDOAKHIR N (15))
CSQL = "SELECT t1.noper, t1.tanggal, t1.saldoawal, t1.mutasidebet, t1.mutasikredit, "+"t1.saldoakhir FROM akt_neraca t1 "+"WHERE tutupbuku<>'T' and tanggal = ( SELECT MAX( t2.tanggal ) "+"FROM akt_neraca t2 WHERE t1.noper = t2.noper AND tutupbuku<>'Y' and tanggal < ?sqldate(mtgl1) "+"GROUP BY noper ) "
LCEK = SQLEXEC(OODBC, CSQL, HITUNG)
GOTO TOP
DO WHILE  .NOT. EOF()
MTANGGAL = TANGGAL
MNOPER = NOPER
MSALDOAWAL = SALDOAWAL
MMUTASIDEBET = MUTASIDEBET
MMUTASIKREDIT = MUTASIKREDIT
MSALDOAKHIR = SALDOAKHIR
SELECT HITUNGNRC
APPEND BLANK
REPLACE MTGL WITH MTANGGAL, TANGGAL WITH MTANGGAL, NOPER WITH MNOPER, SALDOAWAL WITH MSALDOAWAL
REPLACE MUTASIDEBET WITH MMUTASIDEBET, MUTASIKREDIT WITH MMUTASIKREDIT, SALDOAKHIR WITH MSALDOAKHIR
SELECT &HITUNG
SKIP
ENDDO
IF MTGL1<>MTGL2
CSQL = "SELECT t1.noper, t1.tanggal, t1.saldoawal, t1.mutasidebet, t1.mutasikredit, "+"t1.saldoakhir FROM akt_neraca t1 "+"WHERE tutupbuku<>'T' and tanggal = ( SELECT MAX( t2.tanggal ) "+"FROM akt_neraca t2 WHERE t1.noper = t2.noper AND tutupbuku<>'Y' and tanggal < ?sqldate(mtgl2) "+"GROUP BY noper ) "
LCEK = SQLEXEC(OODBC, CSQL, HITUNG)
GOTO TOP
DO WHILE  .NOT. EOF()
MTANGGAL = TANGGAL
MNOPER = NOPER
MSALDOAWAL = SALDOAWAL
MMUTASIDEBET = MUTASIDEBET
MMUTASIKREDIT = MUTASIKREDIT
MSALDOAKHIR = SALDOAKHIR
SELECT HITUNGNRC
APPEND BLANK
REPLACE MTGL WITH MTANGGAL, TANGGAL WITH MTANGGAL, NOPER WITH MNOPER, SALDOAWAL WITH MSALDOAWAL
REPLACE MUTASIDEBET WITH MMUTASIDEBET, MUTASIKREDIT WITH MMUTASIKREDIT, SALDOAKHIR WITH MSALDOAKHIR
SELECT &HITUNG
SKIP
ENDDO
ENDIF
SELECT &HITUNG
USE
ENDPROC
**
FUNCTION saldoner
PARAMETER TGL1, MSET
LOCAL HIT, MSET1, MSET2, JML, JML1
IF MSET=' '
RETURN 0
ENDIF
JML = 0
MSET1 = MSET
MSET2 = ''
T = '+'
DO WHILE .T.
X = LEFT(MSET1, 1)
IF X='+' .OR. X='-' .OR. X='/' .OR. X='*' .OR. X='(' .OR. X=')'
JML1 = 0
MPANJ = LEN(MSET2)
SUM SALDOAKHIR TO JML1 FOR TANGGAL=TGL1 .AND. LEFT(NOPER, MPANJ)=MSET2
DO CASE
CASE T='+'
JML = JML+JML1
CASE T='-'
JML = JML-JML1
CASE T='/'
JML = JML/JML1
CASE T='*'
JML = JML*JML1
OTHERWISE
JML = JML+JML1
ENDCASE
T = X
MSET2 = ''
MSET1 = SUBSTR(MSET1, 2, LEN(MSET1)-1)
ENDIF
MSET2 = MSET2+LEFT(MSET1, 1)
IF LEN(MSET1)=0
JML1 = 0
ADA = .F.
MPANJ = LEN(MSET2)
SUM SALDOAKHIR TO JML1 FOR TANGGAL=TGL1 .AND. LEFT(NOPER, MPANJ)=MSET2
DO CASE
CASE T='-'
JML = JML-JML1
CASE T='/'
JML = JML/JML1
CASE T='*'
JML = JML*JML1
CASE T='+'
JML = JML+JML1
OTHERWISE
JML = JML+JML1
ENDCASE
T = X
MSET2 = ''
MSET1 = SUBSTR(MSET1, 2, LEN(MSET1)-1)
EXIT
ENDIF
MSET1 = SUBSTR(MSET1, 2, LEN(MSET1)-1)
ENDDO
RETURN JML
ENDFUNC
**
FUNCTION hitner
PARAMETER MTGL1, MSET
LOCAL HIT, MSET1, MSET2, JML, JML1
IF MSET=' '
RETURN 0
ENDIF
JML = 0
HITUNG = SYS(2015)
MSET1 = MSET
MSET2 = ''
T = '+'
DO WHILE .T.
X = LEFT(MSET1, 1)
IF X='+' .OR. X='-' .OR. X='/' .OR. X='*' .OR. X='(' .OR. X=')'
JML1 = 0
MPANJ = LEN(MSET2)
CSQL = "SELECT t1.noper, t1.tanggal, t1.saldoawal, t1.mutasidebet, t1.mutasikredit, "+"t1.saldoakhir FROM akt_neraca t1 "+"WHERE LEFT(t1.noper,?mpanj)=?mset2 and tutupbuku<>'T' and tanggal = ( SELECT MAX( t2.tanggal ) "+"FROM akt_neraca t2 WHERE t1.noper = t2.noper AND tutupbuku<>'Y' and tanggal < ?sqldate(mtgl1) "+"GROUP BY noper ) "
LCEK = SQLEXEC(OODBC, CSQL, HITUNG)
SUM SALDOAKHIR TO JML1 
USE
DO CASE
CASE T='+'
JML = JML+JML1
CASE T='-'
JML = JML-JML1
CASE T='/'
JML = JML/JML1
CASE T='*'
JML = JML*JML1
OTHERWISE
JML = JML+JML1
ENDCASE
T = X
MSET2 = ''
MSET1 = SUBSTR(MSET1, 2, LEN(MSET1)-1)
ENDIF
MSET2 = MSET2+LEFT(MSET1, 1)
IF LEN(MSET1)=0
JML1 = 0
ADA = .F.
MPANJ = LEN(MSET2)
CSQL = "SELECT t1.noper, t1.tanggal, t1.saldoawal, t1.debet, t1.kredit, "+"t1.saldo FROM neraca t1 "+"WHERE LEFT(t1.noper,?mpanj)=?mset2 and tutupbuku<>'T' and tanggal = ( SELECT MAX( t2.tanggal ) "+"FROM akt_neraca t2 WHERE t1.noper = t2.noper AND tutupbuku<>'Y' and tanggal < ?sqldate(mtgl1) "+"GROUP BY noper ) "
LCEK = SQLEXEC(OODBC, CSQL, HITUNG)
SUM SALDOAKHIR TO JML1 
USE
DO CASE
CASE T='-'
JML = JML-JML1
CASE T='/'
JML = JML/JML1
CASE T='*'
JML = JML*JML1
CASE T='+'
JML = JML+JML1
OTHERWISE
JML = JML+JML1
ENDCASE
T = X
MSET2 = ''
MSET1 = SUBSTR(MSET1, 2, LEN(MSET1)-1)
EXIT
ENDIF
MSET1 = SUBSTR(MSET1, 2, LEN(MSET1)-1)
ENDDO
RETURN JML
ENDFUNC
**
FUNCTION bacaneraca
PARAMETER MKANTOR, MNOPER, MTGL, MAWAL
IF PARAMETERS()<4
MAWAL = "AKHIR"
ENDIF
MAWAL = IIF(MAWAL<>"AKHIR", "AWAL", "AKHIR")
OLDDBF = SELECT()
MTB = "T"
IF MKANTOR="0000" .OR. EMPTY(MKANTOR)
IF MAWAL="AKHIR"
CSQL = "select MAX(tanggal) as tanggal from neraca where noper=?mnoper and tanggal<=?mtgl"
ELSE
CSQL = "select MAX(tanggal) as tanggal from neraca where noper=?mnoper and tanggal<?mtgl"
ENDIF
ELSE
IF MAWAL="AKHIR"
CSQL = "select MAX(tanggal) as tanggal from neraca where kantor=?mkantor and noper=?mnoper and tanggal<=?mtgl"
ELSE
CSQL = "select MAX(tanggal) as tanggal from neraca where kantor=?mkantor and noper=?mnoper and tanggal<?mtgl"
ENDIF
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "CEK")
MTGLMUTASI = TANGGAL
IF MONTH(MTGLMUTASI)=12 .AND. DAY(MTGLMUTASI)=31
IF MKANTOR="0000" .OR. EMPTY(MKANTOR)
CSQL = "select tb from neraca where noper=?mnoper and tanggal=?mtglmutasi and tb='Y'"
ELSE
CSQL = "select tb from neraca where kantor=?mKantor and noper=?mnoper and tanggal=?mtglmutasi and tb='Y'"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "CEK")
IF  .NOT. ISNULL(TB) .AND. TB='Y'
MTB = "Y"
ENDIF
ENDIF
IF MTB='Y'
IF MTGLMUTASI=MTGL
IF MKANTOR="0000" .OR. EMPTY(MKANTOR)
CSQL = "select saldo from neraca where noper=?mnoper and tanggal=?mtglmutasi and tb<>'Y'"
ELSE
CSQL = "select saldo from neraca where kantor=?mkantor and noper=?mnoper and tanggal=?mtglmutasi and tb<>'Y'"
ENDIF
ELSE
IF MKANTOR="0000" .OR. EMPTY(MKANTOR)
CSQL = "select saldo from neraca where noper=?mnoper and tanggal=?mtglmutasi and tb='Y'"
ELSE
CSQL = "select saldo from neraca where kantor=?mKantor and noper=?mnoper and tanggal=?mtglmutasi and tb='Y'"
ENDIF
ENDIF
ELSE
IF MKANTOR="0000" .OR. EMPTY(MKANTOR)
CSQL = "select saldo from neraca where noper=?mnoper and tanggal=?mtglmutasi"
ELSE
CSQL = "select saldo from neraca where kantor=?mKantor and noper=?mnoper and tanggal=?mtglmutasi"
ENDIF
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "CEK")
MSALDO = SALDO
USE
SELECT (OLDDBF)
RETURN MSALDO
ENDFUNC
**
FUNCTION bacalogctt
PARAMETER TANDA
OLDALIAS = ALIAS()
MYCURSOR = SYS(2015)
CSQL = "select catatan from log_proses"
LCEK = SQLEXEC(OODBC, CSQL, MYCURSOR)
MTEKS = CATATAN
KE1 = AT(TANDA, MTEKS)
KATA1 = SUBSTR(MTEKS, KE1, 10)
USE
SELECT (OLDALIAS)
RETURN KATA1
ENDFUNC
**
PROCEDURE savelogctt
PARAMETER TANDA, JUMLAH
OLDALIAS = ALIAS()
MYCURSOR = SYS(2015)
CSQL = "select catatan from log_proses"
LCEK = SQLEXEC(OODBC, CSQL, MYCURSOR)
MTEKS = CATATAN
KE1 = AT(TANDA, MTEKS)
KATA1 = SUBSTR(MTEKS, KE1, 10)
GANTI1 = LEFT(TANDA+ALLTRIM(STR(JUMLAH))+SPACE(10), 10)
MTEKS = STRTRAN(MTEKS, KATA1, GANTI1)
CSQL = "update log_proses set catatan=?mteks"
LCEK = SQLEXEC(OODBC, CSQL)
USE
SELECT (OLDALIAS)
ENDPROC
**
FUNCTION cekkata
PARAMETER MKATA
MKATA = CHRTRAN(MKATA, ";'\", "")
RETURN MKATA
ENDFUNC
**
FUNCTION tgltohari
LPARAMETERS MTGL
HARI = "senin"
RETURN HARI
ENDFUNC
**
FUNCTION mtype
LPARAMETERS MDATA
IF VARTYPE(MDATA)="X"
RETURN 0
ENDIF
MDATA = UPPER(MDATA)
MAWAL = AT('(', MDATA)+1
MAKHIR = AT(')', MDATA)
MLEBAR = ''
MLEBAR = SUBSTR(MDATA, MAWAL, MAKHIR-MAWAL)
RETURN VAL(MLEBAR)
ENDFUNC
**
FUNCTION formatangka
LPARAMETERS MLEBAR
MLEBAR = IIF(MLEBAR=0, 15, MLEBAR)
TAMBAH = INT(MLEBAR/3)
MLEBAR = MLEBAR+TAMBAH
MFORMAT = RIGHT('999,999,999,999,999,999', MLEBAR)
MFORMAT = IIF(LEFT(MFORMAT, 1)=',', SUBSTR(MFORMAT, 2), MFORMAT)
RETURN MFORMAT
ENDFUNC
**
FUNCTION num2car
LPARAMETERS VNUM, LBR
VNUM = ABS(VNUM)
ANUM = TRANSFORM(VNUM, '999999999999999')
ANUM = '000000000000000'+ALLTRIM(ANUM)
ANUM = RIGHT(ANUM, LBR)
RETURN ANUM
ENDFUNC
**
FUNCTION c2c
LPARAMETERS MCHAR, PANJANG
RETURN LEFT(MCHAR+SPACE(PANJANG), PANJANG)
ENDFUNC
**
FUNCTION d2c
LPARAMETERS MTANGGAL
IF EMPTY(MTANGGAL) .OR. MTANGGAL=CTOD('  -  -    ')
CTGL = '        '
ELSE
CTGL = TRANSFORM(YEAR(MTANGGAL), '9999')+RIGHT('00'+ALLTRIM(STR(MONTH(MTANGGAL))), 2)+RIGHT('00'+ALLTRIM(STR(DAY(MTANGGAL), 2)), 2)
ENDIF
RETURN CTGL
ENDFUNC
**
FUNCTION c2d
LPARAMETERS CHRTGL
LOCAL MTH, MBL, HR
MTH = SUBSTR(CHRTGL, 1, 4)
MBL = SUBSTR(CHRTGL, 5, 2)
MHR = SUBSTR(CHRTGL, 7, 2)
RETURN CTOD(MHR+'-'+MBL+'-'+MTH)
ENDFUNC
**
FUNCTION n2c
LPARAMETERS VNUM, LBR
VNUM = ABS(VNUM)
ANUM = TRANSFORM(VNUM, '999999999999999')
ANUM = '000000000000000'+ALLTRIM(ANUM)
ANUM = RIGHT(ANUM, LBR)
RETURN ANUM
ENDFUNC
**
FUNCTION c2n
LPARAMETERS SNUM
RETURN VAL(SNUM)
ENDFUNC
**
FUNCTION dt2c
LPARAMETERS MTANGGAL
IF EMPTY(MTANGGAL) .OR. MTANGGAL=CTOD('  -  -    ')
CTGL = '              '
ELSE
CTGL = TRANSFORM(YEAR(MTANGGAL), '9999')+RIGHT('00'+ALLTRIM(STR(MONTH(MTANGGAL))), 2)+RIGHT('00'+ALLTRIM(STR(DAY(MTANGGAL), 2)), 2)+LEFT(TIME(), 2)+SUBSTR(TIME(), 4, 2)+SUBSTR(TIME(), 7, 2)
ENDIF
RETURN CTGL
ENDFUNC
**
FUNCTION cekvld
LPARAMETERS HURUF
HURUF = STRTRAN(HURUF, '.', ' ')
HURUF = STRTRAN(HURUF, ',', ' ')
HURUF = STRTRAN(HURUF, '    ', ' ')
HURUF = STRTRAN(HURUF, '   ', ' ')
HURUF = STRTRAN(HURUF, '  ', ' ')
HURUF = STRTRAN(HURUF, '  ', ' ')
RETURN HURUF
ENDFUNC
**
FUNCTION mydtos
LPARAMETERS MTANGGAL
LOCAL MHARI, MBLN, MTH
IF EMPTY(MTANGGAL)
RETURN '00000000'
ENDIF
MHARI = RIGHT('00'+ALLTRIM(STR(DAY(MTANGGAL))), 2)
MBLN = RIGHT('00'+ALLTRIM(STR(MONTH(MTANGGAL))), 2)
MTH = RIGHT('0000'+ALLTRIM(STR(YEAR(MTANGGAL))), 4)
RETURN MHARI+MBLN+MTH
ENDFUNC
**
PROCEDURE lewat
RETURN
ENDPROC
**
FUNCTION urutnorek
PARAMETER MJENISTR, MKODEMARKETING
LOCAL OLDSELECT
OLDSELECT = SELECT()
MNOREK = ''
DO CASE
CASE MJENISTR='1'
IF DEFASETNOREK='1'
ELSE
ENDIF
CASE MJENISTR='2'
CSQL = "select MAX(norek) as lastNorek from simpanan where jenis=1"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = LASTNOREK
USE
MNOREK = AUTONOMOR(MNOREK)
CASE MJENISTR='3'
CSQL = "select MAX(norek) as lastNorek from simpanan where jenis=2"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = LASTNOREK
USE
MNOREK = AUTONOMOR(MNOREK)
CASE MJENISTR='4'
CSQL = "select MAX(norek) as lastNorek from simpanan where jenis=3"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = LASTNOREK
USE
MNOREK = AUTONOMOR(MNOREK)
CASE MJENISTR='5'
CSQL = "select MAX(norek) as lastNorek from pinjaman"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = LASTNOREK
USE
MNOREK = AUTONOMOR(MNOREK)
OTHERWISE
ENDCASE
SELECT (OLDSELECT)
RETURN MNOREK
ENDFUNC
**
FUNCTION Mysqlexec
PARAMETER MODBC, CSQL, MATA
IF VARTYPE(MODBC)="X"
MODBC = OODBC
ENDIF
IF VARTYPE(CSQL)="X"
CSQL = ""
ENDIF
IF VARTYPE(MDATA)="X"
MDATA = ""
ENDIF
DO FORM BacaSQL TO MHASIL WITH MODBC, CSQL, MDATA
RETURN MHASIL
ENDFUNC
**
FUNCTION AutoNoberkas
IF DEFAAUTOBERKAS="T" .OR. EMPTY(DEFAAUTOBERKAS)
RETURN '00000001'
ENDIF
OLDSELECT = SELECT()
CSQL = "select MAX(noberkas) as berkas from pinjaman_jaminan"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOMOR = AUTONOMOR(IIF(ISNULL(BERKAS), '00000000', BERKAS))
SELECT (OLDSELECT)
RETURN MNOMOR
ENDFUNC
**
FUNCTION autonomor
PARAMETER MBUKTI
LOCAL P, XBUKTI1, XBUKTI2, MURT, MCAR
P = 0
MCAR = MBUKTI
DO WHILE P<=LEN(MBUKTI)
P = P+1
IF AT(LEFT(MCAR, 1), '0123456789')>0
MCAR = SUBSTR(MCAR, 2, LEN(MCAR)-1)
ELSE
EXIT
ENDIF
ENDDO
P = 0
MURT = VAL(MBUKTI)
XBUKTI1 = MURT+1
XBUKTI3 = RIGHT(('00000000'+ALLTRIM(STR(XBUKTI1, 15))+ALLTRIM(MCAR)), 8)
RETURN XBUKTI3
ENDFUNC
**
PROCEDURE menucetak
ACTIVATE SCREEN
DEFINE POPUP POPFRUITS FROM 5, 5 MARGIN MULTISELECT
DEFINE BAR 1 OF POPFRUITS PROMPT '\<Apples' MARK CHR(3)
DEFINE BAR 2 OF POPFRUITS PROMPT '\<Bananas' MARK CHR(4)
DEFINE BAR 3 OF POPFRUITS PROMPT '\<Grapes' MARK CHR(5)
DEFINE BAR 4 OF POPFRUITS PROMPT '\<Lemons' MARK CHR(6)
ON SELECTION POPUP POPFRUITS DO YOURCHOICE    
ACTIVATE POPUP POPFRUITS
ENDPROC
**
PROCEDURE yourchoice
FOR GNCOUNT = 1 TO CNTBAR('popFruits')
IF MRKBAR('popFruits', GNCOUNT)=.T.
? PRMBAR('popFruits', GNCOUNT) AT 5
ENDIF
ENDFOR
ENDPROC
**
FUNCTION listbunga
LPARAMETERS MNOMORREK, TGLHIT, MKIRIM, MCURSOR
LOCAL XKODE, XNOREK, TGLDAFTAR, JUMBUNGA, JUMPAJAK
STORE 0 TO JUMBUNGA, JUMPAJAK
OLDSELE = SELECT()
IF VARTYPE(MCURSOR)='X' .OR. VARTYPE(MCURSOR)='L'
MCURSOR = "BUNGA"
ENDIF
CREATE CURSOR &MCURSOR (TANGGAL D, BUKTI C(10),DEBET N(12),KREDIT N(12),SALDO N(12),HARI N(3),RATE N(5,2), BUNGA N(12),PAJAK N(12))
IF VARTYPE(MNOMORREK)='X'
MRET = ALLTRIM(STR(0))+'|'+ALLTRIM(STR(0))
RETURN MRET
ENDIF
IF VARTYPE(TGLHIT)='X' .OR. VARTYPE(TGLHIT)='L'
TGLHIT = TGLNOW
MRET = ALLTRIM(STR(0))+'|'+ALLTRIM(STR(0))
RETURN MRET
ENDIF
IF VARTYPE(MKIRIM)='X' .OR. VARTYPE(MKIRIM)='L'
MKIRIM = 'T'
ENDIF
XNOREK = MNOMORREK
CSQL = "select a.tanggal as tglbuka,a.norek,a.jenis,a.produk,a.tgltutup,b.saldo,rate_khusus,rate from simpanan as a, "+"simpanan_mutasi as b where a.norek=b.norek and a.norek='"+MNOMORREK+"' and b.iddata=("+"select MAX(iddata) from simpanan_mutasi where norek='"+MNOMORREK+"' and tanggal<='"+SQLDATE(AWALBLN(TGLHIT))+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MSALDOAWAL = IIF(ISNULL(SALDO), 0, SALDO)
MTGLBUKA = TGLBUKA
IF RECCOUNT()=0
CSQL = "select a.tanggal as tglbuka,a.norek,a.jenis,a.produk,a.tgltutup,b.saldo,rate_khusus,rate from simpanan as a, "+"simpanan_mutasi as b where a.norek=b.norek and a.norek='"+MNOMORREK+"' and b.iddata=("+"select MAX(iddata) from simpanan_mutasi where norek='"+MNOMORREK+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MSALDOAWAL = 0
MTGLBUKA = TGLBUKA
ENDIF
IF NOREK<>MNOMORREK
USE
SELECT (OLDSELE)
MRET = ALLTRIM(STR(0))+'|'+ALLTRIM(STR(0))
RETURN MRET
ENDIF
MRATEKHUSUS = IIF(RATE_KHUSUS="Y", "Y", "T")
MRATESIMP = RATE
MNOREK = NOREK
MPRODUK = PRODUK
MTGLTUTUP = TGLTUTUP
MJENIS = JENIS
USE
IF  .NOT. EMPTY(MTGLTUTUP) .AND. MTGLTUTUP<TGLHIT
RETURN 0
ENDIF
CSQL = "select * from setsandi_tab where jenis='"+MJENIS+"' and sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MOPTPASIF = OPTPASIF
MHARIPASIF = HARIPASIF
MNOMIPASIF = NOMIPASIF
XVER = VER
MOPTHARI = OPTHARI
MA_RATE = A_RATE
MA_RATE1 = A_RATE1
MA_RATE2 = A_RATE2
MA_RATE3 = A_RATE3
MA_RATE4 = A_RATE4
MA_RATE5 = A_RATE5
MA_NOMI_RATE1 = A_NOMI_RATE1
MA_NOMI_RATE2 = A_NOMI_RATE2
MA_NOMI_RATE3 = A_NOMI_RATE3
MA_NOMI_RATE4 = A_NOMI_RATE4
MA_NOMI_RATE5 = A_NOMI_RATE5
MA_TYPE_RATE = A_TYPE_RATE
MP_RATE = P_RATE
MP_RATE1 = P_RATE1
MP_RATE2 = P_RATE2
MP_RATE3 = P_RATE3
MP_RATE4 = P_RATE4
MP_RATE5 = P_RATE5
MP_NOMI_RATE1 = P_NOMI_RATE1
MP_NOMI_RATE2 = P_NOMI_RATE2
MP_NOMI_RATE3 = P_NOMI_RATE3
MP_NOMI_RATE4 = P_NOMI_RATE4
MP_NOMI_RATE5 = P_NOMI_RATE5
MP_TYPE_RATE = P_TYPE_RATE
MANTARBANK = ANTARBANK
MSALDOMINIMAL = SALDOMINIMAL
MBATASBUNGA = BATASBUNGA
MBATASPAJAK = BATASPAJAK
MPAJAK = PAJAK
MBUKTI = ''
CSQL = "select MAX(tanggal) as tglmutasi from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(AWALBLN(TGLHIT))+"'  and kode='"+DEFATABSTOR+"' "
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MTGLMUTASI = TGLMUTASI
CSQL = "select * from simpanan_mutasi where norek='"+MNOREK+"' and tanggal>='"+SQLDATE(AWALBLN(TGLHIT))+"'  and tanggal<'"+SQLDATE(AKHIRBLN(TGLHIT))+"' order by tanggal"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO CASE
CASE XVER=1 .OR. XVER=4
MTGLHIT = MAX(AWALBLN(TGLHIT)-1, MTGLBUKA)
SELECT (MCURSOR)
APPEND BLANK
REPLACE TANGGAL WITH MTGLHIT, SALDO WITH MSALDOAWAL
SELECT SMT
GOTO TOP
MTGLTRANS = IIF(MTGLBUKA<AWALBLN(TGLHIT), AWALBLN(TGLHIT)-1, MTGLBUKA)
DO WHILE  .NOT. EOF()
IF TANGGAL>TGLHIT
EXIT
ENDIF
IF KODE=DEFATABSTOR
MTGLMUTASI = TANGGAL
ENDIF
IF TANGGAL>=AWALBLN(TGLHIT)
MTANGGAL = TANGGAL
MBUKTI = BUKTI
MDEBET = DEBET
MKREDIT = KREDIT
MSALDO = IIF(ISNULL(SALDO), 0, SALDO)
MHARI = TANGGAL-MTGLTRANS
IF MHARIPASIF>(TGLHIT-MTGLMUTASI) .AND. MSALDOAWAL<MNOMIPASIF
DO CASE
CASE MSALDOAWAL<MP_NOMI_RATE1 .OR. MP_NOMI_RATE1=0
MRATE = MP_RATE
CASE MSALDOAWAL>=MP_NOMI_RATE1 .AND. MSALDOAWAL<MP_NOMI_RATE2
MRATE = MP_RATE1
CASE MSALDOAWAL>=MP_NOMI_RATE2 .AND. MSALDOAWAL<MP_NOMI_RATE3
MRATE = MP_RATE2
CASE MSALDOAWAL>=MP_NOMI_RATE3 .AND. MSALDOAWAL<MP_NOMI_RATE4
MRATE = MP_RATE3
CASE MSALDOAWAL>=MP_NOMI_RATE4 .AND. MSALDOAWAL<MP_NOMI_RATE5
MRATE = MP_RATE4
CASE MSALDOAWAL>=MP_NOMI_RATE5
MRATE = MP_RATE5
ENDCASE
ELSE
DO CASE
CASE MSALDOAWAL<MA_NOMI_RATE1 .OR. MA_NOMI_RATE1=0
MRATE = MA_RATE
CASE MSALDOAWAL>=MA_NOMI_RATE1 .AND. MSALDOAWAL<MA_NOMI_RATE2
MRATE = MA_RATE1
CASE MSALDOAWAL>=MA_NOMI_RATE2 .AND. MSALDOAWAL<MA_NOMI_RATE3
MRATE = MA_RATE2
CASE MSALDOAWAL>=MA_NOMI_RATE3 .AND. MSALDOAWAL<MA_NOMI_RATE4
MRATE = MA_RATE3
CASE MSALDOAWAL>=MA_NOMI_RATE4 .AND. MSALDOAWAL<MA_NOMI_RATE5
MRATE = MA_RATE4
CASE MSALDOAWAL>=MA_NOMI_RATE5
MRATE = MA_RATE5
ENDCASE
ENDIF
IF MRATEKHUSUS="Y"
MRATE = MRATESIMP
ENDIF
MRATE = IIF(ISNULL(MRATE), 0, MRATE)
MPJK = IIF(ISNULL(MPAJAK), 0, MPAJAK)
IF MSALDOAWAL<=MBATASBUNGA .AND. MBATASBUNGA>0
MRATE = 0
ENDIF
MBUNGA = ROUND(MSALDOAWAL*(MHARI/365)*(MRATE/100), 0)
MPJKBG = 0
IF MSALDOAWAL>IIF(ISNULL(MBATASPAJAK), 0, MBATASPAJAK)
MPJKBG = ROUND(MBUNGA*(MPJK/100), 0)
ENDIF
JUMBUNGA = JUMBUNGA+MBUNGA
JUMPAJAK = JUMPAJAK+MPJKBG
MTGLTRANS = TANGGAL
MSALDOAWAL = SALDO
SELECT (MCURSOR)
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI, DEBET WITH MDEBET
REPLACE KREDIT WITH MKREDIT, SALDO WITH MSALDOAWAL, HARI WITH MHARI
REPLACE RATE WITH MRATE, BUNGA WITH MBUNGA, PAJAK WITH MPJKBG
ELSE
MSALDOAWAL = SALDO
ENDIF
SELECT SMT
SKIP
ENDDO
MHARI = TGLHIT-MTGLTRANS
IF MHARIPASIF>(TGLHIT-MTGLMUTASI) .AND. MSALDOAWAL<MNOMIPASIF
DO CASE
CASE MSALDOAWAL<MP_NOMI_RATE1 .OR. MP_NOMI_RATE1=0
MRATE = MP_RATE
CASE MSALDOAWAL>=MP_NOMI_RATE1 .AND. MSALDOAWAL<MP_NOMI_RATE2
MRATE = MP_RATE1
CASE MSALDOAWAL>=MP_NOMI_RATE2 .AND. MSALDOAWAL<MP_NOMI_RATE3
MRATE = MP_RATE2
CASE MSALDOAWAL>=MP_NOMI_RATE3 .AND. MSALDOAWAL<MP_NOMI_RATE4
MRATE = MP_RATE3
CASE MSALDOAWAL>=MP_NOMI_RATE4 .AND. MSALDOAWAL<MP_NOMI_RATE5
MRATE = MP_RATE4
CASE MSALDOAWAL>=MP_NOMI_RATE5
MRATE = MP_RATE5
ENDCASE
ELSE
DO CASE
CASE MSALDOAWAL<MA_NOMI_RATE1 .OR. MA_NOMI_RATE1=0
MRATE = MA_RATE
CASE MSALDOAWAL>=MA_NOMI_RATE1 .AND. MSALDOAWAL<MA_NOMI_RATE2
MRATE = MA_RATE1
CASE MSALDOAWAL>=MA_NOMI_RATE2 .AND. MSALDOAWAL<MA_NOMI_RATE3
MRATE = MA_RATE2
CASE MSALDOAWAL>=MA_NOMI_RATE3 .AND. MSALDOAWAL<MA_NOMI_RATE4
MRATE = MA_RATE3
CASE MSALDOAWAL>=MA_NOMI_RATE4 .AND. MSALDOAWAL<MA_NOMI_RATE5
MRATE = MA_RATE4
CASE MSALDOAWAL>=MA_NOMI_RATE5
MRATE = MA_RATE5
ENDCASE
ENDIF
IF MRATEKHUSUS="Y"
MRATE = MRATESIMP
ENDIF
MRATE = IIF(ISNULL(MRATE), 0, MRATE)
MPJK = IIF(ISNULL(MPAJAK), 0, MPAJAK)
IF MSALDOAWAL<=MBATASBUNGA
MRATE = 0
ENDIF
MBUNGA = MSALDOAWAL*(MHARI/365)*(MRATE/100)
MPJKBG = 0
IF MSALDOAWAL>IIF(ISNULL(MBATASPAJAK), 0, MBATASPAJAK)
MPJKBG = MBUNGA*(MPJK/100)
ENDIF
JUMBUNGA = JUMBUNGA+MBUNGA
JUMPAJAK = JUMPAJAK+MPJKBG
MSALDOAWAL = SALDO
SELECT (MCURSOR)
APPEND BLANK
REPLACE TANGGAL WITH TGLHIT, BUKTI WITH MBUKTI, DEBET WITH 0
REPLACE KREDIT WITH 0, SALDO WITH MSALDOAWAL, HARI WITH MHARI
REPLACE RATE WITH MRATE, BUNGA WITH MBUNGA, PAJAK WITH MPJKBG
SELECT (MCURSOR)
CASE XVER=2
MTGLHIT = MAX(AWALBLN(TGLHIT)-1, MTGLBUKA)
SELECT (MCURSOR)
APPEND BLANK
REPLACE TANGGAL WITH MTGLHIT, SALDO WITH MSALDOAWAL
SELECT SMT
GOTO TOP
XBUNGA = 0
MTOT = MSALDOAWAL
XSISA = MSALDOAWAL
MKE = 1
MTGLTRANS = IIF(MTGLBUKA<AWALBLN(TGLHIT), AWALBLN(TGLHIT)-1, MTGLBUKA)
DO WHILE  .NOT. EOF()
IF KODE=DEFATABSTOR
MTGLMUTASI = TANGGAL
ENDIF
MHARI = TANGGAL-MTGLTRANS
MTANGGAL = TANGGAL
MBUKTI = BUKTI
MDEBET = DEBET
MKREDIT = KREDIT
MSISA = SALDO
SELECT (MCURSOR)
APPEND BLANK
REPLACE TANGGAL WITH MTANGGAL, BUKTI WITH MBUKTI, DEBET WITH MDEBET
REPLACE KREDIT WITH MKREDIT, SALDO WITH MSISA, HARI WITH MHARI
REPLACE RATE WITH MRATE, BUNGA WITH 0, PAJAK WITH 0
SELECT SMT
MTGLTRANS = TANGGAL
MTOT = MTOT+(XSISA*MHARI)
XSISA = SALDO
SKIP
ENDDO
MHARI = TGLHIT-MTGLTRANS
MTOT = MTOT+(XSISA*MHARI)
MRATA = ROUND(MTOT/(TGLHIT-MTGLBUKA), 0)
IF MHARIPASIF>(TGLHIT-MTGLMUTASI) .AND. MRATA<MNOMIPASIF
XBG = MA_RATE
ELSE
XBG = MP_RATE
ENDIF
IF MRATA>=MBATASBUNGA
XTOTBG = MRATA*(XBG/1200)
ELSE
XTOTBG = 0
ENDIF
IF MRATA>MBATASPAJAK
XTOTPJK = ((XPAJAK)/100)*XTOTBG
BUNGA1 = BUNGA1+XTOTBG
ELSE
BUNGA0 = BUNGA0+XTOTBG
ENDIF
JUMBUNGA = JUMBUNGA+XTOTBG
JUMPAJAK = JUMPAJAK+XTOTPJK
SELECT (MCURSOR)
APPEND BLANK
REPLACE TANGGAL WITH TGLHIT, BUKTI WITH '', DEBET WITH 0
REPLACE KREDIT WITH 0, SALDO WITH MSALDOAWAL, HARI WITH MHARI
REPLACE RATE WITH MRATE, BUNGA WITH XTOTBG, PAJAK WITH XTOTPJK
CASE XVER=3
MTGLHIT = MAX(AWALBLN(TGLHIT)-1, MTGLBUKA)
XTOTPJK = 0
XTOTBG = 0
SELECT (MCURSOR)
APPEND BLANK
REPLACE TANGGAL WITH MTGLHIT, SALDO WITH MSALDOAWAL
SELECT SMT
GOTO TOP
MTGLTRANS = IIF(MTGLBUKA<AWALBLN(TGLHIT), AWALBLN(TGLHIT)-1, MTGLBUKA)
XTGLMTS = IIF(MTGLBUKA<AWALBLN(TGLHIT), AWALBLN(TGLHIT)-1, MTGLBUKA)
XSLDAWAL = IIF(MTGLBUKA<AWALBLN(TGLHIT), MSALDOAWAL, 0)
XSISA = MSALDOAWAL
XBUNGA = 0
P = IIF(XSLDAWAL>=MBATASPAJAK, .T., .F.)
XMIN = MSALDOAWAL
DO WHILE  .NOT. EOF()
IF KODE=DEFATABSTOR
MTGLMUTASI = TANGGAL
ENDIF
XMIN = IIF(SALDO<XMIN, SALDO, XMIN)
MTANGGAL = TANGGAL
MBUKTI = BUKTI
MDEBET = DEBET
MKREDIT = KREDIT
MSISA = SALDO
XSLDAKHIR = SALDO
IF MHARIPASIF>(TGLHIT-MTGLMUTASI) .AND. XMIN<MNOMIPASIF
XBG = MA_RATE
ELSE
XBG = MP_RATE
ENDIF
SELECT (MCURSOR)
APPEND BLANK
REPLACE TANGGAL WITH MTANGGAL, BUKTI WITH MBUKTI, DEBET WITH MDEBET
REPLACE KREDIT WITH MKREDIT, SALDO WITH MSISA, HARI WITH 0
REPLACE RATE WITH XBG, BUNGA WITH 0, PAJAK WITH 0
SELECT SMT
P = IIF(MSISA>=MBATASPAJAK, .T., P)
SKIP
ENDDO
IF MHARIPASIF>(TGLHIT-MTGLMUTASI) .AND. XMIN<MNOMIPASIF
XBG = MA_RATE
ELSE
XBG = MP_RATE
ENDIF
IF XMIN>=MBATASBUNGA
XTOTBG = ROUND(XMIN*(XBG/1200), 0)
ELSE
XTOTBG = 0
ENDIF
IF XMIN>MBATASPAJAK
XTOTPJK = ((MPAJAK)/100)*XTOTBG
ELSE
ENDIF
JUMBUNGA = JUMBUNGA+XTOTBG
JUMPAJAK = JUMPAJAK+XTOTPJK
SELECT (MCURSOR)
REPLACE TANGGAL WITH TGLHIT, BUKTI WITH '', DEBET WITH 0
REPLACE KREDIT WITH 0, SALDO WITH MSALDOAWAL, HARI WITH 0
REPLACE RATE WITH XBG, BUNGA WITH XTOTBG, PAJAK WITH XTOTPJK
ENDCASE
IF MKIRIM='T'
SELECT (MCURSOR)
USE
ENDIF
SELECT (OLDSELE)
MRET = ALLTRIM(STR(JUMBUNGA))+'|'+ALLTRIM(STR(JUMPAJAK))
RETURN MRET
ENDFUNC
**
FUNCTION cekAktif
LPARAMETERS MNOREK, MTANGGAL
LOCAL OLDSELECT, VSALDO, VTGLMUTASI, VAKTIF
OLDSELECT = SELECT()
CSQL = "select produk from simpanan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CEK1")
MPRODUK = PRODUK
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi where "+"norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTANGGAL)+"' group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "CEK1")
VSALDO = SALDO
CSQL = "select tanggal from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi where "+"norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTANGGAL)+"' and "+"(kode='"+DEFATABSTOR+"' or kode='"+DEFATABAMB+"' or kode='"+DEFATABPBK+"' ) group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "CEK1")
VTGLMUTASI = TANGGAL
VAKTIF = "Y"
CSQL = "select * from setsandi_tab where sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CEK1")
DO CASE
CASE OPTPASIF=1
IF HARIPASIF<MTANGGAL-VTGLMUTASI
VAKTIF = "T"
ENDIF
CASE OPTPASIF=2
IF NOMIPASIF<VSALDO
VAKTIF = "T"
ENDIF
CASE OPTPASIF=3
IF HARIPASIF<MTANGGAL-VTGLMUTASI .AND. NOMIPASIF<VSALDO
VAKTIF = "T"
ENDIF
ENDCASE
USE
SELECT (OLDSELECT)
RETURN VAKTIF
ENDFUNC
**
PROCEDURE saldotab
LPARAMETERS MTGLCARI, MREKCARI
TIME1 = TIME()
MYTUNGGU = NEWOBJECT("tunggu")
MYTUNGGU.SHOW()
INKEY(0.01 )
CREATE CURSOR saldotab (NOREK VARCHAR (17), NAMA C (30), ALAMAT C (30), PRODUK VARCHAR (4), TGLMASUK DATE, TANGGAL DATE, SALDOAWAL INT (10), DEBET INT (10), KREDIT INT (10), BUNGA INT (10), PAJAK INT (10), ADM INT (10), SALDO INT (10), TGLMUTASI DATE, TGLAKHIR DATE)
IF MREKCARI="ALL"
CSQL = "select norek,tanggal,bukti,kd,debet,kredit,sisa from tab_mutasi where norek is not null and tanggal<=?sqldate(mtglcari)"
LCEK = SQLEXEC(OODBC, CSQL, "SLDTAB_MTS")
CSQL = "select a.norek,a.produk,a.tglmasuk, b.nama,b.alamat from tab_data a left join data_nasabah b on a.cif=b.cif where norek is not null and tglmasuk<=?sqldate(mtglcari) and (tgltutup='0000-00-00' or tgltutup<?sqldate(mtglcari))"
LCEK = SQLEXEC(OODBC, CSQL, "SLDTAB_DT")
ELSE
CSQL = "select norek,tanggal,bukti,kd,debet,kredit,sisa from tab_mutasi where norek=?mrekcari and tanggal<=?sqldate(mtglcari)"
LCEK = SQLEXEC(OODBC, CSQL, "SLDTAB_MTS")
CSQL = "select a.norek,a.produk,a.tglmasuk,b.nama,b.alamat from tab_data a left join data_nasabah b on a.cif=b.cif where norek=?mrekcari"
LCEK = SQLEXEC(OODBC, CSQL, "SLDTAB_DT")
ENDIF
SELECT SLDTAB_MTS
INDEX ON NOREK+DTOS(TANGGAL) TAG TEST1
SELECT SLDTAB_DT
MYTUNGGU.RELEASE()
MYPROSES = NEWOBJECT("proses")
MYPROSES.MAXIMAL(RECCOUNT())
MYPROSES.KE(0)
MYPROSES.NAMA("Proses Hitung")
MYPROSES.SHOW()
GOTO TOP
DO WHILE  .NOT. EOF()
MYPROSES.KE(RECNO())
IF  .NOT. EMPTY(NOREK)
MNOREK = NOREK
MPRODUK = IIF(VARTYPE(PRODUK)="X", "", PRODUK)
MTGLMASUK = TGLMASUK
MSALDO = 0
MNAMA = IIF(VARTYPE(NAMA)="X", "", NAMA)
MALAMAT = IIF(VARTYPE(ALAMAT)="X", "", ALAMAT)
MSALDOAWAL = 0
MBUNGA = 0
MPAJAK = 0
MADM = 0
MDEBET = 0
MKREDIT = 0
MTGLMAX = TGLMASUK
MTGLAKHIR = TGLMASUK
SELECT SLDTAB_MTS
SET NEAR ON
SET ORDER TO TEST1
SEEK RTRIM(MNOREK) 
SET NEAR OFF
DO WHILE  .NOT. EOF()
IF NOREK<>MNOREK .OR. TANGGAL>MTGLCARI
EXIT
ENDIF
MSALDOAKHIR = SISA
IF TANGGAL<MTGLCARI
MTGLMAX = TANGGAL
MSALDOAWAL = SISA
IF KD<>'05' .AND. KD<>'08' .AND. KD<>'09'
MTGLAKHIR = TANGGAL
ENDIF
ELSE
DO CASE
CASE KD='05'
MBUNGA = MBUNGA+(KREDIT-DEBET)
CASE KD='08'
MPAJAK = MPAJAK+(DEBET-KREDIT)
CASE KD='09'
MADM = MADM+(DEBET-KREDIT)
OTHERWISE
MDEBET = MDEBET+DEBET
MKREDIT = MKREDIT+KREDIT
ENDCASE
ENDIF
SKIP
ENDDO
SELECT SALDOTAB
APPEND BLANK
REPLACE NOREK WITH MNOREK
REPLACE PRODUK WITH MPRODUK
REPLACE TGLMASUK WITH IIF(VARTYPE(MTGLMASUK)="X", CTOD("  -  -    "), MTGLMASUK)
REPLACE TANGGAL WITH MTGLCARI
REPLACE NAMA WITH MNAMA
REPLACE ALAMAT WITH MALAMAT
REPLACE SALDOAWAL WITH MSALDOAWAL
REPLACE DEBET WITH MDEBET
REPLACE KREDIT WITH MKREDIT
REPLACE BUNGA WITH MBUNGA
REPLACE PAJAK WITH MPAJAK
REPLACE ADM WITH MADM
REPLACE TGLMUTASI WITH MTGLAKHIR
REPLACE TGLAKHIR WITH MTGLMAX
ENDIF
SELECT SLDTAB_DT
SKIP
ENDDO
MYPROSES.RELEASE()
SELECT SLDTAB_MTS
USE
SELECT SLDTAB_DT
USE
SELECT SALDOTAB
TIME2 = TIME()
RETURN
ENDPROC
**
PROCEDURE justcek
CSQL = "select * from pinjaman"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTGLREAL = TANGGAL
MPOKOK = VAL(POKOK)
MTGL = CTOD("01-01-"+ALLTRIM(STR(YEAR(TGLNOW))))
CSQL = "select SUM(pokok) as pk, SUM(jasa) as bg from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MPK = IIF(ISNULL(PK), 0, PK)
MSLDPOKOK = IIF(MTGLREAL<MTGL, MPOKOK-MPK, 0)
CSQL = "update pinjaman set sldawalthn='"+STR(MSLDPOKOK)+"' where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MTGL = CTOD("01-"+ALLTRIM(STR(MONTH(TGLNOW)))+"-"+ALLTRIM(STR(YEAR(TGLNOW))))
CSQL = "select SUM(pokok) as pk, SUM(jasa) as bg from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MPK = IIF(ISNULL(PK), 0, PK)
MSLDPOKOK = IIF(MTGLREAL<MTGL, MPOKOK-MPK, 0)
CSQL = "update pinjaman set sldawalbln='"+STR(MSLDPOKOK)+"' where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MTGL = TGLNOW-1
CSQL = "select SUM(pokok) as pk, SUM(jasa) as bg from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MPK = IIF(ISNULL(PK), 0, PK)
MSLDPOKOK = IIF(MTGLREAL<MTGL, MPOKOK-MPK, 0)
CSQL = "update pinjaman set sldawalhr='"+STR(MSLDPOKOK)+"' where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MTGL = TGLNOW
CSQL = "select SUM(pokok) as pk, SUM(jasa) as bg from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MPK = IIF(ISNULL(PK), 0, PK)
MSLDPOKOK = IIF(MTGLREAL<=MTGL, MPOKOK-MPK, 0)
CSQL = "update pinjaman set sldsekarang='"+STR(MSLDPOKOK)+"' where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT SMT
SKIP
ENDDO
RETURN
ENDPROC
**
PROCEDURE JurnalAntarKantor
PARAMETER MTANGGAL, MBUKTI, MKET, KANTOR1, KANTOR2, MJUMLAH
CSQL = "select saldo from neraca where kantor='"+KANTOR1+"' and noper='"+ALLTRIM(DEFANOPERAKA)+KANTOR2+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+KANTOR1+"' and noper='"+ALLTRIM(DEFANOPERAKA)+KANTOR2+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SALDO1 = SALDO
IF SALDO1>0
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) values "
CSQL = CSQL+"('"+KANTOR2+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"','"+ALLTRIM(DEFANOPERAKA)+KANTOR2+"',"+"'"+MKET+"','"+ALLTRIM(STR(MJUMLAH))+"'), "
CSQL = CSQL+"('"+KANTOR1+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"','"+ALLTRIM(DEFANOPERAKP)+KANTOR1+"',"+"'"+MKET+"','"+ALLTRIM(STR(0-MJUMLAH))+"'), "
CSQL = ALLTRIM(CSQL)
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) values "
CSQL = CSQL+"('"+KANTOR1+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"','"+ALLTRIM(DEFANOPERAKP)+KANTOR2+"',"+"'"+MKET+"','"+ALLTRIM(STR(0-MJUMLAH))+"'), "
CSQL = CSQL+"('"+KANTOR2+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"','"+ALLTRIM(DEFANOPERAKA)+KANTOR1+"',"+"'"+MKET+"','"+ALLTRIM(STR(MJUMLAH))+"'), "
CSQL = ALLTRIM(CSQL)
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "select saldo from neraca where kantor='"+KANTOR1+"' and noper='"+ALLTRIM(DEFANOPERAKA)+KANTOR2+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+KANTOR1+"' and noper='"+ALLTRIM(DEFANOPERAKA)+KANTOR2+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SALDO1 = SALDO
CSQL = "select saldo from neraca where kantor='"+KANTOR1+"' and noper='"+ALLTRIM(DEFANOPERAKP)+KANTOR2+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+KANTOR1+"' and noper='"+ALLTRIM(DEFANOPERAKP)+KANTOR2+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SALDO2 = SALDO
IF SALDO1<>0 .AND. SALDO2<>0
MADJ = 0-SALDO2
MADJ = IIF(MADJ>SALDO1, SALDO1, MADJ)
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,ket,jumlah) value ("+"'"+KANTOR1+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"','"+ALLTRIM(DEFANOPERAKA)+KANTOR2+"',"+"'"+MKET+"','"+STR(0-MADJ)+"'),"+"('"+KANTOR1+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"','"+ALLTRIM(DEFANOPERAKP)+KANTOR2+"',"+"'"+MKET+"','"+STR(MADJ)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
SLDKANTOR1 = IIF(SALDO1-MADJ=0, SALDO2-MADJ, SALDO1-MADJ)
ELSE
SLDKANTOR1 = SALDO1+SALDO2
ENDIF
CSQL = "select saldo from neraca where kantor='"+KANTOR2+"' and noper='"+ALLTRIM(DEFANOPERAKA)+KANTOR1+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+KANTOR2+"' and noper='"+ALLTRIM(DEFANOPERAKA)+KANTOR1+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SALDO1 = SALDO
CSQL = "select saldo from neraca where kantor='"+KANTOR2+"' and noper='"+ALLTRIM(DEFANOPERAKP)+KANTOR1+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+KANTOR2+"' and noper='"+ALLTRIM(DEFANOPERAKP)+KANTOR1+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SALDO2 = SALDO
IF SALDO1<>0 .AND. SALDO2<>0
MADJ = 0-SALDO2
MADJ = IIF(MADJ>SALDO1, SALDO1, MADJ)
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,ket,jumlah) value ("+"'"+KANTOR2+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"','"+ALLTRIM(DEFANOPERAKA)+KANTOR1+"',"+"'"+MKET+"','"+STR(0-MADJ)+"'),"+"('"+KANTOR2+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"','"+ALLTRIM(DEFANOPERAKP)+KANTOR1+"',"+"'"+MKET+"','"+STR(MADJ)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
SLDKANTOR2 = IIF(SALDO1-MADJ=0, SALDO2-MADJ, SALDO1-MADJ)
ELSE
SLDKANTOR2 = SALDO1+SALDO2
ENDIF
HITNERACA(KANTOR1, ALLTRIM(DEFANOPERAKA)+KANTOR1, MTANGGAL)
HITNERACA(KANTOR1, ALLTRIM(DEFANOPERAKP)+KANTOR1, MTANGGAL)
HITNERACA(KANTOR1, ALLTRIM(DEFANOPERAKA)+KANTOR2, MTANGGAL)
HITNERACA(KANTOR1, ALLTRIM(DEFANOPERAKP)+KANTOR2, MTANGGAL)
HITNERACA(KANTOR2, ALLTRIM(DEFANOPERAKA)+KANTOR1, MTANGGAL)
HITNERACA(KANTOR2, ALLTRIM(DEFANOPERAKP)+KANTOR1, MTANGGAL)
HITNERACA(KANTOR2, ALLTRIM(DEFANOPERAKA)+KANTOR2, MTANGGAL)
HITNERACA(KANTOR2, ALLTRIM(DEFANOPERAKP)+KANTOR2, MTANGGAL)
RETURN
ENDPROC
**
PROCEDURE pros_autodebet
CSQL = "select * from simpanan_autodebet where "
RETURN
ENDPROC
**
FUNCTION BuatRegister
PARAMETER MNOMOR, MPROG, MASET, MTGL
NKEY = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'
NKEY = 'ABC0DE1FG2HI3JK4LM5NO6PQ7RS8TU9VWXYZ'
IF VARTYPE(MNOMOR)<>'C'
MNOMOR = '8'+RIGHT('000'+ALLTRIM(TRANSFORM(RANDOM(0, 999), '999')), 3)
ENDIF
IF VARTYPE(MASET)<>"N"
MASET = 0
ENDIF
IF VARTYPE(MPROG)<>"N"
MPROG = 2
ENDIF
IF VARTYPE(MTGL)<>"D"
MTGL = TGLNOW
ENDIF
MKODE = ''
MKE = 1
MKDASET = RIGHT('0000'+ALLTRIM(STR(MASET)), 3)
DO WHILE .T.
IF MKE>4
EXIT
ENDIF
MANGKA = RANDOM(1, 36)
DO CASE
CASE MPROG=1
IF MKE=1
IF MOD(MANGKA, 3)=0
MKODE = MKODE+SUBSTR(NKEY, MANGKA, 1)
MKE = MKE+1
ENDIF
ELSE
IF MKE>1
MURUT = INT((RANDOM(0, 3)*10)/4)+VAL(SUBSTR(MKDASET, MKE-1, 1))
MKODE = MKODE+SUBSTR(NKEY, MURUT, 1)
MKE = MKE+1
ENDIF
ENDIF
CASE MPROG=2
IF MKE=1
IF MOD(MANGKA, 3)=1
MKODE = MKODE+SUBSTR(NKEY, MANGKA, 1)
MKE = MKE+1
ENDIF
ELSE
IF MKE>1
MURUT = (RANDOM(1, 8)*4)+VAL(SUBSTR(MKDASET, MKE-1, 1))
MKODE = MKODE+SUBSTR(NKEY, MURUT, 1)
MKE = MKE+1
ENDIF
ENDIF
CASE MPROG=3
IF MKE=1
IF MOD(MANGKA, 3)=2
MKODE = MKODE+SUBSTR(NKEY, MANGKA, 1)
MKE = MKE+1
ENDIF
ELSE
IF MKE>1
MURUT = (RANDOM(1, 2)*10)+VAL(SUBSTR(MKDASET, MKE-1, 1))+1
MKODE = MKODE+SUBSTR(NKEY, MURUT, 1)
MKE = MKE+1
ENDIF
ENDIF
ENDCASE
ENDDO
MTGLJT = MTGL-CTOD('01-01-2015')
MHIT = RIGHT('0000'+ALLTRIM(STR(MTGLJT)), 4)
MKE = 1
A = 1
DO WHILE .T.
IF MKE>4
EXIT
ENDIF
MANGKA = RANDOM(1, 36)
HITUNG = INT((MANGKA-VAL(SUBSTR(MHIT, MKE, 1)))/10)*10+VAL(SUBSTR(MHIT, MKE, 1))
MKODE = MKODE+SUBSTR(NKEY, HITUNG, 1)
MKE = MKE+1
ENDDO
MKE = 1
DO WHILE .T.
IF MKE>5
EXIT
ENDIF
MANGKA = RANDOM(1, 36)
HITUNG = INT((MANGKA-VAL(SUBSTR(MHIT, MKE, 1)))/10)*10+VAL(SUBSTR(MNOMOR, MKE, 1))
MKODE = MKODE+SUBSTR(NKEY, HITUNG, 1)
MKE = MKE+1
ENDDO
RETURN MKODE
ENDFUNC
**
PROCEDURE bacaRegister
PARAMETER MKODE
NKEY = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'
NKEY = 'ABC0DE1FG2HI3JK4LM5NO6PQ7RS8TU9VWXYZ'
MSTAT = ''
MASET = ''
MTGLJT = TGLNOW
MNOPROG = ''
KDPROG = ''
MHR = ''
FOR A = 1 TO 12
IF A=1
MHRF = SUBSTR(MKODE, A, 1)
MKD = MOD(AT(MHRF, NKEY), 3)
DO CASE
CASE MKD=0
KDPROG = '1'
CASE MKD=1
KDPROG = '2'
CASE MKD=2
KDPROG = '3'
ENDCASE
MSTAT = KDPROG
KDPROG = ''
ENDIF
IF A>1 .AND. A<5
MHRF = SUBSTR(MKODE, A, 1)
MKE = AT(MHRF, NKEY)
MKE = MOD(MKE, 10)-1
KDPROG = KDPROG+ALLTRIM(STR(MKE))
IF A=4
MASET = VAL(KDPROG)
KDPROG = ''
ENDIF
ENDIF
IF A>=6 .AND. A<9
MHRF = SUBSTR(MKODE, A, 1)
MKE = AT(MHRF, NKEY)
MHIT = MOD(MKE, 10)
MHR = MHR+ALLTRIM(STR(MHIT))
IF A=8
MTGLJT = CTOD('01-01-2015')+VAL(MHR)
KDPROG = '8'
ENDIF
ENDIF
IF A>9
MHRF = SUBSTR(MKODE, A, 1)
MKE = AT(MHRF, NKEY)
KDPROG = KDPROG+ALLTRIM(STR(MOD(MKE, 10)))
ENDIF
ENDFOR
DEFAREGASET = MASET
DEFAREGKANTOR = KDPROG
DEFAREGTGLJT = MTGLJT
DEFAREGSTAT = MSTAT
RETURN
ENDPROC
**
FUNCTION RANDOM
PARAMETER ANLOW, ANHIGH
IF PARAMETERS()<1
ANLOW = 1
ANHIGH = 100
ENDIF
LNRNUMBER = INT((RAND()*(ANHIGH-ANLOW+1))+ANLOW)
RETURN LNRNUMBER
ENDFUNC
**
FUNCTION Cret
PARAMETER A1, A2, A3, A4, A5, A6, A7, A8, A9, A10
MRET = ''
FOR KE = 1 TO 10
VKE = ALLTRIM(STR(KE))
IF VARTYPE(A&VKE)="L"
RETURN MRET
ENDIF
IF VARTYPE(A&VKE)="C"
MRET=MRET+A&VKE+'|'
ENDIF
IF VARTYPE(A&VKE)="D"
MRET=MRET+DTOC(A&VKE)+'|'
ENDIF
IF VARTYPE(A&VKE)="N"
MRET=MRET+ALLTRIM(STR(A&VKE))+'|'
ENDIF
ENDFOR
RETURN MRET
ENDFUNC
**
FUNCTION bacaret
PARAMETER MTEXT, MKE
AA = 1
DO WHILE .T.
IF AT("|", MTEXT)=0
EXIT
ENDIF
MKATA = LEFT(MTEXT, AT("|", MTEXT)-1)
MTEXT = SUBSTR(MTEXT, AT("|", MTEXT)+1)
IF AA=MKE
EXIT
ENDIF
AA = AA+1
ENDDO
RETURN MKATA
ENDFUNC
**
FUNCTION GetArg
LPARAMETERS TCARGUMENT, TCARGNO, TCSEPARATOR
IF PARAMETERS()<3 .OR. TCSEPARATOR==''
TCSEPARATOR = ';'
ENDIF
TCARGUMENT = TCSEPARATOR+TCSEPARATOR+TCARGUMENT+REPLICATE(TCSEPARATOR, MAX(0, TCARGNO))
TCARGUMENT = SUBSTR(TCARGUMENT, AT(TCSEPARATOR, TCARGUMENT, MAX(0, TCARGNO)+1)+1)
RETURN LEFT(TCARGUMENT, AT(TCSEPARATOR, TCARGUMENT)-1)
ENDFUNC
**
FUNCTION GetFocus
DECLARE INTEGER GetFocus IN user32 AS GetFocus
RETURN GETFOCUS()
ENDFUNC
**
FUNCTION cektanggal
PARAMETER VTGL
LOCAL OLDSELECT, MBOLEH
MBOLEH = .F.
OLDSELECT = SELECT()
CSQL = "select tglawal,tglakhir from batastanggal where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "BATASTANGGAL")
IF VTGL>=TGLAWAL .AND. VTGL<=TGLAKHIR
MBOLEH = .T.
ENDIF
SELECT (OLDSELECT)
RETURN MBOLEH
ENDFUNC
**
FUNCTION namakantor
PARAMETER MKANTOR
LOCAL OLDSELECT, MNAMAKANTOR
OLDSELECT = SELECT()
CSQL = "select keterangan from setsandi where kantor='ID' and kode='KNT' and sandi='"+MKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "xkantor")
MNAMAKANTOR = IIF(ISNULL(KETERANGAN), "", KETERANGAN)
USE
SELECT (OLDSELECT)
RETURN MNAMAKANTOR
ENDFUNC
**
FUNCTION ubahdesktop
MFILE = GETFILE("JPG,BMP,PNG", "Ambil Gambar", "Ambil")
RETURN MFILE
ENDFUNC
**
PROCEDURE cekversidbf
CSQL = "select keterangan from setsandi where kantor='ID' and kode='VER'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MVERSINOW = "003"
IF EMPTY(KETERANGAN) .OR. KETERANGAN<>MVERSINOW .OR. RECCOUNT()=0
IF RECCOUNT()=0
CSQL = "insert into setsandi (kantor,kode,keterangan,inpopr) values ("+"'ID','VER','"+MVERSINOW+"','SYSTEM')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "update setsandi set keterangan='"+MVERSINOW+"' where kantor='ID' and kode='VER'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "CREATE TABLE `urutnota` ("+"kantor      VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"statusnomor VARCHAR( 1 ) NOT NULL DEFAULT '0',"+"kas         VARCHAR( 6 ) NOT NULL DEFAULT 'KAS',"+"nomorbukti  VARCHAR( 10 ) NOT NULL DEFAULT '',"+"INDEX ( `kantor` ))"
CSQL = SQLEXEC(OODBC, CSQL)
CSQL = "ALTER TABLE `anggota` ADD `pekerjaan` VARCHAR(20), ADD statuskawin  VARCHAR(15)"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
RETURN
ENDPROC
**
FUNCTION CekChar
PARAMETER MKATA
MKATA = STRTRAN(MKATA, "'", "\'")
RETURN MKATA
ENDFUNC
**
FUNCTION sldsimp
PARAMETER MNOREK, MTGL
LOCAL MSALDO, OLDSELE, CSQL
OLDSELE = SELECT()
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
MSALDO = IIF(ISNULL(SALDO), 0, SALDO)
MSALDO = IIF(VARTYPE(MSALDO)="C", VAL(MSALDO), MSALDO)
USE
SELECT (OLDSELE)
RETURN MSALDO
ENDFUNC
**
PROCEDURE dbf2cursor
PARAMETER MHASIL, MDATA1, MDATA2, MDATA3, MDATA4
CSQL = "select column_name,column_type from information_schema.columns where table_schema='sbu' and table_name='"+MDATA1+"'"
LCEK = SQLEXEC(OODBC, CSQL, "MDBF")
MCUR = "CREATE CURSOR "+MHASIL+" ( "
DO WHILE  .NOT. EOF()
MFIELD = ALLTRIM(COLUMN_NAME)
DO CASE
CASE LEFT(COLUMN_TYPE, 6)='double'
MTYPE = 'int(12)'
CASE LEFT(COLUMN_TYPE, 6)='tinyin'
MTYPE = 'int(6)'
CASE LEFT(COLUMN_TYPE, 6)='decima'
MTYPE = 'N(5,2)'
OTHERWISE
MTYPE = COLUMN_TYPE
ENDCASE
IF AT(' '+MFIELD+' ', MCUR)=0
MCUR = MCUR+MFIELD+" "+MTYPE+", "
ENDIF
SKIP
ENDDO
IF VARTYPE(MDATA2)="C"
CSQL = "select column_name,column_type from information_schema.columns where table_schema='sbu' and table_name='"+MDATA2+"'"
LCEK = SQLEXEC(OODBC, CSQL, "MDBF")
DO WHILE  .NOT. EOF()
MFIELD = ALLTRIM(COLUMN_NAME)
DO CASE
CASE LEFT(COLUMN_TYPE, 6)='double'
MTYPE = 'int(12)'
CASE LEFT(COLUMN_TYPE, 6)='tinyin'
MTYPE = 'int(6)'
CASE LEFT(COLUMN_TYPE, 6)='decima'
MTYPE = 'N(5,2)'
OTHERWISE
MTYPE = COLUMN_TYPE
ENDCASE
IF AT(' '+MFIELD+' ', MCUR)=0
MCUR = MCUR+MFIELD+" "+MTYPE+", "
ENDIF
SKIP
ENDDO
ENDIF
IF VARTYPE(MDATA3)="C"
CSQL = "select column_name,column_type from information_schema.columns where table_schema='sbu' and table_name='"+MDATA3+"'"
LCEK = SQLEXEC(OODBC, CSQL, "MDBF")
DO WHILE  .NOT. EOF()
MFIELD = ALLTRIM(COLUMN_NAME)
DO CASE
CASE LEFT(COLUMN_TYPE, 6)='double'
MTYPE = 'int(12)'
CASE LEFT(COLUMN_TYPE, 6)='tinyin'
MTYPE = 'int(6)'
CASE LEFT(COLUMN_TYPE, 6)='decima'
MTYPE = 'N(5,2)'
OTHERWISE
MTYPE = COLUMN_TYPE
ENDCASE
IF AT(' '+MFIELD+' ', MCUR)=0
MCUR = MCUR+MFIELD+" "+MTYPE+", "
ENDIF
SKIP
ENDDO
ENDIF
IF VARTYPE(MDATA4)="C"
CSQL = "select column_name,column_type from information_schema.columns where table_schema='sbu' and table_name='"+MDATA4+"'"
LCEK = SQLEXEC(OODBC, CSQL, "MDBF")
DO WHILE  .NOT. EOF()
MFIELD = ALLTRIM(COLUMN_NAME)
DO CASE
CASE LEFT(COLUMN_TYPE, 6)='double'
MTYPE = 'int(12)'
CASE LEFT(COLUMN_TYPE, 6)='tinyin'
MTYPE = 'int(6)'
CASE LEFT(COLUMN_TYPE, 6)='decima'
MTYPE = 'N(5,2)'
OTHERWISE
MTYPE = COLUMN_TYPE
ENDCASE
IF AT(' '+MFIELD+' ', MCUR)=0
MCUR = MCUR+MFIELD+" "+MTYPE+", "
ENDIF
SKIP
ENDDO
ENDIF
MCUR = LEFT(MCUR, LEN(MCUR)-2)
MCUR = MCUR+")"
&MCUR
RETURN
ENDPROC
**
FUNCTION myprint
PARAMETER MON, MFONT, MSIZE, MBOLD
IF MON="ON"
IF PARAMETERS()<2
MFONT = 'DRAFT'
ENDIF
IF PARAMETERS()<3
MSIZE = 8
ENDIF
IF PARAMETERS()<4
MBOLD = 'N'
ENDIF
SET REPORTBEHAVIOR 80
IF SYS(13)='OFFLINE'
MESSAGEBOX("Printer Tidak Tersedia", 48, "")
RETURN .F.
ENDIF
LCPF_NAME = SET("PRINTER", 3)
SET PRINTER TO NAME (LCPF_NAME)
SET PRINTER ON
SET DEVICE TO PRINTER
SET CONSOLE OFF
SET PRINTER FONT MFONT, MSIZE STYLE MBOLD
ELSE
SET PRINTER OFF
SET PRINTER TO
SET REPORTBEHAVIOR 90
SET CONSOLE ON
SET DEVICE TO SCREEN
ENDIF
RETURN .T.
ENDFUNC
**
PROCEDURE cetakvalidasi
PARAMETER MNAMACETAK, MBARIS1, MBARIS2, MBARIS3, MBARIS4
LOCAL OLDSELECT
OLDSELECT = SELECT()
MFRX = "C:\CTK.FRX"
MFRT = STRTRAN(MFRX, ".FRX", ".FRT")
SELECT 0
CSQL = "select * from set_cetakfrx where namafrx='"+MNAMACETAK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
STORE 0 TO MBARIS, MBRSHAL1, MHEIGHT, MANTARA, LNOMOR, LTANGGAL, LKODE, LDEBET, LKREDIT, LSALDO, LOPT
DO WHILE  .NOT. EOF()
DO CASE
CASE OBJCODE=1
MBARIS = BARIS
MBRSHAL1 = BRSHAL1
MHEIGHT = HEIGHT
MANTARA = ANTARA
CASE ALLTRIM(EXPR)="nomor"
LNOMOR = HPOS
CASE ALLTRIM(EXPR)="tanggal"
LTANGGAL = HPOS
CASE ALLTRIM(EXPR)="kode"
LKODE = HPOS
CASE ALLTRIM(EXPR)="debet"
LDEBET = HPOS
CASE ALLTRIM(EXPR)="kredit"
LKREDIT = HPOS
CASE ALLTRIM(EXPR)="saldo"
LSALDO = HPOS
CASE ALLTRIM(EXPR)="opt"
LOPT = HPOS
ENDCASE
SKIP
ENDDO
SELECT 0
CREATE CURSOR ctk (CETAK C (80))
APPEND BLANK
REPLACE CETAK WITH MBARIS1
APPEND BLANK
REPLACE CETAK WITH MBARIS2
APPEND BLANK
REPLACE CETAK WITH MBARIS3
APPEND BLANK
REPLACE CETAK WITH MBARIS4
GOTO TOP
IF DEFAUSERID='IMR'
REPORT FORM ctk_validasi PREVIEW
ELSE
REPORT FORM ctk_validasi TO PRINTER
ENDIF
USE
SELECT (OLDSELECT)
RETURN
ENDPROC
**
FUNCTION bukafile
LPARAMETERS TCFILENAME, TCWORKDIR, TCOPERATION
LOCAL LCFILENAME, LCWORKDIR, LCOPERATION, LNCALLSTAT, LCMSGREPLY
LNCALLSTAT = 0
LNMSGREPLY = 0
IF EMPTY(TCFILENAME)
RETURN -1
ENDIF
LCFILENAME = ALLTRIM(TCFILENAME)
LCWORKDIR = IIF(TYPE("tcWorkDir")="C", ALLTRIM(TCWORKDIR), "")
LCOPERATION = IIF(TYPE("tcOperation")="C" .AND.  .NOT. EMPTY(TCOPERATION), ALLTRIM(TCOPERATION), "Open")
DECLARE INTEGER ShellExecute IN SHELL32.DLL INTEGER, STRING, STRING, STRING, STRING, INTEGER
LCCALLSTAT = SHELLEXECUTE(0, LCOPERATION, LCFILENAME, "", LCWORKDIR, 1)
ENDFUNC
**
PROCEDURE cekkelneraca
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MMODEL = VAL(CARIPUBLIC("NRC_MODEL"))
MKEL = ''
MKELDATA = ''
MNRC_AKT = ALLTRIM(CARIPUBLIC("NRC_AKT"))
MNRC_PSV = ALLTRIM(CARIPUBLIC("NRC_PSV"))
MNRC_ADM = ALLTRIM(CARIPUBLIC("NRC_ADM"))
MNRC_PO = ALLTRIM(CARIPUBLIC("NRC_PO"))
MNRC_PL = ALLTRIM(CARIPUBLIC("NRC_PL"))
MNRC_BB = ALLTRIM(CARIPUBLIC("NRC_BB"))
MNRC_BO = ALLTRIM(CARIPUBLIC("NRC_BO"))
MNRC_PNO = ALLTRIM(CARIPUBLIC("NRC_PNO"))
MNRC_BNO = ALLTRIM(CARIPUBLIC("NRC_BNO"))
MNRC_EKU = ALLTRIM(CARIPUBLIC("NRC_EKU"))
MNRC_BB1 = MNRC_BB
MNRC_BB2 = ""
IF AT(",", MNRC_BB)>0
MNRC_BB1 = LEFT(MNRC_BB, AT(",", MNRC_BB)-1)
MNRC_BB2 = SUBSTR(MNRC_BB, AT(",", MNRC_BB)+1)
ENDIF
MNRC_PO1 = MNRC_PO
MNRC_PO2 = ""
IF AT(",", MNRC_PO)>0
MNRC_PO1 = LEFT(MNRC_PO, AT(",", MNRC_PO)-1)
MNRC_PO2 = SUBSTR(MNRC_PO, AT(",", MNRC_PO)+1)
ENDIF
MNRC_PL1 = MNRC_PL
MNRC_PL2 = ""
MNRC_PL3 = ""
IF AT(",", MNRC_PL)>0
MNRC_PL1 = LEFT(MNRC_PL, AT(",", MNRC_PL)-1)
MNRC_PLA = SUBSTR(MNRC_PL, AT(",", MNRC_PL)+1)
MNRC_PL2 = SUBSTR(MNRC_PLA, AT(",", MNRC_PLA)-1)
MNRC_PL3 = SUBSTR(MNRC_PLA, AT(",", MNRC_PLA)+1)
ENDIF
CSQL = "update perkiraan set keldata='40' where '1'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set kel='NA', keldata='NA' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_AKT)))+")='"+MNRC_AKT+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set kel='NP', keldata='NP' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_PSV)))+")='"+MNRC_PSV+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set kel='AD', keldata='AD' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_ADM)))+")='"+MNRC_ADM+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set kel='RA', keldata='11' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_PO1)))+")='"+MNRC_PO1+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF  .NOT. EMPTY(MNRC_PO2)
CSQL = "update perkiraan set kel='RA', keldata='11' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_PO2)))+")='"+MNRC_PO2+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "update perkiraan set kel='RA', keldata='"+IIF(MMODEL=2, "13", "11")+"' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_PL)))+")='"+MNRC_PL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set kel='RP', keldata='21' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_BO)))+")='"+MNRC_BO+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set kel='RP', keldata='"+IIF(MMODEL=3, "21", "12")+"' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_BB1)))+")='"+MNRC_BB1+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF  .NOT. EMPTY(MNRC_BB2)
CSQL = "update perkiraan set kel='RP', keldata='"+IIF(MMODEL=3, "21", "12")+"' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_BB2)))+")='"+MNRC_BB2+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "update perkiraan set kel='RA', keldata='31' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_PNO)))+")='"+MNRC_PNO+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set kel='RP', keldata='31' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_BNO)))+")='"+MNRC_BNO+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set kel='NP', keldata='NP' where LEFT(noper,"+ALLTRIM(STR(LEN(MNRC_EKU)))+")='"+MNRC_EKU+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
PROCEDURE DeclareAPIs
DECLARE INTEGER WSAStartup IN wsock32 INTEGER, STRING @
DECLARE INTEGER WSACleanup IN wsock32
DECLARE INTEGER gethostname IN wsock32 STRING @, INTEGER
DECLARE INTEGER gethostbyname IN wsock32 STRING
DECLARE RtlMoveMemory IN kernel32 AS Heap2Str STRING @, INTEGER, INTEGER
ENDPROC
**
FUNCTION IPPortion
LPARAMETERS NPOINTER
LOCAL LNADDRESS, LCRESULT
LNADDRESS = BUF2DWORD(MEMORYBUFFER(NPOINTER, 4))
RETURN IIF(LNADDRESS<>0, JUSTIP(MEMORYBUFFER(LNADDRESS, 4)), "")
ENDFUNC
**
FUNCTION JustIP
LPARAMETERS CBUFFER
LOCAL LCRESULT, LNCOUNTER
LCRESULT = ""
FOR LNCOUNTER = 1 TO 4
LCRESULT = LCRESULT+LTRIM(STR(ASC(SUBSTR(CBUFFER, LNCOUNTER))))+IIF(LNCOUNTER=4, "", ".")
ENDFOR
RETURN LCRESULT
ENDFUNC
**
FUNCTION buf2word
LPARAMETERS CBUFFER
RETURN ASC(SUBSTR(CBUFFER, 1, 1))+ASC(SUBSTR(CBUFFER, 2, 1))*256
ENDFUNC
**
FUNCTION buf2dword
LPARAMETERS CBUFFER
RETURN ASC(SUBSTR(CBUFFER, 1, 1))+BITLSHIFT(ASC(SUBSTR(CBUFFER, 2, 1)), 8)+BITLSHIFT(ASC(SUBSTR(CBUFFER, 3, 1)), 16)+BITLSHIFT(ASC(SUBSTR(CBUFFER, 4, 1)), 24)
ENDFUNC
**
FUNCTION MemoryBuffer
LPARAMETERS NADDRESS, NBUFFERSIZE
LOCAL LCBUFFER
LCBUFFER = SPACE(NBUFFERSIZE)
= HEAP2STR(@LCBUFFER, NADDRESS, NBUFFERSIZE)
RETURN LCBUFFER
ENDFUNC
**
FUNCTION myhostname
LOCAL LCBUFFER, LNRESULT, LCHOSTNAME, LCMESSAGE, LCHOSTENTSTRUCT
LCBUFFER = SPACE(398)
LNRESULT = WSASTARTUP(514, @LCBUFFER)
LCMESSAGE = ""
LCHOSTNAME = ""
IF LNRESULT=0
LCBUFFER = REPLICATE(CHR(0), 256)
LNRESULT = GETHOSTNAME(@LCBUFFER, 256)
IF LNRESULT=0
LCHOSTNAME = STRTRAN(LCBUFFER, CHR(0), "")
ENDIF
ENDIF
= WSACLEANUP()
RETURN LCHOSTNAME
ENDFUNC
**
FUNCTION myipaddress
LOCAL LCBUFFER, LNRESULT, LCHOSTNAME, LCMESSAGE, LCHOSTENTSTRUCT
LCBUFFER = SPACE(398)
LNRESULT = WSASTARTUP(514, @LCBUFFER)
LCMESSAGE = ""
MIP = ""
IF LNRESULT=0
LCBUFFER = REPLICATE(CHR(0), 256)
LNRESULT = GETHOSTNAME(@LCBUFFER, 256)
IF LNRESULT=0
LCHOSTNAME = STRTRAN(LCBUFFER, CHR(0), "")
LNRESULT = GETHOSTBYNAME(LCHOSTNAME)
IF LNRESULT<>0
LCHOSTENTSTRUCT = MEMORYBUFFER(LNRESULT, 16)
LNRESULT = BUF2DWORD(SUBSTR(LCHOSTENTSTRUCT, 13, 4))
IF LNRESULT<>0
MIP = IPPORTION(LNRESULT)
ENDIF
ENDIF
ENDIF
ENDIF
= WSACLEANUP()
RETURN MIP
ENDFUNC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** readini2.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
PARAMETER PRMPARENTSECTION, PRMCHILDSECTION, PRMDEFAULTVALUE, PRMFILEINI
DECLARE INTEGER GetPrivateProfileString IN Win32API AS GetPrivStr STRING, STRING, STRING, STRING @, INTEGER, STRING
LOCAL FILEHANDLER, RETURNVALUE
WINDINIPATH = "C:\WINDOWS\"+PRMFILEINI
IF FILE(WINDINIPATH)
FILEHANDLER = FOPEN(WINDINIPATH, 0)
PRMFILEINILOC = "C:\WINDOWS\"+PRMFILEINI
ELSE
IF FILE(PRMFILEINI)
FILEHANDLER = FOPEN(PRMFILEINI, 0)
PRMFILEINILOC = CURDIR()+PRMFILEINI
ELSE
RETURNVALUE = PRMDEFAULTVALUE
RETURN RETURNVALUE
ENDIF
ENDIF
IF FILEHANDLER<0
WAIT WINDOW NOWAIT "Gagal akses INI File."
= FCLOSE(FILEHANDLER)
RETURNVALUE = PRMDEFAULTVALUE
RETURN RETURNVALUE
ELSE
= FCLOSE(FILEHANDLER)
ENDIF
LOCAL LCBUFFER
LCBUFFER = SPACE(500)+CHR(0)
= GETPRIVSTR(PRMPARENTSECTION, PRMCHILDSECTION, PRMDEFAULTVALUE, @LCBUFFER, LEN(LCBUFFER), PRMFILEINILOC)
LCBUFFER = ALLTRIM(STRTRAN(LCBUFFER, CHR(0), ""))
RETURN LCBUFFER
ENDFUNC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** script1.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
PARAMETER P_KATA
LOCAL L_HASIL, L_ACAK, L_INDEX, I
L_ACAK = "MULYONO RAFIANTO"
L_HASIL = ""
L_INDEX = 1
FOR I = 1 TO LEN(ALLTRIM(P_KATA))
L_HASIL = L_HASIL+CHR(ASC(SUBSTR(P_KATA, I, 1))+ASC(SUBSTR(L_ACAK, L_INDEX, 1)))
L_INDEX = L_INDEX+1
IF L_INDEX>LEN(L_ACAK)
L_INDEX = 1
ENDIF
ENDFOR
RETURN L_HASIL
ENDFUNC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** script2.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
PARAMETER P_KATA
LOCAL L_HASIL, L_ACAK, L_INDEX, I
L_ACAK = "MULYONO RAFIANTO"
L_HASIL = ""
L_INDEX = 1
FOR I = 1 TO LEN(ALLTRIM(P_KATA))
L_HASIL = L_HASIL+CHR(ASC(SUBSTR(P_KATA, I, 1))-ASC(SUBSTR(L_ACAK, L_INDEX, 1)))
L_INDEX = L_INDEX+1
IF L_INDEX>LEN(L_ACAK)
L_INDEX = 1
ENDIF
ENDFOR
MESSAGEBOX(L_HASIL)
RETURN L_HASIL
ENDFUNC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** frm_calender.scx
***
*
*
*  frm_calender.scx::FORM1
**
FUNCTION Unload
RETURN THISFORM.TANGGAL
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MTOP, MLEFT
THISFORM.TOP = MTOP
THISFORM.LEFT = MLEFT
THISFORM.TANGGAL = DATE()
ENDPROC
**
*
*  frm_calender.scx::Olecontrol1
**
PROCEDURE Click
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE DblClick
THISFORM.TANGGAL = CTOD(ALLTRIM(STR(THIS.DAY))+'-'+ALLTRIM(STR(THIS.MONTH))+'-'+ALLTRIM(STR(THIS.YEAR)))
THISFORM.RELEASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS KEYASCII
IF LASTKEY()=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.DAY = DAY(DATE())
THIS.MONTH = MONTH(DATE())
THIS.YEAR = YEAR(DATE())
ENDPROC
**
PROCEDURE Today
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
***
*** frm_calender.sct
***
*
***
*** frm_login.scx
***
*
*
*  frm_login.scx::FORM1
**
PROCEDURE Init
_USERS = ""
_PASWD = ""
_TYPEUSER = ""
_AKSESOKE = .F.
_MULAI = .T.
VARPUBLIC()
CSQL = "select COUNT(nama) as ada from user"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF VAL(ADA)=0
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.COMMAND1.ENABLED = .F.
THISFORM.COMMAND3.VISIBLE = .T.
ELSE
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.COMMAND1.ENABLED = .T.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
USE
THISFORM.WINDOWSTATE = 0
_SCREEN.ENABLED = .F.
THISFORM.TEXT3.VALUE = DEFAKANTOR
THISFORM.TEXT1.VALUE = DEFAIDUSER
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
PROCEDURE Error
LPARAMETERS NERROR, CMETHOD, NLINE
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  frm_login.scx::Text2
**
PROCEDURE LostFocus
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  frm_login.scx::Command1
**
PROCEDURE Click
LOCAL PASOKE, _USERS1, _PASWD1
THISFORM.JML_LOGIN = THISFORM.JML_LOGIN+1
DEFAKANTOR = THISFORM.TEXT3.VALUE
_USERS1 = ALLTRIM(THISFORM.TEXT1.VALUE)
_PASWD1 = THISFORM.TEXT2.VALUE
_MULAI = .T.
CSQL = "select * from user where userid='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' and password=md5('"+ALLTRIM(THISFORM.TEXT2.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF USERID<>ALLTRIM(THISFORM.TEXT1.VALUE)
MESSAGEBOX("User atau Password Salah", 32, "")
IF THISFORM.JML_LOGIN>=3
_AKSESOKE = .F.
_USERS = ""
_PASSWD = ""
_TYPEUSER = ""
DEFAHAKMENU = '0000000'
DEFAHAKUSER = '0000000'
STORE '2' TO DEFAHAKANGG, DEFAHAKSIMP, DEFAHAKPINJ, DEFAHAKKAS, DEFAHAKAKT, DEFAHAKCOL, DEFAHAKUSER, DEFAHAKSET
DEFAIDGROUP = ""
DEFAMASUK = .F.
DEFAIDGROUP = ''
THISFORM.RELEASE
ENDIF
RETURN
ENDIF
DEFAMASUK = .T.
MID = ID
_USERS = USERID
_PASWD = PASSWORD
_NOGROUP = ALLTRIM(NAMAGROUP)
_USERID = ID
MSTAT = STAT
DEFABATASKAS = BATASKAS
USE
CSQL = "select * from user_group where md5(id)=?_nogroup"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DEFAHAKMENU = ALLTRIM(STR(SETING))+ALLTRIM(STR(MASTER))+ALLTRIM(STR(TRANSAKSI))+ALLTRIM(STR(LAPORAN))+ALLTRIM(STR(PROSES))+ALLTRIM(STR(UTILITY))
DEFAHAKREPT = ALLTRIM(STR(R_ANGGOTA))+ALLTRIM(STR(R_SIMPANAN))+ALLTRIM(STR(R_PINJAMAN))+ALLTRIM(STR(R_KASIR))+ALLTRIM(STR(R_AKUNTANSI))+ALLTRIM(STR(R_LAIN))
DEFAHAKANGG = M_ANGGOTA
DEFAHAKSIMP = M_SIMPANAN
DEFAHAKPINJ = M_PINJAMAN
DEFAHAKKAS = M_KASIR
DEFAHAKAKT = M_AKUNTANSI
DEFAHAKCOL = M_KOLEKTOR
DEFAHAKUSER = M_USER
DEFAHAKSET = M_SETTING
DEFAIDGROUP = NAMAGROUP
IF MSTAT="0"
MESSAGEBOX("USER ID / PASSWORD BELUM DAPAT DIGUNAKAN"+CHR(13)+"ANDA HARUS MELAKUKAN PERUBAHAN PASSWORD "+CHR(13)+"DAN PASTIKAN RUBAH PASSWORD SECARA BERKALA", 64, "PERNGATAN")
ENDIF
USE
FOR A = 1 TO _SCREEN.FORMCOUNT
IF _SCREEN.FORMS(A).NAME="XMFORM"
_SCREEN.FORMS(A).TAMPILAWAL()
ENDIF
ENDFOR
CSQL = "select ket2,ket3 from setsandi where kantor='ID' and kode='KNT' and sandi='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MREG = KET2
IF EMPTY(KET2)
MREG = BUATREGISTER()
CSQL = "update setsandi set ket2='"+MREG+"' where kantor='ID' and kode='KNT' and sandi='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
BACAREGISTER(MREG)
VARPUBLIC()
DEFAUSERID = THISFORM.TEXT1.VALUE
DEFAKANTOR = THISFORM.TEXT3.VALUE
CEKDATA()
MAIN_MENU()
THISFORM.RELEASE
ENDPROC
**
*
*  frm_login.scx::Command2
**
PROCEDURE Click
_AKSESOKE = .F.
_USERS = ""
_PASSWD = ""
_TYPEUSER = ""
DEFAHAKMENU = '0000000'
DEFAHAKUSER = '0000000'
STORE '2' TO DEFAHAKANGG, DEFAHAKSIMP, DEFAHAKPINJ, DEFAHAKKAS, DEFAHAKAKT, DEFAHAKCOL, DEFAHAKUSER, DEFAHAKSET
DEFAIDGROUP = ""
DEFAMASUK = .F.
DEFAIDGROUP = ''
THISFORM.RELEASE
ENDPROC
**
*
*  frm_login.scx::Command3
**
PROCEDURE Click
THISFORM.HIDE()
DO FORM atur_user
THISFORM.SHOW()
CSQL = "select COUNT(nama) as ada from user"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF VAL(ADA)=0
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.COMMAND1.ENABLED = .F.
THISFORM.COMMAND3.VISIBLE = .T.
ELSE
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.COMMAND1.ENABLED = .T.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
USE
ENDPROC
**
*
*  frm_login.scx::Text3
**
PROCEDURE LostFocus
CSQL = "select sandi from setsandi where kantor='ID' and kode='KNT' and sandi='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF THIS.VALUE<>SANDI .OR. EMPTY(THIS.VALUE)
THISFORM.HIDE()
DO FORM set_kantor TO MKANTOR
THIS.VALUE = MKANTOR
THISFORM.SHOW()
ENDIF
IF THISFORM.TEXT1.ENABLED=.F.
THISFORM.COMMAND3.SETFOCUS
ENDIF
ENDPROC
**
***
*** frm_login.sct
***
*
***
*** anggota.scx
***
*
*
*  anggota.scx::NASABAH
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
IF DEFAPROSMIGRASI="Y"
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 9
.FONTSIZE = 10
.FONTNAME = "Cambria"
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "CIF"
.COLUMN1.HEADER1.CAPTION = "NO.ANGG"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 100
.COLUMN2.CONTROLSOURCE = "CIF_LAMA"
.COLUMN2.HEADER1.CAPTION = "NO.REKENING"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 80
.COLUMN3.CONTROLSOURCE = "CIF_SMT"
.COLUMN3.HEADER1.CAPTION = "NO. BARU"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN4.WIDTH = 100
.COLUMN4.CONTROLSOURCE = "TANGGAL"
.COLUMN4.HEADER1.CAPTION = "TANGGAL"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN5.WIDTH = 300
.COLUMN5.CONTROLSOURCE = "NAMA"
.COLUMN5.HEADER1.CAPTION = "NAMA"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN6.WIDTH = 100
.COLUMN6.CONTROLSOURCE = "KECAMATAN"
.COLUMN6.HEADER1.CAPTION = "KECAMATAN"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN7.WIDTH = 100
.COLUMN7.CONTROLSOURCE = "KOTA"
.COLUMN7.HEADER1.CAPTION = "KOTA"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN8.WIDTH = 150
.COLUMN8.CONTROLSOURCE = "IBU"
.COLUMN8.HEADER1.CAPTION = "IBU"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN9.WIDTH = 150
.COLUMN9.CONTROLSOURCE = "KELKERJA"
.COLUMN9.HEADER1.CAPTION = "KEL. KERJA"
.COLUMN9.HEADER1.FONTBOLD = .T.
.REFRESH
ENDWITH
ELSE
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 9
.FONTSIZE = 10
.FONTNAME = "Cambria"
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "CIF"
.COLUMN1.HEADER1.CAPTION = "NO.ANGG"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 80
.COLUMN2.CONTROLSOURCE = "TANGGAL"
.COLUMN2.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KELKERJA"
.COLUMN3.HEADER1.CAPTION = "INST"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN4.WIDTH = 300
.COLUMN4.CONTROLSOURCE = "NAMA"
.COLUMN4.HEADER1.CAPTION = "NAMA"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN5.WIDTH = 300
.COLUMN5.CONTROLSOURCE = "ALAMAT"
.COLUMN5.HEADER1.CAPTION = "ALAMAT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN6.WIDTH = 150
.COLUMN6.CONTROLSOURCE = "DESA"
.COLUMN6.HEADER1.CAPTION = "DESA"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN7.WIDTH = 100
.COLUMN7.CONTROLSOURCE = "KECAMATAN"
.COLUMN7.HEADER1.CAPTION = "KECAMATAN"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN8.WIDTH = 100
.COLUMN8.CONTROLSOURCE = "KOTA"
.COLUMN8.HEADER1.CAPTION = "KOTA"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN9.WIDTH = 150
.COLUMN9.CONTROLSOURCE = "IBU"
.COLUMN9.HEADER1.CAPTION = "IBU"
.COLUMN9.HEADER1.FONTBOLD = .T.
.REFRESH
ENDWITH
ENDIF
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
IF THISFORM.STATUS="A"
CSQL = "select kelkerja ,anggota.* from anggota where tglkeluar='0000-00-00' and "
ELSE
CSQL = "select kelkerja ,anggota.* from anggota where tglkeluar>'0000-00-00' and "
ENDIF
MLIMIT = ALLTRIM(STR((THISFORM.HALAMAN.VALUE-1)*THISFORM.MLIMIT.VALUE))+", "+ALLTRIM(STR(THISFORM.MLIMIT.VALUE))
CSQL = CSQL+IIF(EMPTY(THISFORM.MFILTER.CAPTION), "1", THISFORM.MFILTER.CAPTION)+" order by cif limit "+MLIMIT
MDATA = THISFORM.DATA
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX("Gagal Baca Data Anggota", 0, "")
ENDIF
JMLDATA = RECCOUNT()
GOTO TOP
IF IJINMODUL("ANGG", "EDIT")
IF JMLDATA>0
THISFORM.CMDEDIT.ENABLED = .T.
ELSE
THISFORM.CMDEDIT.ENABLED = .F.
ENDIF
ENDIF
IF IJINMODUL("ANGG", "HAPUS")
IF JMLDATA>0
THISFORM.CMDHAPUS.ENABLED = .T.
ELSE
THISFORM.CMDHAPUS.ENABLED = .F.
ENDIF
ENDIF
IF IJINMODUL("ANGG", "CATATAN")
IF JMLDATA>0
THISFORM.CMDCATATAN1.ENABLED = .T.
ELSE
THISFORM.CMDCATATAN1.ENABLED = .F.
ENDIF
ENDIF
ENDPROC
**
PROCEDURE Activate
THISFORM.WINDOWSTATE = 2
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MSTATUS
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "TAMPIL"
ENDIF
THISFORM.MODE = MMODE
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("ANGG", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("ANGG", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("ANGG", "HAPUS")
IF DEFAPROSMIGRASI<>"Y"
THISFORM.CMDCIF.VISIBLE = .F.
THISFORM.CMDCATATAN2.VISIBLE = .F.
THISFORM.CMDCATATAN3.VISIBLE = .F.
THISFORM.COMMAND10.VISIBLE = .F.
ENDIF
THISFORM.OLDSELECT = SELECT()
IF VARTYPE(MSTATUS)="X" .OR. VARTYPE(MSTATUS)="L" .OR. MSTATUS="A"
THISFORM.LABEL2.CAPTION = "DAFTAR ANGGOTA (AKTIF)"
MSTATUS = "A"
ELSE
THISFORM.LABEL2.CAPTION = "DAFTAR ANGGOTA (HISTORY)"
ENDIF
THISFORM.STATUS = MSTATUS
IF MMODE="TAMPIL"
THISFORM.MFILTER.CAPTION = "tanggal='"+SQLDATE(TGLNOW)+"'"
ENDIF
THISFORM.MLIMIT.VALUE = 50
CSQL = "select COUNT(cif) as jml from anggota"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.JUMREC = IIF(ISNULL(JML), 0, VAL(JML))
THISFORM.HAL = INT(THISFORM.JUMREC/THISFORM.MLIMIT.VALUE)
THISFORM.HALAMAN.VALUE = 1
USE
SELECT (THISFORM.OLDSELECT)
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
IF MMODE="CARI"
THISFORM.CMDCARI1.CLICK
ENDIF
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA)
MCIF = CIF
USE
SELECT (THISFORM.OLDSELECT)
RETURN MCIF
ENDFUNC
**
*
*  anggota.scx::Cmdhapus
**
PROCEDURE Click
SELECT (THISFORM.DATA)
YT = MESSAGEBOX("Benar Data Akan dihapus", 20, "PERHATIAN")
IF YT=6
CSQL = "delete from anggota where iddata='"+STR(IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDIF
ENDPROC
**
*
*  anggota.scx::Cmdedit
**
PROCEDURE Click
IF THISFORM.STATUS="A"
SELECT (THISFORM.DATA)
MIDDATA = IDDATA
THISFORM.MYENABLE()
DO FORM ./form/anggota_data WITH "EDIT", MIDDATA, THISFORM.STATUS
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
LOCATE FOR IDDATA=MIDDATA
ELSE
MESSAGEBOX("Data History Tidak dapat dikoreksi", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  anggota.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
SELECT (THISFORM.DATA)
IF THISFORM.STATUS="A"
MYDATA = THISFORM.DATA
MIDDATA = IDDATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM ./form/anggota_data TO MCIF WITH "INPUT", MIDDATA, THISFORM.STATUS
IF  .NOT. EMPTY(MCIF)
THISFORM.MFILTER.CAPTION = "cif='"+MCIF+"'"
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat digunakan untuk input data", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  anggota.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  anggota.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota.scx::Cmddatatop1
**
PROCEDURE Click
THISFORM.HALAMAN.VALUE = MAX(1, THISFORM.HALAMAN.VALUE-1)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  anggota.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(cif),tanggal,TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama))"+" LIKE "+UPPER(MFILTER)
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  anggota.scx::Cmdcatatan1
**
PROCEDURE Click
SELECT (THISFORM.DATA)
DO FORM .\form\catatan WITH "ANGG", CIF
SELECT (THISFORM.DATA)
ENDPROC
**
*
*  anggota.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  anggota.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  anggota.scx::Cmddatabott1
**
PROCEDURE Click
THISFORM.HALAMAN.VALUE = MIN(THISFORM.HAL, THISFORM.HALAMAN.VALUE+1)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  anggota.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  anggota.scx::mLimit
**
PROCEDURE LostFocus
THISFORM.HAL = INT(THISFORM.JUMREC/THISFORM.MLIMIT.VALUE)
ENDPROC
**
*
*  anggota.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
IF THISFORM.MODE="CARI"
THISFORM.RELEASE
ELSE
DO FORM .\form\anggota_data WITH "TAMPIL", IDDATA, THISFORM.STATUS
KEYBOARD '{LEFTARROW}'
SELECT (THISFORM.DATA)
ENDIF
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=33
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM .\form\anggota_data WITH "TAMPIL", IDDATA, THISFORM.STATUS
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  anggota.scx::Cmdcatatan2
**
PROCEDURE Click
SELECT (THISFORM.DATA)
MFILTER = THISFORM.MFILTER.CAPTION
CSQL = "select distinct * from anggota where "+MFILTER+" and tglkeluar='0000-00-00' group by cif_smt"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
REPORT FORM angg_daftarnama PREVIEW
SELECT (THISFORM.DATA)
ENDPROC
**
*
*  anggota.scx::Cmdcatatan3
**
PROCEDURE Click
GOTO TOP
DO WHILE  .NOT. EOF()
IF CIF<>CIF_SMT
MCIF = CIF
MCIF_SMT = CIF_SMT
CSQL = "UPDATE anggota_mutasi set cif=?mcif_smt where cif=?mcif"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "UPDATE anggota_relasi set cif=?mcif_smt where cif=?mcif"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "UPDATE simpanan set cif=?mcif_smt where cif=?mcif"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "UPDATE pinjaman set cif=?mcif_smt where cif=?mcif"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
IF CIF<>CIF_SMT
CSQL = "delete from anggota where iddata=?iddata"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Data Salah")
ENDIF
ENDIF
SKIP
ENDDO
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  anggota.scx::cmdcif
**
PROCEDURE Click
IF THISFORM.STATUS="A"
SELECT (THISFORM.OLDSELECT)
MIDDATA = IDDATA
DO FORM anggota_edit
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
LOCATE FOR IDDATA=MIDDATA
ELSE
MESSAGEBOX("Data History Tidak dapat dikoreksi", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  anggota.scx::cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota.scx::Command10
**
PROCEDURE Click
OLDSELECT = SELECT()
DO FORM anggota_pindah WITH CIF
SELECT (OLDSELECT)
ENDPROC
**
***
*** anggota.sct
***
*
***
*** cari_data.scx
***
*
*
*  cari_data.scx::Form1
**
FUNCTION Unload
RETURN THISFORM.MYCARI
ENDFUNC
**
PROCEDURE Init
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  cari_data.scx::Command3
**
PROCEDURE Click
THISFORM.MYCARI = "'%"+ALLTRIM(THISFORM.TEXT1.VALUE)+"%'"
THISFORM.RELEASE
ENDPROC
**
*
*  cari_data.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
THISFORM.COMMAND3.CLICK
ENDIF
ENDPROC
**
*
*  cari_data.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** cari_data.sct
***
*
***
*** filter_data.scx
***
*
*
*  filter_data.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=18
IF THISFORM.HALAMAN>1
MHAL = THISFORM.HALAMAN
MCOMMAND = "thisform.KONTAINER"+ALLTRIM(STR(MHAL))+".visible=.f."
&MCOMMAND
THISFORM.HALAMAN = THISFORM.HALAMAN-1
MHAL = THISFORM.HALAMAN
MCOMMAND = "thisform.KONTAINER"+ALLTRIM(STR(MHAL))+".visible=.t."
&MCOMMAND
ENDIF
ENDIF
IF NKEYCODE=3
IF THISFORM.HALAMAN<THISFORM.MAXHAL
MHAL = THISFORM.HALAMAN
MCOMMAND = "thisform.KONTAINER"+ALLTRIM(STR(MHAL))+".visible=.f."
&MCOMMAND
THISFORM.HALAMAN = THISFORM.HALAMAN+1
MHAL = THISFORM.HALAMAN
MCOMMAND = "thisform.KONTAINER"+ALLTRIM(STR(MHAL))+".visible=.t."
&MCOMMAND
ENDIF
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MCURSOR, MVERSI
IF VARTYPE(MVERSI)="X" .OR. VARTYPE(MVERSI)="L" .OR. VARTYPE(MVERSI)<>"N" .OR. (VARTYPE(MVERSI)="N" .AND. MVERSI<>1)
MVERSI = 1
ENDIF
THISFORM.MVERSI = MVERSI
THISFORM.MYSELECT = MCURSOR
SELECT &MCURSOR
THISFORM.MYDATA = SYS(2015)
MPERPAGE = 12
JML = ROUND(IIF((FCOUNT()/MPERPAGE)=INT(FCOUNT()/MPERPAGE), FCOUNT()/MPERPAGE, INT(FCOUNT()/MPERPAGE)+1), 0)
THISFORM.MAXHAL = JML
THISFORM.HEIGHT = IIF(FCOUNT()>=MPERPAGE, (MPERPAGE*23)+90, FCOUNT()*23+90)
JML = 8
FOR I = 1 TO JML
MNAMA = "KONTAINER"+ALLTRIM(STR(I))
THISFORM.ADDOBJECT(MNAMA, "container")
OBJECTNAME = "thisform."+MNAMA
WITH &OBJECTNAME
.TOP = 33
.LEFT = 4
.WIDTH = THISFORM.WIDTH-10
.BACKSTYLE = 0
.HEIGHT = IIF(FCOUNT()>=MPERPAGE, (MPERPAGE*23)+7+5, (FCOUNT()*23)+7+5)
.SPECIALEFFECT = 1
ENDWITH
ENDFOR
THISFORM.KONTAINER1.VISIBLE = .T.
MYDATA = THISFORM.MYDATA
CREATE CURSOR &MYDATA (NAMA CHAR(30), ISI CHAR(250),TIPE CHAR(1) )
THISFORM.MYDATA = MYDATA
SELECT &MCURSOR 
THISFORM.CONTAINER1.TOP = THISFORM.HEIGHT-40
THISFORM.CONTAINER1.LEFT = 4
I = 1
MK = 1
HAL = 1
MAWAL = 7
FOR I = 1 TO FCOUNT()
MNAMA = "LABEL"+ALLTRIM(STR(I))
MOBJ = "thisform.KONTAINER"+ALLTRIM(STR(MK))+".addobject(mnama,'label')"
&MOBJ
OBJECTNAME = "thisform.KONTAINER"+ALLTRIM(STR(MK))+"."+MNAMA
WITH &OBJECTNAME
.VISIBLE = .T.
.CAPTION = FIELD(I)
.TOP = MAWAL+((I-((HAL-1)*MPERPAGE)-1)*23)+3
.LEFT = 7
.WIDTH = 70
.ALIGNMENT = 1
.BACKSTYLE = 0
.FONTNAME = "Cambria"
ENDWITH
MNAMA = "TEXT"+ALLTRIM(STR(I))
MOBJ = "thisform.KONTAINER"+ALLTRIM(STR(MK))+".addobject(mnama,'TEXTBOX')"
&MOBJ
OBJECTNAME = "thisform.KONTAINER"+ALLTRIM(STR(MK))+"."+MNAMA
MDBNAMA = FIELD(I)
MTYPE=VARTYPE(&MDBNAMA)
WITH &OBJECTNAME
.VISIBLE = .T.
.TOP = MAWAL+((I-((HAL-1)*MPERPAGE)-1)*23)
.LEFT = 80
.WIDTH = 200
.BACKSTYLE = 0
.THEMES = .F.
IF MTYPE="D"
.FORMAT = "D"
.VALUE = CTOD('  -  -    ')
ENDIF
IF MTYPE="N"
.INPUTMASK = "999,999,999,999"
.VALUE = 0
ENDIF
IF MTYPE="C"
.FORMAT = "K!"
.VALUE = ""
ENDIF
.FONTNAME = "Cambria"
ENDWITH
SELECT &MYDATA
APPEND BLANK
REPLACE NAMA WITH MDBNAMA, ISI WITH OBJECTNAME+".value", TIPE WITH MTYPE
SELECT &MCURSOR 
MK = INT(I/MPERPAGE)+1
IF I/MPERPAGE=INT(I/MPERPAGE)
MAWAL = 7
HAL = HAL+1
ENDIF
ENDFOR
THISFORM.KONTAINER1.TEXT1.SETFOCUS
ENDPROC
**
FUNCTION Unload
MCURSOR = THISFORM.MYSELECT
MYDATA = THISFORM.MYDATA
SELECT &MYDATA
USE
SELECT &MCURSOR 
HASIL = THISFORM.HASIL
RETURN HASIL
ENDFUNC
**
*
*  filter_data.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  filter_data.scx::Cmdsimpan1
**
PROCEDURE Click
MVERSI = THISFORM.MVERSI
MYDATA = THISFORM.MYDATA
SELECT &MYDATA
GOTO TOP
CSQL = ""
DO WHILE  .NOT. EOF()
BB = ALLTRIM(ISI)
HASIL=&BB
IF  .NOT. EMPTY(HASIL)
IF  .NOT. EMPTY(CSQL)
CSQL = CSQL+" and "
ENDIF
IF MVERSI=1
DO CASE
CASE TIPE="C"
CSQL = CSQL+ALLTRIM(NAMA)+" like '"+ALLTRIM(HASIL)+"%'"
CASE TIPE='D'
CSQL = CSQL+ALLTRIM(NAMA)+"='"+SQLDATE(HASIL)+"'"
CASE TIPE="N"
CSQL = CSQL+ALLTRIM(NAMA)+"='"+STR(HASIL)+"'"
OTHERWISE
CSQL = CSQL+" 1 "
ENDCASE
ELSE
DO CASE
CASE TIPE="C"
CSQL = CSQL+ALLTRIM(NAMA)+"='"+ALLTRIM(HASIL)+"'"
CASE TIPE='D'
CSQL = CSQL+ALLTRIM(NAMA)+"=CTOD('"+DTOC(HASIL)+"')"
CASE TIPE="N"
CSQL = CSQL+ALLTRIM(NAMA)+"="+STR(HASIL)
OTHERWISE
CSQL = CSQL+" .t. "
ENDCASE
ENDIF
ENDIF
SKIP
ENDDO
THISFORM.HASIL = CSQL
THISFORM.RELEASE
ENDPROC
**
***
*** filter_data.sct
***
*
***
*** anggota_data1.scx
***
*
*
*  anggota_data1.scx::FORM1
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MIDDATA
THISFORM.MODE = MMODE
THISFORM.COMMAND1.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
THISFORM.COMMAND4.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
THISFORM.COMMAND5.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
THISFORM.COMMAND6.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
THISFORM.COMMAND7.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
IF DEFAPROSMIGRASI<>"Y"
THISFORM.PAGEFRAME1.PAGE1.LABEL11.VISIBLE = .F.
THISFORM.PAGEFRAME1.PAGE1.LABEL13.VISIBLE = .F.
THISFORM.PAGEFRAME1.PAGE1.TEXT9.VISIBLE = .F.
THISFORM.PAGEFRAME1.PAGE1.TEXT11.VISIBLE = .F.
ENDIF
THISFORM.IDDATA = MIDDATA
THISFORM.OLDSELECT = SELECT()
THISFORM.DATA1 = SYS(2015)
DATA1 = THISFORM.DATA1
CSQL = "Select * from anggota where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, DATA1)
THISFORM.COMMAND12.SETFOCUS
THISFORM.PAGEFRAME1.PAGE1.TEXT1.INPUTMASK = DEFAFMTANGG
IF MMODE="TAMPIL"
THISFORM.PAGEFRAME1.PAGE1.SETALL("enabled", .F., "textbox")
THISFORM.PAGEFRAME1.PAGE1.SETALL("enabled", .F., "combobox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
IF MMODE="TAMPIL" .OR. MMODE="EDIT"
IF MMODE="EDIT"
THISFORM.PAGEFRAME1.PAGE1.TEXT12.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.LABEL2.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.TEXT12.VALUE = CTOD('00-00-0000')
ENDIF
THISFORM.PAGEFRAME1.PAGE1.TEXT10.VALUE = TANGGAL
THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE = CIF
THISFORM.PAGEFRAME1.PAGE1.TEXT9.VALUE = CIF_LAMA
THISFORM.PAGEFRAME1.PAGE1.TEXT11.VALUE = CIF_SMT
THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE = NAMA
THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE = ALAMAT
THISFORM.PAGEFRAME1.PAGE1.TEXT4.VALUE = DESA
THISFORM.PAGEFRAME1.PAGE1.TEXT5.VALUE = KECAMATAN
THISFORM.PAGEFRAME1.PAGE1.TEXT6.VALUE = KOTA
THISFORM.PAGEFRAME1.PAGE1.TEXT7.VALUE = IBU
THISFORM.PAGEFRAME1.PAGE1.TEXT8.VALUE = AGAMA
THISFORM.PAGEFRAME1.PAGE1.TEXT13.VALUE = PHONE
THISFORM.PAGEFRAME1.PAGE1.COMBO2.VALUE = KELKERJA
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+KELKERJA+"'"
LCEK = SQLEXEC(OODBC, CSQL, "DUMMY")
IF EMPTY(KETERANGAN)
THISFORM.PAGEFRAME1.PAGE1.COMBO2.ENABLED = .F.
ENDIF
THISFORM.PAGEFRAME1.PAGE1.KET_INSTANSI.VALUE = KETERANGAN
USE
SELECT (THISFORM.OLDSELECT)
ENDIF
IF MMODE="INPUT"
THISFORM.PAGEFRAME1.PAGE1.TEXT1.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE1.TEXT10.VALUE = TGLNOW
THISFORM.PAGEFRAME1.PAGE1.TEXT10.SETFOCUS
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Load
THISFORM.OLDSELECT = SELECT()
ENDPROC
**
*
*  anggota_data1.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_data1.scx::Command3
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
IF EMPTY(THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE)
MESSAGEBOX("Nama Tidak Boleh Kosong", 0, "")
THISFORM.PAGEFRAME1.PAGE1.TEXT2.SETFOCUS
RETURN
ENDIF
IF THISFORM.MODE="INPUT"
CSQL = "select MAX(cif) as cif from anggota"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MCIF = IIF(ISNULL(CIF), "0", ALLTRIM(CIF))
MLEN = LEN(ALLTRIM(DEFAFMTANGG))
MCIF = RIGHT('00000000000000000'+ALLTRIM(STR(VAL(MCIF)+1)), MLEN)
MCIF_SMT = THISFORM.PAGEFRAME1.PAGE1.TEXT11.VALUE
MNAMA = CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE)
CSQL = "insert into anggota (kantor,tanggal,cif,cif_smt,noktp,nama,"+"tempatlhr,tanggallhr,jeniskl,alamat,rt,desa,"+"kecamatan,kota,agama,phone,ibu,kelkerja) value "+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT10.VALUE)+"',"+"'"+MCIF+"',"+"'"+MCIF_SMT+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT14.VALUE+"',"+"'"+MNAMA+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT15.VALUE+"',"+"'"+SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT16.VALUE)+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT17.VALUE+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE)+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT18.VALUE+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT4.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT5.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT6.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT7.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT8.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT13.VALUE)+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.COMBO2.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert data anggota")
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
MCIFASAL = CIF
MNAMA = CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE)
CSQL = "update anggota set "+" cif='"+THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE+"',"+" cif_smt='"+THISFORM.PAGEFRAME1.PAGE1.TEXT11.VALUE+"',"+" nama='"+MNAMA+"',"+" alamat='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE)+"',"+" desa='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT4.VALUE)+"',"+" kecamatan='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT5.VALUE)+"',"+" kota='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT6.VALUE)+"',"+" ibu='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT7.VALUE)+"',"+" agama='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT8.VALUE)+"', "+" phone='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT13.VALUE)+"', "+" kelkerja='"+THISFORM.PAGEFRAME1.PAGE1.COMBO2.VALUE+"', "+" tglkeluar='"+SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT12.VALUE)+"' "+" where idData='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF MCIFASAL<>THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_data1.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_data1.scx::Command1
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_fasilitas
ENDPROC
**
*
*  anggota_data1.scx::Command4
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_mutasi WITH "TAMPIL", "1"
ENDPROC
**
*
*  anggota_data1.scx::Command5
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_mutasi WITH "TAMPIL", "2"
ENDPROC
**
*
*  anggota_data1.scx::Command6
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_potong_gaji
ENDPROC
**
*
*  anggota_data1.scx::Command7
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_mutasi WITH "TAMPIL", "3"
ENDPROC
**
*
*  anggota_data1.scx::Text2
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Nama Tidak Boleh Kosong", 0, "")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  anggota_data1.scx::Combo2
**
PROCEDURE InteractiveChange
OLDSELECT = SELECT()
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+THIS.SANDI+"' and sandi='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CEK")
THISFORM.PAGEFRAME1.PAGE1.KET_INSTANSI.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE Init
MSANDI = 'P003'
THIS.ADDPROPERTY("sandi", MSANDI)
THIS.ADDPROPERTY("data", SELECT())
THIS.CLEAR
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT00")
THIS.ROWSOURCE = "SMT00"
IF EMPTY(SANDI)
THIS.ENABLED = .F.
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH THIS.SANDI
THIS.VALUE = MSANDI
ENDIF
MSANDI = THIS.VALUE
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+THIS.SANDI+"' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("Kode Instansi Tidak Tersedia")
NODEFAULT
SELECT (OLDSELECT)
RETURN
ENDIF
THISFORM.PAGEFRAME1.PAGE1.KET_INSTANSI.VALUE = KETERANGAN
SELECT SMT
USE
SELECT (THIS.DATA)
ENDFUNC
**
*
*  anggota_data1.scx::Text17
**
PROCEDURE InteractiveChange
IF 'LAKI-LAKI'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'LAKI-LAKI'
ENDIF
IF 'PEREMPUAN'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'PEREMPUAN'
ENDIF
IF 'WANITA'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'WANITA'
ENDIF
ENDPROC
**
*
*  anggota_data1.scx::Text18
**
PROCEDURE Init
THIS.VALUE = '000/000'
ENDPROC
**
*
*  anggota_data1.scx::Text19
**
PROCEDURE InteractiveChange
IF 'KAWIN'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'KAWIN'
ENDIF
IF 'BELUM KAWIN'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'BELUM KAWIN'
ENDIF
IF 'DUDA'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'DUDA'
ENDIF
IF 'JANDA'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'JANDA'
ENDIF
IF 'TIDAK KAWIN'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'TIDAK KAWIN'
ENDIF
ENDPROC
**
*
*  anggota_data1.scx::Cmdcatatan1
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM .\form\catatan WITH "ANGG", CIF
SELECT (THISFORM.DATA1)
ENDPROC
**
*
*  anggota_data1.scx::Command9
**
PROCEDURE Click
DO FORM pinjaman_lainnya
ENDPROC
**
***
*** anggota_data1.sct
***
*
***
*** catatan.scx
***
*
*
*  catatan.scx::Form1
**
PROCEDURE myenable
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.OPTIONGROUP1.ENABLED = .T.
THISFORM.TEXT6.ENABLED = .T.
ENDPROC
**
PROCEDURE mydisable
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.OPTIONGROUP1.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
ENDPROC
**
PROCEDURE tampil
MYDATA = THISFORM.MYDATA
THISFORM.GRID1.RECORDSOURCE = MYDATA
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 400
.COLUMN2.CONTROLSOURCE = "CATATAN"
.COLUMN2.HEADER1.CAPTION = "CATATAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "JUMLAH"
.COLUMN3.HEADER1.CAPTION = "JUMLAH"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, IIF(EMPTY(tglselesai),RGB(245,250,252),RGB(255,108,108)) , IIF(EMPTY(tglselesai),RGB(223,223,255),RGB(255,108,108))", "Column")
ENDPROC
**
PROCEDURE bacasql
MNOREK = THISFORM.NOREK
MDEPT = THISFORM.DEPT
MYDATA = THISFORM.MYDATA
CSQL = "select * from catatan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, MYDATA)
IF LCEK<1
MESSAGEBOX("Gagal baca catatan")
ENDIF
ENDPROC
**
PROCEDURE tampil2
THISFORM.LABEL1.FONTBOLD = .F.
THISFORM.LABEL3.FONTBOLD = .F.
THISFORM.LABEL8.FONTBOLD = .F.
THISFORM.OPTIONGROUP1.OPTION1.FONTBOLD = .F.
THISFORM.OPTIONGROUP1.OPTION2.FONTBOLD = .F.
THISFORM.OPTIONGROUP2.OPTION1.FONTBOLD = .F.
THISFORM.OPTIONGROUP2.OPTION2.FONTBOLD = .F.
THISFORM.OPTIONGROUP2.OPTION3.FONTBOLD = .F.
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = CATATAN
DO CASE
CASE VLD='1'
THISFORM.OPTIONGROUP1.VALUE = 1
THISFORM.OPTIONGROUP2.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.LABEL8.ENABLED = .F.
THISFORM.OPTIONGROUP2.VISIBLE = .F.
CASE VLD='2'
THISFORM.OPTIONGROUP2.VISIBLE = .T.
THISFORM.OPTIONGROUP2.VALUE = IIF(VLD2='1', 1, IIF(VLD2='2', 2, 3))
THISFORM.TEXT3.VALUE = TGLVALID
OTHERWISE
ENDCASE
THISFORM.TEXT6.VALUE = JUMLAH
THISFORM.TEXT4.VALUE = TGLSELESAI
THISFORM.TEXT5.VALUE = CTTSELESAI
ENDPROC
**
PROCEDURE Init
PARAMETER MDEPT, MKEY
THISFORM.MYDATA = SYS(2015)
THISFORM.OLDSELECT = SELECT()
DO CASE
CASE MDEPT="SIMP"
THISFORM.LABEL2.CAPTION = "CATATAN SIMPANAN"
CASE MDEPT="PINJ"
THISFORM.LABEL2.CAPTION = "CATATAN PINJAMAN"
CASE MDEPT="ANGG"
THISFORM.LABEL2.CAPTION = "CATATAN ANGGOTA"
ENDCASE
THISFORM.NOREK = MKEY
THISFORM.DEPT = MDEPT
THISFORM.TEXT5.INPUTMASK = REPLICATE("!", 40)
THISFORM.TEXT3.ENABLED = .F.
THISFORM.OPTIONGROUP2.VISIBLE = .F.
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.MYDATA)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  catatan.scx::cmdexit
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  catatan.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
*
*  catatan.scx::Optiongroup1
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.OPTIONGROUP2.VISIBLE = .F.
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .F.
ELSE
THISFORM.OPTIONGROUP2.VISIBLE = .T.
THISFORM.LABEL8.VISIBLE = .T.
THISFORM.TEXT3.VISIBLE = .T.
ENDIF
ENDPROC
**
PROCEDURE Option1.Click
THISFORM.TEXT3.ENABLED = .F.
THISFORM.OPTIONGROUP2.ENABLED = .F.
ENDPROC
**
PROCEDURE Option2.Click
THISFORM.TEXT3.ENABLED = .T.
THISFORM.OPTIONGROUP2.ENABLED = .T.
ENDPROC
**
*
*  catatan.scx::Cmdhapus
**
PROCEDURE Click
MNOREK = THISFORM.NOREK
MTANGGAL = TANGGAL
MCATATAN = CATATAN
THISFORM.MYEDIT = "HAPUS"
MIDCATATAN = IDCATATAN
CSQL = "delete from data_catatan where idcatatan=?midcatatan"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus data")
ELSE
SQLCOMMIT(OODBC)
ENDIF
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  catatan.scx::Cmdsimpan
**
PROCEDURE Click
THISFORM.CMDEDIT.VISIBLE = .T.
THISFORM.CMDHAPUS.VISIBLE = .T.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDKELUAR.VISIBLE = .T.
THISFORM.CMDINPUT.VISIBLE = .T.
THISFORM.CMDPRINT.VISIBLE = .T.
THISFORM.CMDSELESAI.VISIBLE = .T.
MDEPT = THISFORM.DEPT
MTANGGAL = THISFORM.TEXT1.VALUE
MIDCATATAN = IDCATATAN
MCATATAN = ALLTRIM(THISFORM.TEXT2.VALUE)
MNOREK = THISFORM.NOREK
MCIF = THISFORM.CIF
MVLD = IIF(THISFORM.OPTIONGROUP1.OPTION1.VALUE=1, '1', '2')
MTGLVALID = IIF(MVLD='1', CTOD("  -  -    "), THISFORM.TEXT3.VALUE)
MVLD2 = IIF(THISFORM.OPTIONGROUP2.OPTION1.VALUE=1, '1', IIF(THISFORM.OPTIONGROUP2.OPTION2.VALUE=1, '2', '3'))
MJUMLAH = THISFORM.TEXT6.VALUE
MIDCTT = JAM2ANGKA(DATETIME())
MIDCATATAN = IDCATATAN
MTGLSLS = TGLSELESAI
MTGLSELESAI = THISFORM.TEXT4.VALUE
MCTTSELESAI = THISFORM.TEXT5.VALUE
DO CASE
CASE THISFORM.MYEDIT="INPUT"
CSQL = "insert into catatan (kantor,dept,norek,tanggal,catatan,jumlah,vld, tglvalid, vld2, inpopr) "+"values (?DefaKantor,?mdept,?mnorek,?sqldate(mtanggal),?mcatatan,?STR(mjumlah),?mvld,?sqldate(mtglvalid),?mvld2,'OPT')"
CASE THISFORM.MYEDIT="EDIT"
CSQL = "update catatan set tanggal=?sqldate(mtanggal),catatan=?mcatatan,jumlah=?STR(mjumlah),vld=?mvld,tglvalid=?sqldate(mtglvalid),"+"vld2=?mvld2,EDTopr=?defaopr where  norek=?mnorek and idcatatan=?midcatatan"
CASE THISFORM.MYEDIT="HAPUS"
CSQL = "DELETE from catatan where norek=?mnorek and idcatatan=?midcatatan"
CASE THISFORM.MYEDIT="SELESAI"
CSQL = "update catatan set tglselesai='"+SQLDATE(THISFORM.TEXT4.VALUE)+"', cttselesai='"+THISFORM.TEXT5.VALUE+"' "+"where idcatatan='"+MIDCATATAN+"'"
ENDCASE
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data")
ELSE
SQLCOMMIT(OODBC)
ENDIF
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.GRID1.REFRESH
ENDPROC
**
*
*  catatan.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  catatan.scx::Cmdedit
**
PROCEDURE Click
THISFORM.CMDEDIT.VISIBLE = .F.
THISFORM.CMDHAPUS.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .T.
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDKELUAR.VISIBLE = .F.
THISFORM.CMDINPUT.VISIBLE = .F.
THISFORM.CMDPRINT.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.MYENABLE()
THISFORM.TEXT1.SETFOCUS
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = CATATAN
THISFORM.TEXT3.VALUE = TGLVALID
IF VLD='1'
THISFORM.OPTIONGROUP1.OPTION1.VALUE = 1
THISFORM.OPTIONGROUP1.OPTION2.VALUE = 0
ELSE
THISFORM.OPTIONGROUP1.OPTION1.VALUE = 0
THISFORM.OPTIONGROUP1.OPTION2.VALUE = 1
ENDIF
DO CASE
CASE VLD2='1'
THISFORM.OPTIONGROUP2.OPTION1.VALUE = 1
THISFORM.OPTIONGROUP2.OPTION2.VALUE = 0
THISFORM.OPTIONGROUP2.OPTION3.VALUE = 0
CASE VLD2='1'
THISFORM.OPTIONGROUP2.OPTION1.VALUE = 0
THISFORM.OPTIONGROUP2.OPTION2.VALUE = 1
THISFORM.OPTIONGROUP2.OPTION3.VALUE = 0
CASE VLD2='1'
THISFORM.OPTIONGROUP2.OPTION1.VALUE = 0
THISFORM.OPTIONGROUP2.OPTION2.VALUE = 0
THISFORM.OPTIONGROUP2.OPTION3.VALUE = 3
ENDCASE
THISFORM.TEXT6.VALUE = JUMLAH
THISFORM.MYEDIT = "EDIT"
ENDPROC
**
*
*  catatan.scx::Cmdbatal
**
PROCEDURE Click
THISFORM.CMDEDIT.VISIBLE = .T.
THISFORM.CMDHAPUS.VISIBLE = .T.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDKELUAR.VISIBLE = .T.
THISFORM.CMDINPUT.VISIBLE = .T.
THISFORM.CMDPRINT.VISIBLE = .T.
THISFORM.CMDSELESAI.VISIBLE = .T.
THISFORM.TAMPIL()
ENDPROC
**
*
*  catatan.scx::Cmdinput
**
PROCEDURE Click
THISFORM.CMDEDIT.VISIBLE = .F.
THISFORM.CMDHAPUS.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .T.
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDKELUAR.VISIBLE = .F.
THISFORM.CMDINPUT.VISIBLE = .F.
THISFORM.CMDPRINT.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.MYENABLE()
THISFORM.TEXT1.SETFOCUS
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT2.VALUE = SPACE(40)
THISFORM.TEXT3.VALUE = TGLNOW
THISFORM.OPTIONGROUP1.OPTION1.VALUE = 1
THISFORM.OPTIONGROUP2.OPTION1.VALUE = 1
THISFORM.TEXT6.VALUE = 0
THISFORM.MYEDIT = "INPUT"
ENDPROC
**
*
*  catatan.scx::cmdselesai
**
PROCEDURE Click
MTGLSLS = TGLSELESAI
MYT = "T"
IF  .NOT. EMPTY(MTGLSLS) .AND. MTGLSLS<>CTOD('0000-00-00') .AND. VARTYPE(MTGLSLS)<>"X"
YT = MESSAGEBOX("Penyelesaian Catatan Dibatalkan", 20, "")
IF MYT=6
RETURN
ENDIF
ENDIF
THISFORM.MYEDIT = "SELESAI"
THISFORM.CMDEDIT.VISIBLE = .F.
THISFORM.CMDHAPUS.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .T.
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDKELUAR.VISIBLE = .F.
THISFORM.CMDINPUT.VISIBLE = .F.
THISFORM.CMDPRINT.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.TEXT4.ENABLED = .T.
THISFORM.TEXT5.ENABLED = .T.
THISFORM.TEXT4.VALUE = TGLNOW
THISFORM.TEXT4.SETFOCUS
ENDPROC
**
***
*** catatan.sct
***
*
***
*** kas_anggota.scx
***
*
*
*  kas_anggota.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE9.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE8.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE7.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT16.VALUE = "KAS MASUK"
THISFORM.LABEL14.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE8.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE7.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT16.VALUE = "KAS KELUAR"
THISFORM.LABEL14.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
FUNCTION Unload
IF THISFORM.MODE="INPUT"
CEKURUTNOTA("KAS", THISFORM.TANGGAL, THISFORM.BUKTI)
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MKAS
THISFORM.MODE = IIF(VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L", "INPUT", MMODE)
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.TANGGAL = TGLNOW
THISFORM.BUKTI = ' '
THISFORM.KAS = IIF(VARTYPE(MKAS)="X" .OR. VARTYPE(MKAS)="L", "KAS", MKAS)
IF THISFORM.KAS="NONKAS"
THISFORM.LABEL2.CAPTION = "TRANSAKSI KEANGGOTAAN VIA BANK"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 128, 0)
THISFORM.LABEL15.VISIBLE = .T.
THISFORM.TEXT17.VISIBLE = .T.
THISFORM.TEXT18.VISIBLE = .T.
ENDIF
THISFORM.OLDSELECT = SELECT()
SELECT (THISFORM.OLDSELECT)
MTGL = TANGGAL
MBKT = BUKTI
MKDKAS = IIF(DEBET-KREDIT>0, "M", "K")
THISFORM.TEXT1.SETFOCUS
THISFORM.TEXT1.INPUTMASK = DEFAFMTANGG
IF THISFORM.MODE="INPUT"
THISFORM.TEXT7.VALUE = DEFATGLKAS
ENDIF
IF THISFORM.MODE="TAMPIL" .OR. THISFORM.MODE="HAPUS"
THISFORM.TEXT12.VALUE = JUMLAH1
THISFORM.TEXT13.VALUE = JUMLAH2
THISFORM.TEXT7.VALUE = TANGGAL
THISFORM.TEXT8.VALUE = BUKTI
THISFORM.TEXT15.VALUE = MKDKAS
THISFORM.TEXT9.VALUE = JUMLAH3
THISFORM.TEXT10.VALUE = JUMLAH4
THISFORM.TEXT19.VALUE = JUMLAH5
THISFORM.TEXT11.VALUE = JUMLAH3+JUMLAH4+JUMLAH5
MCIF = NOREK
THISFORM.UBAHWARNA(MKDKAS)
CSQL = "select cif,nama,alamat,desa,kecamatan,kota from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = DESA
THISFORM.TEXT5.VALUE = KECAMATAN
THISFORM.TEXT6.VALUE = KOTA
USE
SELECT (THISFORM.OLDSELECT)
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT15.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
IF THISFORM.MODE="HAPUS"
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .T.
ENDIF
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  kas_anggota.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_anggota.scx::Command3
**
PROCEDURE Click
MCIF = THISFORM.TEXT1.VALUE
MKD = '01'
MKDKAS = THISFORM.TEXT15.VALUE
IF THISFORM.TEXT15.VALUE='K' .AND. THISFORM.TEXT11.VALUE>DEFABATASKAS
DO WHILE .T.
MKETACC = "PENGAMBILAN SIMP.POKOK / WAJIB"+CHR(13)+"---------------------------------------------------"+CHR(13)+"NOMOR ANGGOTA	: "+THISFORM.TEXT1.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT2.VALUE+CHR(13)+"		AMBIL POKOK	: "+TRANSFORM(THISFORM.TEXT9.VALUE, "999,999,999,999")+CHR(13)+"		AMBIL WAJIB	: "+TRANSFORM(THISFORM.TEXT10.VALUE, "999,999,999,999")+CHR(13)+"		PENYERTAAN	: "+TRANSFORM(THISFORM.TEXT19.VALUE, "999,999,999,999")+CHR(13)+"---------------------------------------------------"+CHR(13)+"JML PENGAMBILAN	: "+TRANSFORM(THISFORM.TEXT11.VALUE, "999,999,999,999")
DO FORM acc_client TO HASIL WITH THISFORM.TEXT7.VALUE, ALLTRIM(THISFORM.TEXT8.VALUE), MKETACC, THISFORM.TEXT11.VALUE
IF HASIL=1 .OR. HASIL=2
EXIT
ENDIF
ENDDO
IF HASIL=2
RETURN
ENDIF
ENDIF
CSQL = "select sldpokok,sldwajib,saldosmk from anggota_mutasi where cif='"+MCIF+"' and iddata=(select MAX(iddata) from anggota_mutasi where cif='"+MCIF+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
MSLDPOKOK = IIF(ISNULL(SLDPOKOK), 0, SLDPOKOK)
MSLDWAJIB = IIF(ISNULL(SLDWAJIB), 0, SLDWAJIB)
CSQL = "insert into anggota_mutasi (kantor,cif, tanggal, bukti, kd, mtspokok, sldpokok, mtswajib, sldwajib) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+STR(IIF(THISFORM.TEXT15.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE))+"',"+"'"+STR(MSLDPOKOK+IIF(THISFORM.TEXT15.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE))+"',"+"'"+STR(IIF(THISFORM.TEXT15.VALUE="M", THISFORM.TEXT10.VALUE, 0-THISFORM.TEXT10.VALUE))+"',"+"'"+STR(MSLDWAJIB+IIF(THISFORM.TEXT15.VALUE="M", THISFORM.TEXT10.VALUE, 0-THISFORM.TEXT10.VALUE))+"')"
LCEK = SQLEXEC(OODBC, CSQL)
MKET = IIF(THISFORM.TEXT15.VALUE="M", "STR.", "AMB.")
MKET = MKET+IIF(THISFORM.TEXT9.VALUE>0, "SIMP. POKOK ", "")
MKET = MKET+IIF(THISFORM.TEXT10.VALUE>0, " SMK", "")
MKET = MKET+" "+THISFORM.TEXT1.VALUE
IF THISFORM.KAS="KAS"
CSQL = "insert into kasir (kantor,csr,tanggal,bukti,kode,keterangan,debet,kredit,opt,"+"norek,jumlah1,jumlah2,jumlah3,jumlah4,jumlah5) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"?mket,"+"'"+IIF(THISFORM.TEXT15.VALUE="M", STR(THISFORM.TEXT9.VALUE+THISFORM.TEXT10.VALUE), '0')+"',"+"'"+IIF(THISFORM.TEXT15.VALUE="K", STR(THISFORM.TEXT9.VALUE+THISFORM.TEXT10.VALUE), '0')+"',"+"'"+"OPR"+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+STR(THISFORM.TEXT12.VALUE)+"',"+"'"+STR(THISFORM.TEXT13.VALUE)+"',"+"'"+STR(THISFORM.TEXT9.VALUE)+"',"+"'"+STR(THISFORM.TEXT10.VALUE)+"',"+"'"+STR(THISFORM.TEXT19.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into nonkas (kantor,csr,tanggal,bukti,kode,kodebank,keterangan,debet,kredit,opt) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+STR(THISFORM.TEXT17.VALUE)+"',"+"?mket"+"'"+IIF(THISFORM.TEXT15.VALUE="M", STR(THISFORM.TEXT9.VALUE+THISFORM.TEXT10.VALUE), '0')+"',"+"'"+IIF(THISFORM.TEXT15.VALUE="K", STR(THISFORM.TEXT9.VALUE+THISFORM.TEXT10.VALUE), '0')+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT15.VALUE="M", THISFORM.TEXT11.VALUE, 0-THISFORM.TEXT11.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
JURNALANTARKANTOR(THISFORM.TEXT7.VALUE, THISFORM.TEXT8.VALUE, MKET, DEFAKANTOR, DEFAKANTORASAL, MJUMLAH)
ENDIF
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "
IF THISFORM.TEXT11.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERKAS+"',"+"?mket,"+"'"+STR(MJUMLAH)+"'),"
ENDIF
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+" ('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+DEFANOPERSIMPK+"',"+"?mket,"+"'"+STR(0-IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE))+"'),"
ENDIF
IF THISFORM.TEXT10.VALUE<>0
CSQL = CSQL+" ('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+DEFANOPERSIMWJB+"',"+"?mket,"+"'"+STR(0-IIF(MKDKAS="M", THISFORM.TEXT10.VALUE, 0-THISFORM.TEXT10.VALUE))+"'),"
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
IF THISFORM.TEXT15.VALUE="K"
CSQL = "update anggota set tglkeluar='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' where cif='"+TRIM(THISFORM.TEXT1.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, DEFANOPERSIMPK, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, DEFANOPERSIMWJB, THISFORM.TEXT7.VALUE)
IF DEFAVALIDASI='1'
MNAMACETAK = IIF(THISFORM.TEXT15.VALUE="M", "VLD_LAIN_MASUK", "VLD_LAIN_KELUAR")
MKET = IIF(THISFORM.TEXT9.VALUE>0, "SIMP.POKOK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+"", "")
MKET = MKET+IIF(THISFORM.TEXT10.VALUE>0, "/SIMP.WAJIB:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT10.VALUE, '999,999,999,999'))+"/", "")
MKET = MKET+IIF(THISFORM.TEXT19.VALUE>0, "/PENYERTAAN:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT19.VALUE, '999,999,999,999'))+" ", "")
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/ANGG/"+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT11.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT8.VALUE)+'/'+DTOC(THISFORM.TEXT7.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = ALLTRIM(THISFORM.TEXT1.VALUE)+'/'+THISFORM.TEXT2.VALUE
MBARIS3 = MKET
MBARIS4 = ''
CETAKVALIDASI(MNAMACETAK, MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_anggota.scx::Command13
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_anggota.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
OLDSELECT = SELECT()
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
SELECT (OLDSELECT)
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
DEFAKANTORASAL = KANTOR
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = DESA
THISFORM.TEXT5.VALUE = KECAMATAN
THISFORM.TEXT6.VALUE = KOTA
USE
IF  .NOT. (THISFORM.MODE="HAPUS" .OR. THISFORM.MODE="TAMPIL")
CSQL = "select SUM(mtspokok) as pokok, SUM(mtswajib) as wajib, SUM(mtspenyertaan) as penyertaan from anggota_mutasi where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MPOKOK = IIF(ISNULL(POKOK), 0, POKOK)
MWAJIB = IIF(ISNULL(WAJIB), 0, WAJIB)
MPENYERTAAN = IIF(ISNULL(PENYERTAAN), 0, PENYERTAAN)
THISFORM.TEXT12.VALUE = MPOKOK
THISFORM.TEXT13.VALUE = MWAJIB
THISFORM.TEXT14.VALUE = MPENYERTAAN
SELECT (OLDSELECT)
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDIF
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_anggota.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MBUKTI = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT1 = BUKTI
USE
CSQL = "select bukti from jurnal where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBKT2 = BUKTI
USE
SELECT (OLDSELECT)
IF (ISNULL(MBKT1) .OR. EMPTY(MBKT1)) .AND. (ISNULL(MBKT2) .OR. EMPTY(MBKT2))
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
RETURN
ENDIF
MESSAGEBOX("Bukti Sudah Pernah Masuk", 0, "Validasi Bukti")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_anggota.scx::Text9
**
PROCEDURE LostFocus
IF THISFORM.TEXT15.VALUE='K' .AND. THIS.VALUE>THISFORM.TEXT12.VALUE
MESSAGEBOX("Pengambilan Pokok Melebihi saldo yang ada", 16, "")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT11.VALUE = THISFORM.TEXT10.VALUE+THISFORM.TEXT9.VALUE
ENDPROC
**
*
*  kas_anggota.scx::Text10
**
PROCEDURE InteractiveChange
THISFORM.TEXT11.VALUE = THISFORM.TEXT10.VALUE+THISFORM.TEXT9.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF THISFORM.TEXT15.VALUE='K' .AND. THIS.VALUE>THISFORM.TEXT13.VALUE
MESSAGEBOX("Pengambilan Simpanan Wajib Melebihi saldo yang ada", 16, "")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  kas_anggota.scx::Text15
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="M" .OR. THIS.VALUE="K")
MESSAGEBOX("Gunakan Huruf "+CHR(13)+"M : Untuk Kas Masuk"+CHR(13)+"K  : Untuk Kas Keluar", 64, "TIDAK VALID")
THIS.SETFOCUS
NODEFAULT
ENDIF
IF THIS.VALUE="K"
THISFORM.LABEL16.VISIBLE = .T.
THISFORM.TEXT19.VISIBLE = .T.
THISFORM.TEXT9.VALUE = THISFORM.TEXT12.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT13.VALUE
THISFORM.TEXT19.VALUE = THISFORM.TEXT14.VALUE
THISFORM.TEXT11.VALUE = THISFORM.TEXT12.VALUE+THISFORM.TEXT13.VALUE+THISFORM.TEXT14.VALUE
THISFORM.TEXT9.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.TEXT19.ENABLED = .F.
ENDIF
THISFORM.UBAHWARNA(THIS.VALUE)
ENDPROC
**
*
*  kas_anggota.scx::Text16
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_anggota.scx::Text17
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT18.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_anggota.scx::Text18
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_anggota.scx::Command1
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_anggota.scx::Command4
**
PROCEDURE Click
MKD = '01'
MKDKAS = THISFORM.TEXT15.VALUE
CSQL = "DELETE FROM anggota_mutasi where kantor='"+DEFAKANTOR+"' and cif='"+THISFORM.TEXT1.VALUE+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kd='"+MKD+"' and mtspokok='"+STR(IIF(THISFORM.TEXT15.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE))+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Mutasi anggota gagal dihapus")
ENDIF
MKET = IIF(THISFORM.TEXT15.VALUE="M", "STR.", "AMB.")
MKET = MKET+IIF(THISFORM.TEXT9.VALUE>0, "SIMP. POKOK ", "")
MKET = MKET+IIF(THISFORM.TEXT10.VALUE>0, " SMK", "")
MKET = MKET+" "+THISFORM.TEXT1.VALUE
IF THISFORM.KAS="KAS"
CSQL = "DELETE FROM kasir where kantor='"+DEFAKANTOR+"' and csr='01' and "+"tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and "+"bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"' and "+"keterangan=?mket"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Mutasi Kas gagal dihapus")
ENDIF
ELSE
CSQL = "DELETE FROM nonkas where kantor='"+DEFAKANTOR+"' and csr='01' and "+"tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and "+"bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"' and "+"keterangan=?mket"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Mutasi Non Kas gagal dihapus")
ENDIF
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
CSQL = "DELETE FROM jurnal where kantor='"+DEFAKANTOR+"' and "+"tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and "+"bukti='"+THISFORM.TEXT8.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus Jurnal")
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, DEFANOPERSIMPK, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, DEFANOPERSIMWJB, THISFORM.TEXT7.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
MNOPER = ALLTRIM(DEFANOPERAKA)+DEFAKANTORASAL
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKP)+DEFAKANTORASAL
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKA)+DEFAKANTOR
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKP)+DEFAKANTOR
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_anggota.scx::Text19
**
PROCEDURE InteractiveChange
THISFORM.TEXT11.VALUE = THISFORM.TEXT10.VALUE+THISFORM.TEXT9.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF THISFORM.TEXT15.VALUE='K' .AND. THIS.VALUE>THISFORM.TEXT14.VALUE
MESSAGEBOX("Pengambilan MODAL PENYERTAAN Melebihi saldo yang ada", 16, "")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** kas_anggota.sct
***
*
***
*** kas_simpanan1.scx
***
*
*
*  kas_simpanan1.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE9.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE13.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE8.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT11.VALUE = "KAS MASUK"
THISFORM.LABEL16.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL7.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE13.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE8.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT11.VALUE = "KAS KELUAR"
THISFORM.LABEL16.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL7.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
PROCEDURE tampil
DO CASE
CASE THISFORM.JENIS='1'
THISFORM.LABEL17.CAPTION = "TABUNGAN"
THISFORM.LABEL14.CAPTION = "SALDO MINIMAL"
THISFORM.LABEL15.CAPTION = "MAXIMAL PENGAMBILAN"
CASE THISFORM.JENIS='2'
THISFORM.LABEL17.CAPTION = "DEPOSITO"
THISFORM.LABEL14.CAPTION = "MAX. AMBIL POKOK"
THISFORM.LABEL15.CAPTION = "SALDO JASA"
CASE THISFORM.JENIS='3'
THISFORM.LABEL17.CAPTION = "SERTIFIKAT SIMPANAN"
THISFORM.LABEL14.CAPTION = "MAX. AMBIL POKOK"
THISFORM.LABEL15.CAPTION = "SALDO JASA"
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MKAS
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.MODE = IIF(VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L", "INPUT", MMODE)
THISFORM.KAS = IIF(VARTYPE(MKAS)="X" .OR. VARTYPE(MKAS)="L", "KAS", MKAS)
IF THISFORM.KAS="NONKAS"
THISFORM.LABEL2.CAPTION = "TRANSAKSI SIMPANAN VIA BANK"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 128, 0)
THISFORM.LABEL22.VISIBLE = .T.
THISFORM.TEXT20.VISIBLE = .T.
THISFORM.TEXT34.VISIBLE = .T.
ENDIF
DEFAKANTORASAL = DEFAKANTOR
THISFORM.OLDSELECT = SELECT()
SELECT (THISFORM.OLDSELECT)
MTGL = TANGGAL
MBKT = BUKTI
MKDKAS = IIF(DEBET-KREDIT>0, "M", "K")
MSETOR = JUMLAH6
IF THISFORM.MODE="INPUT"
THISFORM.TEXT4.SETFOCUS
THISFORM.TEXT7.VALUE = DEFATGLKAS
ENDIF
IF THISFORM.MODE="TAMPIL" .OR. THISFORM.MODE="HAPUS"
THISFORM.TEXT4.VALUE = NOREK
THISFORM.TEXT5.VALUE = TANGGAL1
THISFORM.TEXT6.VALUE = JUMLAH1
THISFORM.TEXT12.VALUE = JUMLAH2
THISFORM.TEXT13.VALUE = JUMLAH3
THISFORM.TEXT14.VALUE = JUMLAH4
THISFORM.TEXT15.VALUE = JUMLAH5
THISFORM.TEXT9.VALUE = JUMLAH6
THISFORM.TEXT17.VALUE = JUMLAH7
THISFORM.TEXT21.VALUE = JUMLAH6+JUMLAH7
THISFORM.UBAHWARNA(MKDKAS)
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.TEXT18.ENABLED = .F.
MNOREK = NOREK
THISFORM.TEXT7.VALUE = TANGGAL
THISFORM.TEXT8.VALUE = BUKTI
THISFORM.TEXT10.VALUE = MKDKAS
THISFORM.TEXT18.VALUE = KETERANGAN
CSQL = "select a.*,b.* from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca data simpanan", 0, "")
ENDIF
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT16.VALUE = KOTA
THISFORM.TEXT19.VALUE = PHONE
THISFORM.PRODUK = PRODUK
THISFORM.JENIS = JENIS
THISFORM.TAMPIL()
IF MKDKAS='K' .AND. THISFORM.JENIS<>'1'
THISFORM.LABEL21.VISIBLE = .T.
THISFORM.LABEL7.CAPTION = "PENGAMBILAN POKOK"
THISFORM.LABEL21.CAPTION = "PENGAMBILAN JASA"
ENDIF
USE
SELECT (THISFORM.OLDSELECT)
IF THISFORM.MODE="HAPUS"
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
ENDIF
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  kas_simpanan1.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan1.scx::Command3
**
PROCEDURE Click
MKD = '02'
MKDKAS = THISFORM.TEXT10.VALUE
OLDSELECT = SELECT()
IF THISFORM.KAS="KAS"
IF THISFORM.TEXT10.VALUE="M"
MNOMORTR = "01"
ELSE
MNOMORTR = "02"
ENDIF
ELSE
IF THISFORM.TEXT10.VALUE="M"
MNOMORTR = "03"
ELSE
MNOMORTR = "04"
ENDIF
ENDIF
IF THISFORM.TEXT10.VALUE='K' .AND. THISFORM.TEXT9.VALUE>DEFABATASKAS
DO WHILE .T.
MKETACC = "PENGAMBILAN SIMPANAN"+CHR(13)+"---------------------------------------------------"+CHR(13)+"NOMOR REKENING	: "+THISFORM.TEXT4.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT2.VALUE+CHR(13)+"		JML AMBIL	: "+TRANSFORM(THISFORM.TEXT9.VALUE, "999,999,999,999")+CHR(13)+"---------------------------------------------------"+CHR(13)+"JML PENGAMBILAN	: "+TRANSFORM(THISFORM.TEXT9.VALUE, "999,999,999,999")
DO FORM acc_client TO HASIL WITH THISFORM.TEXT7.VALUE, ALLTRIM(THISFORM.TEXT8.VALUE), MKETACC, THISFORM.TEXT9.VALUE
IF HASIL=1 .OR. HASIL=2
EXIT
ENDIF
ENDDO
IF HASIL=2
RETURN
ENDIF
ENDIF
CSQL = "select jurnaltab from setsandi_tab where jenis='"+THISFORM.JENIS+"' and sandi='"+THISFORM.PRODUK+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNALTAB = JURNALTAB
USE
IF THISFORM.TEXT10.VALUE="M"
IF THISFORM.JENIS='1'
MKDMTS = DEFATABSTOR
ELSE
MKDMTS = DEFADEPSTOR
ENDIF
ELSE
IF THISFORM.JENIS='1'
MKDMTS = DEFATABAMB
ELSE
MKDMTS = DEFADEPAMBPK
MKDMTS2 = DEFADEPAMBBG
ENDIF
ENDIF
MSALDO = 0
MSALDOJASA = 0
IF THISFORM.JENIS='1'
CSQL = "select saldo from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
ELSE
CSQL = "select saldo from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') "+"and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
CSQL = "select saldo from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and (kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') "+"and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDOJASA = SALDO
ENDIF
USE
SELECT (OLDSELECT)
IF THISFORM.TEXT9.VALUE>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT4.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKDMTS+"',"+"'"+THISFORM.TEXT18.VALUE+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+TRANSFORM(MSALDO+IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE), '999999999999999')+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
ENDIF
IF THISFORM.TEXT17.VALUE>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT4.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKDMTS2+"',"+"'"+THISFORM.TEXT18.VALUE+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT17.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT17.VALUE, 0))+"',"+"'"+TRANSFORM(MSALDOJASA+IIF(MKDKAS="M", THISFORM.TEXT17.VALUE, 0-THISFORM.TEXT17.VALUE), '999999999999999')+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
ENDIF
IF ALLTRIM(DEFANOTIFIKASI)='1'
CSQL = "select cif,sms_stor,sms_ambil from simpanan where norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSMS_STOR = SMS_STOR
MSMS_AMBIL = SMS_AMBIL
MCIF = CIF
DEFADBFSMS = ALLTRIM(DEFADBFSMS)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFJML'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBATASNOTIF = VAL(KETERANGAN)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFKATA1'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKATASETOR = ALLTRIM(KETERANGAN)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFKATA2'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKATAAMBIL = ALLTRIM(KETERANGAN)
MPHONE = THISFORM.TEXT19.VALUE
MSLD = 0
MCTK = 'T'
IF MKDKAS="M" .AND. MSMS_STOR=1 .AND. MBATASNOTIF<=THISFORM.TEXT9.VALUE
MKATA = MKATASETOR
MSLD = THISFORM.TEXT12.VALUE+THISFORM.TEXT9.VALUE
MCTK = 'Y'
ENDIF
IF MKDKAS="K" .AND. MSMS_AMBIL=1 .AND. MBATASNOTIF<=THISFORM.TEXT9.VALUE
MKATA = MKATAAMBIL
MSLD = THISFORM.TEXT12.VALUE-THISFORM.TEXT9.VALUE
MCTK = 'Y'
ENDIF
IF MCTK='Y'
MNOREK0 = ALLTRIM(THISFORM.TEXT4.VALUE)
MKATA = STRTRAN(MKATA, "<<nama>>", ALLTRIM(THISFORM.TEXT2.VALUE))
MKATA = STRTRAN(MKATA, "<<norek>>", MNOREK0)
MKATA = STRTRAN(MKATA, "<<noangg>>", THISFORM.TEXT1.VALUE)
MKATA = STRTRAN(MKATA, "<<saldo>>", ALLTRIM(TRANSFORM(MSLD, "99,999,999,999")))
MKATA = STRTRAN(MKATA, "<<stor>>", ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, "99,999,999,999")))
MKATA = STRTRAN(MKATA, "<<ambil>>", STR(THISFORM.TEXT9.VALUE))
MKATA = STRTRAN(MKATA, "<<tanggal>>", DTOC(THISFORM.TEXT7.VALUE))
MKATA = STRTRAN(MKATA, "<<jam>>", TIME())
MKATA = STRTRAN(MKATA, "<<bukti>>", THISFORM.TEXT8.VALUE)
IF THISFORM.KAS="KAS"
MKATA = STRTRAN(MKATA, "<<tunai>>", "TUNAI")
ELSE
MKATA = STRTRAN(MKATA, "<<tunai>>", "VIA BANK")
ENDIF
CSQL = "insert into "+DEFADBFSMS+".outbox (Text,DestinationNumber) value (?mkata,?mphone)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDIF
CSQL = "SELECT sum(if(kode='07',kredit,0)) as bunga, "+"sum(if(kode='08',debet,0)) as adm, "+"sum(if(kode='13',debet,0)) as pajak "+"FROM simpanan_mutasi WHERE norek='"+THISFORM.TEXT4.VALUE+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MBUNGA = BUNGA
MADM = ADM
MPJK = PAJAK
USE
CSQL = "select SUM(jadwal)-SUM(bayar) as autodebet from simpanan_autodebet_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' order by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MAUTODEBET = IIF(ISNULL(AUTODEBET), 0, AUTODEBET)
CSQL = "select SUM(saldoblokir) as blokir from simpanan_blokir where norek='"+THISFORM.TEXT4.VALUE+"' and tglcabut='0000-00-00' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBLOKIR = IIF(ISNULL(BLOKIR), 0, BLOKIR)
CSQL = "select a.norek,b.* from simpanan as a left join setsandi_tab as b on a.kantor=b.kantor and a.jenis=b.jenis and a.produk=b.sandi where a.norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca ")
ENDIF
MADM = IIF(ISNULL(A_ADM), 0, A_ADM)
MRATE = IIF(ISNULL(A_RATE), 0, A_RATE)
MSLDMIN = IIF(ISNULL(SALDOMINIMAL), 0, SALDOMINIMAL)
MBATASBUNGA = IIF(ISNULL(BATASBUNGA), 0, BATASBUNGA)
MJURUTANG = IIF(ISNULL(JURNALUTANGBG), '', JURNALUTANGBG)
MJURBUNGA = IIF(ISNULL(JURNALBUNGA), '', JURNALBUNGA)
MJURTAB = IIF(ISNULL(JURNALTAB), '', JURNALTAB)
MJURPAJAK = IIF(ISNULL(JURNALPAJAK), '', JURNALPAJAK)
CSQL = "select norek from simpanan_saldo where kantor='"+DEFAKANTOR+"' and norek='"+THISFORM.TEXT4.VALUE+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF NOREK<>THISFORM.TEXT4.VALUE
CSQL = "insert into simpanan_saldo (kantor,tanggal,norek,SALDO,"+"bunga,pajak,adm,autodebet,blokir,tglmutasi,aktif,hit_adm,hit_rate,"+"hit_minbunga,hit_minsaldo,jur_utangbg,jur_biayabg,jur_tab,jur_pjk,opt) value ('"+DEFAKANTOR+"','"+SQLDATE(THISFORM.TEXT7.VALUE)+"','"+THISFORM.TEXT4.VALUE+"','"+TRANSFORM(MSALDO+IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE), '999999999999999')+"','"+STR(MBUNGA)+"','"+STR(MPJK)+"','"+STR(MADM)+"','"+STR(MAUTODEBET)+"','"+STR(MBLOKIR)+"','"+SQLDATE(THISFORM.TEXT7.VALUE)+"','"+"A"+"','"+STR(MADM)+"','"+STR(MRATE)+"','"+STR(MBATASBUNGA)+"','"+STR(MSLDMIN)+"','"+MJURUTANG+"','"+MJURBUNGA+"','"+MJURTAB+"','"+MJURPAJAK+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert saldo simpanan 1")
RETURN
ENDIF
ELSE
CSQL = "update simpanan_saldo set "+"SALDO='"+TRANSFORM(MSALDO+IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE), '999999999999999')+"', "+"bunga='"+STR(MBUNGA)+"', "+"pajak='"+STR(MPJK)+"', "+"adm='"+STR(MADM)+"', "+"autodebet='"+STR(MAUTODEBET)+"', "+"blokir='"+STR(MBLOKIR)+"', "+"tglmutasi='"+SQLDATE(THISFORM.TEXT7.VALUE)+"', "+"aktif='"+"A"+"', "+"hit_adm='"+STR(MADM)+"', "+"hit_rate='"+STR(MRATE)+"', "+"hit_minbunga='"+STR(MBATASBUNGA)+"', "+"hit_minsaldo='"+STR(MSLDMIN)+"', "+"jur_utangbg='"+MJURUTANG+"', "+"jur_biayabg='"+MJURBUNGA+"', "+"jur_tab='"+MJURTAB+"', "+"jur_pjk='"+MJURPAJAK+"' "+"where kantor='"+DEFAKANTOR+"' and norek='"+THISFORM.TEXT4.VALUE+"' and "+"tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update saldo simpanan")
THISFORM.EDIT1.VALUE = CSQL
RETURN
ENDIF
ENDIF
MNOREK = THISFORM.TEXT4.VALUE
IF THISFORM.KAS="KAS"
CSQL = "insert into kasir (kantor,csr,tanggal,bukti,kode,keterangan,debet,kredit,opt,norek,"+"tanggal1,jumlah1,jumlah2,jumlah3,jumlah4,jumlah5,jumlah6,jumlah7) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+THISFORM.TEXT18.VALUE+"',"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+DEFAUSERID+"',"+"'"+MNOREK+"',"+"'"+SQLDATE(THISFORM.TEXT5.VALUE)+"',"+"'"+STR(THISFORM.TEXT6.VALUE)+"',"+"'"+STR(THISFORM.TEXT12.VALUE)+"',"+"'"+STR(THISFORM.TEXT13.VALUE)+"',"+"'"+STR(THISFORM.TEXT14.VALUE)+"',"+"'"+STR(THISFORM.TEXT15.VALUE)+"',"+"'"+STR(THISFORM.TEXT9.VALUE)+"',"+"'"+STR(THISFORM.TEXT17.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "insert into nonkas (kantor,csr,tanggal,bukti,kode,kodebank,keterangan,debet,kredit,opt,norek) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+STR(THISFORM.TEXT20.VALUE)+"',"+"'"+THISFORM.TEXT18.VALUE+"',"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+DEFAUSERID+"',"+"'"+MNOREK+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT10.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
JURNALANTARKANTOR(THISFORM.TEXT7.VALUE, THISFORM.TEXT8.VALUE, THISFORM.TEXT18.VALUE, DEFAKANTOR, DEFAKANTORASAL, MJUMLAH)
ENDIF
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERKAS+"',"+"'"+THISFORM.TEXT18.VALUE+"',"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE))+"'),"
ENDIF
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MJURNALTAB+"',"+"'"+THISFORM.TEXT18.VALUE+"',"+"'"+STR(IIF(MKDKAS="M", 0-THISFORM.TEXT9.VALUE, THISFORM.TEXT9.VALUE))+"'),"
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan Jurnal")
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MJURNALTAB, THISFORM.TEXT7.VALUE)
IF DEFAVALIDASI='1'
MKET = ''
IF THISFORM.TEXT10.VALUE='K'
IF THISFORM.JENIS='1'
MKET = IIF(THISFORM.TEXT9.VALUE>0, "/AMBIL TAB:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+" ", "")
ELSE
MKET = IIF(THISFORM.TEXT9.VALUE>0, "/AMBIL PK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+" ", "")
MKET = MKET+IIF(THISFORM.TEXT17.VALUE>0, "/AMBIL JASA:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT17.VALUE, '999,999,999,999'))+" ", "")
ENDIF
ELSE
IF THISFORM.JENIS='1'
MKET = IIF(THISFORM.TEXT9.VALUE>0, "/STOR TAB:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+" ", "")
ELSE
MKET = IIF(THISFORM.TEXT9.VALUE>0, "/STOR PK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+" ", "")
ENDIF
ENDIF
MKET = SUBSTR(MKET, 2)
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/SIMP/"+IIF(THISFORM.TEXT10.VALUE='K', "KREDIT:", "DEBET:")+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT21.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT8.VALUE)+'/'+DTOC(THISFORM.TEXT7.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = ALLTRIM(THISFORM.TEXT4.VALUE)+'/'+ALLTRIM(THISFORM.TEXT2.VALUE)
MBARIS3 = MKET
MBARIS4 = ''
CETAKVALIDASI(MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan1.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan1.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = DESA
THISFORM.TEXT5.VALUE = KECAMATAN
THISFORM.TEXT6.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. EMPTY(THIS.VALUE)
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
*
*  kas_simpanan1.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MBUKTI = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT = BUKTI
USE
SELECT (OLDSELECT)
IF ISNULL(MBKT) .OR. EMPTY(MBKT)
RETURN
ENDIF
MESSAGEBOX("Bukti Sudah Pernah Masuk", 0, "Validasi Bukti")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan1.scx::Text9
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THISFORM.TEXT9.VALUE+THISFORM.TEXT17.VALUE
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF THISFORM.TEXT10.VALUE="M"
IF THIS.VALUE>=0
RETURN
ELSE
MESSAGEBOX("Tidak ada mutasi dng Nilai Negatif")
ENDIF
ELSE
IF THISFORM.JENIS='1'
IF THIS.VALUE>THISFORM.TEXT15.VALUE
MESSAGEBOX("Pengambilan Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ELSE
IF THIS.VALUE>THISFORM.TEXT14.VALUE
MESSAGEBOX("Pengambilan Pokok Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ENDIF
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan1.scx::Text4
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
MNOREK = THIS.VALUE
CSQL = "select a.*,b.* from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MPRODUK = PRODUK
IF NOREK=MNOREK
DEFAKANTORASAL = KANTOR
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT16.VALUE = DESA
THISFORM.PRODUK = PRODUK
THISFORM.JENIS = JENIS
THISFORM.TAMPIL()
USE
CSQL = "select MAX(tanggal) as tanggal from simpanan_mutasi where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MTANGGAL = IIF(ISNULL(TANGGAL), CTOD('  -  -    '), TANGGAL)
CSQL = "select debet,kredit from simpanan_mutasi where tanggal=?mtanggal and  norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MUTASI = KREDIT-DEBET
THISFORM.TEXT5.VALUE = MTANGGAL
THISFORM.TEXT6.VALUE = IIF(ISNULL(MUTASI), 0, MUTASI)
IF THISFORM.JENIS='1'
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
ELSE
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') "+" and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca saldo")
ENDIF
THISFORM.TEXT12.VALUE = IIF(ISNULL(SALDO), 0, SALDO)
CSQL = "select blokirsemua from simpanan_blokir where norek=?mnorek and tglcabut='0000-00-00' and blokirsemua='Y'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
MBLOKIR = THISFORM.TEXT12.VALUE
ELSE
CSQL = "select SUM(saldoblokir) as blokir from simpanan_blokir where norek=?mnorek and tglcabut='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBLOKIR = IIF(ISNULL(BLOKIR), 0, BLOKIR)
ENDIF
THISFORM.TEXT13.VALUE = IIF(ISNULL(MBLOKIR), 0, MBLOKIR)
IF THISFORM.JENIS='1'
CSQL = "select saldominimal from setsandi_tab where sandi=?mproduk"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT14.VALUE = SALDOMINIMAL
MMAXAMBIL = THISFORM.TEXT12.VALUE-THISFORM.TEXT13.VALUE-THISFORM.TEXT14.VALUE
MMAXAMBIL = MAX(MMAXAMBIL, 0)
THISFORM.TEXT15.VALUE = IIF(ISNULL(MMAXAMBIL), 0, MMAXAMBIL)
ELSE
THISFORM.TEXT14.VALUE = THISFORM.TEXT12.VALUE-MBLOKIR
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') "+"and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = IIF(ISNULL(SALDO), 0, SALDO)
THISFORM.TEXT15.VALUE = MSALDO
USE
ENDIF
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
SELECT (OLDSELECT)
ELSE
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDFUNC
**
*
*  kas_simpanan1.scx::Text10
**
PROCEDURE LostFocus
IF LASTKEY()=27
RETURN
ENDIF
IF  .NOT. (THIS.VALUE="M" .OR. THIS.VALUE="K")
MESSAGEBOX("Gunakan Huruf "+CHR(13)+"M : Untuk Kas Masuk"+CHR(13)+"K  : Untuk Kas Keluar", 64, "TIDAK VALID")
THIS.SETFOCUS
NODEFAULT
ENDIF
THISFORM.UBAHWARNA(THIS.VALUE)
DO CASE
CASE THISFORM.JENIS='1'
MKET = "TAB."
CASE THISFORM.JENIS='2'
MKET = "DEP."
CASE THISFORM.JENIS='3'
MKET = "SMK."
OTHERWISE
MKET = "SIMP."
ENDCASE
IF THIS.VALUE="M"
THISFORM.TEXT18.VALUE = "STR "+MKET+ALLTRIM(THISFORM.TEXT4.VALUE)+" AN."+ALLTRIM(THISFORM.TEXT2.VALUE)
ELSE
IF THISFORM.JENIS='1'
THISFORM.LABEL21.VISIBLE = .F.
THISFORM.TEXT17.VISIBLE = .F.
ELSE
THISFORM.LABEL21.VISIBLE = .T.
THISFORM.TEXT17.VISIBLE = .T.
THISFORM.LABEL7.CAPTION = "PENGAMBILAN POKOK"
THISFORM.LABEL21.CAPTION = "PENGAMBILAN JASA"
ENDIF
THISFORM.TEXT18.VALUE = "AMB "+MKET+ALLTRIM(THISFORM.TEXT4.VALUE)+" AN."+ALLTRIM(THISFORM.TEXT2.VALUE)
ENDIF
ENDPROC
**
*
*  kas_simpanan1.scx::Text11
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_simpanan1.scx::Text20
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT34.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan1.scx::Text34
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_simpanan1.scx::Command1
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan1.scx::Command4
**
PROCEDURE Click
MKD = '02'
OLDSELECT = SELECT()
CSQL = "select jurnaltab from setsandi_tab where jenis='"+THISFORM.JENIS+"' and sandi='"+THISFORM.PRODUK+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNALTAB = JURNALTAB
USE
SELECT (OLDSELECT)
CSQL = "DELETE from simpanan_mutasi where kantor='"+DEFAKANTOR+"' and norek='"+THISFORM.TEXT4.VALUE+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus data mutasi simpanan")
ENDIF
MNOREK = THISFORM.TEXT4.VALUE
IF THISFORM.KAS="KAS"
CSQL = "delete from kasir where kantor='"+DEFAKANTOR+"' and csr='01' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus data kasir kas", 0, "")
ENDIF
ELSE
CSQL = "delete from kasir where kantor='"+DEFAKANTOR+"' and csr='01' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"' and "+"kodebank='"+STR(THISFORM.TEXT20.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus data kasir non kas", 0, "")
ENDIF
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT10.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE)
CSQL = "delete from jurnal where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus Jurnal")
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MJURNALTAB, THISFORM.TEXT7.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
MNOPER = ALLTRIM(DEFANOPERAKA)+DEFAKANTORASAL
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKP)+DEFAKANTORASAL
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKA)+DEFAKANTOR
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKP)+DEFAKANTOR
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan1.scx::Command5
**
PROCEDURE Click
OLDSELECT = SELECT()
CSQL = "select b.iddata,b.cif_lama,b.nama,b.alamat,b.desa,b.kecamatan,b.kota,b.ibu,a.* from simpanan as a, anggota as b "+"where a.tgltutup='0000-00-00' and a.cif=b.cif and a.norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "KAS01")
DO FORM .\form\simpanan_data WITH "TAMPIL"
SELECT KAS01
USE
SELECT (OLDSELECT)
ENDPROC
**
*
*  kas_simpanan1.scx::Text17
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THISFORM.TEXT9.VALUE+THISFORM.TEXT17.VALUE
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF THISFORM.TEXT10.VALUE="M"
IF THIS.VALUE>=0
RETURN
ELSE
MESSAGEBOX("Tidak ada mutasi dng Nilai Negatif")
ENDIF
ELSE
IF THISFORM.JENIS='1'
IF THIS.VALUE>THISFORM.TEXT15.VALUE
MESSAGEBOX("Pengambilan Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ELSE
IF THIS.VALUE>THISFORM.TEXT15.VALUE
MESSAGEBOX("Pengambilan Jasa Simpanan Berjangka/Penyertaan, Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ENDIF
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan1.scx::Text21
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF THISFORM.TEXT10.VALUE="M"
IF THIS.VALUE>=0
RETURN
ELSE
MESSAGEBOX("Tidak ada mutasi dng Nilai Negatif")
ENDIF
ELSE
IF THIS.VALUE>THISFORM.TEXT15.VALUE
MESSAGEBOX("Pengambilan Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
***
*** kas_simpanan1.sct
***
*
***
*** kas_pinjaman.scx
***
*
*
*  kas_pinjaman.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE11.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE13.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT33.VALUE = "KAS MASUK"
THISFORM.LABEL33.CAPTION = "PENERIMAAN KAS"
IF THISFORM.KDHIT<>"H"
THISFORM.LABEL7.VISIBLE = .T.
THISFORM.TEXT9.VISIBLE = .T.
THISFORM.LABEL8.CAPTION = "ANGS. POKOK"
THISFORM.LABEL16.VISIBLE = .T.
THISFORM.LABEL15.VISIBLE = .T.
THISFORM.TEXT11.VISIBLE = .T.
THISFORM.TEXT15.VISIBLE = .T.
ENDIF
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE11.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE13.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE9.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT33.VALUE = "KAS KELUAR"
THISFORM.LABEL33.CAPTION = "PENGELUARAN KAS"
IF THISFORM.KDHIT<>"H"
THISFORM.LABEL8.CAPTION = "JUMLAH PENCAIRAN"
THISFORM.TEXT10.VALUE = THISFORM.TEXT6.VALUE
THISFORM.LABEL7.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.LABEL16.VISIBLE = .F.
THISFORM.LABEL15.VISIBLE = .F.
THISFORM.TEXT11.VISIBLE = .F.
THISFORM.TEXT15.VISIBLE = .F.
ENDIF
ENDIF
ENDPROC
**
PROCEDURE tampilrk
THISFORM.LABEL18.VISIBLE = .F.
THISFORM.LABEL19.VISIBLE = .F.
THISFORM.TEXT16.VISIBLE = .F.
THISFORM.TEXT17.VISIBLE = .F.
THISFORM.LABEL31.VISIBLE = .F.
THISFORM.TEXT31.VISIBLE = .F.
THISFORM.TEXT22.VISIBLE = .F.
THISFORM.TEXT23.VISIBLE = .F.
THISFORM.LABEL14.VISIBLE = .F.
THISFORM.TEXT14.VISIBLE = .F.
THISFORM.LABEL24.VISIBLE = .F.
THISFORM.LABEL25.VISIBLE = .F.
THISFORM.LABEL35.VISIBLE = .F.
THISFORM.LABEL36.VISIBLE = .F.
THISFORM.TEXT29.VISIBLE = .F.
THISFORM.TEXT30.VISIBLE = .F.
THISFORM.LABEL7.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.LABEL16.VISIBLE = .F.
THISFORM.LABEL15.VISIBLE = .F.
THISFORM.TEXT11.VISIBLE = .F.
THISFORM.TEXT15.VISIBLE = .F.
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from pinjaman_mutasi where "+"norek='"+THISFORM.TEXT4.VALUE+"' and tanggal<='"+SQLDATE(TGLNOW)+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDORK = IIF(ISNULL(DEBET), 0, DEBET)-IIF(ISNULL(KREDIT), 0, KREDIT)
THISFORM.TEXT12.VALUE = MSALDORK
THISFORM.LABEL13.CAPTION = "SISA PLAFON"
THISFORM.TEXT13.VALUE = THISFORM.TEXT6.VALUE-THISFORM.TEXT12.VALUE
THISFORM.LABEL23.CAPTION = "MUTASI TERAKHIR"
THISFORM.TEXT21.FORMAT = "D"
CSQL = "select MAX(tanggal) as tanggal from pinjaman_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and tanggal<='"+SQLDATE(TGLNOW)+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT21.VALUE = IIF(ISNULL(TANGGAL), TGLNOW, TANGGAL)
THISFORM.LABEL27.CAPTION = "JUMLAH HARI"
THISFORM.TEXT25.VALUE = TGLNOW-THISFORM.TEXT21.VALUE
THISFORM.LABEL28.CAPTION = "RATE"
THISFORM.TEXT26.INPUTMASK = "999.99"
THISFORM.TEXT26.VALUE = THISFORM.RATE
THISFORM.TEXT28.VALUE = ROUND(THISFORM.TEXT12.VALUE*(THISFORM.RATE/36500)*THISFORM.TEXT25.VALUE, 0)
THISFORM.LABEL29.CAPTION = "SISA PLAFON"
THISFORM.LABEL30.CAPTION = "TAGIHAN JASA"
THISFORM.LABEL26.CAPTION = "MAX TARIKAN"
THISFORM.TEXT27.VALUE = THISFORM.TEXT13.VALUE
THISFORM.TEXT24.VALUE = THISFORM.TEXT27.VALUE-THISFORM.TEXT28.VALUE
THISFORM.LABEL8.CAPTION = "ANGSURAN R/K"
ENDPROC
**
PROCEDURE tampilnonrk
THISFORM.LABEL18.VISIBLE = .T.
THISFORM.LABEL19.VISIBLE = .T.
THISFORM.TEXT16.VISIBLE = .T.
THISFORM.TEXT17.VISIBLE = .T.
THISFORM.LABEL31.VISIBLE = .T.
THISFORM.TEXT31.VISIBLE = .T.
THISFORM.TEXT22.VISIBLE = .T.
THISFORM.TEXT23.VISIBLE = .T.
THISFORM.LABEL14.VISIBLE = .T.
THISFORM.TEXT14.VISIBLE = .T.
THISFORM.LABEL24.VISIBLE = .T.
THISFORM.LABEL25.VISIBLE = .T.
THISFORM.LABEL35.VISIBLE = .T.
THISFORM.LABEL36.VISIBLE = .T.
THISFORM.TEXT29.VISIBLE = .T.
THISFORM.TEXT30.VISIBLE = .T.
THISFORM.LABEL7.VISIBLE = .T.
THISFORM.TEXT9.VISIBLE = .T.
THISFORM.LABEL16.VISIBLE = .T.
THISFORM.LABEL15.VISIBLE = .T.
THISFORM.TEXT11.VISIBLE = .T.
THISFORM.TEXT15.VISIBLE = .T.
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MKAS
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.TEXT4.VALUE = NOREK
THISFORM.MODE = IIF(VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L", "INPUT", MMODE)
THISFORM.KAS = IIF(VARTYPE(MKAS)="X" .OR. VARTYPE(MKAS)="L", "KAS", MKAS)
THISFORM.TANGGAL = TGLNOW
THISFORM.BUKTI = ' '
IF THISFORM.KAS="NONKAS"
THISFORM.LABEL2.CAPTION = "TRANSAKSI PINJAMAN VIA BANK"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 128, 0)
THISFORM.LABEL22.VISIBLE = .T.
THISFORM.TEXT20.VISIBLE = .T.
THISFORM.TEXT34.VISIBLE = .T.
ENDIF
DEFAKANTORASAL = DEFAKANTOR
THISFORM.OLDSELECT = SELECT()
SELECT (THISFORM.OLDSELECT)
MKDKAS = IIF(DEBET-KREDIT>0, "M", "K")
IF THISFORM.MODE="INPUT"
THISFORM.TEXT4.VALUE = ""
THISFORM.TEXT4.SETFOCUS
THISFORM.TEXT7.VALUE = DEFATGLKAS
ENDIF
IF THISFORM.MODE="TAMPIL" .OR. THISFORM.MODE="HAPUS"
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.TEXT11.ENABLED = .F.
THISFORM.TEXT15.ENABLED = .F.
THISFORM.TEXT32.ENABLED = .F.
THISFORM.TEXT35.ENABLED = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
MTGL = TANGGAL
MBKT = BUKTI
THISFORM.TEXT7.VALUE = TANGGAL
THISFORM.TEXT8.VALUE = BUKTI
THISFORM.TEXT12.VALUE = JUMLAH1
THISFORM.TEXT13.VALUE = JUMLAH2
THISFORM.TEXT21.VALUE = JUMLAH3
THISFORM.TEXT25.VALUE = JUMLAH4
THISFORM.TEXT22.VALUE = JUMLAH5
THISFORM.TEXT29.VALUE = JUMLAH6
THISFORM.TEXT23.VALUE = JUMLAH7
THISFORM.TEXT30.VALUE = JUMLAH8
THISFORM.TEXT27.VALUE = JUMLAH9
THISFORM.TEXT28.VALUE = JUMLAH10
THISFORM.TEXT24.VALUE = JUMLAH11
MNOREK = THISFORM.TEXT4.VALUE
MDEBETRK = 0
MKREDITRK = 0
CSQL = "select a.*,nama,alamat,desa,kecamatan,kota from pinjaman as a, anggota as b where a.cif=b.cif and a.norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TGLVALUTA = TGLVALUTA
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT5.VALUE = TANGGAL
THISFORM.TEXT18.VALUE = LAMA
THISFORM.TEXT19.VALUE = TGLJTEMPO
THISFORM.TEXT6.VALUE = POKOK
THISFORM.TEXT16.VALUE = JASA
THISFORM.TEXT17.VALUE = POKOK+JASA
THISFORM.TEXT32.VALUE = MKDKAS
THISFORM.KDHIT = KDHIT
THISFORM.PRODUK = JENIS
THISFORM.RATE = RATE
MNOREK = NOREK
MPOKOK = POKOK
CSQL = "select * from pinjaman_mutasi where tanggal='"+SQLDATE(MTGL)+"' and bukti='"+MBKT+"' and (kode='"+DEFAPINSTOR+"' or kode='"+DEFAPINTRK+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF MKDKAS="M"
THISFORM.TEXT9.VALUE = POKOK+JASA+DENDA
THISFORM.TEXT10.VALUE = POKOK
THISFORM.TEXT11.VALUE = JASA
THISFORM.TEXT15.VALUE = DENDA
THISFORM.TEXT20.VALUE = POKOK+JASA+DENDA
MDEBETRK = DEBET
MKREDITRK = KREDIT
IF THISFORM.KDHIT="H"
THISFORM.TEXT9.VALUE = 0
THISFORM.TEXT10.VALUE = KREDIT
THISFORM.TEXT11.VALUE = 0
THISFORM.TEXT15.VALUE = 0
THISFORM.TEXT20.VALUE = KREDIT
ENDIF
ENDIF
IF MKDKAS="K"
IF THISFORM.KDHIT="H"
THISFORM.TEXT10.VALUE = DEBET
ELSE
THISFORM.TEXT10.VALUE = MPOKOK
ENDIF
ENDIF
USE
SELECT (THISFORM.OLDSELECT)
THISFORM.UBAHWARNA(MKDKAS)
IF THISFORM.MODE="HAPUS"
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .T.
ENDIF
IF THISFORM.KDHIT="H"
THISFORM.TAMPILRK()
ENDIF
ENDIF
ENDPROC
**
FUNCTION Unload
IF THISFORM.MODE="INPUT"
CEKURUTNOTA("KAS", THISFORM.TANGGAL, THISFORM.BUKTI)
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  kas_pinjaman.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_pinjaman.scx::Command3
**
PROCEDURE Click
OLDSELECT = SELECT()
IF THISFORM.TEXT32.VALUE='K' .AND. THISFORM.TEXT10.VALUE>DEFABATASKAS
DO WHILE .T.
MKETACC = "PENCAIRAN PINJAMAN "+CHR(13)+"---------------------------------------------------"+CHR(13)+"NOMOR REKENING	: "+THISFORM.TEXT1.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT2.VALUE+CHR(13)+"		PINJAMAN	: "+TRANSFORM(THISFORM.TEXT10.VALUE, "999,999,999,999")+CHR(13)+"---------------------------------------------------"+CHR(13)+"JML PENGAMBILAN	: "+TRANSFORM(THISFORM.TEXT10.VALUE, "999,999,999,999")
DO FORM acc_client TO HASIL WITH THISFORM.TEXT7.VALUE, ALLTRIM(THISFORM.TEXT8.VALUE), MKETACC, THISFORM.TEXT10.VALUE
IF HASIL=1 .OR. HASIL=2
EXIT
ENDIF
ENDDO
IF HASIL=2
RETURN
ENDIF
ENDIF
CSQL = "select jurnal_pokok,jurnal_jasa,jurnal_denda from setsandi_pinj where sandi='"+ALLTRIM(THISFORM.PRODUK)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL, 64, "")
ENDIF
MJURPOKOK = JURNAL_POKOK
MJURBUNGA = JURNAL_JASA
MJURDENDA = JURNAL_DENDA
USE
SELECT (OLDSELECT)
MKD = '03'
MKDKAS = THISFORM.TEXT32.VALUE
MBUNGARK = 0
IF THISFORM.KDHIT="H"
MBUNGARK = THISFORM.TEXT28.VALUE
ENDIF
IF MKDKAS="M"
BAYARANGSUR(THISFORM.KAS, ALLTRIM(THISFORM.TEXT4.VALUE), THISFORM.TEXT7.VALUE, THISFORM.TEXT8.VALUE, THISFORM.TEXT10.VALUE, THISFORM.TEXT11.VALUE, THISFORM.TEXT15.VALUE, THISFORM.TEXT3.VALUE, THISFORM.TEXT13.VALUE)
MKET = 'ANGS. '+ALLTRIM(THISFORM.TEXT4.VALUE)+" AN. "+ALLTRIM(THISFORM.TEXT2.VALUE)
ELSE
CSQL = "select tglvaluta from pinjaman where norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF EMPTY(TGLVALUTA)
CSQL = "update pinjaman set tglvaluta='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' where "+"norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MKET = 'PENC. '+ALLTRIM(THISFORM.TEXT4.VALUE)+" AN. "+ALLTRIM(THISFORM.TEXT2.VALUE)
IF THISFORM.KDHIT="H"
MBUNGARK = THISFORM.TEXT28.VALUE
MKET = 'TARIKAN R/K '+ALLTRIM(THISFORM.TEXT4.VALUE)+" AN. "+ALLTRIM(THISFORM.TEXT2.VALUE)
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from pinjaman_mutasi where norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt001")
MSALDO = DEBET-KREDIT
IF MBUNGARK>0
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT4.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+DEFAPINJASA+"',"+"'"+STR(MBUNGARK)+"',"+"'"+STR(0)+"',"+"'"+STR(MSALDO+MBUNGARK)+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT4.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+IIF(THISFORM.KAS="KAS", DEFAPINSTOR, DEFAPINPBK)+"',"+"'"+STR(THISFORM.TEXT10.VALUE)+"',"+"'"+STR(0)+"',"+"'"+STR(MSALDO+MBUNGARK+THISFORM.TEXT10.VALUE)+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
IF THISFORM.KAS="KAS"
MANGSPK = THISFORM.TEXT21.VALUE
IF THISFORM.KDHIT="H"
MANGSPK = VAL(SYS(11, DTOC(THISFORM.TEXT21.VALUE)))
ENDIF
MJMLKAS = IIF(THISFORM.KDHIT="H" .OR. MKDKAS="K", THISFORM.TEXT10.VALUE, THISFORM.TEXT9.VALUE)
CSQL = "insert into kasir (kantor,csr,tanggal,bukti,kode,keterangan,debet,kredit,opt,norek,"+"jumlah1,jumlah2,jumlah3,jumlah4,jumlah5,jumlah6,jumlah7,jumlah8,jumlah9,"+"jumlah10,jumlah11) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", MJMLKAS, 0))+"',"+"'"+STR(IIF(MKDKAS="K", MJMLKAS, 0))+"',"+"'"+DEFAUSERID+"','"+THISFORM.TEXT4.VALUE+"',"+"'"+STR(THISFORM.TEXT12.VALUE)+"',"+"'"+STR(THISFORM.TEXT13.VALUE)+"',"+"'"+STR(MANGSPK)+"',"+"'"+STR(THISFORM.TEXT25.VALUE)+"',"+"'"+STR(THISFORM.TEXT22.VALUE)+"',"+"'"+STR(THISFORM.TEXT29.VALUE)+"',"+"'"+STR(THISFORM.TEXT23.VALUE)+"',"+"'"+STR(THISFORM.TEXT30.VALUE)+"',"+"'"+STR(THISFORM.TEXT27.VALUE)+"',"+"'"+STR(THISFORM.TEXT28.VALUE)+"',"+"'"+STR(THISFORM.TEXT24.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan di kasir"+CHR(13)+CSQL)
ENDIF
ELSE
CSQL = "insert into nonkas (kantor,csr,tanggal,bukti,kode,kodebank,keterangan,debet,kredit,opt,norek) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+STR(THISFORM.TEXT20.VALUE)+"', "+"?mket,"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+DEFAUSERID+"','"+THISFORM.TEXT4.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MPRODUK = THISFORM.PRODUK
CSQL = "select * from setsandi_pinj where sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOPERPK = JURNAL_POKOK
MNOPERBG = JURNAL_JASA
MNOPERDN = JURNAL_DENDA
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT32.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT10.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
JURNALANTARKANTOR(THISFORM.TEXT7.VALUE, THISFORM.TEXT8.VALUE, MKET, DEFAKANTOR, DEFAKANTORASAL, MJUMLAH)
ENDIF
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "
IF MJUMLAH<>0
CSQL = CSQL+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERKAS+"',"+"?mket,"+"'"+STR(MJUMLAH)+"'),"
ENDIF
IF MBUNGARK>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERPK+"',"+"?mket,"+"'"+STR(MBUNGARK)+"'),"
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERBG+"',"+"?mket,"+"'"+STR(0-MBUNGARK)+"'),"
ENDIF
IF MKDKAS="M"
IF THISFORM.TEXT10.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERPK+"',"+"?mket,"+"'"+STR(0-THISFORM.TEXT10.VALUE)+"'),"
ENDIF
IF THISFORM.TEXT11.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERBG+"',"+"?mket,"+"'"+STR(0-THISFORM.TEXT11.VALUE)+"'),"
ENDIF
IF THISFORM.TEXT15.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERDN+"',"+"?mket,"+"'"+STR(0-THISFORM.TEXT15.VALUE)+"'),"
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal jurnal")
ENDIF
ELSE
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERPK+"',"+"?mket,"+"'"+STR(THISFORM.TEXT10.VALUE)+"'),"
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MNOPERPK, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MNOPERBG, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MNOPERDN, THISFORM.TEXT7.VALUE)
IF DEFAVALIDASI='1'
MKET = ''
IF THISFORM.TEXT32.VALUE='K'
MNAMACETAK = "VLD_PINJ_PBKCAIR"
MJML = THISFORM.TEXT10.VALUE
IF THISFORM.KDHIT="H"
MKET = IIF(THISFORM.TEXT10.VALUE>0, "TARIKAN R/K:Rp."+ALLTRIM(TRANSFORM(MJML, '999,999,999,999'))+" ", "")
ELSE
MKET = IIF(THISFORM.TEXT10.VALUE>0, "REALISASI:Rp."+ALLTRIM(TRANSFORM(MJML, '999,999,999,999'))+" ", "")
ENDIF
ELSE
MNAMACETAK = "VLD_PINJ_ANGS"
MJML = THISFORM.TEXT10.VALUE+THISFORM.TEXT11.VALUE+THISFORM.TEXT15.VALUE
MKET = IIF(THISFORM.TEXT10.VALUE>0, "/ANG.POKOK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT10.VALUE, '999,999,999,999'))+" ", "")
MKET = MKET+IIF(THISFORM.TEXT11.VALUE>0, "/ANG.JASA:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT11.VALUE, '999,999,999,999'))+" ", "")
MKET = MKET+IIF(THISFORM.TEXT15.VALUE>0, "/ANG.DENDA:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT15.VALUE, '999,999,999,999'))+" ", "")
MKET = SUBSTR(MKET, 2)
ENDIF
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/PINJ/"+'Rp.'+ALLTRIM(TRANSFORM(MJML, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT8.VALUE)+'/'+DTOC(THISFORM.TEXT7.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = ALLTRIM(THISFORM.TEXT4.VALUE)+'/'+ALLTRIM(THISFORM.TEXT2.VALUE)
MBARIS3 = MKET
MBARIS4 = ''
CETAKVALIDASI(MNAMACETAK, MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_pinjaman.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_pinjaman.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = DESA
THISFORM.TEXT5.VALUE = KECAMATAN
THISFORM.TEXT6.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. EMPTY(THIS.VALUE)
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
*
*  kas_pinjaman.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MBUKTI = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT1 = BUKTI
USE
CSQL = "select bukti from jurnal where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT2 = BUKTI
USE
SELECT (OLDSELECT)
IF (ISNULL(MBKT1) .OR. EMPTY(MBKT1)) .AND. (ISNULL(MBKT2) .OR. EMPTY(MBKT2))
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
RETURN
ENDIF
MESSAGEBOX("Bukti Sudah Pernah Masuk", 0, "Validasi Bukti")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_pinjaman.scx::Text9
**
PROCEDURE LostFocus
MTOTANG = THISFORM.TEXT9.VALUE
MDENDA = MIN(MTOTANG, THISFORM.TEXT24.VALUE)
MANGBUNGA = MIN((MTOTANG-MDENDA), THISFORM.TEXT30.VALUE)
MANGPOKOK = MTOTANG-MDENDA-MANGBUNGA
IF ALLTRIM(THISFORM.TEXT35.VALUE)="A"
THISFORM.TEXT15.VALUE = MDENDA
THISFORM.TEXT11.VALUE = MANGBUNGA
THISFORM.TEXT10.VALUE = MANGPOKOK
ELSE
THISFORM.TEXT10.VALUE = THISFORM.TEXT12.VALUE
THISFORM.TEXT15.VALUE = MIN(THIS.VALUE-THISFORM.TEXT12.VALUE, THISFORM.TEXT12.VALUE)
THISFORM.TEXT11.VALUE = THIS.VALUE-THISFORM.TEXT12.VALUE-THISFORM.TEXT15.VALUE
ENDIF
ENDPROC
**
*
*  kas_pinjaman.scx::Text10
**
PROCEDURE LostFocus
IF THISFORM.TEXT3.VALUE='L'
IF THIS.VALUE<>THISFORM.TEXT12.VALUE
MESSAGEBOX("Pembayaran Pokok harus sama dengan sisa pokok, untuk pelunasan", 0, "")
NODEFAULT
RETURN
ENDIF
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT15.VALUE = THISFORM.TEXT9.VALUE-THISFORM.TEXT10.VALUE-THISFORM.TEXT11.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text11
**
PROCEDURE InteractiveChange
THISFORM.TEXT15.VALUE = THISFORM.TEXT9.VALUE-THISFORM.TEXT10.VALUE-THISFORM.TEXT11.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text4
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM pinjaman TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
IF LASTKEY()<>13 .AND. EMPTY(THIS.VALUE)
RETURN .T.
ENDIF
MNOREK = TRIM(THIS.VALUE)
CSQL = "select SUM(pokok) as angpk, SUM(jasa) as angbg from pinjaman_mutasi where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Angs")
MANGPK = IIF(ISNULL(ANGPK), 0, ANGPK)
MANGBG = IIF(ISNULL(ANGBG), 0, ANGBG)
CSQL = "select b.kantor,a.cif,a.nama,a.alamat,b.* from anggota as a, pinjaman as b where b.norek='"+MNOREK+"' and a.cif=b.cif"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOREK=MNOREK
MSISAPK = POKOK-MANGPK
MSISABG = JASA-MANGBG
MTGLLUNAS = TGLLUNAS
DEFAKANTORASAL = KANTOR
THISFORM.KDHIT = KDHIT
THISFORM.PRODUK = JENIS
THISFORM.TGLVALUTA = TGLVALUTA
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT5.VALUE = TANGGAL
THISFORM.TEXT18.VALUE = LAMA
THISFORM.TEXT19.VALUE = TGLJTEMPO
THISFORM.TEXT6.VALUE = POKOK
THISFORM.TEXT16.VALUE = JASA
THISFORM.TEXT17.VALUE = MSISAPK+MSISABG
THISFORM.RATE = RATE
IF KDHIT<>"H"
THISFORM.TAMPILNONRK()
OLDSELE = SELECT()
MCUR = SALDOKRD(MNOREK, DEFATGLKAS)
SELECT (MCUR)
MKOLECT = KOL
MSISAPOKOK = MSISAPK
MSISABUNGA = MSISABG
MKALIPK = KALIPK
MKALIBG = KALIBG
MODPK = ODPK
MODBG = ODBG
MHARIPK = IIF(EMPTY(TGLODPK), 0, DEFATGLKAS-TGLODPK)
MHARIBG = IIF(EMPTY(TGLODBG), 0, DEFATGLKAS-TGLODBG)
MTGLOD = MAX(TGLODPK, TGLODBG)
MPPAP = PPAP
MHARUS = HRSPK+HRSBG
MWAJIB = WJBPK+WJBBG
USE
SELECT (OLDSELE)
THISFORM.TEXT12.VALUE = MSISAPOKOK
THISFORM.TEXT13.VALUE = MSISABUNGA
THISFORM.TEXT14.VALUE = MSISAPOKOK+MSISABUNGA
THISFORM.TEXT22.VALUE = MKALIPK
THISFORM.TEXT23.VALUE = MKALIBG
THISFORM.TEXT29.VALUE = MODPK
THISFORM.TEXT30.VALUE = MODBG
THISFORM.TEXT27.VALUE = MWAJIB
THISFORM.TEXT28.VALUE = MODPK+MODBG
CSQL = "select pokok,jasa from pinjaman_jadwal where norek='"+THISFORM.TEXT4.VALUE+"' order by tanggal"
CSQL = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT21.VALUE = POKOK
THISFORM.TEXT25.VALUE = JASA
THISFORM.TEXT26.VALUE = POKOK+JASA
MTGL = THISFORM.TEXT7.VALUE
MDENDA = MAX(HITDENDA(MNOREK, MTGL), 0)
THISFORM.TEXT24.VALUE = MDENDA
THISFORM.TEXT31.VALUE = MWAJIB+MODPK+MODBG+MDENDA
USE
ELSE
THISFORM.TAMPILRK()
ENDIF
IF MTGLLUNAS>CTOD(' -  -    ') .AND. MTGLLUNAS<MTGL
MESSAGEBOX("Pinjaman sudah lunas, harap dicek lagi")
NODEFAULT
THISFORM.TEXT4.SETFOCUS
RETURN
ENDIF
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ELSE
NODEFAULT
THIS.SETFOCUS
ENDIF
THISFORM.TEXT8.SETFOCUS
ENDFUNC
**
*
*  kas_pinjaman.scx::Text12
**
PROCEDURE InteractiveChange
THISFORM.TEXT14.VALUE = THISFORM.TEXT12.VALUE+THISFORM.TEXT13.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text13
**
PROCEDURE InteractiveChange
THISFORM.TEXT14.VALUE = THISFORM.TEXT12.VALUE+THISFORM.TEXT13.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text15
**
PROCEDURE LostFocus
IF LASTKEY()=5 .OR. LASTKEY()=27
RETURN
ENDIF
IF (THISFORM.TEXT10.VALUE+THISFORM.TEXT11.VALUE+THISFORM.TEXT15.VALUE)<>THISFORM.TEXT9.VALUE
MESSAGEBOX("Jumlah Setoran Tidak Sama")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
RETURN
ENDPROC
**
*
*  kas_pinjaman.scx::Text21
**
PROCEDURE InteractiveChange
THISFORM.TEXT26.VALUE = THISFORM.TEXT21.VALUE+THISFORM.TEXT25.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text24
**
PROCEDURE InteractiveChange
THISFORM.TEXT31.VALUE = THISFORM.TEXT27.VALUE+THISFORM.TEXT28.VALUE+THISFORM.TEXT24.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text25
**
PROCEDURE InteractiveChange
THISFORM.TEXT26.VALUE = THISFORM.TEXT21.VALUE+THISFORM.TEXT25.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text32
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="M" .OR. THIS.VALUE="K")
MESSAGEBOX("Gunakan Huruf "+CHR(13)+"M : Untuk Kas Masuk"+CHR(13)+"K  : Untuk Kas Keluar", 64, "TIDAK VALID")
THIS.SETFOCUS
NODEFAULT
ENDIF
THISFORM.UBAHWARNA(THIS.VALUE)
IF THIS.VALUE="K"
IF THISFORM.KDHIT="H"
IF THISFORM.TEXT24.VALUE<=0
MESSAGEBOX("Plafon pinjaman sudah habis")
NODEFAULT
RETURN
ENDIF
THISFORM.LABEL8.CAPTION = "TARIKAN R/K"
THISFORM.TEXT10.VALUE = THISFORM.TEXT24.VALUE
ELSE
IF  .NOT. EMPTY(THISFORM.TGLVALUTA)
MESSAGEBOX("Pinjaman Sudah Dicairkan Tanggal "+DTOC(THISFORM.TGLVALUTA), 16, "PERINGATAN")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
IF THISFORM.KDHIT="H"
THISFORM.LABEL8.CAPTION = "ANGSURAN R/K"
THISFORM.TEXT10.VALUE = THISFORM.TEXT12.VALUE+THISFORM.TEXT28.VALUE
ELSE
IF EMPTY(THISFORM.TGLVALUTA)
MESSAGEBOX("Pinjaman Belum Direalisasikan"+CHR(13)+"Mohon Periksa kembali Nomor Rekening Pinjaman", 16, "PERINGATAN")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THISFORM.TEXT9.VALUE = THISFORM.TEXT26.VALUE+THISFORM.TEXT24.VALUE
ENDIF
ENDIF
ENDPROC
**
*
*  kas_pinjaman.scx::Text33
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_pinjaman.scx::Text20
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT34.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_pinjaman.scx::Text34
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_pinjaman.scx::Text27
**
PROCEDURE InteractiveChange
THISFORM.TEXT31.VALUE = THISFORM.TEXT27.VALUE+THISFORM.TEXT28.VALUE+THISFORM.TEXT24.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text28
**
PROCEDURE InteractiveChange
THISFORM.TEXT31.VALUE = THISFORM.TEXT27.VALUE+THISFORM.TEXT28.VALUE+THISFORM.TEXT24.VALUE
ENDPROC
**
*
*  kas_pinjaman.scx::Text35
**
PROCEDURE InteractiveChange
IF THIS.VALUE='A'
THISFORM.TEXT36.VALUE = "ANGSURAN"
ENDIF
IF THIS.VALUE='L'
THISFORM.TEXT36.VALUE = "PELUNASAN"
ENDIF
ENDPROC
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="A" .OR. THIS.VALUE="L")
MESSAGEBOX("Hanya dapat di isi A / L"+CHR(13)+"  - A : ANGSURAN"+CHR(13)+"  - L : PELUNASAN")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
IF THIS.VALUE='L'
THISFORM.TEXT9.VALUE = THISFORM.TEXT12.VALUE+THISFORM.TEXT30.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT12.VALUE
ENDIF
ENDPROC
**
*
*  kas_pinjaman.scx::Text36
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_pinjaman.scx::Command1
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_pinjaman.scx::Command4
**
PROCEDURE Click
MKD = '03'
MKDKAS = THISFORM.TEXT32.VALUE
IF THISFORM.KAS="KAS"
CSQL = "delete from kasir where kantor='"+DEFAKANTOR+"' and csr='01' and "+"tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus data kasir"+CHR(13)+CSQL)
ENDIF
ELSE
CSQL = "delete from nonkas where kantor='"+DEFAKANTOR+"' and csr='01' and "+"tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus data non kas")
ENDIF
ENDIF
IF THISFORM.TEXT32.VALUE='M'
CSQL = "delete from pinjaman_mutasi where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "UPDATE pinjaman set tglvaluta='0000-00-00' where norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from pinjaman_mutasi where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
MPRODUK = THISFORM.PRODUK
CSQL = "select * from setsandi_pinj where sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOPERPK = JURNAL_POKOK
MNOPERBG = JURNAL_JASA
MNOPERDN = JURNAL_DENDA
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT32.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE)
CSQL = "delete from jurnal where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus jurnal")
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MNOPERPK, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MNOPERBG, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MNOPERDN, THISFORM.TEXT7.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
MNOPER = ALLTRIM(DEFANOPERAKA)+DEFAKANTORASAL
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKP)+DEFAKANTORASAL
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKA)+DEFAKANTOR
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKP)+DEFAKANTOR
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_pinjaman.scx::Command5
**
PROCEDURE Click
DO FORM .\form\pinjaman_data WITH "TAMPIL"
ENDPROC
**
***
*** kas_pinjaman.sct
***
*
***
*** kas_kolektif.scx
***
*
*
*  kas_kolektif.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE11.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE12.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE13.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE14.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT17.VALUE = "KAS MASUK"
THISFORM.LABEL20.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL8.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE11.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE12.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE13.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE14.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT17.VALUE = "KAS KELUAR"
THISFORM.LABEL20.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL8.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
FUNCTION Unload
IF THISFORM.MODE="INPUT"
CEKURUTNOTA("KAS", THISFORM.TANGGAL, THISFORM.BUKTI)
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MKAS
THISFORM.MODE = MMODE
THISFORM.KAS = IIF(VARTYPE(MKAS)="X" .OR. VARTYPE(MKAS)="L", "KAS", MKAS)
THISFORM.TANGGAL = TGLNOW
THISFORM.BUKTI = ' '
IF THISFORM.KAS="NONKAS"
THISFORM.LABEL2.CAPTION = "TRANSAKSI KOLEKTIF VIA BANK"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 128, 0)
THISFORM.LABEL21.VISIBLE = .T.
THISFORM.TEXT18.VISIBLE = .T.
THISFORM.TEXT19.VISIBLE = .T.
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.SHAPE10.WIDTH = 0
MKDKAS = IIF(DEBET-KREDIT>0, "M", "K")
THISFORM.TEXT1.SETFOCUS
THISFORM.TEXT7.VALUE = DEFATGLKAS
THISFORM.UBAHWARNA(MKDKAS)
IF THISFORM.MODE="HAPUS"
THISFORM.HAPUS.TOP = 0
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  kas_kolektif.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_kolektif.scx::Command3
**
PROCEDURE Click
MKD = '04'
MSANDI = THISFORM.TEXT4.VALUE
CREATE CURSOR CUR_JURNAL (TANGGAL D, BUKTI C (10), NOPER C (10), KET C (40), JUMLAH N (15))
CSQL = "select a.*,b.jenis,b.produk from col_bayar as a, simpanan as b  where a.norek=b.norek and "+"a.kantor='"+DEFAKANTOR+"' and kode='"+MSANDI+"' and kdtrans='SIMP' and a.tanggal='"+SQLDATE(DEFATGLKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
SELECT SMT
GOTO TOP
THISFORM.SHAPE10.WIDTH = 0
DO WHILE  .NOT. EOF()
THISFORM.SHAPE10.WIDTH = INT((RECNO()/RECCOUNT())*590)
MSALDO = SLDSIMP(NOREK, TANGGAL)+TABUNGAN
CSQL = "insert into simpanan_mutasi (kantor,norek,JAM,BUKTI,TANGGAL,kode,KETERANGAN,DEBET,KREDIT,SALDO,opt) values "+"('"+DEFAKANTOR+"','"+ALLTRIM(NOREK)+"','"+TIME()+"','"+BUKTI+"','"+SQLDATE(TANGGAL)+"','"+"01"+"','"+"TAB KOLEKTIF "+ALLTRIM(THISFORM.TEXT4.VALUE)+"','"+STR(IIF(TABUNGAN<0, 0-TABUNGAN, 0))+"','"+STR(IIF(TABUNGAN>0, TABUNGAN, 0))+"','"+STR(MSALDO)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert")
ENDIF
SELECT SMT
SKIP
ENDDO
ENDIF
CSQL = "select jenis,sandi,jurnaltab,jurnalutangbg,jurnalbunga,jurnaladm,jurnaladmtutup,jurnalpajak,jurnalksd from setsandi_tab"
LCEK = SQLEXEC(OODBC, CSQL, "SETSANDI")
GOTO TOP
DO WHILE  .NOT. EOF()
MJENIS = JENIS
MSANDI = SANDI
MJURNAL = JURNALTAB
SELECT SMT
SUM TABUNGAN TO MSTOR FOR JENIS=MJENIS .AND. PRODUK=MSANDI .AND. TABUNGAN>0
SUM TABUNGAN TO MAMBIL FOR JENIS=MJENIS .AND. PRODUK=MSANDI .AND. TABUNGAN<0
IF MSTOR<>0
SELECT CUR_JURNAL
APPEND BLANK
REPLACE TANGGAL WITH THISFORM.TEXT7.VALUE, BUKTI WITH THISFORM.TEXT8.VALUE
REPLACE NOPER WITH MJURNAL, KET WITH "STR. TABUNGAN KOLEKTIF "+THISFORM.TEXT4.VALUE
REPLACE JUMLAH WITH 0-MSTOR
ENDIF
IF MAMBIL<>0
SELECT CUR_JURNAL
APPEND BLANK
REPLACE TANGGAL WITH THISFORM.TEXT7.VALUE, BUKTI WITH THISFORM.TEXT8.VALUE
REPLACE NOPER WITH MJURNAL, KET WITH "STR. TABUNGAN KOLEKTIF "+THISFORM.TEXT4.VALUE
REPLACE JUMLAH WITH 0-MAMBIL
ENDIF
SELECT SETSANDI
SKIP
ENDDO
SELECT SMT
USE
CSQL = "update col_bayar set flag='*' where kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT4.VALUE+"' and kdtrans='SIMP' and tanggal='"+SQLDATE(DEFATGLKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
CSQL = "select a.*,b.jenis from col_bayar as a, pinjaman as b where a.kantor='"+DEFAKANTOR+"' and a.norek=b.norek and "+"kode='"+THISFORM.TEXT4.VALUE+"' and kdtrans='PINJ' and a.tanggal='"+SQLDATE(DEFATGLKAS)+"' "
LCEK = SQLEXEC(OODBC, CSQL, "KOL")
IF RECCOUNT()>0
SELECT KOL
GOTO TOP
THISFORM.SHAPE10.WIDTH = 0
DO WHILE  .NOT. EOF()
THISFORM.SHAPE10.WIDTH = INT((RECNO()/RECCOUNT())*590)
BAYARANGSUR("KAS", NOREK, TANGGAL, BUKTI, POKOK, JASA, DENDA, 'A', 0)
SELECT KOL
SKIP
ENDDO
ENDIF
CSQL = "update col_bayar set flag='*' where kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT4.VALUE+"' and kdtrans='PINJ' and tanggal='"+SQLDATE(DEFATGLKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
CSQL = "select sandi,keterangan,jurnal_pokok,jurnal_jasa,jurnal_denda,jurnal_adm,jurnal_prov,jurnal_yadit,jurnal_ppap from setsandi_pinj"
LCEK = SQLEXEC(OODBC, CSQL, "SETSANDI")
GOTO TOP
DO WHILE  .NOT. EOF()
MSANDI = SANDI
MKET = KETERANGAN
MJURPOKOK = JURNAL_POKOK
MJURJASA = JURNAL_JASA
MJURDENDA = JURNAL_DENDA
MJURADM = JURNAL_ADM
MJURPROV = JURNAL_PROV
MJURYADIT = JURNAL_YADIT
MJURPPAP = JURNAL_PPAP
SELECT KOL
SUM POKOK TO MANGPK FOR JENIS=MSANDI
SUM JASA TO MANGJS FOR JENIS=MSANDI
SUM DENDA TO MANGDN FOR JENIS=MSANDI
IF MANGPK<>0
SELECT CUR_JURNAL
APPEND BLANK
REPLACE TANGGAL WITH THISFORM.TEXT7.VALUE, BUKTI WITH THISFORM.TEXT8.VALUE
REPLACE NOPER WITH MJURPOKOK, KET WITH "ANGS. POKOK KOLEKTIF "+THISFORM.TEXT4.VALUE
REPLACE JUMLAH WITH 0-MANGPK
ENDIF
IF MANGJS<>0
SELECT CUR_JURNAL
APPEND BLANK
REPLACE TANGGAL WITH THISFORM.TEXT7.VALUE, BUKTI WITH THISFORM.TEXT8.VALUE
REPLACE NOPER WITH MJURJASA, KET WITH "ANGS. JASA KOLEKTIF "+THISFORM.TEXT4.VALUE
REPLACE JUMLAH WITH 0-MANGJS
ENDIF
IF MANGDN<>0
SELECT CUR_JURNAL
APPEND BLANK
REPLACE TANGGAL WITH THISFORM.TEXT7.VALUE, BUKTI WITH THISFORM.TEXT8.VALUE
REPLACE NOPER WITH MJURDENDA, KET WITH "ANGS. DENDA KOLEKTIF "+THISFORM.TEXT4.VALUE
REPLACE JUMLAH WITH 0-MANGDN
ENDIF
SELECT SETSANDI
SKIP
ENDDO
SELECT SETSANDI
USE
SELECT KOL
USE
CSQL = "update col_bayar set flag='*' where kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT4.VALUE+"' and kdtrans='PINJ' and a.tanggal='"+SQLDATE(DEFATGLKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SELECT CUR_JURNAL
MKAS = 0
GOTO TOP
DO WHILE  .NOT. EOF()
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TANGGAL)+"','"+BUKTI+"','"+NOPER+"','"+KET+"','"+STR(JUMLAH)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
MKAS = MKAS+JUMLAH
SKIP
ENDDO
IF THISFORM.KAS="KAS"
MNOPERKAS = DEFANOPERKAS
ELSE
MNOPERKAS = THISFORM.NOPERBANK
ENDIF
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "+"('"+DEFAKANTOR+"','"+SQLDATE(THISFORM.TEXT7.VALUE)+"','"+THISFORM.TEXT8.VALUE+"','"+MNOPERKAS+"','"+"STR. KOLEKTIF"+THISFORM.TEXT4.VALUE+"','"+STR(0-MKAS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF THISFORM.KAS="KAS"
CSQL = "insert into kasir (kantor,csr,tanggal,bukti,kode,keterangan,debet,kredit,opt) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+"STR. KOLEKTIF "+THISFORM.TEXT4.VALUE+"',"+"'"+STR(IIF(THISFORM.TEXT11.VALUE="M", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+STR(IIF(THISFORM.TEXT11.VALUE="K", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into nonkas (kantor,csr,tanggal,bukti,kode,kodebank,keterangan,debet,kredit,opt) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+STR(THISFORM.TEXT18.VALUE)+"',"+"'"+"STR. KOLEKTIF "+THISFORM.TEXT4.VALUE+"',"+"'"+STR(IIF(THISFORM.TEXT11.VALUE="M", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+STR(IIF(THISFORM.TEXT11.VALUE="K", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF DEFAVALIDASI='1'
MKET = IIF(THISFORM.TEXT6.VALUE>0, "TABUNGAN:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT6.VALUE, '999,999,999,999'))+" ", "")
MKET = MKET+IIF(THISFORM.TEXT20.VALUE>0, "/LAIN-LAIN:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT20.VALUE, '999,999,999,999'))+" ", "")
MKET1 = IIF(THISFORM.TEXT12.VALUE>0, "ANG.POKOK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT12.VALUE, '999,999,999,999'))+" ", "")
MKET1 = MKET1+IIF(THISFORM.TEXT13.VALUE>0, "/ANGS.JASA:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT13.VALUE, '999,999,999,999'))+" ", "")
MKET1 = MKET1+IIF(THISFORM.TEXT14.VALUE>0, "/ANGS.DENDA:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT14.VALUE, '999,999,999,999'))+" ", "")
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/COL/"+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT10.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT8.VALUE)+'/'+DTOC(THISFORM.TEXT7.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = ALLTRIM(THISFORM.TEXT4.VALUE)+'/'+THISFORM.TEXT2.VALUE
MBARIS3 = MKET
MBARIS4 = MKET1
CETAKVALIDASI("VLD_KOLEKTOR", MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_kolektif.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_kolektif.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MBUKTI = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT1 = BUKTI
USE
CSQL = "select bukti from jurnal where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT2 = BUKTI
USE
SELECT (OLDSELECT)
IF (ISNULL(MBKT1) .OR. EMPTY(MBKT1)) .AND. (ISNULL(MBKT2) .OR. EMPTY(MBKT2))
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
RETURN
ENDIF
MESSAGEBOX("Bukti Sudah Pernah Masuk", 0, "Validasi Bukti")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_kolektif.scx::Text4
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "C002"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THISFORM.TEXT4.VALUE = ALLTRIM(MSANDI)
ENDIF
ELSE
MSANDI = ALLTRIM(THISFORM.TEXT4.VALUE)
ENDIF
CSQL = "select sandi,keterangan,ket2,ket3 from setsandi where kode='C002' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Marketing tidak terbaca")
ENDIF
IF RECCOUNT()>0
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.TEXT3.VALUE = KET2
THISFORM.TEXT1.VALUE = KET3
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Marketing tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
CSQL = "select * from col_bayar where kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT4.VALUE+"' and tanggal='"+SQLDATE(DEFATGLKAS)+"' and flag<>'*'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SUM TABUNGAN TO MAMBIL FOR TABUNGAN<0
SUM TABUNGAN TO MSTOR FOR TABUNGAN>0
SUM POKOK TO MANGPK FOR POKOK>0
SUM JASA TO MANGBG FOR JASA>0
MANGDENDA = 0
USE
THISFORM.TEXT5.VALUE = MSTOR
THISFORM.TEXT6.VALUE = MAMBIL
THISFORM.TEXT12.VALUE = MANGPK
THISFORM.TEXT13.VALUE = MANGBG
THISFORM.TEXT14.VALUE = MANGDENDA
THISFORM.TEXT16.VALUE = MSTOR+MAMBIL
THISFORM.TEXT15.VALUE = MANGPK+MANGBG+MANGDENDA
THISFORM.TEXT9.VALUE = MSTOR+MAMBIL+MANGPK+MANGBG+MANGDENDA
THISFORM.TEXT10.VALUE = THISFORM.TEXT9.VALUE
THISFORM.TEXT11.VALUE = IIF(THISFORM.TEXT9.VALUE>0, "M", "K")
THISFORM.UBAHWARNA(THISFORM.TEXT11.VALUE)
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  kas_kolektif.scx::Text11
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="M" .OR. THIS.VALUE="K")
MESSAGEBOX("Gunakan Huruf "+CHR(13)+"M : Untuk Kas Masuk"+CHR(13)+"K  : Untuk Kas Keluar", 64, "TIDAK VALID")
THIS.SETFOCUS
NODEFAULT
ENDIF
THISFORM.UBAHWARNA(THIS.VALUE)
ENDPROC
**
*
*  kas_kolektif.scx::Text17
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_kolektif.scx::Text18
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT19.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_kolektif.scx::Text19
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
***
*** kas_kolektif.sct
***
*
***
*** kas_lainnya.scx
***
*
*
*  kas_lainnya.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE9.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE13.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE7.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT16.VALUE = "KAS MASUK"
THISFORM.LABEL14.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL7.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE13.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE7.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT16.VALUE = "KAS KELUAR"
THISFORM.LABEL14.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL7.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
FUNCTION Unload
IF THISFORM.MODE="INPUT"
CEKURUTNOTA("KAS", THISFORM.TANGGAL, THISFORM.BUKTI)
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MKAS
THISFORM.MODE = IIF(VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L", "INPUT", MMODE)
THISFORM.KAS = IIF(VARTYPE(MKAS)="X" .OR. VARTYPE(MKAS)="L", "KAS", MKAS)
THISFORM.TANGGAL = TGLNOW
THISFORM.BUKTI = ' '
IF THISFORM.KAS="NONKAS"
THISFORM.LABEL2.CAPTION = "TRANSAKSI KEANGGOTAAN VIA BANK"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 128, 0)
THISFORM.LABEL15.VISIBLE = .T.
THISFORM.TEXT17.VISIBLE = .T.
THISFORM.TEXT18.VISIBLE = .T.
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.OLDSELECT = SELECT()
DEFAKANTORASAL = DEFAKANTOR
THISFORM.TEXT3.INPUTMASK = DEFAFMTAKT
CREATE CURSOR DUMMY01 (TANGGAL D (8), BUKTI C (10), NOREK C (25), NAMA C (40), ALAMAT C (40), POKOK N (15), ADM N (10), PROVISI N (10), MATERAI N (10), NOTARIS N (10), ASURANSI N (10), LAINLAIN N (10))
SELECT DUMMY01
APPEND BLANK
SELECT (THISFORM.OLDSELECT)
MTGL = TANGGAL
MBKT = BUKTI
MKDKAS = IIF(DEBET-KREDIT>0, "M", "K")
IF THISFORM.MODE="INPUT"
THISFORM.TEXT7.SETFOCUS
THISFORM.TEXT7.VALUE = DEFATGLKAS
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDIF
IF THISFORM.MODE="TAMPIL" .OR. THISFORM.MODE="HAPUS"
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND5.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.UBAHWARNA(MKDKAS)
THISFORM.TEXT7.VALUE = TANGGAL
THISFORM.TEXT8.VALUE = BUKTI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.TEXT9.VALUE = IIF(DEBET=0, KREDIT, DEBET)
THISFORM.TEXT15.VALUE = MKDKAS
THISFORM.TEXT3.VALUE = NOREK
IF LEFT(KETERANGAN, 9)="ADM NOREK"
THISFORM.COMMAND1.VISIBLE = .T.
ENDIF
MNOPER = NOREK
CSQL = "select nama from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT1.VALUE = NAMA
USE
SELECT (THISFORM.OLDSELECT)
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.TEXT15.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  kas_lainnya.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_lainnya.scx::Command3
**
PROCEDURE Click
MKD = '99'
MKDKAS = THISFORM.TEXT15.VALUE
MTANGGAL = THISFORM.TEXT7.VALUE
IF THISFORM.TEXT15.VALUE='K' .AND. THISFORM.TEXT9.VALUE>DEFABATASKAS
DO WHILE .T.
MKETACC = ALLTRIM(THISFORM.TEXT2.VALUE)+CHR(13)+"---------------------------------------------------"+CHR(13)+"JML PENGAMBILAN	: "+TRANSFORM(THISFORM.TEXT9.VALUE, "999,999,999,999")
DO FORM acc_client TO HASIL WITH THISFORM.TEXT7.VALUE, ALLTRIM(THISFORM.TEXT8.VALUE), MKETACC, THISFORM.TEXT9.VALUE
IF HASIL=1 .OR. HASIL=2
EXIT
ENDIF
ENDDO
IF HASIL=2
RETURN
ENDIF
ENDIF
IF THISFORM.KAS="KAS"
MKET = TRIM(THISFORM.TEXT2.VALUE)
CSQL = "insert into kasir (kantor,csr,tanggal,bukti,kode,keterangan,debet,kredit,opt,norek) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+DEFAUSERID+"','"+THISFORM.TEXT3.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
MKET = TRIM(THISFORM.TEXT2.VALUE)
CSQL = "insert into nonkas (kantor,csr,tanggal,bukti,kode,kodebank,keterangan,debet,kredit,opt,norek) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+TRANSFORM(THISFORM.TEXT17.VALUE)+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+DEFAUSERID+",'"+THISFORM.TEXT3.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT15.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
JURNALANTARKANTOR(THISFORM.TEXT7.VALUE, THISFORM.TEXT8.VALUE, MKET, DEFAKANTOR, DEFAKANTORASAL, MJUMLAH)
ENDIF
IF LEFT(THISFORM.TEXT2.VALUE, 9)<>"ADM NOREK"
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERKAS+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE))+"'),"
ENDIF
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+THISFORM.TEXT3.VALUE+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", 0-THISFORM.TEXT9.VALUE, THISFORM.TEXT9.VALUE))+"'),"
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTOR, THISFORM.TEXT3.VALUE, THISFORM.TEXT7.VALUE)
IF DEFAVALIDASI='1'
MKET = THISFORM.TEXT2.VALUE
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/OTH/"+IIF(THISFORM.TEXT15.VALUE='K', "KREDIT:", "DEBET:")+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT8.VALUE)+'/'+DTOC(THISFORM.TEXT7.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = TRANSFORM(THISFORM.TEXT3.VALUE, DEFAFMTAKT)+'/'+THISFORM.TEXT1.VALUE
MBARIS3 = MKET
MBARIS4 = ''
MNAMACETAK = IIF(THISFORM.TEXT15.VALUE="M", "VLD_LAIN_MASUK", "VLD_LAIN_KELUAR")
CETAKVALIDASI(MNAMACETAK, MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
ELSE
MKD = '05'
MKDKAS = THISFORM.TEXT15.VALUE
MKET = THISFORM.TEXT2.VALUE
SELECT DUMMY01
MNAMA = ALLTRIM(NAMA)
CSQL = "insert into kasir_datalain (kantor,csr,tanggal,bukti,opt,norek,nama,alamat,pokok,adm,"+"provisi,materai,notaris,asuransi,lainlain) value "+"('"+DEFAKANTORASAL+"',"+"'"+"01"+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+BUKTI+"',"+"'"+DEFAUSERID+"',"+"'"+NOREK+"',"+"?mnama,"+"'"+ALAMAT+"',"+"'"+STR(POKOK)+"',"+"'"+STR(ADM)+"',"+"'"+STR(PROVISI)+"',"+"'"+STR(MATERAI)+"',"+"'"+STR(NOTARIS)+"',"+"'"+STR(ASURANSI)+"',"+"'"+STR(LAINLAIN)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal input data lainnya")
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MNOREK = NOREK
CSQL = "select jenis from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MJENISKRD = JENIS
CSQL = "select jurnal_pokok,jurnal_jasa,jurnal_denda,jurnal_adm,jurnal_prov from setsandi_pinj where sandi='"+MJENISKRD+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOPERADM = JURNAL_ADM
MNOPERPROV = JURNAL_PROV
MNOPERMATERAI = JURNAL_ADM
MNOPERNOTARIS = DEFANOPERNOTARIS
MNOPERASURANSI = DEFANOPERPREMI
MNOPERLAIN = DEFANOPERTRANS
SELECT DUMMY01
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "
IF ADM+PROVISI+MATERAI+NOTARIS+LAINLAIN<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+BUKTI+"',"+"'"+MNOPERKAS+"',"+"?mket,"+"'"+STR(ADM+PROVISI+MATERAI+NOTARIS+ASURANSI+LAINLAIN)+"'),"
ENDIF
IF ADM<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+BUKTI+"',"+"'"+MNOPERADM+"',"+"?mket,"+"'"+STR(0-ADM)+"'),"
ENDIF
IF PROVISI<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+BUKTI+"',"+"'"+MNOPERPROV+"',"+"?mket,"+"'"+STR(0-PROVISI)+"'),"
ENDIF
IF MATERAI<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+BUKTI+"',"+"'"+MNOPERMATERAI+"',"+"?mket,"+"'"+STR(0-MATERAI)+"'),"
ENDIF
IF NOTARIS<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+BUKTI+"',"+"'"+MNOPERNOTARIS+"',"+"?mket,"+"'"+STR(0-NOTARIS)+"'),"
ENDIF
IF ASURANSI<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+BUKTI+"',"+"'"+DEFANOPERPREMI+"',"+"?mket,"+"'"+STR(0-ASURANSI)+"'),"
ENDIF
IF LAINLAIN<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+BUKTI+"',"+"'"+MNOPERLAIN+"',"+"?mket,"+"'"+STR(0-LAINLAIN)+"'),"
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal melakukan jurnal")
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERADM, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERPROV, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERMATERAI, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERNOTARIS, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERLAIN, MTANGGAL)
IF DEFAVALIDASI='1'
SELECT DUMMY01
MKET = ''
MKET = MKET+IIF(ADM>0, '/ADM:Rp.'+ALLTRIM(TRANSFORM(ADM, '999,999,999,999')), '')
MKET = MKET+IIF(PROVISI>0, '/PROVISI : '+ALLTRIM(TRANSFORM(PROVISI, '999,999,999,999')), '')
MKET = MKET+IIF(MATERAI>0, '/MATERAI : '+ALLTRIM(TRANSFORM(MATERAI, '999,999,999,999')), '')
MKET = MKET+IIF(NOTARIS>0, '/NOTARIS : '+ALLTRIM(TRANSFORM(NOTARIS, '999,999,999,999')), '')
MKET = MKET+IIF(ASURANSI>0, '/ASURANSI : '+ALLTRIM(TRANSFORM(ASURANSI, '999,999,999,999')), '')
MKET = MKET+IIF(LAINLAIN>0, '/LAIN-LAIN : '+ALLTRIM(TRANSFORM(LAINLAIN, '999,999,999,999')), '')
MKET = SUBSTR(MKET, 2)
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/OTH/"+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT8.VALUE)+'/'+DTOC(THISFORM.TEXT7.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = MKET
MBARIS3 = ''
MBARIS4 = ''
MNAMACETAK = "VLD_LAIN_MASUK"
CETAKVALIDASI(MNAMACETAK, MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_lainnya.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_lainnya.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MNOPER WITH "GL01"
IF EMPTY(MNOPER)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THIS.VALUE = MNOPER
ENDIF
ELSE
MNOPER = THIS.VALUE
ENDIF
OLDSELE = SELECT()
CSQL = "select noper,nama,bukubantu,detail from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOPER=MNOPER .AND. DETAIL='Y'
THISFORM.TEXT1.VALUE = NAMA
MBUKUBANTU = BUKUBANTU
USE
SELECT (OLDSELE)
DO CASE
CASE MBUKUBANTU="INVEN"
CREATE CURSOR mCURS (NAMA C (30), TANGGAL D (8), HARGA N (12))
APPEND BLANK
REPLACE TANGGAL WITH THISFORM.TEXT7.VALUE
REPLACE HARGA WITH THISFORM.TEXT9.VALUE
CSQL = "select * from gl_inventaris"
MINV = SYS(2015)
LCEK = SQLEXEC(OODBC, CSQL, MINV)
DO FORM gl_inventaris_data WITH "INPUT", "mcurs"
OTHERWISE
ENDCASE
RETURN
ELSE
MESSAGEBOX("Nomor tidak ketemu atau Nomor induk yg tidak dapat digunakan untuk transaksi", 16, "")
ENDIF
USE
SELECT (OLDSELE)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDPROC
**
*
*  kas_lainnya.scx::Text15
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="M" .OR. THIS.VALUE="K")
MESSAGEBOX("Gunakan Huruf "+CHR(13)+"M : Untuk Kas Masuk"+CHR(13)+"K  : Untuk Kas Keluar", 64, "TIDAK VALID")
THIS.SETFOCUS
NODEFAULT
ENDIF
THISFORM.UBAHWARNA(THIS.VALUE)
ENDPROC
**
*
*  kas_lainnya.scx::Text16
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_lainnya.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MBUKTI = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT1 = BUKTI
USE
CSQL = "select bukti from jurnal where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT2 = BUKTI
USE
SELECT (OLDSELECT)
IF (ISNULL(MBKT1) .OR. EMPTY(MBKT1)) .AND. (ISNULL(MBKT2) .OR. EMPTY(MBKT2))
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
RETURN
ENDIF
MESSAGEBOX("Bukti Sudah Pernah Masuk", 0, "Validasi Bukti")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_lainnya.scx::Text2
**
PROCEDURE InteractiveChange
IF THISFORM.TEXT15.VALUE="M" .AND. THIS.VALUE="ADM NOREK"
SELECT DUMMY01
GOTO TOP
REPLACE TANGGAL WITH THISFORM.TEXT7.VALUE
REPLACE BUKTI WITH THISFORM.TEXT8.VALUE
DO FORM kas_adm WITH "INPUT"
MKETERANGAN = IIF(ADM>0, "ADM,", "")+IIF(PROVISI>0, "PROVISI,", "")+IIF(MATERAI>0, "MATERAI,", "")+IIF(NOTARIS>0, "NOTARIS,", "")+IIF(ASURANSI>0, "ASURANSI,", "")+IIF(LAINLAIN>0, "LAIN-LAIN,", "")
THISFORM.TEXT2.VALUE = "ADM NOREK "+ALLTRIM(NOREK)+" AN."+ALLTRIM(NAMA)+" "+LEFT(MKETERANGAN, LEN(MKETERANGAN)-1)+")"
THISFORM.TEXT9.VALUE = ADM+PROVISI+MATERAI+NOTARIS+ASURANSI+LAINLAIN
THISFORM.TEXT3.ENABLED = .F.
ENDIF
ENDPROC
**
*
*  kas_lainnya.scx::Text17
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT18.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_lainnya.scx::Text18
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_lainnya.scx::Command1
**
PROCEDURE Click
CSQL = "select * from kasir_datalain where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
REPLACE TANGGAL WITH THISFORM.TEXT7.VALUE
REPLACE BUKTI WITH THISFORM.TEXT8.VALUE
REPLACE NOREK WITH THISFORM.TEXT7.VALUE
REPLACE NAMA WITH THISFORM.TEXT8.VALUE
REPLACE ALAMAT WITH THISFORM.TEXT15.VALUE
REPLACE POKOK WITH THISFORM.TEXT17.VALUE
REPLACE ADM WITH THISFORM.TEXT1.VALUE
REPLACE PROVISI WITH THISFORM.TEXT2.VALUE
REPLACE MATERAI WITH THISFORM.TEXT3.VALUE
REPLACE NOTARIS WITH THISFORM.TEXT4.VALUE
REPLACE ASURANSI WITH THISFORM.TEXT9.VALUE
REPLACE LAINLAIN WITH THISFORM.TEXT5.VALUE
GOTO TOP
DO FORM kas_adm WITH "TAMPIL"
ENDPROC
**
*
*  kas_lainnya.scx::Command4
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_lainnya.scx::Command5
**
PROCEDURE Click
MKD = '99'
MKDKAS = THISFORM.TEXT15.VALUE
MTANGGAL = THISFORM.TEXT7.VALUE
IF THISFORM.KAS="KAS"
CSQL = "delete FROM kasir where kantor='"+DEFAKANTOR+"' and csr='01' and tanggal="+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "delete FROM nonkas where kantor='"+DEFAKANTOR+"' and csr='01' and tanggal="+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT15.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE)
CSQL = "delete from jurnal where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus Data Jurnal", 0, "")
ENDIF
IF LEFT(THISFORM.TEXT2.VALUE, 9)<>"ADM NOREK"
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTOR, THISFORM.TEXT3.VALUE, THISFORM.TEXT7.VALUE)
THISFORM.RELEASE
ELSE
MKD = '05'
MKDKAS = THISFORM.TEXT15.VALUE
MKET = THISFORM.TEXT2.VALUE
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MNOREK = NOREK
CSQL = "select jenis from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MJENISKRD = JENIS
CSQL = "select jurnal_pokok,jurnal_jasa,jurnal_denda,jurnal_adm,jurnal_prov from setsandi_pinj where sandi='"+MJENISKRD+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOPERADM = JURNAL_ADM
MNOPERPROV = JURNAL_PROV
MNOPERMATERAI = JURNAL_ADM
MNOPERNOTARIS = DEFANOPERNOTARIS
MNOPERLAIN = DEFANOPERTRANS
HITNERACA(DEFAKANTOR, MNOPERKAS, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERADM, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERPROV, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERMATERAI, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERNOTARIS, MTANGGAL)
HITNERACA(DEFAKANTORASAL, MNOPERLAIN, MTANGGAL)
THISFORM.RELEASE
ENDIF
ENDPROC
**
***
*** kas_lainnya.sct
***
*
***
*** pinjaman.scx
***
*
*
*  pinjaman.scx::PINJAMAN
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 8
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "NOREK"
.COLUMN2.HEADER1.CAPTION = "NO.REKENING"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "CIF"
.COLUMN3.HEADER1.CAPTION = "NO.ANGGOTA"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 300
.COLUMN4.CONTROLSOURCE = "NAMA"
.COLUMN4.HEADER1.CAPTION = "NAMA"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 300
.COLUMN5.CONTROLSOURCE = "ALAMAT"
.COLUMN5.HEADER1.CAPTION = "ALAMAT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 150
.COLUMN6.CONTROLSOURCE = "KECAMATAN"
.COLUMN6.HEADER1.CAPTION = "KECAMATAN"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN7.WIDTH = 150
.COLUMN7.CONTROLSOURCE = "KOTA"
.COLUMN7.HEADER1.CAPTION = "KOTA"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN8.WIDTH = 150
.COLUMN8.ALIGNMENT = 1
.COLUMN8.CONTROLSOURCE = "POKOK"
.COLUMN8.HEADER1.CAPTION = "POKOK PINJAMAN"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN8.INPUTMASK = "999,999,999,999"
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
DO CASE
CASE THISFORM.STATUS="A"
CSQL = "select b.kelkerja,b.nama,b.alamat,b.desa,b.kecamatan,b.kota,b.ibu,a.*,b.cif_lama,b.iddata from pinjaman as a, anggota as b where a.tgllunas='0000-00-00' and a.cif=b.cif and "
CASE THISFORM.STATUS="P"
CSQL = "select b.kelkerja,b.nama,b.alamat,b.desa,b.kecamatan,b.kota,b.ibu,a.*,b.cif_lama,b.iddata from pinjaman as a, anggota as b where a.tgllunas>'0000-00-00' and a.cif=b.cif and "
CASE THISFORM.STATUS="B"
CSQL = "select c.kelkerja,a.*,b.cif,c.*,c.cif_lama from pinjaman_mutasi as a left join pinjaman as b on a.norek=b.norek left join anggota as c on b.cif=c.cif where "
ENDCASE
CSQL = CSQL+IIF(EMPTY(THISFORM.MFILTER.CAPTION), "1", THISFORM.MFILTER.CAPTION)
CSQL = CSQL+" order by norek Limit "+STR(THISFORM.MLIMIT.VALUE)
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX("Gagal Baca DataPinjaman", 0, "")
RETURN
ENDIF
IF THISFORM.MODE="P"
THISFORM.CMDEDIT.ENABLED = .F.
THISFORM.CMDHAPUS.ENABLED = .F.
ENDIF
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA)
MNOREK = NOREK
USE
SELECT (THISFORM.OLDSELECT)
RETURN MNOREK
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MSTATUS
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "TAMPIL"
ENDIF
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("PINJ", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("PINJ", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("PINJ", "HAPUS")
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
IF VARTYPE(MSTATUS)="X" .OR. VARTYPE(MSTATUS)="L" .OR. MSTATUS="A"
MSTATUS = "A"
ENDIF
DO CASE
CASE MSTATUS="A"
THISFORM.LABEL2.CAPTION = "DAFTAR PINJAMAN (AKTIF)"
CASE MSTATUS="B"
THISFORM.LABEL2.CAPTION = "DAFTAR PENERIMAAN ANGSURAN"
CASE MSTATUS="P"
THISFORM.LABEL2.CAPTION = "DAFTAR PINJAMAN (HISTORY)"
THISFORM.CMDINPUT.ENABLED = .F.
THISFORM.CMDEDIT.ENABLED = .F.
THISFORM.CMDHAPUS.ENABLED = .F.
ENDCASE
THISFORM.STATUS = MSTATUS
IF MMODE="TAMPIL"
THISFORM.MFILTER.CAPTION = "a.tanggal='"+SQLDATE(TGLNOW)+"'"
ENDIF
THISFORM.MLIMIT.VALUE = 50
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
IF MMODE="CARI"
THISFORM.CMDCARI1.CLICK
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Activate
THISFORM.WINDOWSTATE = 2
ENDPROC
**
*
*  pinjaman.scx::Cmdhapus
**
PROCEDURE Click
IF THISFORM.STATUS="A"
MYT = MESSAGEBOX("Benar Data akan di hapus", 36, "")
IF MYT=6
MNOREK = NOREK
MTANGGAL = TANGGAL
CSQL = "select * from pinjaman_mutasi where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"'"
CSQL = SQLEXEC(OODBC, CSQL, "smt")
IF NOREK=MNOREK
MESSAGEBOX("PINJAMAN TIDAK DAPAT DHAPUS, KARENA MASIH TERDAPAT ANGSURAN", 16, '')
RETURN
ENDIF
CSQL = "select * from pinjaman_jadwal where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"'"
CSQL = SQLEXEC(OODBC, CSQL, "smt")
IF NOREK=MNOREK
MESSAGEBOX("PINJAMAN TIDAK DAPAT DHAPUS, KARENA MASIH TERDAPAT JADWAL", 16, '')
RETURN
ENDIF
CSQL = "select * from pinjaman_jaminan where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"'"
CSQL = SQLEXEC(OODBC, CSQL, "smt")
IF NOREK=MNOREK
MESSAGEBOX("PINJAMAN TIDAK DAPAT DHAPUS, KARENA MASIH TERDAPAT JAMINAN", 16, '')
RETURN
ENDIF
CSQL = "delete from pinjaman where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat dihapus", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  pinjaman.scx::Cmdedit
**
PROCEDURE Click
IF THISFORM.STATUS="A"
MYDATA = THISFORM.DATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM ./form/pinjaman_data WITH "EDIT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat dikoreksi", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  pinjaman.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
IF THISFORM.STATUS="A"
MYDATA = THISFORM.DATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM ./form/pinjaman_data TO MNOREK WITH "INPUT"
IF  .NOT. EMPTY(MNOREK)
THISFORM.MFILTER.CAPTION = "norek='"+MNOREK+"'"
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat digunakan untuk input data", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  pinjaman.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  pinjaman.scx::Cmddatatop1
**
PROCEDURE Click
GOTO TOP
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  pinjaman.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(a.cif),TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama),norek,b.tanggal,nopk)"+" LIKE "+UPPER(MFILTER)
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  pinjaman.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  pinjaman.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  pinjaman.scx::Cmddatabott1
**
PROCEDURE Click
GOTO BOTTOM
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  pinjaman.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  pinjaman.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE DblClick
DO FORM .\form\pinjaman_data WITH "TAMPIL"
THISFORM.CMDREFRESH1.CLICK
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
IF THISFORM.MODE="CARI"
THISFORM.RELEASE
ELSE
DO FORM .\form\pinjaman_data WITH "TAMPIL"
ENDIF
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
ENDPROC
**
*
*  pinjaman.scx::Cmddetail
**
PROCEDURE Click
DO FORM .\form\pinjaman_data WITH "TAMPIL"
ENDPROC
**
***
*** pinjaman.sct
***
*
***
*** pinjaman_data.scx
***
*
*
*  pinjaman_data.scx::FORM1
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.CMDCATATAN1.VISIBLE = IJINMODUL("PINJ", "CATATAN")
THISFORM.COMMAND5.VISIBLE = IJINMODUL("PINJ", "VIEW")
THISFORM.COMMAND6.VISIBLE = IJINMODUL("PINJ", "CETAK")
THISFORM.COMMAND1.VISIBLE = IJINMODUL("PINJ", "VIEW")
THISFORM.COMMAND4.VISIBLE = IJINMODUL("PINJ", "VIEW")
THISFORM.CMDHITUNG.VISIBLE = IJINMODUL("PINJ", "VIEW")
THISFORM.COMMAND9.VISIBLE = IJINMODUL("PINJ", "VIEW")
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.OLDSELECT = SELECT()
THISFORM.SETALL("selectonentry", .T., "textbox")
THISFORM.MODE = MMODE
THISFORM.TEXT4.SETFOCUS
THISFORM.TEXT4.VALUE = TGLNOW
THISFORM.TEXT32.INPUTMASK = DEFAFMTPINJ
THISFORM.TEXT33.INPUTMASK = DEFAFMTPK
IF EMPTY(ALLTRIM(DEFAKETLAIN))
THISFORM.LABEL7.VISIBLE = .F.
THISFORM.TEXT31.VISIBLE = .F.
ELSE
THISFORM.LABEL7.CAPTION = ALLTRIM(DEFAKETLAIN)
ENDIF
SELECT (THISFORM.OLDSELECT)
THISFORM.NOREKASAL = NOREK
MNOREK = NOREK
WITH THISFORM
IF MMODE='TAMPIL' .OR. MMODE='EDIT'
CSQL = "select * from pinjaman where norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt001")
MTGLVALUTA = TGLVALUTA
MNOPK = NOPK
IF EMPTY(MTGLVALUTA)
.COMMAND10.VISIBLE = .T.
ENDIF
MCIF = CIF
.TEXT4.VALUE = TANGGAL
.TEXT47.VALUE = TGLVALUTA
.TEXT32.VALUE = NOREK
.TEXT33.VALUE = NOPK
.TEXT41.VALUE = KDHIT
.TEXT42.VALUE = MARKETING
.TEXT45.VALUE = NOREK_LAMA
.TEXT1.VALUE = CIF
.TEXT52.VALUE = IIF(ISNULL(TUJUAN), '', TUJUAN)
.TEXT38.VALUE = POKOK
.TEXT5.VALUE = RATE
.TEXT18.VALUE = LAMA
.TEXT19.VALUE = TGLMULAI
.TEXT14.VALUE = TGLJTEMPO
.TEXT39.VALUE = ADM
.TEXT12.VALUE = (ADM/POKOK)*100
.TEXT40.VALUE = PROVISI
.TEXT13.VALUE = (PROVISI/POKOK)*100
.TEXT23.VALUE = MATERAI
.TEXT48.VALUE = IIF(ISNULL(KD_NOTARIS), '', KD_NOTARIS)
.TEXT28.VALUE = NOTARIS
.TEXT49.VALUE = IIF(ISNULL(KD_ASURANSI), '', KD_ASURANSI)
.TEXT30.VALUE = ASURANSI
.TEXT31.VALUE = LAINLAIN
.TEXT21.VALUE = JENIS
.TEXT25.VALUE = KELOMPOK
.TEXT26.VALUE = WILAYAH
.TEXT22.VALUE = PENGGUNAAN
.TEXT27.VALUE = SEKTOR
.TEXT24.VALUE = SUMBER
.TEXT6.VALUE = POKOK
.TEXT16.VALUE = POKOK*(RATE/100)*LAMA
.TEXT17.VALUE = .TEXT6.VALUE+.TEXT16.VALUE
THISFORM.TGLLUNAS.VALUE = TGLLUNAS
MKDHIT = KDHIT
MRATE = RATE
MKD_ASURANSI = IIF(ISNULL(KD_ASURANSI), '', KD_ASURANSI)
MKD_NOTARIS = IIF(ISNULL(KD_NOTARIS), '', KD_NOTARIS)
USE
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt001")
.TEXT46.VALUE = CIF_LAMA
.TEXT2.VALUE = NAMA
.TEXT3.VALUE = ALAMAT
.TEXT35.VALUE = DESA
.TEXT36.VALUE = KECAMATAN
.TEXT37.VALUE = KOTA
CSQL = "select sandi,keterangan from setsandi where kode='P013' and sandi='"+MKD_NOTARIS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
.TEXT50.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where kode='P014' and sandi='"+MKD_ASURANSI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
.TEXT51.VALUE = KETERANGAN
CSQL = "select SUM(pokok) as pokok, SUM(jasa) as bunga from pinjaman_jadwal where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
JDWPK = IIF(ISNULL(POKOK), 0, POKOK)
JDWBG = IIF(ISNULL(BUNGA), 0, BUNGA)
CSQL = "select SUM(pokok) as pokok, SUM(jasa) as bunga from pinjaman_mutasi where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
ANGPK = IIF(ISNULL(POKOK), 0, POKOK)
ANGBG = IIF(ISNULL(BUNGA), 0, BUNGA)
THISFORM.TEXT6.VALUE = JDWPK-ANGPK
THISFORM.TEXT16.VALUE = JDWBG-ANGBG
THISFORM.TEXT17.VALUE = (JDWPK-ANGPK)+(JDWBG-ANGBG)
CSQL = "select keterangan from setsandi_pinj where sandi='"+THISFORM.TEXT21.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT7.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where kode='A001' and sandi='"+THISFORM.TEXT42.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT11.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='P002' AND sandi='"+THISFORM.TEXT41.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT20.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='P013' AND sandi='"+THISFORM.TEXT48.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT50.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='P014' AND sandi='"+THISFORM.TEXT49.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT51.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='P003' AND sandi='"+THISFORM.TEXT25.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT8.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='A003' AND sandi='"+THISFORM.TEXT26.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT9.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='P005' AND sandi='"+THISFORM.TEXT22.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT10.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='P006' AND sandi='"+THISFORM.TEXT27.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT15.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='P007' AND sandi='"+THISFORM.TEXT24.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT29.VALUE = KETERANGAN
IF MKDHIT="H"
THISFORM.SHAPE11.VISIBLE = .F.
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.LABEL15.VISIBLE = .F.
THISFORM.LABEL16.VISIBLE = .F.
THISFORM.TEXT34.VISIBLE = .F.
THISFORM.TEXT43.VISIBLE = .F.
THISFORM.TEXT44.VISIBLE = .F.
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from pinjaman_mutasi where norek='"+THISFORM.TEXT32.VALUE+"' and tanggal<='"+SQLDATE(TGLNOW)+"' group by norek "
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDORK = IIF(ISNULL(DEBET), 0, DEBET)-IIF(ISNULL(KREDIT), 0, KREDIT)
THISFORM.TEXT6.VALUE = MSALDORK
CSQL = "select MAX(tanggal) as tanggal from pinjaman_mutasi where norek='"+THISFORM.TEXT32.VALUE+"' and tanggal<='"+SQLDATE(TGLNOW)+"' group by norek "
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MTGLMUTASI = IIF(ISNULL(TANGGAL), TGLNOW, TANGGAL)
MJASA = (TGLNOW-MTGLMUTASI)*(MRATE/36500)*MSALDORK
THISFORM.TEXT16.VALUE = MJASA
THISFORM.LABEL18.CAPTION = "TAGIHAN JASA"
THISFORM.LABEL19.CAPTION = "SISA PLAFON"
THISFORM.TEXT17.VALUE = THISFORM.TEXT38.VALUE-(MSALDORK+MJASA)
ENDIF
SELECT SMT
USE
SELECT (THISFORM.OLDSELECT)
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.CMDKELUAR1.SETFOCUS
THIS.HEIGHT = 520
ENDIF
ELSE
THISFORM.CMDHITUNG.VISIBLE = .F.
THISFORM.COMMAND6.VISIBLE = .F.
THISFORM.COMMAND8.VISIBLE = .F.
CSQL = "select sandi,keterangan from setsandi where KODE='P002'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT20.VALUE = KETERANGAN
CSQL = "select sandi,keterangan from setsandi where KODE='P003'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
THISFORM.TEXT25.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='P013'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
THISFORM.TEXT48.ENABLED = .F.
THISFORM.TEXT28.ENABLED = .F.
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='P014'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
THISFORM.TEXT49.ENABLED = .F.
THISFORM.TEXT30.ENABLED = .F.
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='A003'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
THISFORM.TEXT9.ENABLED = .F.
THISFORM.TEXT26.ENABLED = .F.
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='P005'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
THISFORM.TEXT22.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='P006'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
THISFORM.TEXT27.ENABLED = .F.
THISFORM.TEXT15.ENABLED = .F.
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='P007' AND sandi='"+THISFORM.TEXT24.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()=0
THISFORM.TEXT24.ENABLED = .F.
THISFORM.TEXT29.ENABLED = .F.
ENDIF
SELECT SMT
USE
ENDIF
ENDWITH
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=-2
DO FORM pinjaman_valuta TO MVALUTA WITH THISFORM.TEXT32.VALUE, THISFORM.TEXT47.VALUE
THISFORM.TEXT47.VALUE = MVALUTA
ENDIF
ENDPROC
**
PROCEDURE Activate
IF THISFORM.MPOPUP
SHOW POPUP MYMENU
ENDIF
ENDPROC
**
PROCEDURE Deactivate
IF THISFORM.MPOPUP
HIDE POPUP MYMENU
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_data.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
THISFORM.MYPILIH = THISFORM.TEXT32.VALUE
CSQL = "insert into pinjaman (kantor,tanggal, norek, nopk, kdhit, marketing, cif, tujuan,pokok,"+"rate,jasa,lama,tglmulai, tgljtempo, adm, provisi, materai,kd_notaris,notaris,kd_asuransi,asuransi,lainlain,"+"jenis, kelompok, wilayah, penggunaan, sektor, pot_pokok,pot_bunga,sumber) value "+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+.TEXT52.VALUE+"',"+"'"+STR(.TEXT38.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT38.VALUE*(.TEXT5.VALUE/100)*.TEXT18.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"',"+"'"+STR(.TEXT39.VALUE)+"',"+"'"+STR(.TEXT40.VALUE)+"',"+"'"+STR(.TEXT23.VALUE)+"',"+"'"+.TEXT48.VALUE+"',"+"'"+STR(.TEXT28.VALUE)+"',"+"'"+.TEXT49.VALUE+"',"+"'"+STR(.TEXT30.VALUE)+"',"+"'"+STR(.TEXT31.VALUE)+"',"+"'"+.TEXT21.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+.TEXT22.VALUE+"',"+"'"+.TEXT27.VALUE+"',"+"'"+STR(THISFORM.TEXT34.VALUE)+"',"+"'"+STR(THISFORM.TEXT43.VALUE)+"',"+"'"+.TEXT24.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
ENDIF
BUATJDW(THISFORM.TEXT32.VALUE)
DO FORM pinjaman_jaminan WITH .TEXT32.VALUE
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',"+"norek='"+.TEXT32.VALUE+"',"+"nopk='"+.TEXT33.VALUE+"',"+"kdhit='"+.TEXT41.VALUE+"',"+"marketing='"+.TEXT42.VALUE+"',"+"cif='"+.TEXT1.VALUE+"',"+"tujuan='"+.TEXT52.VALUE+"',"+"pokok='"+STR(.TEXT38.VALUE)+"',"+"rate='"+TRANSFORM(.TEXT5.VALUE, '99.99')+"',"+"jasa='"+STR(.TEXT38.VALUE*(.TEXT5.VALUE/100)*.TEXT18.VALUE)+"', "+"lama='"+STR(.TEXT18.VALUE)+"',"+"tglmulai='"+SQLDATE(.TEXT19.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT14.VALUE)+"',"+"adm='"+STR(.TEXT39.VALUE)+"',"+"provisi='"+STR(.TEXT40.VALUE)+"',"+"materai='"+STR(.TEXT23.VALUE)+"',"+"kd_notaris='"+.TEXT48.VALUE+"',"+"notaris='"+STR(.TEXT28.VALUE)+"',"+"kd_asuransi='"+.TEXT49.VALUE+"',"+"asuransi='"+STR(.TEXT30.VALUE)+"',"+"jenis='"+.TEXT21.VALUE+"',"+"kelompok='"+.TEXT25.VALUE+"',"+"wilayah='"+.TEXT26.VALUE+"',"+"penggunaan='"+.TEXT22.VALUE+"',"+"sektor='"+.TEXT27.VALUE+"',"+"sumber='"+.TEXT24.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF THISFORM.TEXT32.VALUE<>THISFORM.NOREKASAL
CSQL = "update pinjaman_mutasi set norek='"+THISFORM.TEXT32.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman_saldo set norek='"+THISFORM.TEXT32.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman_akrual set norek='"+THISFORM.TEXT32.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman_jadwal set norek='"+THISFORM.TEXT32.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman_jaminan set norek='"+THISFORM.TEXT32.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman_catatan set norek='"+THISFORM.TEXT32.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
IF THISFORM.MODE="HAPUS"
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_data.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. THIS.ADA=0
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
MNOPK = ''
DEFAAUTONOREK = 2
DO CASE
CASE DEFAAUTONOREK=1
CSQL = "select MAX(norek) as norek from pinjaman where jenis='"+ALLTRIM(THISFORM.TEXT32.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNOREK = IIF(ISNULL(NOREK), "", NOREK)
MPOS = RAT(".", ALLTRIM(DEFAFMTPINJ))
MREK1 = LEFT(MNOREK, MPOS)
MLEN = LEN(ALLTRIM(SUBSTR(DEFAFMTPINJ, MPOS+1)))
MPOS = RAT(".", MNOREK)
MNOMOR = SUBSTR(MNOREK, MPOS+1)
MNOMOR = ALLTRIM(STR(VAL(MNOMOR)+1))
MNOREK = MREK1+RIGHT("000000000000000"+MNOMOR, MLEN)
CASE DEFAAUTONOREK=2
CSQL = "select MAX(norek) as norek from pinjaman where jenis='"+ALLTRIM(THISFORM.TEXT32.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNOREK = IIF(ISNULL(NOREK), "", NOREK)
MPOS = RAT(".", ALLTRIM(DEFAFMTPINJ))
MREK1 = LEFT(MNOREK, MPOS)
MLEN = LEN(ALLTRIM(SUBSTR(DEFAFMTPINJ, MPOS+1)))
MPOS = RAT(".", MNOREK)
MNOMOR = SUBSTR(MNOREK, MPOS+1)
MNOMOR = ALLTRIM(STR(VAL(MNOMOR)+1))
MNOREK = MREK1+RIGHT("000000000000000"+MNOMOR, MLEN)
CASE DEFAAUTONOREK=3
MPRODUK = RIGHT("00"+ALLTRIM(THISFORM.TEXT21.VALUE), 2)
CSQL = "select COUNT(norek) as ke from pinjaman where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKE = IIF(ISNULL(KE), 0, VAL(KE))+1
MKE = LEFT('00'+ALLTRIM(STR(MKE)), 2)
MNOREK = ALLTRIM(MCIF)+"."+MPRODUK+"."+MKE
CASE DEFAAUTONOREK=4
MNOREK = URUTNOREK('5', THIS.VALUE)
ENDCASE
THISFORM.TEXT32.VALUE = MNOREK
THISFORM.TEXT33.VALUE = MNOPK
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  pinjaman_data.scx::Text4
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text5
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT38.VALUE
THISFORM.TEXT16.VALUE = THISFORM.TEXT38.VALUE*(THISFORM.TEXT5.VALUE/100)*THISFORM.TEXT18.VALUE
THISFORM.TEXT17.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT16.VALUE
ENDPROC
**
*
*  pinjaman_data.scx::Text12
**
PROCEDURE LostFocus
THISFORM.TEXT39.VALUE = (THIS.VALUE/100)*THISFORM.TEXT38.VALUE
ENDPROC
**
*
*  pinjaman_data.scx::Text13
**
PROCEDURE LostFocus
THISFORM.TEXT40.VALUE = (THIS.VALUE/100)*THISFORM.TEXT38.VALUE
ENDPROC
**
*
*  pinjaman_data.scx::Text18
**
PROCEDURE LostFocus
THISFORM.TEXT14.VALUE = HITJT(THISFORM.PERIODE, THIS.VALUE, THISFORM.TEXT19.VALUE)
IF THIS.VALUE=0
MESSAGEBOX("Lama pinjaman tidak boleh 0", 16, "PERINGATAN")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
IF THISFORM.TEXT41.VALUE="A"
THISFORM.TEXT34.VALUE = ROUND(THISFORM.TEXT38.VALUE/THISFORM.TEXT18.VALUE, 0)
THISFORM.TEXT43.VALUE = THISFORM.TEXT38.VALUE*(THISFORM.TEXT5.VALUE/100)
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT38.VALUE
THISFORM.TEXT16.VALUE = THISFORM.TEXT38.VALUE*(THISFORM.TEXT5.VALUE/100)*THISFORM.TEXT18.VALUE
THISFORM.TEXT17.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT16.VALUE
ENDPROC
**
*
*  pinjaman_data.scx::Text19
**
PROCEDURE LostFocus
THISFORM.TEXT14.VALUE = HITJT(THISFORM.PERIODE, THISFORM.TEXT18.VALUE, THIS.VALUE)
ENDPROC
**
*
*  pinjaman_data.scx::Text21
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P001"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
THISFORM.TEXT20.VALUE = "FLAT"
CSQL = "select * from setsandi_pinj where sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Jenis Pinjamantidak terbaca")
ENDIF
IF RECCOUNT()>0
THISFORM.TEXT41.VALUE = KDHIT
THISFORM.TEXT12.VALUE = ADM
THISFORM.TEXT13.VALUE = PROV
THISFORM.TEXT5.VALUE = RATE
THISFORM.PERIODE = PERIODE
THIS.VALUE = MSANDI
THISFORM.TEXT7.VALUE = KETERANGAN
DO CASE
CASE PERIODE="HARIAN"
THISFORM.TEXT19.VALUE = THISFORM.TEXT4.VALUE+1
CASE PERIODE="MINGGUAN"
THISFORM.TEXT19.VALUE = THISFORM.TEXT4.VALUE+7
CASE PERIODE="PASARAN"
THISFORM.TEXT19.VALUE = THISFORM.TEXT4.VALUE+5
OTHERWISE
THISFORM.TEXT19.VALUE = MAJU1BLN(THISFORM.TEXT4.VALUE)
ENDCASE
CSQL = "select sandi,keterangan from setsandi where KODE='P002' AND sandi='"+KDHIT+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT20.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Jenis Pinjaman tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text22
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P005"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P005' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Jenis Penggunan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT10.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Jenis Penggunan tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text24
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P007"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P007' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Sumber Pelunasan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT29.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Sumber Pelunasan tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text25
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P003"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P003' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Kelompok tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT8.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Kelompok tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text26
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "A003"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='A003' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Wilayah tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT9.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Wilayah tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text27
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P006"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P006' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Sektor Ekonomi tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT20.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Sektor Ekonomi tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text32
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
OLDSELECT = SELECT()
CSQL = "select norek from pinjaman where norek='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = NOREK
USE
SELECT (OLDSELECT)
IF ALLTRIM(MNOREK)=ALLTRIM(THIS.VALUE) .OR. EMPTY(THIS.VALUE)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  pinjaman_data.scx::Text33
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text38
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THIS.VALUE
THISFORM.TEXT16.VALUE = THIS.VALUE*(THISFORM.TEXT5.VALUE/100)*THISFORM.TEXT18.VALUE
THISFORM.TEXT17.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT16.VALUE
THISFORM.TEXT39.VALUE = THIS.VALUE*(THISFORM.TEXT12.VALUE/100)
THISFORM.TEXT40.VALUE = THIS.VALUE*(THISFORM.TEXT13.VALUE/100)
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=5
RETURN
ENDIF
IF THIS.VALUE=0
MESSAGEBOX("Pinjaman tidak boleh 0", 16, "PERINGATAN")
NODEFAULT
THIS.SETFOCUS
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P002"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='P002' AND sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Perhitungan Bunga tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT20.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Perhitungan Bunga tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text42
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "A001"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='A001' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Marketing tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT11.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Marketing tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
MKDTR = ' '
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_data.scx::Cmdcatatan1
**
PROCEDURE Click
DO FORM catatan WITH "PINJ", NOREK
ENDPROC
**
*
*  pinjaman_data.scx::Command6
**
PROCEDURE RightClick
LOCAL OLDSELECT
OLDSELECT = SELECT()
DO FORM set_laporan WITH "PIN"
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE Click
LOCAL OLDSELECT
THISFORM.MPOPUP = .T.
MNOREK = THISFORM.TEXT32.VALUE
OLDSELECT = SELECT()
MDEPT = "PIN"
MKEL = '1'
DEFINE POPUP MYMENU FROM 6, 95 FONT "Cambria", 10 TITLE "CETAK LAPORAN" SHADOW MARGIN
DEFINE BAR 1 OF MYMENU PROMPT "1. LAPORAN INTERN (CUSTOMIZE)"
DEFINE BAR 2 OF MYMENU PROMPT "2. CETAK REKENING KORAN"
CSQL = "select * from set_print where dept='"+MDEPT+"' and kel='"+MKEL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
ON BAR 1 OF MYMENU ACTIVATE POPUP NAMAMENU
DEFINE POPUP NAMAMENU TITLE "CUSTOM REPORT" RELATIVE SCROLL
A = 1
DO WHILE  .NOT. EOF()
AA = "DEFINE BAR "+STR(A)+" OF NamaMenu PROMPT '"+ALLTRIM(STR(A))+". "+UPPER(NAMA_MENU)+"'"
&AA
BB = "ON SELECTION BAR "+STR(A)+" OF NamaMenu cetaktemp('"+TEMPLATE_ID+"','"+NAMA_MENU+"','"+MNOREK+"')"
&BB
A = A+1
SKIP
ENDDO
ENDIF
USE
SELECT (OLDSELECT)
ACTIVATE POPUP MYMENU
THISFORM.MPOPUP = .F.
SELECT (OLDSELECT)
ENDPROC
**
*
*  pinjaman_data.scx::Command1
**
PROCEDURE Click
SELECT (THISFORM.OLDSELECT)
DO FORM pinjaman_angsur WITH "TAMPIL"
ENDPROC
**
*
*  pinjaman_data.scx::Command4
**
PROCEDURE Click
DO FORM pinjaman_jadwal WITH "TAMPIL"
ENDPROC
**
*
*  pinjaman_data.scx::Command5
**
PROCEDURE Click
DO FORM pinjaman_jaminan WITH NOREK
ENDPROC
**
*
*  pinjaman_data.scx::Cmdhitung
**
PROCEDURE Click
MNOREK = THISFORM.TEXT32.VALUE
DEFINE POPUP MENUHITPINJ FROM 5, 80 FONT "cambria", 12
DEFINE BAR 1 OF MENUHITPINJ PROMPT "1. TABEL TUNGGAKAN"
DEFINE BAR 2 OF MENUHITPINJ PROMPT "2. PERHITUNGAN PELUNASAN"
ON SELECTION BAR 1 OF MENUHITPINJ PINJMENUHIT(1)
ON SELECTION BAR 2 OF MENUHITPINJ PINJMENUHIT(2)
ACTIVATE POPUP MENUHITPINJ
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  pinjaman_data.scx::Text45
**
PROCEDURE LostFocus
IF LASTKEY()=5
RETURN
ENDIF
IF THIS.VALUE=0
MESSAGEBOX("Pinjaman tidak boleh 0", 16, "PERINGATAN")
NODEFAULT
THIS.SETFOCUS
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THIS.VALUE
THISFORM.TEXT16.VALUE = THIS.VALUE*(THISFORM.TEXT5.VALUE/100)*THISFORM.TEXT18.VALUE
THISFORM.TEXT17.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT16.VALUE
THISFORM.TEXT39.VALUE = THIS.VALUE*(THISFORM.TEXT12.VALUE/100)
THISFORM.TEXT40.VALUE = THIS.VALUE*(THISFORM.TEXT13.VALUE/100)
ENDPROC
**
*
*  pinjaman_data.scx::Text46
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. THIS.ADA=0
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Command7
**
PROCEDURE Click
DO FORM anggota_data WITH "TAMPIL", IDDATA
ENDPROC
**
*
*  pinjaman_data.scx::Text47
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  pinjaman_data.scx::Text48
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P013"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P013' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Kelompok tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT50.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Kelompok tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Text49
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P014"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P014' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Kelompok tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT51.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Kelompok tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::tgllunas
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P007"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P007' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Sumber Pelunasan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT29.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Sumber Pelunasan tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_data.scx::Command8
**
PROCEDURE Click
DO FORM pinjaman_lunas
THISFORM.TGLLUNAS.VALUE = TGLLUNAS
ENDPROC
**
*
*  pinjaman_data.scx::Command9
**
PROCEDURE Click
DO FORM pinjaman_lainnya WITH THISFORM.TEXT32.VALUE
ENDPROC
**
*
*  pinjaman_data.scx::Command10
**
PROCEDURE Click
DO FORM form_pbk TO HASIL WITH "PINJ", THISFORM.TEXT32.VALUE, 1
IF HASIL
SELECT (THISFORM.OLDSELECT)
REPLACE TGLVALUTA WITH TGLNOW
THISFORM.TEXT47.VALUE = TGLNOW
ENDIF
ENDPROC
**
***
*** pinjaman_data.sct
***
*
***
*** simpanan_data.scx
***
*
*
*  simpanan_data.scx::FORM1
**
PROCEDURE bacadata
PARAMETER MNOREK
ENDPROC
**
PROCEDURE cetakmutasi
IF MYPRINT("ON")
MBRS = 10
MKOL = 10
@ MBRS+0, MKOL SAY NOREK
@ MBRS+1, MKOL SAY NAMA
@ MBRS+2, MKOL SAY ALAMAT
@ MBRS+3, MKOL SAY KOTA
ENDIF
MYPRINT("OFF")
ENDPROC
**
PROCEDURE viewbilyet
MKANTOR = KANTOR
MNOREK = NOREK
OLDSELE = SELECT()
CSQL = "select * from simpanan_bilyet where kantor='"+MKANTOR+"' and norek='"+MNOREK+"' and ke="+"(select MAX(ke) from simpanan_bilyet where kantor='"+MKANTOR+"' and norek='"+MNOREK+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal Baca Bilyet")
MESSAGEBOX(CSQL)
ENDIF
WITH THISFORM
.TEXT24.VALUE = KE
.TEXT38.VALUE = POKOK
.TEXT5.VALUE = RATE
.TEXT19.VALUE = CARAHITUNG
.TEXT14.VALUE = LAMA
.TEXT18.VALUE = TGLAWAL
.TEXT20.VALUE = TGLJTEMPO
.TEXT23.VALUE = ARO
ENDWITH
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE GotFocus
IF THISFORM.MPOPUP
SHOW POPUP MYMENU
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.DATA = SELECT()
THISFORM.BORDERSTYLE = 2
THISFORM.NOREKASAL = NOREK
THISFORM.LABEL15.VISIBLE = .F.
THISFORM.TEXT21.VISIBLE = .F.
THISFORM.COMMAND8.VISIBLE = IJINMODUL("SIMP", "ADMIN")
THISFORM.COMMAND7.VISIBLE = IJINMODUL("SIMP", "ADMIN")
THISFORM.COMMAND4.VISIBLE = IJINMODUL("SIMP", "VIEW")
THISFORM.COMMAND1.VISIBLE = IJINMODUL("SIMP", "INPUT")
THISFORM.CMDAUTO.VISIBLE = IJINMODUL("SIMP", "ADMIN")
THISFORM.CMDCATATAN.VISIBLE = IJINMODUL("SIMP", "CATATAN")
THISFORM.CMDBLOKIR.VISIBLE = IJINMODUL("SIMP", "INPUT")
THISFORM.COMMAND6.VISIBLE = IJINMODUL("SIMP", "CETAK")
THISFORM.TEXT4.SETFOCUS
THISFORM.TEXT1.INPUTMASK = DEFAFMTANGG
THISFORM.TEXT41.INPUTMASK = DEFAFMTSIMP
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
IF MMODE="INPUT"
THISFORM.TEXT4.VALUE = TGLNOW
ENDIF
IF MMODE="EDIT" .OR. MMODE="INPUT"
THIS.SETALL("enabled", .T., "Textbox")
THISFORM.SETALL("enabled", .F., "commandbutton")
THISFORM.CMDCATATAN.ENABLED = .F.
THISFORM.CMDAUTO.ENABLED = .F.
THISFORM.CMDBLOKIR.ENABLED = .F.
THISFORM.COMMAND2.ENABLED = .T.
THISFORM.COMMAND3.ENABLED = .T.
THISFORM.TEXT5.ENABLED = .T.
THISFORM.TEXT19.ENABLED = .T.
THISFORM.TEXT38.ENABLED = .T.
THISFORM.TEXT14.ENABLED = .T.
THISFORM.TEXT18.ENABLED = .T.
THISFORM.TEXT20.ENABLED = .T.
THISFORM.TEXT23.ENABLED = .T.
ENDIF
THISFORM.TEXT17.ENABLED = .F.
THISFORM.TEXT21.ENABLED = .F.
THISFORM.TEXT22.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT19.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT16.ENABLED = .F.
THISFORM.TEXT38.VISIBLE = .F.
THISFORM.TEXT14.VISIBLE = .F.
THISFORM.TEXT18.VISIBLE = .F.
THISFORM.TEXT20.VISIBLE = .F.
THISFORM.TEXT23.VISIBLE = .F.
THISFORM.LABEL38.VISIBLE = .F.
THISFORM.LABEL14.VISIBLE = .F.
THISFORM.LABEL20.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.TEXT11.ENABLED = .F.
THISFORM.TEXT12.ENABLED = .F.
THISFORM.TEXT15.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.TEXT35.ENABLED = .F.
THISFORM.TEXT36.ENABLED = .F.
THISFORM.TEXT37.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
IF MMODE="TAMPIL" .OR. MMODE="EDIT"
THISFORM.LABEL33.CAPTION = "NO.BILYET"
THISFORM.LABEL38.VISIBLE = .T.
THISFORM.LABEL14.VISIBLE = .T.
THISFORM.LABEL20.VISIBLE = .T.
THISFORM.LABEL5.VISIBLE = .T.
THISFORM.LABEL6.VISIBLE = .T.
THISFORM.TEXT38.VISIBLE = .T.
THISFORM.TEXT14.VISIBLE = .T.
THISFORM.TEXT18.VISIBLE = .T.
THISFORM.TEXT20.VISIBLE = .T.
THISFORM.TEXT23.VISIBLE = .T.
THISFORM.TEXT16.VISIBLE = .F.
THISFORM.LABEL11.VISIBLE = .F.
IF JENIS='2'
THISFORM.LABEL12.CAPTION = "SALDO POKOK"
THISFORM.LABEL11.VISIBLE = .F.
THISFORM.TEXT16.VISIBLE = .F.
THISFORM.LABEL13.CAPTION = "JASA BLM DIAMBIL"
THISFORM.SHAPE13.VISIBLE = .F.
THISFORM.COMMAND8.VISIBLE = .F.
THISFORM.CMDAUTO.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
ENDIF
WITH THISFORM
SELECT (THISFORM.DATA)
MNOREK = NOREK
MKANTOR = KANTOR
THISFORM.NOBUKU = NOBUKU
.TEXT4.VALUE = TANGGAL
.TEXT32.VALUE = JENIS
.TEXT33.VALUE = PRODUK
.TEXT13.VALUE = MARKETING
.TEXT41.VALUE = NOREK
.TEXT21.VALUE = NOREK_LAMA
.TEXT42.VALUE = NOBUKU
.TEXT1.VALUE = CIF
.TEXT22.VALUE = CIF_LAMA
.TEXT2.VALUE = NAMA
.TEXT3.VALUE = ALAMAT
.TEXT35.VALUE = DESA
.TEXT36.VALUE = KECAMATAN
.TEXT37.VALUE = KOTA
THISFORM.VIEWBILYET()
SELECT (THISFORM.DATA)
.TEXT6.VALUE = 0
.TEXT16.VALUE = 0
.TEXT17.VALUE = 0
.TEXT25.VALUE = KELOMPOK
.TEXT26.VALUE = WILAYAH
.TEXT27.VALUE = IIF(ISNULL(TGLTUTUP), CTOD('0000-00-00'), TGLTUTUP)
.TEXT7.VALUE = SALDO
CSQL = "select keterangan from setsandi where KODE='S000' AND sandi='"+.TEXT32.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
.TEXT10.VALUE = KETERANGAN
.LABEL2.CAPTION = ALLTRIM(KETERANGAN)
.TEXT16.VALUE = 0
DO CASE
CASE .TEXT32.VALUE='1'
CSQL = "select keterangan,saldominimal,ver,a_Rate from setsandi_tab where sandi='"+.TEXT33.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
.TEXT12.VALUE = KETERANGAN
.TEXT16.VALUE = SALDOMINIMAL
MVER = VER
MRATE = A_RATE
THISFORM.TEXT5.VALUE = A_RATE
THISFORM.TEXT19.VALUE = ALLTRIM(STR(MVER))
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='S005' and sandi='"+ALLTRIM(STR(MVER))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT11.VALUE = KETERANGAN
.COMMAND7.VISIBLE = .F.
.COMMAND1.VISIBLE = .F.
.LABEL38.VISIBLE = .F.
.LABEL14.VISIBLE = .F.
.LABEL20.VISIBLE = .F.
.LABEL5.VISIBLE = .F.
.LABEL6.VISIBLE = .F.
.TEXT38.VISIBLE = .F.
.TEXT14.VISIBLE = .F.
.TEXT18.VISIBLE = .F.
.TEXT20.VISIBLE = .F.
.TEXT23.VISIBLE = .F.
.LABEL19.VISIBLE = .F.
.TEXT24.VISIBLE = .F.
CASE .TEXT32.VALUE='2'
CSQL = "select keterangan,saldominimal from setsandi_tab where sandi='"+.TEXT33.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
.TEXT12.VALUE = KETERANGAN
.TEXT16.VALUE = SALDOMINIMAL
.LABEL33.CAPTION = "NO.BILYET"
IF THISFORM.TEXT19.VALUE='E'
THISFORM.TEXT11.VALUE = "HARI EFEKTIF"
ELSE
THISFORM.TEXT11.VALUE = "RATA-RATA"
ENDIF
.LABEL19.VISIBLE = .F.
.TEXT24.VISIBLE = .F.
CASE .TEXT32.VALUE='3'
CSQL = "select keterangan,saldominimal from setsandi_tab where sandi='"+.TEXT33.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
.TEXT12.VALUE = KETERANGAN
.TEXT16.VALUE = SALDOMINIMAL
.COMMAND7.VISIBLE = .F.
IF THISFORM.TEXT19.VALUE='E'
THISFORM.TEXT11.VALUE = "HARI EFEKTIF"
ELSE
THISFORM.TEXT11.VALUE = "RATA-RATA"
ENDIF
.LABEL19.VISIBLE = .F.
.TEXT24.VISIBLE = .F.
ENDCASE
CSQL = "select keterangan from setsandi where KODE='A001' AND sandi='"+.TEXT13.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF ISNULL(KETERANGAN) .OR. EMPTY(KETERANGAN)
.TEXT13.ENABLED = .F.
ELSE
.TEXT15.VALUE = KETERANGAN
ENDIF
CSQL = "select keterangan from setsandi where KODE='S003' AND sandi='"+.TEXT25.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF ISNULL(KETERANGAN) .OR. EMPTY(KETERANGAN)
.TEXT25.ENABLED = .F.
ELSE
.TEXT8.VALUE = KETERANGAN
ENDIF
CSQL = "select keterangan from setsandi where KODE='A003' AND sandi='"+.TEXT26.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF ISNULL(KETERANGAN) .OR. EMPTY(KETERANGAN)
.TEXT26.ENABLED = .F.
ELSE
.TEXT9.VALUE = KETERANGAN
ENDIF
IF THISFORM.TEXT32.VALUE='1'
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(TGLNOW)+"')"
ELSE
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(TGLNOW)+"') and "+"(kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"')"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MSALDO = IIF(ISNULL(SALDO), 0, SALDO)
MSALDO = IIF(VARTYPE(MSALDO)<>"N", MSALDO, MSALDO)
.TEXT7.VALUE = MSALDO
USE
CSQL = "select norek from catatan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MKETCTT = ""
IF NOREK=MNOREK
THISFORM.CHECK3.VALUE = 1
ENDIF
CSQL = "select norek,saldoblokir from simpanan_blokir where norek='"+MNOREK+"' and tglcabut='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOREK=MNOREK
THISFORM.CHECK1.VALUE = 1
THISFORM.TEXT6.VALUE = SALDOBLOKIR
ENDIF
CSQL = "select norek from simpanan_Autodebet where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MKETCTT = ""
IF NOREK=MNOREK
THISFORM.CHECK2.VALUE = 1
ENDIF
USE
IF THISFORM.TEXT32.VALUE='1'
THISFORM.TEXT17.VALUE = MAX(THISFORM.TEXT7.VALUE-THISFORM.TEXT6.VALUE-THISFORM.TEXT16.VALUE, 0)
ELSE
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+ALLTRIM(DEFADEPBG)+"' or kode='"+ALLTRIM(DEFADEPPJK)+"' or kode='"+ALLTRIM(DEFADEPAMBBG)+"' or kode='"+ALLTRIM(DEFADEPPBKBG)+"') "+" and tanggal<='"+SQLDATE(THISFORM.TEXT4.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "Smt")
IF LCEK<1
MESSAGEBOX("Gagal Baca Data", 0, "")
ENDIF
THISFORM.TEXT17.VALUE = IIF(ISNULL(SALDO), 0, SALDO)
ENDIF
ENDWITH
IF MMODE="TAMPIL"
THISFORM.HEIGHT = 525
ENDIF
ELSE
CSQL = "select keterangan from setsandi where KODE='A001' "
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF ISNULL(KETERANGAN) .OR. EMPTY(KETERANGAN)
THISFORM.TEXT13.ENABLED = .F.
ENDIF
CSQL = "select keterangan from setsandi where KODE='S003' "
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF ISNULL(KETERANGAN) .OR. EMPTY(KETERANGAN)
THISFORM.TEXT25.ENABLED = .F.
ELSE
BROWSE
ENDIF
CSQL = "select keterangan from setsandi where KODE='A003' "
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF ISNULL(KETERANGAN) .OR. EMPTY(KETERANGAN)
THISFORM.TEXT26.ENABLED = .F.
ENDIF
ENDIF
SELECT (THISFORM.DATA)
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Deactivate
IF THISFORM.MPOPUP
HIDE POPUP MYMENU
ENDIF
ENDPROC
**
*
*  simpanan_data.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
THISFORM.MYPILIH = THISFORM.TEXT41.VALUE
CSQL = "insert into simpanan (kantor,tanggal,jenis,produk,marketing,norek,nobuku,cif,pokok,"+"rate,carahitung,kelompok,wilayah,saldo) value "+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT13.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+TRANSFORM(.TEXT38.VALUE, '999999999999999')+"',"+"'"+TRANSFORM(.TEXT5.VALUE, '99.99')+"',"+"'"+.TEXT19.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+TRANSFORM(.TEXT7.VALUE, '999999999999999')+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert simpanan")
RETURN
ENDIF
IF THISFORM.TEXT32.VALUE="2"
CSQL = "insert into simpanan_bilyet (kantor,tanggal,norek,pokok,"+"rate,carahitung,lama,tglawal,tgljtempo,aro) value "+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT41.VALUE+"',"+"'"+TRANSFORM(.TEXT38.VALUE, '999999999999999')+"',"+"'"+TRANSFORM(.TEXT5.VALUE, '99.99')+"',"+"'"+.TEXT19.VALUE+"',"+"'"+STR(.TEXT14.VALUE)+"',"+"'"+SQLDATE(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT20.VALUE)+"',"+"'"+.TEXT23.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert Bilyet")
RETURN
ENDIF
SELECT (THISFORM.DATA)
DO FORM simpanan_data_byrbunga WITH THISFORM.TEXT41.VALUE, "", "", "", "INPUT"
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update simpanan set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',jenis='"+.TEXT32.VALUE+"',produk='"+.TEXT33.VALUE+"',marketing='"+.TEXT13.VALUE+"',norek='"+.TEXT41.VALUE+"',nobuku='"+.TEXT42.VALUE+"',cif='"+.TEXT1.VALUE+"',pokok='"+STR(.TEXT38.VALUE)+"',rate='"+TRANSFORM(.TEXT5.VALUE, '999.99')+"',carahitung='"+.TEXT19.VALUE+"',kelompok='"+.TEXT25.VALUE+"',wilayah='"+.TEXT26.VALUE+"',saldo='"+TRANSFORM(.TEXT7.VALUE, '999999999999999')+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan_bilyet set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',pokok='"+STR(.TEXT38.VALUE)+"',rate='"+TRANSFORM(.TEXT5.VALUE, '999.99')+"',carahitung='"+.TEXT19.VALUE+"',lama='"+STR(.TEXT14.VALUE)+"',tglawal='"+SQLDATE(.TEXT18.VALUE)+"',tgljtempo='"+SQLDATE(.TEXT20.VALUE)+"',aro='"+.TEXT23.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF THISFORM.TEXT41.VALUE<>THISFORM.NOREKASAL
CSQL = "update simpanan_mutasi set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan_akrual set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan_autodebet set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan_autodebet_mutasi set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan_bilyet set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan_blokir set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan_bunga set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan_saldo set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update catatan set norek='"+.TEXT41.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
IF THISFORM.MODE="INPUT"
MKELKERJA = RIGHT('0000'+ALLTRIM(KELKERJA), 2)
MNOREK = '01.'+ALLTRIM(THISFORM.TEXT33.VALUE)+MKELKERJA+'.'+ALLTRIM(MCIF)
THISFORM.TEXT25.VALUE = MKELKERJA
CSQL = "select MAX(norek) as norek from simpanan where jenis='"+ALLTRIM(THISFORM.TEXT32.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNOREK = IIF(ISNULL(NOREK), "", NOREK)
MPOS = RAT(".", ALLTRIM(DEFAFMTSIMP))
MREK1 = LEFT(MNOREK, MPOS)
MLEN = LEN(ALLTRIM(SUBSTR(DEFAFMTSIMP, MPOS+1)))
MPOS = RAT(".", MNOREK)
MNOMOR = SUBSTR(MNOREK, MPOS+1)
MNOMOR = ALLTRIM(STR(VAL(MNOMOR)+1))
MNOREK = MREK1+RIGHT("000000000000000"+MNOMOR, MLEN)
THISFORM.TEXT41.VALUE = MNOREK
ENDIF
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
THIS.ADA = 1
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::Text25
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "S003"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='S003' AND sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Kelompok tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT8.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Kelompok tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::Text26
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "A003"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='A003' AND sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Wilayah tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT9.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Wilayah tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::Text32
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
SELECT (THISFORM.DATA)
IF EMPTY(THIS.VALUE)
IF .T.
OLDSELECT = SELECT()
CSQL = "select * from setsandi where kantor='"+DEFAKANTOR+"' and KODE='S000'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF  .NOT. (SANDI='1' .OR. SANDI='2' .OR. SANDI='3')
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan) value "+"('"+DEFAKANTOR+"','S000','1','TABUNGAN'), ('"+DEFAKANTOR+"','S000','2','SIMPANAN BERJANGKA'),('"+DEFAKANTOR+"','S000','3','PENYERTAAN')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
USE
SELECT (OLDSELECT)
DO FORM ./form/setsandi TO MSANDI WITH "S000"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = ALLTRIM(THIS.VALUE)
ENDIF
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='S000' AND sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Produk tabungan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT10.VALUE = KETERANGAN
THISFORM.LABEL2.CAPTION = TRIM(KETERANGAN)
ENDIF
USE
MSANDI = THISFORM.TEXT32.VALUE
THISFORM.TEXT17.ENABLED = .F.
THISFORM.TEXT21.ENABLED = .F.
THISFORM.TEXT22.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT19.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT16.ENABLED = .F.
THISFORM.TEXT38.ENABLED = .F.
THISFORM.TEXT14.ENABLED = .F.
THISFORM.TEXT18.ENABLED = .F.
THISFORM.TEXT20.ENABLED = .F.
THISFORM.TEXT23.ENABLED = .F.
DO CASE
CASE MSANDI='1'
THISFORM.LABEL33.CAPTION = "NO.BUKU TABUNGAN"
THISFORM.COMMAND8.VISIBLE = .T.
THISFORM.CMDAUTO.VISIBLE = .T.
THISFORM.CHECK2.VISIBLE = .T.
THISFORM.COMMAND7.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.LABEL19.VISIBLE = .F.
THISFORM.TEXT24.VISIBLE = .F.
CASE MSANDI='2'
THISFORM.LABEL33.CAPTION = "NO.BILYET"
THISFORM.TEXT5.ENABLED = .T.
THISFORM.TEXT19.ENABLED = .T.
THISFORM.TEXT38.ENABLED = .T.
THISFORM.TEXT14.ENABLED = .T.
THISFORM.TEXT18.ENABLED = .T.
THISFORM.TEXT20.ENABLED = .T.
THISFORM.TEXT23.ENABLED = .T.
IF THISFORM.MODE="INPUT"
THISFORM.TEXT19.VALUE = "R"
THISFORM.TEXT11.VALUE = "RATA-RATA"
ENDIF
THISFORM.LABEL38.VISIBLE = .T.
THISFORM.LABEL14.VISIBLE = .T.
THISFORM.LABEL20.VISIBLE = .T.
THISFORM.LABEL5.VISIBLE = .T.
THISFORM.LABEL6.VISIBLE = .T.
THISFORM.TEXT38.VISIBLE = .T.
THISFORM.TEXT14.VISIBLE = .T.
THISFORM.TEXT18.VISIBLE = .T.
THISFORM.TEXT20.VISIBLE = .T.
THISFORM.TEXT23.VISIBLE = .T.
THISFORM.LABEL19.VISIBLE = .T.
THISFORM.TEXT24.VISIBLE = .T.
THISFORM.TEXT16.VISIBLE = .F.
THISFORM.LABEL11.VISIBLE = .F.
THISFORM.LABEL12.CAPTION = "SALDO POKOK"
THISFORM.LABEL11.VISIBLE = .F.
THISFORM.TEXT16.VISIBLE = .F.
THISFORM.LABEL13.CAPTION = "JASA BLM DIAMBIL"
THISFORM.SHAPE13.VISIBLE = .F.
THISFORM.TEXT23.VALUE = "Y"
THISFORM.COMMAND8.VISIBLE = .F.
THISFORM.CMDAUTO.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
THISFORM.COMMAND7.VISIBLE = .T.
THISFORM.COMMAND1.VISIBLE = .T.
CASE MSANDI='3'
THISFORM.LABEL33.CAPTION = "NO.SERTIFIKAT"
THISFORM.TEXT5.ENABLED = .T.
THISFORM.TEXT19.ENABLED = .T.
THISFORM.TEXT38.ENABLED = .T.
OTHERWISE
THISFORM.LABEL33.CAPTION = "NO.BUKU/BILYET/SERTIF"
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::Text33
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
SELECT (THISFORM.DATA)
IF THISFORM.MODE="EDIT" .AND. ALLTRIM(THIS.VALUE)=ALLTRIM(PRODUK)
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO CASE
CASE THISFORM.TEXT32.VALUE='1'
DO FORM ./form/setsandi TO MSANDI WITH "S01A"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
CASE THISFORM.TEXT32.VALUE='2'
DO FORM ./form/setsandi TO MSANDI WITH "S01B"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
CASE THISFORM.TEXT32.VALUE='3'
DO FORM ./form/setsandi TO MSANDI WITH "S01C"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDCASE
ENDIF
ELSE
MSANDI = THISFORM.TEXT33.VALUE
ENDIF
DO CASE
CASE THISFORM.TEXT32.VALUE='1'
CSQL = "select sandi,keterangan,a_rate,ver from setsandi_tab where jenis='1' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Produk tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT12.VALUE = KETERANGAN
THISFORM.TEXT5.VALUE = A_RATE
THISFORM.TEXT19.VALUE = ALLTRIM(STR(VER))
SELECT SMT
USE
CSQL = "select sandi,keterangan from setsandi where KODE='S005' AND sandi='"+THISFORM.TEXT19.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
THISFORM.TEXT11.VALUE = KETERANGAN
ENDIF
ELSE
MESSAGEBOX("Kode Produk tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
CASE THISFORM.TEXT32.VALUE='2'
CSQL = "select sandi,keterangan,a_rate,ver from setsandi_tab where  jenis='2' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Produk tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT12.VALUE = KETERANGAN
THISFORM.TEXT5.VALUE = A_RATE
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Produk tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
CASE THISFORM.TEXT32.VALUE='3'
CSQL = "select sandi,keterangan,a_rate,ver from setsandi_tab where  jenis='3' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Produk tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT12.VALUE = KETERANGAN
THISFORM.TEXT5.VALUE = A_RATE
THISFORM.TEXT19.VALUE = STR(VER)
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Produk tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDCASE
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF THISFORM.MODE="EDIT" .AND. ALLTRIM(THIS.VALUE)=ALLTRIM(THISFORM.NOREKASAL)
RETURN
ENDIF
OLDSELECT = SELECT()
CSQL = "select norek from simpanan where norek=?this.value"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Produk tidak terbaca")
ENDIF
IF RECCOUNT()=0
SELECT SMT
USE
SELECT (OLDSELECT)
ELSE
MESSAGEBOX("Nomor Rekening Sudah Ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
SELECT (OLDSELECT)
RETURN
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::Text42
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
IF THISFORM.MODE="EDIT" .AND. THIS.VALUE=THISFORM.NOBUKU
RETURN
ENDIF
LOCAL OLDSELECT, MNOBUKU
OLDSELECT = SELECT()
CSQL = "select nobuku from simpanan where nobuku='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOBUKU = NOBUKU
USE
SELECT (OLDSELECT)
IF MNOBUKU=THIS.VALUE
NODEFAULT
THIS.SETFOCUS
MESSAGEBOX("NOMOR sudah pernah masuk", 16, "PERINGATAN")
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data.scx::Cmdcatatan
**
PROCEDURE Click
DO FORM catatan WITH "SIMP", NOREK
ENDPROC
**
*
*  simpanan_data.scx::Command6
**
PROCEDURE RightClick
DO FORM set_laporan WITH "SIM"
ENDPROC
**
PROCEDURE Click
SELECT (THISFORM.DATA)
OLDDBF = SELECT()
MBRSBUKU = BRSBUKU
IF THISFORM.MPOPUP=.F.
THISFORM.MPOPUP = .T.
MNAMA = THISFORM.TEXT2.VALUE
MALAMAT = THISFORM.TEXT3.VALUE
MNOREK = THISFORM.TEXT41.VALUE
MCIF = THISFORM.TEXT1.VALUE
MDEPT = "SIM"
MKEL = '1'
IF THISFORM.TEXT32.VALUE='1'
DEFINE POPUP MYMENU FROM 6, 93 FONT "Cambria", 10 TITLE "CETAK LAPORAN" SHADOW MARGIN
DEFINE BAR 1 OF MYMENU PROMPT "1. LAPORAN INTERN (CUSTOMIZE)"
DEFINE BAR 2 OF MYMENU PROMPT "2. CETAK REKENING KORAN"
DEFINE BAR 3 OF MYMENU PROMPT "3. SIMULASI PERHITUNGAN JASA"
DEFINE BAR 4 OF MYMENU PROMPT "4. CETAK HEADER BUKU TABUNGAN"
DEFINE BAR 5 OF MYMENU PROMPT "5. CETAK MUTASI TABUNGAN"
CSQL = "select * from set_print where dept='"+MDEPT+"' and kel='"+MKEL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
ON BAR 1 OF MYMENU ACTIVATE POPUP NAMAMENU
DEFINE POPUP NAMAMENU TITLE "CUSTOM REPORT" RELATIVE SCROLL
A = 1
DO WHILE  .NOT. EOF()
AA = "DEFINE BAR "+STR(A)+" OF NamaMenu PROMPT '"+NAMA_MENU+"'"
&AA
BB = "ON SELECTION BAR "+STR(A)+" OF NamaMenu cetaktemp('"+TEMPLATE_ID+"','"+NAMA_MENU+"','"+MNOREK+"')"
&BB
A = A+1
SKIP
ENDDO
ENDIF
USE
SELECT (OLDDBF)
ON SELECTION BAR 2 OF MYMENU DO FORM SIMP_LAP2 WITH 1
ON SELECTION BAR 3 OF MYMENU DO FORM SIMPANAN_SIMULASI
ON SELECTION BAR 4 OF MYMENU CETAKHEAD1(MNOREK)
ON SELECTION BAR 5 OF MYMENU DO FORM SIMPANAN_CETAK_BUKU WITH MNOREK,MBRSBUKU
ACTIVATE POPUP MYMENU
SELECT (OLDDBF)
ELSE
DEFINE POPUP MYMENU FROM 6, 93 FONT "Cambria", 10 TITLE "CETAK LAPORAN" SHADOW MARGIN
DEFINE BAR 1 OF MYMENU PROMPT "1. LAPORAN INTERN (CUSTOMIZE)"
DEFINE BAR 2 OF MYMENU PROMPT "2. CETAK REKENING KORAN"
DEFINE BAR 3 OF MYMENU PROMPT "3. SIMULASI PERHITUNGAN JASA"
DEFINE BAR 4 OF MYMENU PROMPT "4. CETAK BILYET"
CSQL = "select * from set_print where dept='"+MDEPT+"' and kel='"+MKEL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
ON BAR 1 OF MYMENU ACTIVATE POPUP NAMAMENU
DEFINE POPUP NAMAMENU TITLE "CUSTOM REPORT" RELATIVE SCROLL
A = 1
DO WHILE  .NOT. EOF()
AA = "DEFINE BAR "+STR(A)+" OF NamaMenu PROMPT '"+NAMA_MENU+"'"
&AA
BB = "ON SELECTION BAR "+STR(A)+" OF NamaMenu cetaktemp('"+TEMPLATE_ID+"','"+NAMA_MENU+"','"+MNOREK+"')"
&BB
A = A+1
SKIP
ENDDO
ENDIF
USE
SELECT (OLDDBF)
ON SELECTION BAR 2 OF MYMENU DO FORM SIMP_LAP2 WITH 1
ON SELECTION BAR 3 OF MYMENU DO FORM SIMPANAN_SIMULASI
ON SELECTION BAR 4 OF MYMENU SIMPANAN_CETAK_BILYET(MNOREK)
ACTIVATE POPUP MYMENU
SELECT (OLDDBF)
ENDIF
ELSE
SHOW POPUP MYMENU
ENDIF
RELEASE POPUPS MYMENU
THISFORM.MPOPUP = .F.
ENDPROC
**
*
*  simpanan_data.scx::Command1
**
PROCEDURE Click
DO FORM simpanan_data_byrbunga WITH THISFORM.TEXT41.VALUE, BUNGA_KE, BUNGA_REK, BUNGA_NAMA, "TAMPIL"
ENDPROC
**
*
*  simpanan_data.scx::Text23
**
FUNCTION Valid
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF THIS.VALUE="Y" .OR. THIS.VALUE="T"
RETURN .T.
ENDIF
RETURN .F.
ENDFUNC
**
*
*  simpanan_data.scx::Text14
**
PROCEDURE LostFocus
THISFORM.TEXT18.VALUE = THISFORM.TEXT4.VALUE
ENDPROC
**
*
*  simpanan_data.scx::Text38
**
PROCEDURE LostFocus
THISFORM.TEXT7.VALUE = THIS.VALUE
ENDPROC
**
*
*  simpanan_data.scx::Text19
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF THISFORM.TEXT32.VALUE='2'
IF THIS.VALUE='E'
THISFORM.TEXT11.VALUE = "HARI EFEKTIF"
ELSE
IF THIS.VALUE='R'
THISFORM.TEXT11.VALUE = "RATA-RATA"
ELSE
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
IF EMPTY(THIS.VALUE)
IF LASTKEY()=13
DO FORM ./form/setsandi TO MSANDI WITH "S005"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='S005' AND sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Cara Hitung, tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT11.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Cara Hitung Bunga, tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::Text18
**
PROCEDURE LostFocus
MTGL = THIS.VALUE
FOR A = 1 TO THISFORM.TEXT14.VALUE
MTGL = MAJU1BLN(MTGL)
ENDFOR
THISFORM.TEXT20.VALUE = MTGL
ENDPROC
**
*
*  simpanan_data.scx::Text13
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "A001"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where KODE='A001' AND sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Marketing tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT15.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Marketing tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
MKDTR = ' '
DO CASE
CASE THISFORM.TEXT32.VALUE='1'
MKDTR = '2'
CASE THISFORM.TEXT32.VALUE='2'
MKDTR = '3'
CASE THISFORM.TEXT32.VALUE='3'
MKDTR = '4'
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simpanan_data.scx::CmdBlokir
**
PROCEDURE Click
DO FORM .\form\simpanan_blokir WITH NOREK
ENDPROC
**
*
*  simpanan_data.scx::Cmdauto
**
PROCEDURE Click
DO FORM simpanan_autodebet
ENDPROC
**
*
*  simpanan_data.scx::Command4
**
PROCEDURE Click
IF THISFORM.TEXT32.VALUE='1'
DO FORM simpanan_mutasi WITH "TAMPIL"
ELSE
DO FORM simpanan_mutasi_dep WITH "TAMPIL"
ENDIF
ENDPROC
**
*
*  simpanan_data.scx::Text22
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
THIS.ADA = 1
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
MNOREK = '01.'+ALLTRIM(THISFORM.TEXT33.VALUE)+ALLTRIM(KELKERJA)+'.'+ALLTRIM(MCIF)
THISFORM.TEXT41.VALUE = MNOREK
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  simpanan_data.scx::Command5
**
PROCEDURE Click
DO FORM anggota_data WITH "TAMPIL", IDDATA
ENDPROC
**
*
*  simpanan_data.scx::Command7
**
PROCEDURE Click
OLDSELECT = SELECT()
DO FORM simpanan_perpanjangan WITH THISFORM.TEXT41.VALUE, NAMA
SELECT (OLDSELECT)
THISFORM.VIEWBILYET()
ENDPROC
**
*
*  simpanan_data.scx::Command8
**
PROCEDURE Click
OLDSELECT = SELECT()
DO FORM simpanan_data_khusus WITH NOREK, BUNGA_KE, BUNGA_REK, BUNGA_NAMA
SELECT (OLDSELECT)
ENDPROC
**
*
*  simpanan_data.scx::Command9
**
PROCEDURE Click
DO FORM simpanan_lainnya WITH THISFORM.TEXT41.VALUE
ENDPROC
**
*
*  simpanan_data.scx::Command10
**
PROCEDURE Click
OLDSELECT = SELECT()
DO FORM anggota_pindah WITH CIF
SELECT (OLDSELECT)
ENDPROC
**
***
*** simpanan_data.sct
***
*
***
*** anggota_fasilitas.scx
***
*
*
*  anggota_fasilitas.scx::FORM1
**
PROCEDURE bacadata
MCIF = THISFORM.CIF
CSQL = "select jenis,CONVERT(if(jenis='1','SIMPANAN',if(produk='2','SIMPANAN BERJNGKA','PENYERTAAN'))USING latin1) as produk, norek,b.tanggal,"+"pokok as jumlah,tgltutup from simpanan as b "+"where cif='"+MCIF+"' and b.tgltutup='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SELECT SMT
DO WHILE  .NOT. EOF()
MPRODUK = PRODUK
MNOREK = NOREK
MTANGGAL = TANGGAL
MJUMLAH = JUMLAH
MTGLTUTUP = TGLTUTUP
MJENIS = JENIS
CSQL = "select saldo from simpanan_mutasi as a where norek='"+MNOREK+"' and iddata=(select max(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(TGLNOW)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt01")
MSALDO = SALDO
USE
SELECT (THISFORM.DATA1)
APPEND BLANK
REPLACE JENIS WITH MJENIS
REPLACE PRODUK WITH MPRODUK
REPLACE NOREK WITH MNOREK
REPLACE TANGGAL WITH MTANGGAL
REPLACE JUMLAH WITH MSALDO
SELECT SMT
SKIP
ENDDO
CSQL = "select CONVERT('PINJAMAN' USING latin1) as produk, norek,b.tanggal,"+"pokok as jumlah,tgllunas from anggota as a, pinjaman as b "+"where a.cif='"+MCIF+"' and a.cif=b.cif and b.tgllunas='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SELECT SMT
DO WHILE  .NOT. EOF()
MPRODUK = PRODUK
MNOREK = NOREK
MTANGGAL = TANGGAL
MJUMLAH = JUMLAH
MTGLTUTUP = TGLLUNAS
SELECT (THISFORM.DATA1)
APPEND BLANK
REPLACE PRODUK WITH MPRODUK
REPLACE NOREK WITH MNOREK
REPLACE TANGGAL WITH MTANGGAL
REPLACE JUMLAH WITH MJUMLAH
SELECT SMT
SKIP
ENDDO
CSQL = "select CONVERT(if(jenis='1','SIMPANAN',if(produk='2','SIMPANAN BERJANGKA','PENYERTAAN')) USING latin1) as produk, norek,b.tanggal,"+"pokok as jumlah,b.tgltutup from anggota as a, simpanan as b "+"where a.cif='"+MCIF+"' and a.cif=b.cif and b.tgltutup<>'0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SELECT SMT
DO WHILE  .NOT. EOF()
MPRODUK = PRODUK
MNOREK = NOREK
MTANGGAL = TANGGAL
MJUMLAH = JUMLAH
MTGLTUTUP = TGLTUTUP
SELECT (THISFORM.DATA2)
APPEND BLANK
REPLACE PRODUK WITH MPRODUK
REPLACE NOREK WITH MNOREK
REPLACE TANGGAL WITH MTANGGAL
REPLACE JUMLAH WITH MJUMLAH
REPLACE TGLSELESAI WITH MTGLTUTUP
SELECT SMT
SKIP
ENDDO
CSQL = "select CONVERT('PINJAMAN' USING latin1) as produk, norek,b.tanggal,"+"pokok as jumlah,tgllunas from anggota as a, pinjaman as b "+"where a.cif='"+MCIF+"' and a.cif=b.cif and b.tgllunas<>'0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
SELECT SMT
DO WHILE  .NOT. EOF()
MPRODUK = PRODUK
MNOREK = NOREK
MTANGGAL = TANGGAL
MJUMLAH = JUMLAH
MTGLTUTUP = TGLLUNAS
SELECT (THISFORM.DATA2)
APPEND BLANK
REPLACE PRODUK WITH MPRODUK
REPLACE NOREK WITH MNOREK
REPLACE TANGGAL WITH MTANGGAL
REPLACE JUMLAH WITH MJUMLAH
REPLACE TGLSELESAI WITH MTGLTUTUP
SELECT SMT
SKIP
ENDDO
ENDPROC
**
PROCEDURE tampil
MYDATA = THISFORM.DATA1
SELECT (MYDATA)
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 4
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "PRODUK"
.COLUMN1.HEADER1.CAPTION = "PRODUK"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 100
.COLUMN2.CONTROLSOURCE = "NOREK"
.COLUMN2.HEADER1.CAPTION = "NO.REKENING"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "TANGGAL"
.COLUMN3.HEADER1.CAPTION = "TGL BUKA"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 100
.COLUMN4.ALIGNMENT = 1
.COLUMN4.CONTROLSOURCE = "JUMLAH"
.COLUMN4.HEADER1.CAPTION = "JUMLAH"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN4.INPUTMASK = "999,999,999,999"
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.SETFOCUS
MYDATA = THISFORM.DATA2
SELECT &MYDATA  
WITH THISFORM.GRID2
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 5
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "PRODUK"
.COLUMN1.HEADER1.CAPTION = "PRODUK"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 100
.COLUMN2.CONTROLSOURCE = "NOREK"
.COLUMN2.HEADER1.CAPTION = "NO.REKENING"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "TANGGAL"
.COLUMN3.HEADER1.CAPTION = "TGL BUKA"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 100
.COLUMN4.ALIGNMENT = 1
.COLUMN4.CONTROLSOURCE = "JUMLAH"
.COLUMN4.HEADER1.CAPTION = "JUMLAH"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "TGLSELESAI"
.COLUMN5.HEADER1.CAPTION = "TGL TUTUP"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.REFRESH
ENDWITH
THISFORM.GRID2.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID2.SETFOCUS
ENDPROC
**
PROCEDURE bacasmt
PARAMETER XPARA, XNOREK
MSMT = THISFORM.DATASMT
IF XPARA='TABUNGAN' .OR. XPARA='DEPOSITO' .OR. XPARA='SIMPANAN'
CSQL = "select a.*,b.* from anggota as a, simpanan as b where a.cif=b.cif and b.norek='"+XNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, MSMT)
ENDIF
IF XPARA='PINJAMAN'
CSQL = "select a.cif,a.cif_lama,a.nama,a.alamat,a.desa,a.kecamatan,a.kota,a.ibu,a.agama,a.tglkeluar,b.* from anggota as a, pinjaman as b where a.cif=b.cif and b.norek='"+XNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, MSMT)
ENDIF
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.DATA2)
USE
SELECT (THISFORM.MSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
THISFORM.MSELECT = SELECT()
OLDSELECT = THISFORM.MSELECT
THISFORM.DATA1 = SYS(2015)
THISFORM.DATA2 = SYS(2015)
THISFORM.DATASMT = SYS(2015)
MDATA1 = THISFORM.DATA1
MDATA2 = THISFORM.DATA2
CREATE CURSOR &MDATA1 (JENIS CHAR(1),PRODUK CHAR(10), NOREK CHAR(25), TANGGAL DATE, JUMLAH INT(15)) 
CREATE CURSOR &MDATA2 (JENIS CHAR(1),PRODUK CHAR(10), NOREK CHAR(25), TANGGAL DATE, JUMLAH INT(15), TGLSELESAI DATE) 
SELECT (OLDSELECT)
THISFORM.TEXT1.SETFOCUS
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = DESA
THISFORM.TEXT5.VALUE = KECAMATAN
THISFORM.TEXT6.VALUE = KOTA
THISFORM.CIF = CIF
THISFORM.BACADATA()
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Load
THISFORM.MSELECT = SELECT()
ENDPROC
**
*
*  anggota_fasilitas.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_fasilitas.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_fasilitas.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO CASE
CASE PRODUK="SIMPANAN"
THISFORM.BACASMT("TABUNGAN", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\simpanan_data WITH "TAMPIL"
CASE PRODUK="DEPOSITO"
THISFORM.BACASMT("DEPOSITO", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\simpanan_data WITH "TAMPIL"
CASE PRODUK="PINJAMAN"
THISFORM.BACASMT("PINJAMAN", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\pinjaman_data WITH "TAMPIL"
ENDCASE
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO CASE
CASE PRODUK="SIMPANAN"
THISFORM.BACASMT("TABUNGAN", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\simpanan_data WITH "TAMPIL"
CASE PRODUK="DEPOSITO"
THISFORM.BACASMT("DEPOSITO", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\simpanan_data WITH "TAMPIL"
CASE PRODUK="PINJAMAN"
THISFORM.BACASMT("PINJAMAN", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\pinjaman_data WITH "TAMPIL"
ENDCASE
ENDPROC
**
*
*  anggota_fasilitas.scx::Grid2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO CASE
CASE PRODUK="TABUNGAN"
THISFORM.BACASMT("TABUNGAN", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\simpanan_data WITH "TAMPIL"
CASE PRODUK="DEPOSITO"
THISFORM.BACASMT("DEPOSITO", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\simpanan_data WITH "TAMPIL"
CASE PRODUK="PINJAMAN"
THISFORM.BACASMT("PINJAMAN", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\pinjaman_data WITH "TAMPIL"
ENDCASE
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO CASE
CASE PRODUK="SIMPANAN"
THISFORM.BACASMT("TABUNGAN", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\simpanan_data WITH "TAMPIL"
CASE PRODUK="DEPOSITO"
THISFORM.BACASMT("DEPOSITO", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\simpanan_data WITH "TAMPIL"
CASE PRODUK="PINJAMAN"
THISFORM.BACASMT("PINJAMAN", NOREK)
SELECT (THISFORM.DATASMT)
DO FORM .\form\pinjaman_data WITH "TAMPIL"
ENDCASE
ENDPROC
**
***
*** anggota_fasilitas.sct
***
*
***
*** setsandi.scx
***
*
*
*  setsandi.scx::FORM1
**
PROCEDURE tampildata
MDATASANDI = THISFORM.MYCURSOR
MKODE = THISFORM.MYKODE
MFILTER = THISFORM.MFILTER
DO CASE
CASE MKODE="GL01"
CSQL = "SELECT * from perkiraan where  "+MFILTER+" order by noper"
LCEK = SQLEXEC(OODBC, CSQL, MDATASANDI)
IF LCEK<0
MESSAGEBOX("tidak bisa baca Daftar Perkiraan")
RETURN
ENDIF
THISFORM.GRID1.RECORDSOURCE = MDATASANDI
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "NOPER"
.COLUMN1.FORMAT = "R"
.COLUMN1.INPUTMASK = DEFAFMTAKT
.COLUMN1.HEADER1.CAPTION = "NOPER"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "space((MAX(VAL(level)-1,0))*5)+NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "KEL"
.COLUMN3.HEADER1.CAPTION = "KELOMPOK"
.COLUMN3.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.REFRESH
CASE MKODE="S01A"
CSQL = "SELECT * from setsandi_tab where jenis='1' and kantor='"+DEFAKANTOR+"' and "+MFILTER
LCEK = SQLEXEC(OODBC, CSQL, MDATASANDI)
IF LCEK<0
MESSAGEBOX("tidak bisa baca Setting Sandi")
RETURN
ENDIF
THISFORM.GRID1.RECORDSOURCE = MDATASANDI
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 2
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "SANDI"
.COLUMN1.HEADER1.CAPTION = "KD PRODUK"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "NAMA PRODUK"
.COLUMN2.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.REFRESH
CASE MKODE="S01B"
CSQL = "SELECT * from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='2'  and "+MFILTER
LCEK = SQLEXEC(OODBC, CSQL, MDATASANDI)
IF LCEK<0
MESSAGEBOX("tidak bisa baca Setting Sandi simpanan berjangka")
RETURN
ENDIF
THISFORM.GRID1.RECORDSOURCE = MDATASANDI
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "SANDI"
.COLUMN1.HEADER1.CAPTION = "KD PRODUK"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "NAMA PRODUK"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 50
.COLUMN3.CONTROLSOURCE = "VER"
.COLUMN3.HEADER1.CAPTION = "VERSI"
.COLUMN3.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.REFRESH
CASE MKODE="S01C"
CSQL = "SELECT * from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='3'  and "+MFILTER
LCEK = SQLEXEC(OODBC, CSQL, MDATASANDI)
IF LCEK<0
MESSAGEBOX("tidak bisa baca Setting Sandi")
RETURN
ENDIF
THISFORM.GRID1.RECORDSOURCE = MDATASANDI
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 2
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "SANDI"
.COLUMN1.HEADER1.CAPTION = "KD PRODUK"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "NAMA PRODUK"
.COLUMN2.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.REFRESH
CASE MKODE="S002"
CSQL = "SELECT * from setsandi where kode like'"+MKODE+"'  and "+MFILTER+" order by sandi"
LCEK = SQLEXEC(OODBC, CSQL, MDATASANDI)
IF LCEK<0
MESSAGEBOX("tidak bisa baca Setting Sandi")
RETURN
ENDIF
THISFORM.GRID1.RECORDSOURCE = MDATASANDI
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "SANDI"
.COLUMN1.HEADER1.CAPTION = "NOMOR"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "KETERANGAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 50
.COLUMN3.CONTROLSOURCE = "KET2"
.COLUMN3.HEADER1.CAPTION = "KD MTS"
.COLUMN3.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.REFRESH
CASE MKODE="P001"
CSQL = "SELECT * from setsandi_pinj where kantor='"+DEFAKANTOR+"' and "+MFILTER
LCEK = SQLEXEC(OODBC, CSQL, MDATASANDI)
IF LCEK<0
MESSAGEBOX("tidak bisa baca setting")
RETURN
ENDIF
THISFORM.GRID1.RECORDSOURCE = MDATASANDI
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 2
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "SANDI"
.COLUMN1.HEADER1.CAPTION = "SANDI"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "KETERANGAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.REFRESH
OTHERWISE
CSQL = "SELECT * from setsandi where kantor='"+DEFAKANTOR+"' and kode like'"+MKODE+"'  and "+MFILTER+" order by sandi"
LCEK = SQLEXEC(OODBC, CSQL, MDATASANDI)
IF LCEK<0
MESSAGEBOX("tidak bisa baca setting")
RETURN
ENDIF
THISFORM.GRID1.RECORDSOURCE = MDATASANDI
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 2
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "SANDI"
.COLUMN1.HEADER1.CAPTION = "SANDI"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "KETERANGAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.REFRESH
ENDCASE
THISFORM.TAMPILGRID()
ENDPROC
**
PROCEDURE tampilgrid
DO CASE
CASE THISFORM.MYKODE="GL01"
MDATA = NOPER
CASE THISFORM.MYKODE="S01A" .OR. THISFORM.MYKODE="S01B" .OR. THISFORM.MYKODE="S01C"
MDATA = SANDI
CASE THISFORM.MYKODE="P001"
MDATA = SANDI
OTHERWISE
MDATA = KODE
ENDCASE
IF THISFORM.MYKODE<>"S000"
IF EMPTY(MDATA)
THISFORM.CMDEDIT.ENABLED = .F.
THISFORM.CMDHAPUS.ENABLED = .F.
ELSE
THISFORM.CMDEDIT.ENABLED = .T.
THISFORM.CMDHAPUS.ENABLED = .T.
ENDIF
ENDIF
ENDPROC
**
PROCEDURE Activate
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE Init
PARAMETER MKODE, MMODE
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("SET", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("SET", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("SET", "HAPUS")
MMODE = IIF(VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L", "CARI", MMODE)
THISFORM.MODE = MMODE
THISFORM.MFILTER = "1"
THISFORM.OLDSELECT = SELECT()
IF MMODE="TAMPIL"
THISFORM.HEIGHT = 550
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDOKE.VISIBLE = .F.
THISFORM.TOP = (_SCREEN.HEIGHT-THISFORM.HEIGHT)/2
ENDIF
THISFORM.MYCURSOR = SYS(2015)
THISFORM.MYKODE = MKODE
THISFORM.CMDDETAIL.VISIBLE = .F.
DO CASE
CASE MKODE="A001"
MJUDUL = "KODE MARKETING"
CASE MKODE="A002"
MJUDUL = "KODE KOTA"
CASE MKODE="A003"
MJUDUL = "WILAYAH / AREA PEMASARAN"
CASE MKODE="S000"
MJUDUL = "JENIS SIMPANAN"
THISFORM.CMDEDIT.ENABLED = .F.
THISFORM.CMDINPUT.ENABLED = .F.
THISFORM.CMDHAPUS.ENABLED = .F.
CASE MKODE="S01A"
MJUDUL = "SETTING PRODUK TABUNGAN"
THISFORM.CMDDETAIL.VISIBLE = .T.
CASE MKODE="S01B"
MJUDUL = "SETTING SIMPANAN BERJANGKA"
THISFORM.CMDDETAIL.VISIBLE = .T.
CASE MKODE="S01C"
MJUDUL = "SETTING MODAL PENYERTAAN"
THISFORM.CMDDETAIL.VISIBLE = .T.
CASE MKODE="S002"
MJUDUL = "KODE MUTASI SIMPANAN"
CSQL = "select sandi from setsandi where kode='S002'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
LOCATE FOR ALLTRIM(SANDI)='1'
IF SANDI<>'1'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','01','SETORAN TUNAI','01')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='2'
IF SANDI<>'2'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','02','PENGAMBILAN TUNAI','02')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='3'
IF SANDI<>'3'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','03','SETORAN VIA BANK','03')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='4'
IF SANDI<>'4'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','04','PENGAMBILAN VIA BANK','04')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='5'
IF SANDI<>'5'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','05','BUNGA DEPOSITO','05')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='6'
IF SANDI<>'6'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','06','BUNGA TABUNGAN','06')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='7'
IF SANDI<>'7'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','07','PAJAK ATAS BUNGA','07')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='8'
IF SANDI<>'8'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','08','ADMINISTRASI','08')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='9'
IF SANDI<>'9'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','09','KOREKSI','09')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
LOCATE FOR ALLTRIM(SANDI)='10'
IF SANDI<>'10'
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value (defakantor,'S002','10','OVERBOOKING','10')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
USE
SELECT (THISFORM.OLDSELECT)
CASE MKODE="S003"
MJUDUL = "KELOMPOK SIMPANAN"
CASE MKODE="S004"
MJUDUL = "WILAYAH SIMPANAN"
CASE MKODE="S005"
MJUDUL = "CARA HITUNG BUNGA"
CASE MKODE="P001"
MJUDUL = "PRODUK PINJAMAN"
THISFORM.CMDDETAIL.VISIBLE = .T.
CASE MKODE="P002"
MJUDUL = "CARA PERHITUNGAN"
CASE MKODE="P004"
MJUDUL = "WILAYAH PINJAMAN"
CASE MKODE="P003"
MJUDUL = "KELOMPOK PINJAMAN"
CASE MKODE="P005"
MJUDUL = "JENIS PENGGUNAAN"
CASE MKODE="P006"
MJUDUL = "SEKTOR EKONOMI"
CASE MKODE="P007"
MJUDUL = "SUMBER PELUNASAN"
CASE MKODE="P008"
MJUDUL = "JENIS JAMINAN PINJAMAN"
CASE MKODE="P009"
MJUDUL = "PENGIKATAN BARANG BERGERAK"
CASE MKODE="P010"
MJUDUL = "PENGIKATAN TANAH & BANGUNAN"
CASE MKODE="P011"
MJUDUL = "PENGIKATAN CASH COLLATERAL"
CASE MKODE="P012"
MJUDUL = "PENGIKATAN JAMINAN LAINNYA"
CASE MKODE="P013"
MJUDUL = "NOTARIS"
CASE MKODE="P014"
MJUDUL = "ASURANSI"
CASE MKODE="GL01"
MJUDUL = "DAFTAR PERKIRAAN AKUNTANSI"
THISFORM.CMDDETAIL.VISIBLE = .T.
THISFORM.TOP = 10
THISFORM.HEIGHT = 570
CASE MKODE="C002"
MJUDUL = "DAFTAR INSTANSI"
CASE MKODE="P003"
MJUDUL = "DAFTAR KOLEKTOR"
CASE MKODE="0001"
THISFORM.CMDDETAIL.VISIBLE = .T.
OTHERWISE
MJUDUL = "BELUM TERDAFTAR"
ENDCASE
THISFORM.LABEL2.CAPTION = MJUDUL
THISFORM.LABEL1.CAPTION = MJUDUL
THISFORM.TAMPILDATA()
ENDPROC
**
FUNCTION Unload
MDATASANDI = THISFORM.MYCURSOR
IF ALIAS()=MDATASANDI
USE
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  setsandi.scx::Cmdoke
**
PROCEDURE Click
IF THISFORM.MYKODE="GL01"
THISFORM.MYPILIH = NOPER
ELSE
THISFORM.MYPILIH = SANDI
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  setsandi.scx::Cmdbatal
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  setsandi.scx::Cmdinput
**
PROCEDURE Click
LOCAL MREC
MKODE = THISFORM.MYKODE
MREC = RECNO()
DO CASE
CASE MKODE="S01A"
DO FORM setsandi_data TO MPILIH WITH "INPUT", MKODE, THISFORM.LABEL2.CAPTION
THISFORM.TAMPILDATA()
LOCATE FOR KANTOR=DEFAKANTOR .AND. SANDI=MPILIH
DO FORM simpanan_setproduk1 WITH "INPUT"
CASE MKODE="S01B"
DO FORM SIMPANAN_SETPRODUK_DEP WITH "INPUT"
CASE MKODE="S01C"
DO FORM setsandi_data WITH "INPUT", MKODE, THISFORM.LABEL2.CAPTION
DO FORM SIMPANAN_SETPRODUK1_JURNAL WITH "S01C", 'SMK', "EDIT"
CASE MKODE="P001"
DO FORM pinjaman_setproduk WITH "INPUT"
CASE MKODE="GL01"
DO FORM gl_perkiraan_data WITH "INPUT"
OTHERWISE
DO FORM setsandi_data WITH "INPUT", MKODE, THISFORM.LABEL2.CAPTION
THISFORM.TAMPILDATA()
ENDCASE
IF  .NOT. EOF()
GOTO MREC
ENDIF
ENDPROC
**
*
*  setsandi.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
LOCAL OLDSELECT
OLDSELECT = SELECT()
IF NKEYCODE=13
IF THISFORM.MYKODE="GL01"
THISFORM.MYPILIH = NOPER
ELSE
THISFORM.MYPILIH = SANDI
ENDIF
IF THISFORM.MODE="CARI"
THISFORM.RELEASE
ELSE
DO CASE
CASE THISFORM.MYKODE="P001"
DO FORM pinjaman_setproduk WITH "TAMPIL"
CASE THISFORM.MYKODE="S01A"
DO FORM simpanan_setproduk1 WITH "TAMPIL"
CASE THISFORM.MYKODE="S01B"
DO FORM SIMPANAN_SETPRODUK_DEP WITH "TAMPIL"
OTHERWISE
ENDCASE
ENDIF
ENDIF
IF NKEYCODE=27
THISFORM.CMDBATAL.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=10 .OR. NKEYCODE=65
THISFORM.COMBO1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
DO FORM cari_data TO MCARI
MCARI = STRTRAN(MCARI, "%", "")
MCARI = STRTRAN(MCARI, "'", "")
SELECT (OLDSELECT)
IF THISFORM.MYKODE="GL01"
IF VAL(LEFT(MCARI, 2))>0
LOCATE FOR NOPER=MCARI
ELSE
LOCATE FOR NAMA=MCARI
ENDIF
IF  .NOT. FOUND()
LOCATE FOR AT(MCARI, ALLTRIM(NOPER)+ALLTRIM(NAMA))>0
ENDIF
ELSE
LOCATE FOR AT(MCARI, ALLTRIM(SANDI)+ALLTRIM(KETERANGAN))>0
ENDIF
THISFORM.GRID1.SETFOCUS
RETURN
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE DblClick
IF THISFORM.MYKODE="GL01"
THISFORM.MYPILIH = NOPER
ELSE
THISFORM.MYPILIH = SANDI
ENDIF
IF THISFORM.MODE="CARI"
THISFORM.RELEASE
ELSE
MREC = 0
IF  .NOT. EOF()
MREC = RECNO()
ENDIF
DO CASE
CASE THISFORM.MYKODE="P001"
DO FORM pinjaman_setproduk WITH "TAMPIL"
CASE THISFORM.MYKODE="GL01"
CASE THISFORM.MYKODE="S01A"
DO FORM simpanan_setproduk1 WITH "TAMPIL"
CASE THISFORM.MYKODE="S01B"
DO FORM SIMPANAN_SETPRODUK_DEP WITH "TAMPIL"
CASE THISFORM.MYKODE="S01C"
OTHERWISE
DO FORM setsandi_data WITH "TAMPIL", THISFORM.MYKODE, THISFORM.LABEL2.CAPTION
ENDCASE
IF MREC<>0
GOTO MREC
ENDIF
ENDIF
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPILGRID()
ENDPROC
**
*
*  setsandi.scx::Cmdedit
**
PROCEDURE Click
MKODE = THISFORM.MYKODE
MREC = 0
IF  .NOT. EOF()
MREC = RECNO()
ENDIF
DO CASE
CASE MKODE="S01A"
DO FORM simpanan_setproduk1 WITH "EDIT"
CASE MKODE="S01B"
DO FORM SIMPANAN_SETPRODUK_DEP WITH "EDIT"
CASE MKODE="S01C"
DO FORM simpanan_setproduk1 WITH "EDIT"
CASE MKODE="P001"
DO FORM pinjaman_setproduk WITH "EDIT"
CASE MKODE="GL01"
DO FORM gl_perkiraan_data WITH "EDIT"
OTHERWISE
DO FORM setsandi_data WITH "EDIT", MKODE, THISFORM.LABEL2.CAPTION
ENDCASE
THISFORM.TAMPILDATA()
IF MREC<>0
GOTO MREC
ENDIF
ENDPROC
**
*
*  setsandi.scx::Cmdhapus
**
PROCEDURE Click
MKODE = THISFORM.MYKODE
LOCAL OLDSELECT
OLDSELECT = SELECT()
IF MKODE='S002' .AND. SANDI>='01' .AND. SANDI<='10'
MESSAGEBOX("KODE INI TIDAK DAPAT DIHAPUS, SILAHKAN GANTI KETERANGAN/KODE MUTASI", 64, "")
ELSE
YT = MESSAGEBOX("DATA AKAN DIHAPUS", 36, "")
IF YT=6
DO CASE
CASE MKODE="S01A" .OR. MKODE="S01B" .OR. MKODE="S01C"
CSQL = "delete from setsandi_tab where sandi='"+SANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CASE MKODE="P001"
CSQL = "delete from setsandi_pinj where sandi='"+SANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
OTHERWISE
CSQL = "delete from setsandi where kode='"+MKODE+"' and sandi='"+SANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDCASE
ENDIF
ENDIF
SELECT (OLDSELECT)
THISFORM.TAMPILDATA()
ENDPROC
**
*
*  setsandi.scx::cmdDetail
**
PROCEDURE Click
DO CASE
CASE THISFORM.MYKODE="S01A"
DO FORM simpanan_setproduk1 WITH "TAMPIL"
CASE THISFORM.MYKODE="S01B"
CASE THISFORM.MYKODE="S01C"
CASE THISFORM.MYKODE="P001"
DO FORM pinjaman_setproduk WITH "TAMPIL"
ENDCASE
THISFORM.TAMPILDATA()
ENDPROC
**
***
*** setsandi.sct
***
*
***
*** setsandi_data.scx
***
*
*
*  setsandi_data.scx::Form1
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MKODE, MJUDUL
THISFORM.TEXT1.INPUTMASK = "!!!!"
THISFORM.TEXT2.INPUTMASK = REPLICATE("!", 25)
THISFORM.MKET2.INPUTMASK = REPLICATE("!", 25)
THISFORM.MKET3.INPUTMASK = REPLICATE("!", 10)
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.MYKODE = MKODE
THISFORM.KODEASAL = MKODE
THISFORM.SANDIASAL = SANDI
THISFORM.HEIGHT = 180
DO CASE
CASE MKODE='GL01'
THISFORM.TEXT1.INPUTMASK = DEFAFMTAKT
THISFORM.KODEASAL = NOPER
THISFORM.LABEL1.CAPTION = "NO. PERKIRAAN"
THISFORM.LABEL3.CAPTION = "NAMA PERKIRAAN"
THISFORM.KET2.CAPTION = "KELOMPOK"
THISFORM.KET2.VISIBLE = .T.
THISFORM.MKET2.VISIBLE = .T.
THISFORM.MKET2.WIDTH = 50
THISFORM.KET3.CAPTION = "BUKU BANTU"
THISFORM.KET3.VISIBLE = .T.
THISFORM.MKET3.VISIBLE = .T.
THISFORM.MKET3.WIDTH = 80
THISFORM.TEXT1.FORMAT = "KR!"
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = NOPER
THISFORM.TEXT2.VALUE = NAMA
THISFORM.MKET2.VALUE = KEL
THISFORM.MKET3.VALUE = BUKUBANTU
ENDIF
THISFORM.HEIGHT = 225
CASE MKODE='S002'
THISFORM.LABEL1.CAPTION = "NOMOR :"
THISFORM.LABEL3.CAPTION = "NAMA TRANSAKSI :"
THISFORM.KET2.CAPTION = "KD MUTASI :"
THISFORM.KET2.VISIBLE = .T.
THISFORM.MKET2.VISIBLE = .T.
THISFORM.MKET2.WIDTH = 50
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.MKET2.VALUE = KET2
ENDIF
IF SANDI>='01' .AND. SANDI<='10'
THISFORM.TEXT1.ENABLED = .F.
ENDIF
THISFORM.HEIGHT = 205
CASE MKODE="P009"
THISFORM.LABEL2.CAPTION = "PENGIKATAN BARANG BERGERAK"
THISFORM.KET2.CAPTION = "PPAP DIHITUNG DARI"
THISFORM.KET3.CAPTION = "PROSENTASE"
THISFORM.KET2.VISIBLE = .T.
THISFORM.KET3.VISIBLE = .T.
THISFORM.MKET2.VISIBLE = .T.
THISFORM.MKET3.VISIBLE = .T.
THISFORM.MKET3.WIDTH = 60
THISFORM.MKET3.INPUTMASK = "99"
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.MKET2.VALUE = KET2
THISFORM.MKET3.VALUE = KET3
ENDIF
THISFORM.HEIGHT = 225
CASE MKODE="P010"
THISFORM.LABEL2.CAPTION = "PENGIKATAN TANAH & BANGUNAN"
THISFORM.KET2.VISIBLE = .T.
THISFORM.KET3.VISIBLE = .T.
THISFORM.MKET2.VISIBLE = .T.
THISFORM.MKET3.VISIBLE = .T.
THISFORM.KET2.CAPTION = "PPAP DIHITUNG DARI"
THISFORM.KET3.CAPTION = "PROSENTASE"
THISFORM.MKET3.WIDTH = 60
THISFORM.MKET3.INPUTMASK = "99"
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.MKET2.VALUE = KET2
THISFORM.MKET3.VALUE = KET3
ENDIF
THISFORM.HEIGHT = 225
CASE MKODE="P011"
THISFORM.LABEL2.CAPTION = "PENGIKATAN CASH COLLATERAL"
THISFORM.KET2.CAPTION = "PPAP DIHITUNG DARI"
THISFORM.KET3.CAPTION = "PROSENTASE"
THISFORM.KET2.VISIBLE = .T.
THISFORM.KET3.VISIBLE = .T.
THISFORM.MKET2.VISIBLE = .T.
THISFORM.MKET3.VISIBLE = .T.
THISFORM.MKET3.WIDTH = 60
THISFORM.MKET3.INPUTMASK = "99"
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.MKET2.VALUE = KET2
THISFORM.MKET3.VALUE = KET3
ENDIF
THISFORM.HEIGHT = 225
CASE MKODE="P012"
THISFORM.LABEL2.CAPTION = "PENGIKATAN JAMINAN LAIN-LAIN"
THISFORM.KET2.CAPTION = "PPAP DIHITUNG DARI"
THISFORM.KET3.CAPTION = "PROSENTASE"
THISFORM.KET2.VISIBLE = .T.
THISFORM.KET3.VISIBLE = .T.
THISFORM.MKET2.VISIBLE = .T.
THISFORM.MKET3.VISIBLE = .T.
THISFORM.MKET3.WIDTH = 60
THISFORM.MKET3.INPUTMASK = "99"
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.MKET2.VALUE = KET2
THISFORM.MKET3.VALUE = KET3
ENDIF
THISFORM.HEIGHT = 225
CASE MKODE="P013"
THISFORM.LABEL2.CAPTION = "NOTARIS"
THISFORM.LABEL3.CAPTION = "NAMA NOTARIS"
THISFORM.KET2.CAPTION = "NO. REKENING"
THISFORM.KET3.CAPTION = "ATAS NAMA"
THISFORM.KET2.VISIBLE = .T.
THISFORM.KET3.VISIBLE = .T.
THISFORM.MKET2.VISIBLE = .T.
THISFORM.MKET3.VISIBLE = .T.
THISFORM.MKET3.ENABLED = .F.
THISFORM.MKET3.WIDTH = 217
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.MKET2.VALUE = KET2
THISFORM.MKET3.VALUE = KET3
ENDIF
THISFORM.HEIGHT = 225
CASE MKODE="P014"
THISFORM.LABEL2.CAPTION = "NAMA ASURANSI"
THISFORM.LABEL3.CAPTION = "NAMA NOTARIS"
THISFORM.KET2.CAPTION = "NO. REKENING"
THISFORM.KET3.CAPTION = "ATAS NAMA"
THISFORM.KET2.VISIBLE = .T.
THISFORM.KET3.VISIBLE = .T.
THISFORM.MKET2.VISIBLE = .T.
THISFORM.MKET3.VISIBLE = .T.
THISFORM.MKET3.ENABLED = .F.
THISFORM.MKET3.WIDTH = 217
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.MKET2.VALUE = KET2
THISFORM.MKET3.VALUE = KET3
ENDIF
THISFORM.HEIGHT = 225
OTHERWISE
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.MKET2.VALUE = KET2
THISFORM.MKET3.VALUE = KET3
ENDIF
ENDCASE
THISFORM.LABEL2.CAPTION = MJUDUL
THISFORM.TEXT1.SETFOCUS
THISFORM.TEXT3.VALUE = MKODE
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
IF MMODE="TAMPIL"
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.MKET2.ENABLED = .F.
THISFORM.MKET3.ENABLED = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDOK.VISIBLE = .T.
ENDIF
ENDIF
IF MMODE="INPUT"
THISFORM.TEXT1.VALUE = ""
THISFORM.TEXT2.VALUE = ""
THISFORM.MKET2.VALUE = ""
THISFORM.MKET3.VALUE = ""
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  setsandi_data.scx::Text2
**
PROCEDURE LostFocus
IF LEFT(THIS.VALUE, 5)="TANPA"
THISFORM.CMDSIMPAN1.SETFOCUS
ENDIF
ENDPROC
**
*
*  setsandi_data.scx::Cmdsimpan1
**
PROCEDURE Click
DO CASE
CASE THISFORM.MYKODE="GL01"
IF THISFORM.MODE="INPUT"
CSQL = "INSERT into perkiraan (kantor,noper, nama,kel,bukubantu) "+"VALUE (?DefaKantor,?thisform.text1.value, ?thisform.text2.value, ?thisform.mket2.value,?thisform.mket3.value)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "UPDATE perkiraan SET noper ='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"', nama='"+THISFORM.TEXT2.VALUE+"', "+"kel='"+THISFORM.MKET2.VALUE+"'"+" where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
IF THISFORM.KODEASAL<>THISFORM.TEXT1.VALUE
CSQL = "UPDATE jurnal SET noper ='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "UPDATE neraca SET noper ='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
CASE THISFORM.MYKODE="S01A"
IF THISFORM.MODE="INPUT"
CSQL = "INSERT into setsandi_tab (kantor,jenis,sandi, keterangan) "+"VALUE (?DefaKantor,'1',?thisform.text1.value, ?thisform.text2.value)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
THISFORM.MYPILIH = THISFORM.TEXT1.VALUE
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "UPDATE setsandi_tab SET jenis='1', sandi='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"', keterangan='"+THISFORM.TEXT2.VALUE+"'"+" where KDKANTOR, jenis, SANDI"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
ENDIF
CASE THISFORM.MYKODE="S01B"
IF THISFORM.MODE="INPUT"
CSQL = "INSERT into setsandi_tab (kantor,jenis,sandi, keterangan) "+"VALUE (?DefaKantor,'2',?thisform.text1.value, ?thisform.text2.value)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "UPDATE setsandi_tab SET sandi='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"', keterangan='"+THISFORM.TEXT2.VALUE+"'"+" where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
ENDIF
CASE THISFORM.MYKODE="P001"
IF THISFORM.MODE="INPUT"
CSQL = "INSERT into setsandi_pinj (kantor,sandi, keterangan) "+"VALUE (?DefaKantor,?thisform.text1.value, ?thisform.text2.value)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "UPDATE setsandi_pinj SET sandi='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"', keterangan='"+THISFORM.TEXT2.VALUE+"'"+" where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
ENDIF
OTHERWISE
IF THISFORM.MODE="INPUT"
CSQL = "INSERT into setsandi (kantor,kode, sandi, keterangan,ket2,ket3) "+"VALUE ('"+DEFAKANTOR+"','"+THISFORM.TEXT3.VALUE+"', '"+THISFORM.TEXT1.VALUE+"' , '"+THISFORM.TEXT2.VALUE+"', '"+THISFORM.MKET2.VALUE+"','"+THISFORM.MKET3.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
THISFORM.EDIT1.VALUE = CSQL
RETURN
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "UPDATE setsandi SET keterangan ='"+ALLTRIM(THISFORM.TEXT2.VALUE)+"', sandi='"+THISFORM.TEXT1.VALUE+"', "+"ket2='"+THISFORM.MKET2.VALUE+"',ket3='"+THISFORM.MKET3.VALUE+"' where kode='"+THISFORM.KODEASAL+"' and sandi='"+THISFORM.SANDIASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
ENDIF
ENDCASE
THISFORM.RELEASE
ENDPROC
**
*
*  setsandi_data.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  setsandi_data.scx::mket2
**
FUNCTION LostFocus
IF THISFORM.TEXT3.VALUE='P013' .OR. THISFORM.TEXT3.VALUE='P014'
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
MNOREK = THIS.VALUE
CSQL = "select a.*,b.* from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.MKET3.VALUE = NAMA
SELECT (OLDSELECT)
ENDIF
ENDFUNC
**
*
*  setsandi_data.scx::CmdOk
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
***
*** setsandi_data.sct
***
*
***
*** pinjaman_angsur.scx
***
*
*
*  pinjaman_angsur.scx::FORM1
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
MNOREK = THISFORM.NOREKASAL
CSQL = "select * from pinjaman_mutasi where kode<>'00' and norek='"+MNOREK+"' and tglmutasi<>'    -  -  ' order by iddata"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
PROCEDURE tampilkan
MYDATA = THISFORM.DATA1
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = IIF(THISFORM.KDHIT='H', 7, 8)
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "TGLMUTASI"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 85
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KODE"
.COLUMN3.HEADER1.CAPTION = "KODE"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
IF THISFORM.KDHIT='H'
.COLUMN4.WIDTH = 110
.COLUMN4.CONTROLSOURCE = "DEBET"
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.ALIGNMENT = 1
.COLUMN4.HEADER1.CAPTION = "DEBET"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 110
.COLUMN5.CONTROLSOURCE = "KREDIT"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "KREDIT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.COLUMN6.WIDTH = 110
.COLUMN6.CONTROLSOURCE = "SALDO"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "SALDO"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 9
.COLUMN7.CONTROLSOURCE = "OPT"
.COLUMN7.HEADER1.CAPTION = "OPT"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 9
ELSE
.COLUMN4.WIDTH = 95
.COLUMN4.CONTROLSOURCE = "POKOK"
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.ALIGNMENT = 1
.COLUMN4.HEADER1.CAPTION = "POKOK"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 95
.COLUMN5.CONTROLSOURCE = "JASA"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "JASA"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.COLUMN6.WIDTH = 95
.COLUMN6.CONTROLSOURCE = "DENDA"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "DENDA"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 9
.COLUMN7.WIDTH = 95
.COLUMN7.CONTROLSOURCE = "pokok+jasa+DENDA"
.COLUMN7.INPUTMASK = "999,999,999,999"
.COLUMN7.ALIGNMENT = 1
.COLUMN7.HEADER1.CAPTION = "JUMLAH ANGSURAN"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 9
.COLUMN8.WIDTH = 50
.COLUMN8.CONTROLSOURCE = "OPT"
.COLUMN8.HEADER1.CAPTION = "OPT"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 9
ENDIF
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = NOREK
THISFORM.KDHIT = KDHIT
THISFORM.DATA1 = SYS(2015)
IF DEFAPROSMIGRASI<>"Y"
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .F.
ENDIF
THISFORM.COMMAND10.VISIBLE = .T.
IF DEFAUSERID='IMR'
THISFORM.COMMAND5.VISIBLE = .T.
ENDIF
WITH THISFORM
IF MMODE='TAMPIL' .OR. MMODE='EDIT'
IF THISFORM.KDHIT='H'
THISFORM.COMMAND10.VISIBLE = .T.
ENDIF
SELECT (THISFORM.OLDSELECT)
.TEXT32.VALUE = NOREK
.TEXT3.VALUE = NAMA
.TEXT1.VALUE = CIF
.TEXT2.VALUE = ALAMAT
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.CMDKELUAR1.SETFOCUS
ENDIF
ENDIF
ENDWITH
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  pinjaman_angsur.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_angsur.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into pinjaman (tanggal, bukti, norek, nopk, kdhit, marketing, cif, pokok, rate, lama, tglmulai, tgljtempo, adm, provisi, jenis, kelompok, wilayah, penggunaan, sektor, sumber) value "+"('"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT34.VALUE+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+STR(.TEXT38.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"',"+"'"+STR(.TEXT39.VALUE)+"',"+"'"+STR(.TEXT40.VALUE)+"',"+"'"+.TEXT21.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+.TEXT22.VALUE+"',"+"'"+.TEXT27.VALUE+"',"+"'"+.TEXT24.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',"+"bukti='"+.TEXT34.VALUE+"',"+"norek='"+.TEXT32.VALUE+"',"+"nopk='"+.TEXT33.VALUE+"',"+"kdhit='"+.TEXT41.VALUE+"',"+"marketing='"+.TEXT42.VALUE+"',"+"cif='"+.TEXT1.VALUE+"',"+"pokok='"+STR(.TEXT38.VALUE)+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"lama='"+STR(.TEXT18.VALUE)+"',"+"tglmulai='"+SQLDATE(.TEXT19.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT14.VALUE)+"',"+"adm='"+STR(.TEXT39.VALUE)+"',"+"provisi='"+STR(.TEXT40.VALUE)+"',"+"jenis='"+.TEXT21.VALUE+"',"+"kelompok='"+.TEXT25.VALUE+"',"+"wilayah='"+.TEXT26.VALUE+"',"+"penggunaan='"+.TEXT22.VALUE+"',"+"sektor='"+.TEXT27.VALUE+"',"+"sumber='"+.TEXT24.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="HAPUS"
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_angsur.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  pinjaman_angsur.scx::Text32
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_angsur.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_angsur.scx::Command6
**
PROCEDURE Click
SELECT (THISFORM.OLDSELECT)
MNAMA = NAMA
MALAMAT = ALAMAT
MNOREK = NOREK
MTANGGAL = TANGGAL
MPOKOK = POKOK
MJASA = JASA
MLAMA = LAMA
MTGLMULAI = TGLMULAI
MTGLJTEMPO = TGLJTEMPO
MCIF = CIF
CSQL = "select *,pokok as sisapokok,pokok as sisajasa from pinjaman_mutasi where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MSISAPOKOK = MPOKOK
MSISAJASA = MJASA
GOTO TOP
DO WHILE  .NOT. EOF()
MSISAPOKOK = MSISAPOKOK-POKOK
MSISAJASA = MSISAJASA-JASA
REPLACE SISAPOKOK WITH MSISAPOKOK
REPLACE SISAJASA WITH MSISAJASA
SKIP
ENDDO
REPORT FORM krd_angsuran PREVIEW
ENDPROC
**
*
*  pinjaman_angsur.scx::Grid1
**
PROCEDURE DblClick
DO FORM pinjaman_mutasi_detail
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM pinjaman_mutasi_detail
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDIF
IF NKEYCODE=7
YT = MESSAGEBOX("Benar Data Akan dihapus", 4, "")
IF YT=6
CSQL = "delete from pinjaman_mutasi where iddata=?iddata"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDIF
ENDPROC
**
*
*  pinjaman_angsur.scx::Command10
**
PROCEDURE Click
DO FORM form_pbk WITH "ANGS", THISFORM.TEXT32.VALUE, 2
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  pinjaman_angsur.scx::Command1
**
PROCEDURE Click
DO FORM pinjaman_angsuran_data WITH "EDIT", THISFORM.TEXT32.VALUE
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  pinjaman_angsur.scx::Command4
**
PROCEDURE Click
DO FORM pinjaman_angsuran_data WITH "INPUT", THISFORM.TEXT32.VALUE
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  pinjaman_angsur.scx::Command5
**
PROCEDURE Click
YT = MESSAGEBOX("Benar Data Akan dihapus", 4, "")
IF YT=6
CSQL = "delete from pinjaman_mutasi where iddata=?iddata"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
***
*** pinjaman_angsur.sct
***
*
***
*** pinjaman_jadwal.scx
***
*
*
*  pinjaman_jadwal.scx::FORM1
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
MNOREK = THISFORM.NOREKASAL
CSQL = "select * from pinjaman_jadwal where norek='"+ALLTRIM(MNOREK)+"' order by tanggal"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
PROCEDURE tampilkan
MYDATA = THISFORM.DATA1
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 5
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 90
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 100
.COLUMN2.CONTROLSOURCE = "POKOK"
.COLUMN2.INPUTMASK = "999,999,999,999"
.COLUMN2.ALIGNMENT = 1
.COLUMN2.HEADER1.CAPTION = "POKOK"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "JASA"
.COLUMN3.INPUTMASK = "999,999,999,999"
.COLUMN3.ALIGNMENT = 1
.COLUMN3.HEADER1.CAPTION = "JASA"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 100
.COLUMN4.CONTROLSOURCE = "(POKOK+JASA)"
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.ALIGNMENT = 1
.COLUMN4.HEADER1.CAPTION = "JUMLAH ANGSURAN"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 50
.COLUMN5.CONTROLSOURCE = "OPT"
.COLUMN5.HEADER1.CAPTION = "OPT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = NOREK
THISFORM.DATA1 = SYS(2015)
WITH THISFORM
IF MMODE='TAMPIL' .OR. MMODE='EDIT'
SELECT (THISFORM.OLDSELECT)
.TEXT32.VALUE = NOREK
.TEXT3.VALUE = NAMA
.TEXT1.VALUE = CIF
.TEXT2.VALUE = ALAMAT
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.CMDKELUAR1.SETFOCUS
ENDIF
ENDIF
ENDWITH
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  pinjaman_jadwal.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_jadwal.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into pinjaman (tanggal, bukti, norek, nopk, kdhit, marketing, cif, pokok, rate, lama, tglmulai, tgljtempo, adm, provisi, jenis, kelompok, wilayah, penggunaan, sektor, sumber) value "+"('"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT34.VALUE+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+STR(.TEXT38.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"',"+"'"+STR(.TEXT39.VALUE)+"',"+"'"+STR(.TEXT40.VALUE)+"',"+"'"+.TEXT21.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+.TEXT22.VALUE+"',"+"'"+.TEXT27.VALUE+"',"+"'"+.TEXT24.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',"+"bukti='"+.TEXT34.VALUE+"',"+"norek='"+.TEXT32.VALUE+"',"+"nopk='"+.TEXT33.VALUE+"',"+"kdhit='"+.TEXT41.VALUE+"',"+"marketing='"+.TEXT42.VALUE+"',"+"cif='"+.TEXT1.VALUE+"',"+"pokok='"+STR(.TEXT38.VALUE)+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"lama='"+STR(.TEXT18.VALUE)+"',"+"tglmulai='"+SQLDATE(.TEXT19.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT14.VALUE)+"',"+"adm='"+STR(.TEXT39.VALUE)+"',"+"provisi='"+STR(.TEXT40.VALUE)+"',"+"jenis='"+.TEXT21.VALUE+"',"+"kelompok='"+.TEXT25.VALUE+"',"+"wilayah='"+.TEXT26.VALUE+"',"+"penggunaan='"+.TEXT22.VALUE+"',"+"sektor='"+.TEXT27.VALUE+"',"+"sumber='"+.TEXT24.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="HAPUS"
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_jadwal.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
*
*  pinjaman_jadwal.scx::Text32
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_jadwal.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_jadwal.scx::Command6
**
PROCEDURE Click
REPORT FORM krd_jadwal PREVIEW
ENDPROC
**
*
*  pinjaman_jadwal.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=7
YT = MESSAGEBOX("Benar Data Akan dihapus", 4, "")
IF YT=6
SELECT (THISFORM.DATA1)
MNOREC = RECNO()
CSQL = "delete from pinjaman_jadwal where kantor='"+KANTOR+"' and norek='"+NOREK+"' and tanggal='"+SQLDATE(TANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, THISFORM.DATA1)
THISFORM.BACADATA()
IF  .NOT. (ISNULL(NOREK) .OR. EMPTY(NOREK))
GOTO MIN(MNOREC, RECCOUNT())
ENDIF
THISFORM.TAMPILKAN()
ENDIF
ENDIF
ENDPROC
**
*
*  pinjaman_jadwal.scx::CmdBuatJdw
**
PROCEDURE Click
BUATJDW(THISFORM.TEXT32.VALUE)
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  pinjaman_jadwal.scx::CmdHapus
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
MNOREC = RECNO()
CSQL = "delete from pinjaman_jadwal where kantor='"+KANTOR+"' and norek='"+NOREK+"' and tanggal='"+SQLDATE(TANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, THISFORM.DATA1)
THISFORM.BACADATA()
IF  .NOT. (ISNULL(NOREK) .OR. EMPTY(NOREK))
GOTO MIN(MNOREC, RECCOUNT())
ENDIF
THISFORM.TAMPILKAN()
ENDPROC
**
***
*** pinjaman_jadwal.sct
***
*
***
*** simpanan_mutasi.scx
***
*
*
*  simpanan_mutasi.scx::FORM1
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
MNOREK = THISFORM.NOREKASAL
CSQL = "select * from simpanan_mutasi where norek='"+MNOREK+"' ORDER BY iddata DESC LIMIT 150"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampilkan
MYDATA = THISFORM.DATA1
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 8
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KODE"
.COLUMN3.HEADER1.CAPTION = "KODE"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 200
.COLUMN4.CONTROLSOURCE = "KETERANGAN"
.COLUMN4.HEADER1.CAPTION = "KETERANGAN"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "DEBET"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "DEBET"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.COLUMN6.WIDTH = 100
.COLUMN6.CONTROLSOURCE = "KREDIT"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "KREDIT"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 9
.COLUMN7.WIDTH = 100
.COLUMN7.CONTROLSOURCE = "SALDO"
.COLUMN7.INPUTMASK = "999,999,999,999"
.COLUMN7.ALIGNMENT = 1
.COLUMN7.HEADER1.CAPTION = "SALDO"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 9
.COLUMN8.WIDTH = 50
.COLUMN8.CONTROLSOURCE = "OPT"
.COLUMN8.HEADER1.CAPTION = "OPT"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 9
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE tampil2
THISFORM.TEXT3.VALUE = KETERANGAN
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = NOREK
IF DEFAUSERID='IMR'
THISFORM.COMMAND4.VISIBLE = .T.
ENDIF
THISFORM.DATA1 = SYS(2015)
WITH THISFORM
IF MMODE='TAMPIL' .OR. MMODE='EDIT'
SELECT (THISFORM.OLDSELECT)
.TEXT32.VALUE = NOREK
.TEXT33.VALUE = NOBUKU
.TEXT1.VALUE = CIF
.TEXT2.VALUE = NAMA
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.CMDKELUAR1.SETFOCUS
ENDIF
ENDIF
ENDWITH
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  simpanan_mutasi.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_mutasi.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into pinjaman (tanggal, bukti, norek, nopk, kdhit, marketing, cif, pokok, rate, lama, tglmulai, tgljtempo, adm, provisi, jenis, kelompok, wilayah, penggunaan, sektor, sumber) value "+"('"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT34.VALUE+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+STR(.TEXT38.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"',"+"'"+STR(.TEXT39.VALUE)+"',"+"'"+STR(.TEXT40.VALUE)+"',"+"'"+.TEXT21.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+.TEXT22.VALUE+"',"+"'"+.TEXT27.VALUE+"',"+"'"+.TEXT24.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',"+"bukti='"+.TEXT34.VALUE+"',"+"norek='"+.TEXT32.VALUE+"',"+"nopk='"+.TEXT33.VALUE+"',"+"kdhit='"+.TEXT41.VALUE+"',"+"marketing='"+.TEXT42.VALUE+"',"+"cif='"+.TEXT1.VALUE+"',"+"pokok='"+STR(.TEXT38.VALUE)+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"lama='"+STR(.TEXT18.VALUE)+"',"+"tglmulai='"+SQLDATE(.TEXT19.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT14.VALUE)+"',"+"adm='"+STR(.TEXT39.VALUE)+"',"+"provisi='"+STR(.TEXT40.VALUE)+"',"+"jenis='"+.TEXT21.VALUE+"',"+"kelompok='"+.TEXT25.VALUE+"',"+"wilayah='"+.TEXT26.VALUE+"',"+"penggunaan='"+.TEXT22.VALUE+"',"+"sektor='"+.TEXT27.VALUE+"',"+"sumber='"+.TEXT24.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="HAPUS"
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_mutasi.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  simpanan_mutasi.scx::Text32
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
ENDPROC
**
*
*  simpanan_mutasi.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_mutasi.scx::Command6
**
PROCEDURE Click
DEFINE POPUP POPUPLAP FROM 5, 43 FONT "Cambria", 10
DEFINE BAR 1 OF POPUPLAP PROMPT 'Cetak Laporan .................. '
DEFINE BAR 2 OF POPUPLAP PROMPT 'Cetak Validasi ......................'
ON SELECTION BAR 1 OF POPUPLAP MESSAGEBOX("111111111111111111111111111")
ON SELECTION BAR 2 OF POPUPLAP MESSAGEBOX("2222222222222222222222222222221")
ACTIVATE POPUP POPUPLAP
ENDPROC
**
*
*  simpanan_mutasi.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM simpanan_mutasi_detail
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM simpanan_mutasi_detail
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  simpanan_mutasi.scx::Command1
**
PROCEDURE Click
DO FORM form_pbk WITH "SIMP", THISFORM.TEXT32.VALUE
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  simpanan_mutasi.scx::Command4
**
PROCEDURE Click
MDATA = THISFORM.DATA1
SELECT (MDATA)
YT = MESSAGEBOX("Data Tanggal "+DTOC(TANGGAL)+" Bukti : "+ALLTRIM(BUKTI)+" Akan Dihapus", 36, "")
IF YT=6
CSQL = "delete from simpanan_mutasi where iddata=?iddata"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDIF
ENDPROC
**
*
*  simpanan_mutasi.scx::Command5
**
PROCEDURE Click
MDATA = THISFORM.DATA1
SELECT (MDATA)
YT = MESSAGEBOX("Benar, nomor ini akan dilakukan perhitungan Ulang", 36, "")
IF YT=6
DO FORM proses_ceksaldo WITH NOREK
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDIF
ENDPROC
**
***
*** simpanan_mutasi.sct
***
*
***
*** akt_bukubesar.frx
***
*
***
*** akt_bukubesar.frt
***
*
***
*** akt_camel.frx
***
*
***
*** akt_camel.frt
***
*
***
*** akt_inventaris.frx
***
*
***
*** akt_inventaris.frt
***
*
***
*** akt_neraca.frx
***
*
***
*** akt_neraca.frt
***
*
***
*** dep_tutup.frx
***
*
***
*** dep_tutup.frt
***
*
***
*** slip_1.frx
***
*
***
*** slip_1.frt
***
*
***
*** slip_2.frx
***
*
***
*** slip_2.frt
***
*
***
*** kas_rincian.scx
***
*
*
*  kas_rincian.scx::FORM1
**
PROCEDURE myenable
PARAMETER MENABLE
WITH THISFORM
.K100.ENABLED = MENABLE
.K50.ENABLED = MENABLE
.K20.ENABLED = MENABLE
.K10.ENABLED = MENABLE
.K5.ENABLED = MENABLE
.K2.ENABLED = MENABLE
.K1.ENABLED = MENABLE
.K05.ENABLED = MENABLE
.K01.ENABLED = MENABLE
.L1000.ENABLED = MENABLE
.L500.ENABLED = MENABLE
.L200.ENABLED = MENABLE
.L100.ENABLED = MENABLE
.L50.ENABLED = MENABLE
.L25.ENABLED = MENABLE
.L10.ENABLED = MENABLE
ENDWITH
ENDPROC
**
PROCEDURE bacasql
MNOKAS = THISFORM.NOKAS
CSQL = "select * from kas_rincian where tanggal='"+SQLDATE(DEFATGLKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "KAS")
WITH THISFORM
.K100.VALUE = KAS.K100
.TEXT2.VALUE = KAS.K100*100000
.K50.VALUE = KAS.K50
.TEXT11.VALUE = KAS.K50*50000
.K20.VALUE = KAS.K20
.TEXT12.VALUE = KAS.K20*20000
.K10.VALUE = KAS.K10
.TEXT13.VALUE = KAS.K10*10000
.K5.VALUE = KAS.K5
.TEXT14.VALUE = KAS.K5*5000
.K2.VALUE = KAS.K2
.TEXT15.VALUE = KAS.K2*2000
.K1.VALUE = KAS.K1
.TEXT16.VALUE = KAS.K1*1000
.K05.VALUE = KAS.K05
.TEXT17.VALUE = KAS.K05*500
.K01.VALUE = KAS.K01
.TEXT18.VALUE = KAS.K01*100
.L1000.VALUE = KAS.L1000
.TEXT21.VALUE = KAS.L1000*1000
.L500.VALUE = KAS.L500
.TEXT30.VALUE = KAS.L500*500
.L200.VALUE = KAS.L200
.TEXT31.VALUE = KAS.L200*200
.L100.VALUE = KAS.L100
.TEXT32.VALUE = KAS.L100*100
.L50.VALUE = KAS.L50
.TEXT33.VALUE = KAS.L50*50
.L25.VALUE = KAS.L25
.TEXT34.VALUE = KAS.L25*25
.L10.VALUE = KAS.L10
.TEXT35.VALUE = KAS.L10*10
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT38.VALUE = .TEXT21.VALUE+.TEXT30.VALUE+.TEXT31.VALUE+.TEXT32.VALUE+.TEXT33.VALUE+.TEXT34.VALUE+.TEXT35.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT3.VALUE = .TEXT38.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
PROCEDURE Init
PARAMETER MSALDO
THISFORM.SALDO = MSALDO
HIDE POPUP MYMENU
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.NOKAS = '01'
THISFORM.MYENABLE(.F.)
THISFORM.CMDKELUAR1.SETFOCUS
THISFORM.BACASQL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
SHOW POPUP MYMENU
ENDPROC
**
*
*  kas_rincian.scx::k100
**
PROCEDURE InteractiveChange
THISFORM.TEXT2.VALUE = THIS.VALUE*100000
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::k50
**
PROCEDURE InteractiveChange
THISFORM.TEXT11.VALUE = THIS.VALUE*50000
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::k20
**
PROCEDURE InteractiveChange
THISFORM.TEXT12.VALUE = THIS.VALUE*20000
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::k10
**
PROCEDURE InteractiveChange
THISFORM.TEXT13.VALUE = THIS.VALUE*10000
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::k5
**
PROCEDURE InteractiveChange
THISFORM.TEXT14.VALUE = THIS.VALUE*5000
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::k2
**
PROCEDURE InteractiveChange
THISFORM.TEXT15.VALUE = THIS.VALUE*2000
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::k1
**
PROCEDURE InteractiveChange
THISFORM.TEXT16.VALUE = THIS.VALUE*1000
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::k05
**
PROCEDURE InteractiveChange
THISFORM.TEXT17.VALUE = THIS.VALUE*500
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::k01
**
PROCEDURE InteractiveChange
THISFORM.TEXT18.VALUE = THIS.VALUE*100
WITH THISFORM
.TEXT19.VALUE = .TEXT2.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE+.TEXT16.VALUE+.TEXT17.VALUE+.TEXT18.VALUE
.TEXT1.VALUE = .TEXT19.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::l1000
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THIS.VALUE*1000
WITH THISFORM
.TEXT38.VALUE = .TEXT21.VALUE+.TEXT30.VALUE+.TEXT31.VALUE+.TEXT32.VALUE+.TEXT33.VALUE+.TEXT34.VALUE+.TEXT35.VALUE
.TEXT3.VALUE = .TEXT38.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::l500
**
PROCEDURE InteractiveChange
THISFORM.TEXT30.VALUE = THIS.VALUE*500
WITH THISFORM
.TEXT38.VALUE = .TEXT21.VALUE+.TEXT30.VALUE+.TEXT31.VALUE+.TEXT32.VALUE+.TEXT33.VALUE+.TEXT34.VALUE+.TEXT35.VALUE
.TEXT3.VALUE = .TEXT38.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::l200
**
PROCEDURE InteractiveChange
THISFORM.TEXT31.VALUE = THIS.VALUE*200
WITH THISFORM
.TEXT38.VALUE = .TEXT21.VALUE+.TEXT30.VALUE+.TEXT31.VALUE+.TEXT32.VALUE+.TEXT33.VALUE+.TEXT34.VALUE+.TEXT35.VALUE
.TEXT3.VALUE = .TEXT38.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::l100
**
PROCEDURE InteractiveChange
THISFORM.TEXT32.VALUE = THIS.VALUE*100
WITH THISFORM
.TEXT38.VALUE = .TEXT21.VALUE+.TEXT30.VALUE+.TEXT31.VALUE+.TEXT32.VALUE+.TEXT33.VALUE+.TEXT34.VALUE+.TEXT35.VALUE
.TEXT3.VALUE = .TEXT38.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::l50
**
PROCEDURE InteractiveChange
THISFORM.TEXT33.VALUE = THIS.VALUE*50
WITH THISFORM
.TEXT38.VALUE = .TEXT21.VALUE+.TEXT30.VALUE+.TEXT31.VALUE+.TEXT32.VALUE+.TEXT33.VALUE+.TEXT34.VALUE+.TEXT35.VALUE
.TEXT3.VALUE = .TEXT38.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::l25
**
PROCEDURE InteractiveChange
THISFORM.TEXT34.VALUE = THIS.VALUE*25
WITH THISFORM
.TEXT38.VALUE = .TEXT21.VALUE+.TEXT30.VALUE+.TEXT31.VALUE+.TEXT32.VALUE+.TEXT33.VALUE+.TEXT34.VALUE+.TEXT35.VALUE
.TEXT3.VALUE = .TEXT38.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::l10
**
PROCEDURE InteractiveChange
THISFORM.TEXT35.VALUE = THIS.VALUE*10
WITH THISFORM
.TEXT38.VALUE = .TEXT21.VALUE+.TEXT30.VALUE+.TEXT31.VALUE+.TEXT32.VALUE+.TEXT33.VALUE+.TEXT34.VALUE+.TEXT35.VALUE
.TEXT3.VALUE = .TEXT38.VALUE
.TEXT4.VALUE = .TEXT1.VALUE+.TEXT3.VALUE
ENDWITH
ENDPROC
**
*
*  kas_rincian.scx::Cmdprint1
**
PROCEDURE Click
IF THISFORM.SALDO=THISFORM.TEXT4.VALUE
MFRX = "kas_rincian.frx"
DO FORM print_setup WITH MFRX
ELSE
MESSAGEBOX("Saldo Mutasi tidak sama dengan rincian uang kas", 16)
ENDIF
ENDPROC
**
*
*  kas_rincian.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_rincian.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDINPUT1.ENABLED = .T.
THISFORM.CMDPRINT1.ENABLED = .T.
THISFORM.CMDKELUAR1.ENABLED = .T.
THISFORM.MYENABLE(.T.)
THISFORM.CMDKELUAR1.SETFOCUS
ENDPROC
**
*
*  kas_rincian.scx::Cmdinput1
**
PROCEDURE Click
THIS.ENABLED = .F.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDPRINT1.ENABLED = .F.
THISFORM.CMDKELUAR1.ENABLED = .F.
THISFORM.MYENABLE(.T.)
THISFORM.K100.SETFOCUS
ENDPROC
**
*
*  kas_rincian.scx::Cmdsimpan1
**
PROCEDURE Click
MNOKAS = THISFORM.NOKAS
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDINPUT1.VISIBLE = .T.
THISFORM.CMDPRINT1.VISIBLE = .T.
THISFORM.CMDKELUAR1.VISIBLE = .T.
THISFORM.CMDKELUAR1.SETFOCUS
THISFORM.MYENABLE(.F.)
CSQL = "delete from kas_rincian where tanggal=?sqldate(DefaTglKas)"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "INSERT into kas_rincian ( kantor,nokasir,tanggal,k100,"+"k50,k20,k10,k5,k2,k1,k05,k01,l1000,l500,l200,l100,l50,l25,l10) "+"values ('"+DEFAKANTOR+"','"+MNOKAS+"', '"+SQLDATE(DEFATGLKAS)+"', '"+STR(THISFORM.K100.VALUE)+"', '"+STR(THISFORM.K50.VALUE)+"', '"+STR(THISFORM.K20.VALUE)+"', '"+STR(THISFORM.K10.VALUE)+"', '"+STR(THISFORM.K5.VALUE)+"', '"+STR(THISFORM.K2.VALUE)+"', '"+STR(THISFORM.K1.VALUE)+"' , '"+STR(THISFORM.K05.VALUE)+"', '"+STR(THISFORM.K01.VALUE)+"', '"+STR(THISFORM.L1000.VALUE)+"', '"+STR(THISFORM.L500.VALUE)+"', '"+STR(THISFORM.L200.VALUE)+"', '"+STR(THISFORM.L100.VALUE)+"', '"+STR(THISFORM.L50.VALUE)+"', '"+STR(THISFORM.L25.VALUE)+"', '"+STR(THISFORM.L10.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
*
*  kas_rincian.scx::Cmdinput2
**
PROCEDURE Click
THIS.ENABLED = .F.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDPRINT1.ENABLED = .F.
THISFORM.CMDKELUAR1.ENABLED = .F.
THISFORM.MYENABLE(.T.)
THISFORM.K100.SETFOCUS
ENDPROC
**
***
*** kas_rincian.sct
***
*
***
*** gl_perkiraan.scx
***
*
*
*  gl_perkiraan.scx::PERKIRAAN
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 9
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "NOPER"
.COLUMN1.INPUTMASK = DEFAFMTAKT
.COLUMN1.FORMAT = "R"
.COLUMN1.HEADER1.CAPTION = "NOPER"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 400
.COLUMN2.CONTROLSOURCE = "space((MAX(VAL(level)-1,0))*5)+NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA PERKIRAAN AKUNTANSI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KEL"
.COLUMN3.HEADER1.CAPTION = "KEL"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 70
.COLUMN4.CONTROLSOURCE = "BUKUBANTU"
.COLUMN4.HEADER1.CAPTION = "BK BANTU"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 60
.COLUMN5.CONTROLSOURCE = "KELDATA"
.COLUMN5.HEADER1.CAPTION = "KEL DATA"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 30
.COLUMN6.CONTROLSOURCE = "LEVEL"
.COLUMN6.HEADER1.CAPTION = "LVL"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN7.WIDTH = 40
.COLUMN7.CONTROLSOURCE = "FONT"
.COLUMN7.HEADER1.CAPTION = "FONT"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN8.WIDTH = 60
.COLUMN8.CONTROLSOURCE = "DETAIL"
.COLUMN8.HEADER1.CAPTION = "DETAIL"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN9.WIDTH = 100
.COLUMN9.CONTROLSOURCE = "trans(saldo,'999,999,999,999,999')"
.COLUMN9.HEADER1.CAPTION = "SALDO"
.COLUMN9.ALIGNMENT = 1
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
CSQL = "select * from perkiraan order by noper"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = NOPER
CSQL = "select tanggal,saldo,tb from neraca where noper='"+MNOPER+"' and tanggal=(select MAX(tanggal) from neraca "+"where noper='"+MNOPER+"')"
LCEK = SQLEXEC(OODBC, CSQL, "aa")
MSALDO = 0
DO WHILE  .NOT. EOF()
IF MONTH(TANGGAL)=12 .AND. DAY(TANGGAL)=31
IF TB='Y'
MSALDO = SALDO
ENDIF
ELSE
MSALDO = SALDO
ENDIF
SKIP
ENDDO
SELECT (MDATA)
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("AKT", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("AKT", "HAPUS")
THISFORM.CMDBUKUBESAR.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.CMDCETAK.VISIBLE = IJINMODUL("AKT", "CETAK")
THISFORM.MLIMIT.VALUE = 99999
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
FUNCTION Unload
MNOPER = NOPER
SELECT (THISFORM.DATA)
USE
SELECT (THISFORM.OLDSELECT)
RETURN MNOPER
ENDFUNC
**
*
*  gl_perkiraan.scx::Cmdhapus
**
PROCEDURE Click
IF KELDATA="SYS"
MESSAGEBOX("DATA INI TIDAK DAPAT DIHAPUS")
RETURN
ENDIF
MRECNO = RECNO()
CSQL = "delete from perkiraan where noper=?noper and nama=?nama and kel=?kel and bukubantu=?bukubantu"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
CSQL = "delete from neraca where noper=?noper"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
CSQL = "delete from jurnal where noper=?noper"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.MYBACASQL()
IF RECCOUNT()<>0
GOTO MIN(RECCOUNT(), MRECNO)
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmdedit
**
PROCEDURE Click
MYDATA = THISFORM.DATA
IF KELDATA="SYS"
MESSAGEBOX("Data ini adalah data system, tidak dapat edit")
RETURN
ENDIF
THISFORM.MYENABLE()
SELECT &MYDATA
MREC = RECNO()
DO FORM ./form/gl_perkiraan_data WITH "EDIT"
THISFORM.MYBACASQL()
MREC = MIN(MREC, RECCOUNT())
IF MREC=0
GOTO BOTTOM
ELSE
GOTO MREC
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmdinput
**
PROCEDURE Click
MYDATA = THISFORM.DATA
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("AKT", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("AKT", "HAPUS")
THISFORM.CMDCETAK.VISIBLE = IJINMODUL("AKT", "CETAK")
THISFORM.CMDBUKUBESAR.VISIBLE = IJINMODUL("AKT", "LAINNYA")
THISFORM.MYENABLE()
SELECT &MYDATA
MNOPER = NOPER
MREC = RECNO()
DO FORM gl_perkiraan_data WITH 'INPUT'
THISFORM.MYBACASQL()
MREC = MIN(MREC, RECCOUNT())
IF MREC=0
GOTO BOTTOM
ELSE
GOTO MREC
ENDIF
LOCATE FOR NOPER=MNOPER
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_perkiraan.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmddatatop1
**
PROCEDURE Click
GOTO TOP
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = STRTRAN(MFILTER, "%", "")
MFILTER = STRTRAN(MFILTER, "'", "")
THISFORM.MFILTER.CAPTION = MFILTER
SELECT (THISFORM.DATA)
LOCATE FOR NOPER=MFILTER
IF  .NOT. FOUND()
LOCATE FOR NAMA=MFILTER
ENDIF
IF  .NOT. FOUND()
LOCATE FOR AT(MFILTER, UPPER(ALLTRIM(NOPER)+ALLTRIM(NAMA)))>0
ENDIF
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmddatabott1
**
PROCEDURE Click
GOTO BOTTOM
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_perkiraan.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM .\form\gl_bukubesar WITH "TAMPIL"
KEYBOARD '{LEFTARROW}'
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM .\form\gl_bukubesar WITH "TAMPIL"
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_perkiraan.scx::Cmdbukubesar
**
PROCEDURE Click
DO FORM gl_bukubesar WITH "TAMPIL"
ENDPROC
**
*
*  gl_perkiraan.scx::cmdcetak
**
PROCEDURE Click
REPORT FORM akt_perkiraan PREVIEW
ENDPROC
**
***
*** gl_perkiraan.sct
***
*
***
*** gl_bukubesar.scx
***
*
*
*  gl_bukubesar.scx::FORM1
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
MNOPER = THISFORM.NOREKASAL
CSQL = "select * from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MNOPER+"' order by tanggal desc limit 200"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
PROCEDURE tampilkan
MYDATA = THISFORM.DATA1
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 5
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 125
.COLUMN2.ALIGNMENT = 1
.COLUMN2.CONTROLSOURCE = "SALDOAWAL"
.COLUMN2.INPUTMASK = '999,999,999,999'
.COLUMN2.HEADER1.CAPTION = "SALDO AWAL"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 125
.COLUMN3.ALIGNMENT = 1
.COLUMN3.CONTROLSOURCE = "DEBET"
.COLUMN3.INPUTMASK = '999,999,999,999'
.COLUMN3.HEADER1.CAPTION = "MUTASI DEBET"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 125
.COLUMN4.ALIGNMENT = 1
.COLUMN4.CONTROLSOURCE = "KREDIT"
.COLUMN4.INPUTMASK = '999,999,999,999'
.COLUMN4.HEADER1.CAPTION = "MUTASI KREDIT"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 125
.COLUMN5.ALIGNMENT = 1
.COLUMN5.CONTROLSOURCE = "SALDO"
.COLUMN5.INPUTMASK = '999,999,999,999'
.COLUMN5.HEADER1.CAPTION = "SALDO AKHIR"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = NOPER
THISFORM.DATA1 = SYS(2015)
WITH THISFORM
IF MMODE='TAMPIL' .OR. MMODE='EDIT'
SELECT (THISFORM.OLDSELECT)
.TEXT32.VALUE = NOPER
.TEXT33.VALUE = NAMA
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.CMDKELUAR1.SETFOCUS
ENDIF
ENDIF
ENDWITH
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  gl_bukubesar.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_bukubesar.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into pinjaman (tanggal, bukti, norek, nopk, kdhit, marketing, cif, pokok, rate, lama, tglmulai, tgljtempo, adm, provisi, jenis, kelompok, wilayah, penggunaan, sektor, sumber) value "+"('"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT34.VALUE+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+STR(.TEXT38.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"',"+"'"+STR(.TEXT39.VALUE)+"',"+"'"+STR(.TEXT40.VALUE)+"',"+"'"+.TEXT21.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+.TEXT22.VALUE+"',"+"'"+.TEXT27.VALUE+"',"+"'"+.TEXT24.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',"+"bukti='"+.TEXT34.VALUE+"',"+"norek='"+.TEXT32.VALUE+"',"+"nopk='"+.TEXT33.VALUE+"',"+"kdhit='"+.TEXT41.VALUE+"',"+"marketing='"+.TEXT42.VALUE+"',"+"cif='"+.TEXT1.VALUE+"',"+"pokok='"+STR(.TEXT38.VALUE)+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"lama='"+STR(.TEXT18.VALUE)+"',"+"tglmulai='"+SQLDATE(.TEXT19.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT14.VALUE)+"',"+"adm='"+STR(.TEXT39.VALUE)+"',"+"provisi='"+STR(.TEXT40.VALUE)+"',"+"jenis='"+.TEXT21.VALUE+"',"+"kelompok='"+.TEXT25.VALUE+"',"+"wilayah='"+.TEXT26.VALUE+"',"+"penggunaan='"+.TEXT22.VALUE+"',"+"sektor='"+.TEXT27.VALUE+"',"+"sumber='"+.TEXT24.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="HAPUS"
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_bukubesar.scx::Text32
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
ENDPROC
**
*
*  gl_bukubesar.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_bukubesar.scx::Command1
**
PROCEDURE Click
DO FORM gl_bukubesar_koreksi
ENDPROC
**
***
*** gl_bukubesar.sct
***
*
***
*** gl_ksd.scx
***
*
*
*  gl_ksd.scx::KSD
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 6
.BACKCOLOR = RGB(217, 217, 255)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "NOPER"
.COLUMN1.HEADER1.CAPTION = "NOPER"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 250
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA TRANSAKSI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 350
.COLUMN3.CONTROLSOURCE = "KETERANGAN"
.COLUMN3.HEADER1.CAPTION = "KETERANGAN"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 120
.COLUMN4.CONTROLSOURCE = "AWAL"
.COLUMN4.HEADER1.CAPTION = "SALDO AWAL"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 120
.COLUMN5.CONTROLSOURCE = "MUTASI"
.COLUMN5.HEADER1.CAPTION = "JUMLAH MUTASI"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 120
.COLUMN6.CONTROLSOURCE = "SALDO"
.COLUMN6.HEADER1.CAPTION = "SALDO AKHIR"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
CSQL = "select * from gl_ksd where saldo>0"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.MLIMIT.VALUE = 50
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
FUNCTION Unload
MNOPER = NOPER
SELECT (THISFORM.DATA)
USE
SELECT (THISFORM.OLDSELECT)
RETURN MNOPER
ENDFUNC
**
*
*  gl_ksd.scx::Cmdhapus
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_ksd.scx::Cmdedit
**
PROCEDURE Click
MYDATA = THISFORM.DATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM gl_ksd_data WITH "EDIT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_ksd.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
MYDATA = THISFORM.DATA
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("AKT", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("AKT", "HAPUS")
THISFORM.CMDCETAK.VISIBLE = IJINMODUL("AKT", "CETAK")
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM ./form/gl_ksd_data WITH "INPUT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_ksd.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_ksd.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_ksd.scx::Cmddatatop1
**
PROCEDURE Click
GOTO TOP
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_ksd.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(cif),tanggal,TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama))"+" LIKE "+UPPER(MFILTER)
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_ksd.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_ksd.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_ksd.scx::Cmddatabott1
**
PROCEDURE Click
GOTO BOTTOM
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_ksd.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_ksd.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM gl_ksd_data WITH "TAMPIL"
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM gl_ksd_data WITH "TAMPIL"
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_ksd.scx::cmdcetak
**
PROCEDURE Click
DEFINE POPUP POPUPLAP FROM 5, 43 FONT "Cambria", 10
DEFINE BAR 1 OF POPUPLAP PROMPT 'Cetak Laporan .................. '
DEFINE BAR 2 OF POPUPLAP PROMPT 'Cetak Validasi ......................'
ON SELECTION BAR 1 OF POPUPLAP MESSAGEBOX("111111111111111111111111111")
ON SELECTION BAR 2 OF POPUPLAP MESSAGEBOX("2222222222222222222222222222221")
ACTIVATE POPUP POPUPLAP
ENDPROC
**
***
*** gl_ksd.sct
***
*
***
*** gl_aba.scx
***
*
*
*  gl_aba.scx::PERKIRAAN
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 5
.BACKCOLOR = RGB(217, 217, 255)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "NOPER"
.COLUMN1.HEADER1.CAPTION = "NOPER"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "NOACCOUNT"
.COLUMN2.HEADER1.CAPTION = "NO. REKENING BANK"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 300
.COLUMN3.CONTROLSOURCE = "NAMA"
.COLUMN3.HEADER1.CAPTION = "NAMA BANK"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 60
.COLUMN4.CONTROLSOURCE = "RATE"
.COLUMN4.HEADER1.CAPTION = "RATE(%)"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 60
.COLUMN5.CONTROLSOURCE = "PROSEN_PPAP"
.COLUMN5.HEADER1.CAPTION = "PPAP(%)"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
CSQL = "select * from gl_antarbank limit 50"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.MLIMIT.VALUE = 50
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
FUNCTION Unload
MNOMORBUKU = NOMORID
SELECT (THISFORM.DATA)
USE
SELECT (THISFORM.OLDSELECT)
RETURN MNOMORBUKU
ENDFUNC
**
PROCEDURE Activate
THISFORM.WIDTH = 700
ENDPROC
**
*
*  gl_aba.scx::Cmdhapus
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_aba.scx::Cmdedit
**
PROCEDURE Click
MYDATA = THISFORM.DATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM gl_aba_data WITH "EDIT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_aba.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
MYDATA = THISFORM.DATA
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("AKT", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("AKT", "HAPUS")
THISFORM.CMDCETAK.VISIBLE = IJINMODUL("AKT", "CETAK")
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM gl_aba_data WITH "INPUT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_aba.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_aba.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_aba.scx::Cmddatatop1
**
PROCEDURE Click
GOTO TOP
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_aba.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(cif),tanggal,TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama))"+" LIKE "+UPPER(MFILTER)
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_aba.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_aba.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_aba.scx::Cmddatabott1
**
PROCEDURE Click
GOTO BOTTOM
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_aba.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_aba.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
IF THISFORM.MODE="CARI"
THISFORM.RELEASE
RETURN
ENDIF
DO FORM gl_aba_data WITH "TAMPIL"
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM gl_aba_data WITH "TAMPIL"
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_aba.scx::Cmdcetak
**
PROCEDURE Click
DEFINE POPUP POPUPLAP FROM 5, 43 FONT "Cambria", 10
DEFINE BAR 1 OF POPUPLAP PROMPT 'Cetak Laporan .................. '
DEFINE BAR 2 OF POPUPLAP PROMPT 'Cetak Validasi ......................'
ON SELECTION BAR 1 OF POPUPLAP MESSAGEBOX("111111111111111111111111111")
ON SELECTION BAR 2 OF POPUPLAP MESSAGEBOX("2222222222222222222222222222221")
ACTIVATE POPUP POPUPLAP
ENDPROC
**
***
*** gl_aba.sct
***
*
***
*** gl_biayadimuka.scx
***
*
*
*  gl_biayadimuka.scx::BIAYADIMUKA
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 9
.BACKCOLOR = RGB(217, 217, 255)
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "KODE"
.COLUMN1.HEADER1.CAPTION = "KODE"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA BARANG"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 125
.COLUMN3.CONTROLSOURCE = "TANGGAL"
.COLUMN3.HEADER1.CAPTION = "TGL.TRANSAKSI"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 125
.COLUMN4.CONTROLSOURCE = "BIAYA"
.COLUMN4.HEADER1.CAPTION = "BIAYA"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 50
.COLUMN5.CONTROLSOURCE = "LAMA"
.COLUMN5.HEADER1.CAPTION = "LAMA"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 125
.COLUMN6.CONTROLSOURCE = "AMORTISASI"
.COLUMN6.HEADER1.CAPTION = "AMORTISASI / BLN"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN7.WIDTH = 125
.COLUMN7.CONTROLSOURCE = "AKUMULASI"
.COLUMN7.HEADER1.CAPTION = "AKUMULASI"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN8.WIDTH = 125
.COLUMN8.CONTROLSOURCE = "SISA"
.COLUMN8.HEADER1.CAPTION = "SISA BIAYA"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN9.WIDTH = 125
.COLUMN9.CONTROLSOURCE = "TGLMUTASI"
.COLUMN9.HEADER1.CAPTION = "PENYST TERAKHIR"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
MFILTER = IIF(EMPTY(THISFORM.MFILTER.CAPTION), '1', THISFORM.MFILTER.CAPTION)
CSQL = "select * from gl_biayadimuka where "
CSQL = CSQL+MFILTER+' order by tanggal'
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("AKT", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("AKT", "HAPUS")
THISFORM.CMDCETAK.VISIBLE = IJINMODUL("AKT", "CETAK")
THISFORM.CMDCATATAN.VISIBLE = IJINMODUL("AKT", "CATATAN")
THISFORM.MLIMIT.VALUE = 50
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA)
MNOMORID = NOMORID
USE
SELECT (THISFORM.OLDSELECT)
RETURN MNOMORID
ENDFUNC
**
PROCEDURE Activate
THIS.WINDOWSTATE = 2
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmdhapus
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmdedit
**
PROCEDURE Click
MYDATA = THISFORM.DATA
SELECT &MYDATA
DO FORM gl_biayadimuka_data WITH "EDIT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
MYDATA = THISFORM.DATA
SELECT &MYDATA
DO FORM gl_biayadimuka_data WITH "INPUT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmddatatop1
**
PROCEDURE Click
GOTO TOP
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(cif),tanggal,TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama))"+" LIKE "+UPPER(MFILTER)
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmdcatatan
**
PROCEDURE Click
SELECT (THISFORM.DATA)
DO FORM .\form\catatan WITH "BDD", KODE
SELECT (THISFORM.DATA)
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmddatabott1
**
PROCEDURE Click
GOTO BOTTOM
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_biayadimuka.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_biayadimuka.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM gl_biayadimuka_data WITH "TAMPIL"
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM gl_biayadimuka_data WITH "TAMPIL"
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_biayadimuka.scx::cmdceta
**
PROCEDURE Click
DEFINE POPUP POPUPLAP FROM 5, 43 FONT "Cambria", 10
DEFINE BAR 1 OF POPUPLAP PROMPT 'Cetak Laporan .................. '
DEFINE BAR 2 OF POPUPLAP PROMPT 'Cetak Validasi ......................'
ON SELECTION BAR 1 OF POPUPLAP MESSAGEBOX("111111111111111111111111111")
ON SELECTION BAR 2 OF POPUPLAP MESSAGEBOX("2222222222222222222222222222221")
ACTIVATE POPUP POPUPLAP
ENDPROC
**
***
*** gl_biayadimuka.sct
***
*
***
*** gl_inventaris.scx
***
*
*
*  gl_inventaris.scx::INVENTARIS
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 10
.BACKCOLOR = RGB(217, 217, 255)
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "KODE"
.COLUMN1.HEADER1.CAPTION = "KODE"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA BARANG"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 125
.COLUMN3.CONTROLSOURCE = "TANGGAL"
.COLUMN3.HEADER1.CAPTION = "TGL.PEROLEHAN"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 125
.COLUMN4.CONTROLSOURCE = "HARGA"
.COLUMN4.INPUTMASK = '999,999,999,999,999'
.COLUMN4.ALIGNMENT = 1
.COLUMN4.HEADER1.CAPTION = "HARGA PEROLEHAN"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 50
.COLUMN5.CONTROLSOURCE = "GOL"
.COLUMN5.HEADER1.CAPTION = "GOL"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 50
.COLUMN6.CONTROLSOURCE = "LAMA"
.COLUMN6.HEADER1.CAPTION = "LAMA"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN7.WIDTH = 125
.COLUMN7.INPUTMASK = '9,999,999,999'
.COLUMN7.ALIGNMENT = 1
.COLUMN7.CONTROLSOURCE = "PENYUSUTAN"
.COLUMN7.HEADER1.CAPTION = "PENYUSUTAN / BLN"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN8.WIDTH = 125
.COLUMN8.INPUTMASK = '999,999,999,999,999'
.COLUMN8.ALIGNMENT = 1
.COLUMN8.CONTROLSOURCE = "AKUMULASI"
.COLUMN8.HEADER1.CAPTION = "AKUMULASI"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN9.WIDTH = 125
.COLUMN9.INPUTMASK = '999,999,999,999,999'
.COLUMN9.ALIGNMENT = 1
.COLUMN9.CONTROLSOURCE = "NILAIBUKU"
.COLUMN9.HEADER1.CAPTION = "NILAI BUKU"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 10
.COLUMN10.WIDTH = 125
.COLUMN10.CONTROLSOURCE = "TGLMUTASI"
.COLUMN10.HEADER1.CAPTION = "PENYST TERAKHIR"
.COLUMN10.HEADER1.FONTBOLD = .T.
.COLUMN10.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
MFILTER = IIF(EMPTY(THISFORM.MFILTER.CAPTION), '1', THISFORM.MFILTER.CAPTION)
CSQL = "select * from gl_inventaris where "
CSQL = CSQL+MFILTER+' order by gol,nomorid'
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
PROCEDURE Activate
THIS.WINDOWSTATE = 2
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA)
USE
SELECT (THISFORM.OLDSELECT)
RETURN
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("AKT", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("AKT", "HAPUS")
THISFORM.CMDCETAK.VISIBLE = IJINMODUL("AKT", "CETAK")
THISFORM.CMDPROSES.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.MLIMIT.VALUE = 50
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
*
*  gl_inventaris.scx::Cmdhapus
**
PROCEDURE Click
DO FORM ./form/gl_inventaris_data WITH "HAPUS"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_inventaris.scx::Cmdedit
**
PROCEDURE Click
DO FORM ./form/gl_inventaris_data WITH "EDIT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_inventaris.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM ./form/gl_inventaris_data WITH "INPUT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_inventaris.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_inventaris.scx::Cmddatatop1
**
PROCEDURE Click
GOTO TOP
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_inventaris.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(cif),tanggal,TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama))"+" LIKE "+UPPER(MFILTER)
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_inventaris.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_inventaris.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_inventaris.scx::Cmddatabott1
**
PROCEDURE Click
GOTO BOTTOM
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_inventaris.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_inventaris.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE DblClick
DO FORM .\form\gl_inventaris_data WITH "TAMPIL"
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM .\form\gl_inventaris_data WITH "TAMPIL"
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
*
*  gl_inventaris.scx::cmdcetak
**
PROCEDURE Click
REPORT FORM akt_inventaris2 PREVIEW
ENDPROC
**
*
*  gl_inventaris.scx::cmdproses
**
PROCEDURE Click
SELECT (THISFORM.DATA)
MNOMORID = NOMORID
MPENYBLN = PENYUSUTAN
CSQL = "select SUM(debet)- SUM(kredit) as akum from gl_inventaris_mutasi where nomorid='"+STR(MNOMORID)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MPENY = 0
IF TGLNOW=AKHIRBLN(TGLNOW)
MPENY = ROUND((DAY(TGLNOW))/30*MPENYBLN, 0)
ENDIF
SELECT (THISFORM.DATA)
ENDPROC
**
***
*** gl_inventaris.sct
***
*
***
*** gl_jurnal.scx
***
*
*
*  gl_jurnal.scx::JURNAL
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
THISFORM.GRID1.RECORDSOURCE = MYDATA
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 5
.COLUMN1.WIDTH = 80
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 75
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 70
.COLUMN3.CONTROLSOURCE = "NOPER"
.COLUMN3.HEADER1.CAPTION = "NOPER"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN3.FORMAT = 'R'
.COLUMN3.INPUTMASK = DEFAFMTAKT
.COLUMN4.WIDTH = 300
.COLUMN4.CONTROLSOURCE = "KETERANGAN"
.COLUMN4.HEADER1.CAPTION = "KETERANGAN"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "JUMLAH"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "JUMLAH"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
ENDWITH
THISFORM.GRID1.REFRESH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(val(no), 2)=0, RGB(217,217,255) , RGB(128,128,255))", "Column")
MCARI = THISFORM.MCARI
IF  .NOT. EMPTY(MCARI)
THISFORM.GRID1.SETALL("DynamicForeColor", "IIF("+MCARI+", RGB(255,0,0) , RGB(0,0,0))", "Column")
ENDIF
ENDPROC
**
PROCEDURE mybacasql
MLIMIT = ALLTRIM(STR(MAX((THISFORM.MHAL.VALUE-1)*THISFORM.MLIMIT.VALUE, 0)))+", "+ALLTRIM(STR(THISFORM.MLIMIT.VALUE))
MDATA = THISFORM.DATA
MTGLBATAS = TRANSFORM(DAY(TGLNOW), '99')+"-"+TRANSFORM(MONTH(TGLNOW), "99")+"-"+TRANSFORM(YEAR(TGLNOW)-1, "9999")
MTGLBATAS = CTOD(MTGLBATAS)
CSQL = "select idtrans,tanggal,bukti,noper,keterangan,jumlah,DAY(tanggal) as no from jurnal where kantor='"+DEFAKANTOR+"' and "+THISFORM.MFILTER.CAPTION+" order by tanggal,bukti,if(jumlah>0,'+','-') "+" limit "+MLIMIT
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX("Data tidak terbaca")
ENDIF
GOTO TOP
MTANGGAL = TANGGAL
MBUKTI = BUKTI
MNO = 1
DO WHILE  .NOT. EOF()
IF TANGGAL=MTANGGAL .AND. BUKTI=MBUKTI
REPLACE NO WITH ALLTRIM(STR(MNO))
ELSE
MTANGGAL = TANGGAL
MBUKTI = BUKTI
MNO = MNO+1
REPLACE NO WITH ALLTRIM(STR(MNO))
ENDIF
SKIP
ENDDO
GOTO TOP
ENDPROC
**
PROCEDURE mytampil2
MNOPER = NOPER
IF VARTYPE(NOPER)="C"
CSQL = "select nama,detail from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK>=1
THISFORM.TEXT1.VALUE = NAMA
IF DETAIL='T'
THISFORM.TEXT1.FORECOLOR = RGB(255, 0, 0)
ELSE
THISFORM.TEXT1.FORECOLOR = RGB(0, 0, 0)
ENDIF
USE
ENDIF
ELSE
THISFORM.TEXT1.VALUE = ""
ENDIF
SELECT (THISFORM.DATA)
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("AKT", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("AKT", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("AKT", "HAPUS")
THISFORM.CMDCETAK.VISIBLE = IJINMODUL("AKT", "CETAK")
THISFORM.MLIMIT.VALUE = 500
THISFORM.MFILTER.CAPTION = '1'
THISFORM.DATA = SYS(2015)
CSQL = "select COUNT(tanggal) as jml from jurnal where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.JUMREC = IIF(ISNULL(JML), 0, VAL(JML))
THISFORM.HALAMAN = INT(THISFORM.JUMREC/THISFORM.MLIMIT.VALUE)+1
THISFORM.MHAL.VALUE = THISFORM.HALAMAN
USE
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE Activate
THIS.WIDTH = 800
THIS.HEIGHT = 500
ENDPROC
**
*
*  gl_jurnal.scx::Cmdhapus
**
PROCEDURE Click
DO FORM gl_jurnal_input WITH "HAPUS"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_jurnal.scx::Cmdedit
**
PROCEDURE Click
DO FORM gl_jurnal_input WITH "EDIT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_jurnal.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
DO FORM gl_jurnal_input WITH "INPUT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_jurnal.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_jurnal.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_jurnal.scx::Cmddatatop1
**
PROCEDURE Click
IF THISFORM.MHAL.VALUE=1
MESSAGEBOX("Halaman Pertama", 16, "")
ENDIF
THISFORM.MHAL.VALUE = MAX(1, THISFORM.MHAL.VALUE-1)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_jurnal.scx::Cmdcari1
**
PROCEDURE Click
DO FORM gl_jurnal_cari
CSQL = "select COUNT(tanggal) as jml from jurnal where "+THISFORM.MFILTER.CAPTION
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.JUMREC = IIF(ISNULL(JML), 0, VAL(JML))
THISFORM.HALAMAN = INT(THISFORM.JUMREC/THISFORM.MLIMIT.VALUE)
THISFORM.MHAL.VALUE = THISFORM.HALAMAN
THISFORM.MYBACASQL()
IF  .NOT. EMPTY(THISFORM.MCARI)
A = "LOCATE FOR "+THISFORM.MCARI
&A
ENDIF
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_jurnal.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_jurnal.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_jurnal.scx::Cmddatabott1
**
PROCEDURE Click
IF THISFORM.MHAL.VALUE=THISFORM.HALAMAN
MESSAGEBOX("Halaman Terakhir", 16, "")
ENDIF
THISFORM.MHAL.VALUE = MIN(THISFORM.HALAMAN, THISFORM.MHAL.VALUE+1)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_jurnal.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  gl_jurnal.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM gl_jurnal_input WITH "TAMPIL"
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  gl_jurnal.scx::Command10
**
PROCEDURE Click
DO FORM form_pbk TO HASIL WITH "AKT"
IF HASIL
SELECT (THISFORM.OLDSELECT)
REPLACE TGLVALUTA WITH TGLNOW
ENDIF
ENDPROC
**
***
*** gl_jurnal.sct
***
*
***
*** kas_rincian.frx
***
*
***
*** kas_rincian.frt
***
*
***
*** simpanan_blokir.scx
***
*
*
*  simpanan_blokir.scx::Form1
**
PROCEDURE myenable
WITH THISFORM
.TEXT1.ENABLED = .T.
.TEXT2.ENABLED = .T.
.TEXT3.ENABLED = .T.
.TEXT8.ENABLED = .T.
.CHECK1.ENABLED = .T.
.OPTIONGROUP2.ENABLED = .T.
ENDWITH
ENDPROC
**
PROCEDURE mydisable
WITH THISFORM
.TEXT1.ENABLED = .F.
.TEXT2.ENABLED = .F.
.TEXT3.ENABLED = .F.
.TEXT8.ENABLED = .F.
.CHECK1.ENABLED = .F.
.OPTIONGROUP2.ENABLED = .F.
ENDWITH
ENDPROC
**
PROCEDURE bacasql
MNOREK = THISFORM.NOREK
MDATA = THISFORM.DATA1
CSQL = "select * from simpanan_blokir where norek=?mnorek"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX("Gagal Baca data")
ENDIF
WITH THISFORM.GRID1
.RECORDSOURCE = MDATA
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TGL BLOKIR"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 250
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "KETERANGAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "TGLCABUT"
.COLUMN3.HEADER1.CAPTION = "TGL.BUKA BLOKIR"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(tglcabut=CTOD('  -  -    '), RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE tampil
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = SALDOBLOKIR
THISFORM.TEXT3.VALUE = KETERANGAN
THISFORM.TEXT8.VALUE = TGLAKHIRBLOKIR
THISFORM.TEXT4.VALUE = TGLCABUT
THISFORM.OPTIONGROUP2.VALUE = IIF(TANPABATAS='Y', 2, 1)
THISFORM.CHECK1.VALUE = IIF(BLOKIRSEMUA='Y', 1, 0)
THISFORM.TEXT2.INPUTMASK = "999,999,999,999"
THISFORM.TEXT3.INPUTMASK = REPLICATE("!", 40)
THISFORM.LABEL1.FONTBOLD = .F.
THISFORM.LABEL2.FONTBOLD = .F.
THISFORM.LABEL3.FONTBOLD = .F.
THISFORM.LABEL4.FONTBOLD = .F.
THISFORM.LABEL5.FONTBOLD = .F.
THISFORM.LABEL9.FONTBOLD = .F.
THISFORM.OPTIONGROUP2.OPTION1.FONTBOLD = .F.
THISFORM.OPTIONGROUP2.OPTION2.FONTBOLD = .F.
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK
THISFORM.DATA1 = SYS(2015)
THISFORM.OLDSELECT = SELECT()
THISFORM.NOREK = MNOREK
THISFORM.LABEL2.CAPTION = "Blokir Simpanan"
THISFORM.BACASQL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT1.CLICK
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT1.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  simpanan_blokir.scx::Text2
**
PROCEDURE LostFocus
IF LASTKEY()=13
THISFORM.TEXT3.SETFOCUS
ENDIF
ENDPROC
**
*
*  simpanan_blokir.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=13
THISFORM.TEXT8.SETFOCUS
ENDIF
ENDPROC
**
*
*  simpanan_blokir.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_blokir.scx::Cmdedit1
**
PROCEDURE Click
THISFORM.CMDINPUT1.VISIBLE = .F.
THISFORM.CMDEDIT1.VISIBLE = .F.
THISFORM.CMDHAPUS1.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDKELUAR1.VISIBLE = .F.
THISFORM.MYENABLE()
THISFORM.TEXT1.SETFOCUS
THISFORM.EDIT = "EDIT"
ENDPROC
**
*
*  simpanan_blokir.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT1.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS1.CLICK
ENDIF
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL()
ENDPROC
**
*
*  simpanan_blokir.scx::Cmdsimpan1
**
PROCEDURE Click
THISFORM.CMDINPUT1.VISIBLE = .T.
THISFORM.CMDEDIT1.VISIBLE = .T.
THISFORM.CMDHAPUS1.VISIBLE = .T.
THISFORM.CMDSELESAI.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDKELUAR1.VISIBLE = .T.
THISFORM.MYDISABLE()
MNOREK = THISFORM.NOREK
MCIF = THISFORM.CIF
MIDBLOKIR = IDBLOKIR
MTANGGAL = THISFORM.TEXT1.VALUE
MSALDOBLOKIR = THISFORM.TEXT2.VALUE
MBLOKIRSEMUA = IIF(THISFORM.CHECK1.VALUE=1, "Y", "T")
MKETERANGAN = THISFORM.TEXT3.VALUE
MTGLAKHIRBLOKIR = THISFORM.TEXT8.VALUE
MTANPABATAS = IIF(THISFORM.OPTIONGROUP2.OPTION2.VALUE=1, "Y", "T")
IF THISFORM.EDIT="INPUT"
CSQL = "insert into simpanan_blokir (kantor,norek, tanggal, saldoblokir, "+"blokirsemua, keterangan, tglakhirblokir, tanpabatas)  "+"values ('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTANGGAL)+"','"+STR(MSALDOBLOKIR)+"','"+MBLOKIRSEMUA+"','"+MKETERANGAN+"','"+SQLDATE(MTGLAKHIRBLOKIR)+"','"+MTANPABATAS+"')"
ELSE
CSQL = "UPDATE simpanan_blokir set tanggal='"+SQLDATE(MTANGGAL)+"', saldoblokir='"+STR(MSALDOBLOKIR)+"', "+"blokirsemua='"+MBLOKIRSEMUA+"', keterangan='"+MKETERANGAN+"', tglakhirblokir='"+SQLDATE(MTGLAKHIRBLOKIR)+"', "+"tanpabatas='"+MTANPABATAS+"' "+"where norek='"+MNOREK+"' and idblokir='"+STR(MIDBLOKIR)+"'"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "BLOKIR")
IF LCEK<1
MESSAGEBOX("Gagal simpan data Blokir")
MESSAGEBOX(CSQL)
ENDIF
THISFORM.BACASQL()
ENDPROC
**
*
*  simpanan_blokir.scx::Cmdinput1
**
PROCEDURE Click
THISFORM.CMDINPUT1.VISIBLE = .F.
THISFORM.CMDEDIT1.VISIBLE = .F.
THISFORM.CMDHAPUS1.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDKELUAR1.VISIBLE = .F.
THISFORM.MYENABLE()
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT2.VALUE = 0
THISFORM.TEXT3.VALUE = SPACE(40)
THISFORM.TEXT8.VALUE = CTOD('  -  -    ')
THISFORM.TEXT4.VALUE = CTOD('  -  -    ')
THISFORM.OPTIONGROUP2.OPTION1.VALUE = 1
THISFORM.TEXT1.SETFOCUS
THISFORM.EDIT = "INPUT"
ENDPROC
**
*
*  simpanan_blokir.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_blokir.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.CMDINPUT1.VISIBLE = .T.
THISFORM.CMDEDIT1.VISIBLE = .T.
THISFORM.CMDHAPUS1.VISIBLE = .T.
THISFORM.CMDSELESAI.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDKELUAR1.VISIBLE = .T.
THISFORM.MYDISABLE()
THISFORM.TAMPIL()
ENDPROC
**
*
*  simpanan_blokir.scx::Check1
**
PROCEDURE Click
IF THIS.VALUE=1
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT2.BACKSTYLE = 1
THISFORM.TEXT2.DISABLEDFORECOLOR = RGB(172, 168, 153)
ELSE
THISFORM.TEXT2.ENABLED = .T.
THISFORM.TEXT2.BACKSTYLE = 0
ENDIF
ENDPROC
**
*
*  simpanan_blokir.scx::Optiongroup2
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.TEXT8.ENABLED = .T.
THISFORM.TEXT8.SETFOCUS
ELSE
THISFORM.TEXT8.ENABLED = .F.
ENDIF
ENDPROC
**
PROCEDURE Option1.Click
THISFORM.TEXT8.ENABLED = .T.
IF THIS.VALUE=1
THISFORM.TEXT8.BACKSTYLE = 0
ENDIF
THISFORM.TEXT8.SETFOCUS
ENDPROC
**
PROCEDURE Option2.Click
THISFORM.TEXT8.ENABLED = .F.
IF THIS.VALUE=1
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT8.BACKSTYLE = 1
THISFORM.TEXT8.DISABLEDFORECOLOR = RGB(172, 168, 153)
ELSE
THISFORM.TEXT8.ENABLED = .T.
THISFORM.TEXT8.BACKSTYLE = 0
ENDIF
ENDPROC
**
*
*  simpanan_blokir.scx::cmdselesai
**
PROCEDURE Click
OLDSELE = ALIAS()
DO FORM simpanan_cabut_auto WITH 2
SELECT &OLDSELE
THISFORM.TEXT4.VALUE = TGLCABUT
ENDPROC
**
***
*** simpanan_blokir.sct
***
*
***
*** simpanan_setproduk1.scx
***
*
*
*  simpanan_setproduk1.scx::FORM1
**
PROCEDURE menable
PARAMETER MKONDISI
THIS.SETALL("enabled", MKONDISI, "Textbox")
THIS.SETALL("enabled", MKONDISI, "Optiongroup")
THIS.SETALL("enabled", MKONDISI, "checkbox")
THISFORM.CMDSIMPAN1.VISIBLE = MKONDISI
THISFORM.CMDBATAL1.VISIBLE = MKONDISI
THISFORM.CMDKELUAR1.VISIBLE =  .NOT. MKONDISI
THISFORM.CMDEDIT1.VISIBLE =  .NOT. MKONDISI
ENDPROC
**
PROCEDURE myinput
WITH THISFORM
.TEXT7.VALUE = ''
.TEXT8.VALUE = ''
.TEXT5.VISIBLE = .F.
.TEXT6.VISIBLE = .F.
.TEXT5.VALUE = 180
.TEXT6.VALUE = 10000
.OPTIONGROUP2.VALUE = 1
.OPTIONGROUP5.VALUE = 1
.TEXT1.VALUE = 0
.OPTIONGROUP3.VALUE = 1
.TEXT2.VALUE = 0
.TEXT3.VALUE = 0
.OPTIONGROUP4.VALUE = 1
.TEXT4.VALUE = 0
.TEXT9.VALUE = 10000
.TEXT10.VALUE = 10000
.TEXT11.VALUE = 7500000
.TEXT12.VALUE = 20
.TEXT13.VALUE = 'T'
ENDWITH
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MYMODE = MMODE
THISFORM.OLDSELECT = SELECT()
SELECT (THISFORM.OLDSELECT)
THISFORM.TEXT7.VALUE = SANDI
THISFORM.TEXT8.VALUE = KETERANGAN
THISFORM.MENABLE(.F.)
THISFORM.CONTAINER1.CHECK1.VALUE = 1
WITH THISFORM
.SQL1 = ''
.SQL2 = ''
.SQL3 = ''
.SQL4 = ''
.SQL5 = ''
.TEXT8.INPUTMASK = REPLICATE('!', 30)
.TEXT5.VISIBLE = .F.
.TEXT6.VISIBLE = .F.
DO CASE
CASE OPTPASIF=0
.CONTAINER1.CHECK1.VALUE = 0
.CONTAINER1.CHECK2.VALUE = 0
CASE OPTPASIF=1
.CONTAINER1.CHECK1.VALUE = 1
.CONTAINER1.CHECK2.VALUE = 0
CASE OPTPASIF=2
.CONTAINER1.CHECK1.VALUE = 0
.CONTAINER1.CHECK2.VALUE = 1
CASE OPTPASIF=3
.CONTAINER1.CHECK1.VALUE = 1
.CONTAINER1.CHECK2.VALUE = 1
OTHERWISE
.CONTAINER1.CHECK1.VALUE = 0
.CONTAINER1.CHECK2.VALUE = 0
ENDCASE
IF .CONTAINER1.CHECK1.VALUE=1 .OR. .CONTAINER1.CHECK2.VALUE=3
.TEXT5.VALUE = HARIPASIF
.TEXT5.VISIBLE = .T.
ENDIF
IF .CONTAINER1.CHECK1.VALUE=2 .OR. .CONTAINER1.CHECK2.VALUE=3
.TEXT6.VISIBLE = .T.
.TEXT6.VALUE = NOMIPASIF
ENDIF
.OPTIONGROUP2.VALUE = VER
.OPTIONGROUP5.VALUE = OPTHARI
IF THISFORM.OPTIONGROUP2.VALUE=4
THISFORM.TEXT1.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .T.
ELSE
THISFORM.TEXT1.VISIBLE = .T.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
.TEXT1.VALUE = (A_RATE)
.OPTIONGROUP3.VALUE = A_OPTADM
IF .OPTIONGROUP3.VALUE=1
.TEXT2.VISIBLE = .T.
.COMMAND2.VISIBLE = .F.
ELSE
.TEXT2.VISIBLE = .F.
.COMMAND2.VISIBLE = .T.
ENDIF
.TEXT2.VALUE = A_ADM
.TEXT3.VALUE = (P_RATE)
.OPTIONGROUP4.VALUE = P_OPTADM
IF .OPTIONGROUP4.VALUE=1
.TEXT4.VISIBLE = .T.
.COMMAND4.VISIBLE = .F.
ELSE
.TEXT4.VISIBLE = .F.
.COMMAND4.VISIBLE = .T.
ENDIF
.TEXT4.VALUE = P_ADM
.TEXT9.VALUE = SALDOMINIMAL
.TEXT10.VALUE = BATASBUNGA
.TEXT11.VALUE = BATASPAJAK
.TEXT12.VALUE = (PAJAK)
.TEXT13.VALUE = ANTARBANK
ENDWITH
THISFORM.MYMODE = MMODE
IF MMODE="INPUT"
THISFORM.MENABLE(.T.)
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
ENDIF
IF MMODE="EDIT"
THISFORM.MENABLE(.T.)
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1.scx::Optiongroup2
**
PROCEDURE InteractiveChange
IF THIS.VALUE=4
THISFORM.TEXT1.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .T.
ELSE
THISFORM.TEXT1.VISIBLE = .T.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1.scx::Command5
**
PROCEDURE Click
DO FORM simpanan_setproduk1_lainnya WITH THISFORM.TEXT7.VALUE, THISFORM.MYMODE
ENDPROC
**
*
*  simpanan_setproduk1.scx::Command6
**
PROCEDURE Click
DO FORM SIMPANAN_SETPRODUK1_JURNAL WITH THISFORM.TEXT7.VALUE, 'TAB', IIF(THISFORM.MYMODE="TAMPIL", "TAMPIL", "EDIT")
ENDPROC
**
*
*  simpanan_setproduk1.scx::Cmdsimpan1
**
PROCEDURE Click
THISFORM.CMDEDIT1.VISIBLE = .T.
DO CASE
CASE THISFORM.CONTAINER1.CHECK1.VALUE=0 .AND. THISFORM.CONTAINER1.CHECK2.VALUE=0
MOPTPASIF = '0'
CASE THISFORM.CONTAINER1.CHECK1.VALUE=1 .AND. THISFORM.CONTAINER1.CHECK2.VALUE=0
MOPTPASIF = '1'
CASE THISFORM.CONTAINER1.CHECK1.VALUE=0 .AND. THISFORM.CONTAINER1.CHECK2.VALUE=1
MOPTPASIF = '2'
CASE THISFORM.CONTAINER1.CHECK1.VALUE=1 .AND. THISFORM.CONTAINER1.CHECK2.VALUE=1
MOPTPASIF = '3'
ENDCASE
WITH THISFORM
IF THISFORM.MYMODE="INPUT"
CSQL = "UPDATE setsandi_tab set "+"SANDI='"+.TEXT7.VALUE+"',"+"KETERANGAN='"+.TEXT8.VALUE+"',"+"OPTPASIF='"+MOPTPASIF+"',"+"HARIPASIF='"+STR(.TEXT5.VALUE)+"',"+"NOMIPASIF='"+STR(.TEXT6.VALUE)+"',"+"VER='"+STR(.OPTIONGROUP2.VALUE)+"',"+"OPTHARI='"+STR(.OPTIONGROUP5.VALUE)+"',"+"A_RATE='"+TRANSFORM(.TEXT1.VALUE, '999.99')+"',"+"A_OPTADM='"+STR(.OPTIONGROUP3.VALUE)+"',"+"A_ADM='"+STR(.TEXT2.VALUE)+"',"+"P_RATE='"+TRANSFORM(.TEXT3.VALUE, '999.99')+"',"+"P_OPTADM='"+STR(.OPTIONGROUP4.VALUE)+"',"+"P_ADM='"+TRANSFORM(.TEXT4.VALUE, '999.99')+"',"+"ANTARBANK='"+.TEXT13.VALUE+"',"+"SALDOMINIMAL='"+STR(.TEXT9.VALUE)+"',"+"BATASBUNGA='"+STR(.TEXT10.VALUE)+"',"+"BATASPAJAK='"+STR(.TEXT11.VALUE)+"',"+"PAJAK='"+STR(.TEXT12.VALUE)+"' "+"where sandi='"+SANDI+"'"
ELSE
CSQL = "UPDATE setsandi_tab set "+"SANDI='"+.TEXT7.VALUE+"',"+"KETERANGAN='"+.TEXT8.VALUE+"',"+"OPTPASIF='"+MOPTPASIF+"',"+"HARIPASIF='"+STR(.TEXT5.VALUE)+"',"+"NOMIPASIF='"+STR(.TEXT6.VALUE)+"',"+"VER='"+STR(.OPTIONGROUP2.VALUE)+"',"+"OPTHARI='"+STR(.OPTIONGROUP5.VALUE)+"',"+"A_RATE='"+TRANSFORM(.TEXT1.VALUE, '999.99')+"',"+"A_OPTADM='"+STR(.OPTIONGROUP3.VALUE)+"',"+"A_ADM='"+STR(.TEXT2.VALUE)+"',"+"P_RATE='"+TRANSFORM(.TEXT3.VALUE, '999.99')+"',"+"P_OPTADM='"+STR(.OPTIONGROUP4.VALUE)+"',"+"P_ADM='"+STR(.TEXT4.VALUE)+"',"+"ANTARBANK='"+.TEXT13.VALUE+"',"+"SALDOMINIMAL='"+STR(.TEXT9.VALUE)+"',"+"BATASBUNGA='"+STR(.TEXT10.VALUE)+"',"+"BATASPAJAK='"+STR(.TEXT11.VALUE)+"',"+"PAJAK='"+STR(.TEXT12.VALUE)+"' "+"where sandi='"+SANDI+"'"
ENDIF
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("TAB_SANDI gagal di akses")
RETURN
ENDIF
THISFORM.MENABLE(.F.)
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDKELUAR1.VISIBLE = .T.
ENDPROC
**
*
*  simpanan_setproduk1.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk1.scx::Cmdedit1
**
PROCEDURE Click
THISFORM.MYMODE = "EDIT"
THISFORM.MENABLE(.T.)
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDKELUAR1.VISIBLE = .F.
THISFORM.CMDEDIT1.VISIBLE = .F.
ENDPROC
**
*
*  simpanan_setproduk1.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk1.scx::Optiongroup5
**
PROCEDURE InteractiveChange
IF THIS.VALUE=4
THISFORM.TEXT1.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .T.
ELSE
THISFORM.TEXT1.VISIBLE = .T.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1.scx::Check1
**
PROCEDURE Click
IF THIS.VALUE=1
THISFORM.TEXT5.VISIBLE = .T.
ELSE
THISFORM.TEXT5.VISIBLE = .F.
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1.scx::Check2
**
PROCEDURE Click
IF THIS.VALUE=1
THISFORM.TEXT6.VISIBLE = .T.
ELSE
THISFORM.TEXT6.VISIBLE = .F.
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1.scx::Command1
**
PROCEDURE Click
DO FORM simpanan_setproduk1_bunga WITH "BUNGA BERJENJANG TABUNGAN AKTIF", 1, THISFORM.TEXT7.VALUE, THISFORM.MYMODE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  simpanan_setproduk1.scx::Command3
**
PROCEDURE Click
DO FORM simpanan_setproduk1_bunga TO MSQL WITH "BUNGA BERJENJANG TABUNGAN PASIF", 2, THISFORM.TEXT7.VALUE, THISFORM.MYMODE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  simpanan_setproduk1.scx::Optiongroup3
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.TEXT2.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
ELSE
THISFORM.TEXT2.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1.scx::Command2
**
PROCEDURE Click
DO FORM simpanan_setproduk1_bunga TO MSQL WITH "ADM BERJENJANG TABUNGAN AKTIF", 3, THISFORM.TEXT7.VALUE, THISFORM.MYMODE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  simpanan_setproduk1.scx::Optiongroup4
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.TEXT4.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
ELSE
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1.scx::Command4
**
PROCEDURE Click
DO FORM simpanan_setproduk1_bunga TO MSQL WITH "ADM BERJENJANG TABUNGAN PASIF", 4, THISFORM.TEXT7.VALUE, THISFORM.MYMODE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
***
*** simpanan_setproduk1.sct
***
*
***
*** simpanan_setproduk1_bunga.scx
***
*
*
*  simpanan_setproduk1_bunga.scx::FORM1
**
PROCEDURE menable
PARAMETER MKONDISI
THIS.SETALL("enabled", MKONDISI, "Textbox")
ENDPROC
**
PROCEDURE tampil
LOCAL OLDSELECT
OLDSELECT = SELECT()
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' and sandi='"+THISFORM.MYSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MPILIH = THISFORM.MYPILIHAN
WITH THISFORM
DO CASE
CASE MPILIH=1
IF A_RATE1>0 .OR. (A_NOMI_RATE1)>0
.CHECK1.VALUE = 1
.CHECK1.VISIBLE = .T.
.TEXT4.VISIBLE = .T.
.LABEL5.VISIBLE = .T.
.TEXT5.VISIBLE = .T.
.TEXT6.VISIBLE = .T.
ENDIF
IF A_RATE2>0 .OR. (A_NOMI_RATE2)>0
.CHECK2.VALUE = 1
.CHECK2.VISIBLE = .T.
.TEXT7.VISIBLE = .T.
.LABEL6.VISIBLE = .T.
.TEXT8.VISIBLE = .T.
.TEXT9.VISIBLE = .T.
ENDIF
IF A_RATE3>0 .OR. (A_NOMI_RATE3)>0
.CHECK3.VALUE = 1
.CHECK3.VISIBLE = .T.
.TEXT10.VISIBLE = .T.
.LABEL7.VISIBLE = .T.
.TEXT11.VISIBLE = .T.
.TEXT12.VISIBLE = .T.
ENDIF
IF A_RATE4>0 .OR. (A_NOMI_RATE4)>0
.CHECK4.VALUE = 1
.TEXT13.VISIBLE = .T.
.LABEL8.VISIBLE = .T.
.TEXT14.VISIBLE = .T.
.TEXT15.VISIBLE = .T.
ENDIF
.TEXT1.VALUE = 0
.TEXT2.VALUE = (A_NOMI_RATE1)
.TEXT4.VALUE = (A_NOMI_RATE1)
.TEXT5.VALUE = (A_NOMI_RATE2)
.TEXT7.VALUE = (A_NOMI_RATE2)
.TEXT8.VALUE = (A_NOMI_RATE3)
.TEXT10.VALUE = (A_NOMI_RATE3)
.TEXT11.VALUE = (A_NOMI_RATE4)
.TEXT13.VALUE = (A_NOMI_RATE4)
.TEXT14.VALUE = (A_NOMI_RATE5)
.TEXT3.VALUE = A_RATE1
.TEXT6.VALUE = A_RATE2
.TEXT9.VALUE = A_RATE3
.TEXT12.VALUE = A_RATE4
.TEXT15.VALUE = A_RATE5
.OPTIONGROUP1.VALUE = A_TYPE_RATE
CASE MPILIH=2
IF P_RATE1>0 .OR. (P_NOMI_RATE1)>0
.CHECK1.VALUE = 1
.CHECK1.VISIBLE = .T.
.TEXT4.VISIBLE = .T.
.LABEL5.VISIBLE = .T.
.TEXT5.VISIBLE = .T.
.TEXT6.VISIBLE = .T.
ENDIF
IF P_RATE2>0 .OR. (P_NOMI_RATE2)>0
.CHECK2.VALUE = 1
.CHECK2.VISIBLE = .T.
.TEXT7.VISIBLE = .T.
.LABEL6.VISIBLE = .T.
.TEXT8.VISIBLE = .T.
.TEXT9.VISIBLE = .T.
ENDIF
IF P_RATE3>0 .OR. (P_NOMI_RATE3)>0
.CHECK3.VALUE = 1
.CHECK3.VISIBLE = .T.
.TEXT10.VISIBLE = .T.
.LABEL7.VISIBLE = .T.
.TEXT11.VISIBLE = .T.
.TEXT12.VISIBLE = .T.
ENDIF
IF P_RATE4>0 .OR. (P_NOMI_RATE4)>0
.CHECK4.VALUE = 1
.TEXT13.VISIBLE = .T.
.LABEL8.VISIBLE = .T.
.TEXT14.VISIBLE = .T.
.TEXT15.VISIBLE = .T.
ENDIF
.TEXT1.VALUE = 0
.TEXT2.VALUE = (P_NOMI_RATE1)
.TEXT4.VALUE = (P_NOMI_RATE1)
.TEXT5.VALUE = (P_NOMI_RATE2)
.TEXT7.VALUE = (P_NOMI_RATE2)
.TEXT8.VALUE = (P_NOMI_RATE3)
.TEXT10.VALUE = (P_NOMI_RATE3)
.TEXT11.VALUE = (P_NOMI_RATE4)
.TEXT13.VALUE = (P_NOMI_RATE4)
.TEXT14.VALUE = (P_NOMI_RATE5)
.TEXT3.VALUE = P_RATE1
.TEXT6.VALUE = P_RATE2
.TEXT9.VALUE = P_RATE3
.TEXT12.VALUE = P_RATE4
.TEXT15.VALUE = P_RATE5
.OPTIONGROUP1.VALUE = P_TYPE_RATE
CASE MPILIH=3
IF A_ADM1>0 .OR. (A_NOMI_ADM1)>0
.CHECK1.VALUE = 1
.CHECK1.VISIBLE = .T.
.TEXT4.VISIBLE = .T.
.LABEL5.VISIBLE = .T.
.TEXT5.VISIBLE = .T.
.TEXT6.VISIBLE = .T.
ENDIF
IF A_ADM2>0 .OR. (A_NOMI_ADM2)>0
.CHECK2.VALUE = 1
.CHECK2.VISIBLE = .T.
.TEXT7.VISIBLE = .T.
.LABEL6.VISIBLE = .T.
.TEXT8.VISIBLE = .T.
.TEXT9.VISIBLE = .T.
ENDIF
IF A_ADM3>0 .OR. (A_NOMI_ADM3)>0
.CHECK3.VALUE = 1
.CHECK3.VISIBLE = .T.
.TEXT10.VISIBLE = .T.
.LABEL7.VISIBLE = .T.
.TEXT11.VISIBLE = .T.
.TEXT12.VISIBLE = .T.
ENDIF
IF A_ADM4>0 .OR. (A_NOMI_ADM4)>0
.CHECK4.VALUE = 1
.TEXT13.VISIBLE = .T.
.LABEL8.VISIBLE = .T.
.TEXT14.VISIBLE = .T.
.TEXT15.VISIBLE = .T.
ENDIF
.TEXT1.VALUE = 0
.TEXT2.VALUE = (A_NOMI_ADM1)
.TEXT4.VALUE = (A_NOMI_ADM1)
.TEXT5.VALUE = (A_NOMI_ADM2)
.TEXT7.VALUE = (A_NOMI_ADM2)
.TEXT8.VALUE = (A_NOMI_ADM3)
.TEXT10.VALUE = (A_NOMI_ADM3)
.TEXT11.VALUE = (A_NOMI_ADM4)
.TEXT13.VALUE = (A_NOMI_ADM4)
.TEXT14.VALUE = (A_NOMI_ADM5)
.TEXT3.VALUE = A_ADM1
.TEXT6.VALUE = A_ADM2
.TEXT9.VALUE = A_ADM3
.TEXT12.VALUE = A_ADM4
.TEXT15.VALUE = A_ADM5
.OPTIONGROUP1.VALUE = A_OPTADM
CASE MPILIH=4
IF P_ADM1>0 .OR. (P_NOMI_ADM1)>0
.CHECK1.VALUE = 1
.CHECK1.VISIBLE = .T.
.TEXT4.VISIBLE = .T.
.LABEL5.VISIBLE = .T.
.TEXT5.VISIBLE = .T.
.TEXT6.VISIBLE = .T.
ENDIF
IF P_ADM2>0 .OR. (P_NOMI_ADM2)>0
.CHECK2.VALUE = 1
.CHECK2.VISIBLE = .T.
.TEXT7.VISIBLE = .T.
.LABEL6.VISIBLE = .T.
.TEXT8.VISIBLE = .T.
.TEXT9.VISIBLE = .T.
ENDIF
IF P_ADM3>0 .OR. (P_NOMI_ADM3)>0
.CHECK3.VALUE = 1
.CHECK3.VISIBLE = .T.
.TEXT10.VISIBLE = .T.
.LABEL7.VISIBLE = .T.
.TEXT11.VISIBLE = .T.
.TEXT12.VISIBLE = .T.
ENDIF
IF P_ADM4>0 .OR. (P_NOMI_ADM4)>0
.CHECK4.VALUE = 1
.TEXT13.VISIBLE = .T.
.LABEL8.VISIBLE = .T.
.TEXT14.VISIBLE = .T.
.TEXT15.VISIBLE = .T.
ENDIF
.TEXT1.VALUE = 0
.TEXT2.VALUE = (P_NOMI_ADM1)
.TEXT4.VALUE = (P_NOMI_ADM1)
.TEXT5.VALUE = (P_NOMI_ADM2)
.TEXT7.VALUE = (P_NOMI_ADM2)
.TEXT8.VALUE = (P_NOMI_ADM3)
.TEXT10.VALUE = (P_NOMI_ADM3)
.TEXT11.VALUE = (P_NOMI_ADM4)
.TEXT13.VALUE = (P_NOMI_ADM4)
.TEXT14.VALUE = (P_NOMI_ADM5)
.TEXT3.VALUE = P_ADM1
.TEXT6.VALUE = P_ADM2
.TEXT9.VALUE = P_ADM3
.TEXT12.VALUE = P_ADM4
.TEXT15.VALUE = P_ADM5
.OPTIONGROUP1.VALUE = P_OPTADM
ENDCASE
ENDWITH
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE Init
PARAMETER MKOP, MPILIHAN, MSANDI, MMODE
THISFORM.MYSANDI = MSANDI
THISFORM.MYPILIHAN = MPILIHAN
THISFORM.LABEL22.CAPTION = MKOP
DO CASE
CASE MPILIHAN=1
CASE MPILIHAN=2
CASE MPILIHAN=3
CASE MPILIHAN=4
ENDCASE
IF MMODE="INPUT" .OR. MMODE="EDIT"
THISFORM.TAMPIL()
THISFORM.MENABLE(.T.)
THISFORM.CMDKELUAR.VISIBLE = .F.
ELSE
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.TAMPIL()
THISFORM.MENABLE(.F.)
ENDIF
IF MPILIHAN=3 .OR. MPILIHAN=4
THISFORM.OPTIONGROUP1.VISIBLE = .F.
THISFORM.LABEL4.CAPTION = "Administrasi"
WITH THISFORM
.TEXT3.INPUTMASK = '9,999,999'
.TEXT6.INPUTMASK = '9,999,999'
.TEXT9.INPUTMASK = '9,999,999'
.TEXT12.INPUTMASK = '9,999,999'
.TEXT15.INPUTMASK = '9,999,999'
ENDWITH
ELSE
THISFORM.OPTIONGROUP1.VISIBLE = .T.
THISFORM.LABEL4.CAPTION = "Rate"
WITH THISFORM
.TEXT3.INPUTMASK = '99.999'
.TEXT6.INPUTMASK = '99.999'
.TEXT9.INPUTMASK = '99.999'
.TEXT12.INPUTMASK = '99.999'
.TEXT15.INPUTMASK = '99.999'
ENDWITH
ENDIF
THISFORM.TEXT1.VALUE = 0
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Check1
**
PROCEDURE InteractiveChange
WITH THISFORM
IF THIS.VALUE=1
.CHECK2.VISIBLE = .T.
.TEXT4.VISIBLE = .T.
.LABEL5.VISIBLE = .T.
.TEXT5.VISIBLE = .T.
.TEXT6.VISIBLE = .T.
ENDIF
ENDWITH
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Text2
**
PROCEDURE InteractiveChange
THISFORM.TEXT4.VALUE = THIS.VALUE
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Check2
**
PROCEDURE InteractiveChange
WITH THISFORM
IF THIS.VALUE=1
.CHECK3.VISIBLE = .T.
.TEXT7.VISIBLE = .T.
.LABEL6.VISIBLE = .T.
.TEXT8.VISIBLE = .T.
.TEXT9.VISIBLE = .T.
ENDIF
ENDWITH
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Text5
**
PROCEDURE InteractiveChange
THISFORM.TEXT7.VALUE = THIS.VALUE
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Check3
**
PROCEDURE InteractiveChange
WITH THISFORM
IF THIS.VALUE=1
.CHECK4.VISIBLE = .T.
.TEXT10.VISIBLE = .T.
.LABEL7.VISIBLE = .T.
.TEXT11.VISIBLE = .T.
.TEXT12.VISIBLE = .T.
ENDIF
ENDWITH
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Text8
**
PROCEDURE InteractiveChange
THISFORM.TEXT10.VALUE = THIS.VALUE
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Check4
**
PROCEDURE InteractiveChange
WITH THISFORM
IF THIS.VALUE=1
.TEXT13.VISIBLE = .T.
.LABEL8.VISIBLE = .T.
.TEXT14.VISIBLE = .T.
.TEXT15.VISIBLE = .T.
ENDIF
ENDWITH
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Text11
**
PROCEDURE InteractiveChange
THISFORM.TEXT13.VALUE = THIS.VALUE
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::CmdBatal
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk1_bunga.scx::CmdSimpan
**
PROCEDURE Click
DO CASE
CASE THISFORM.MYPILIHAN=1
CSQL = "UPDATE setsandi_tab set "+"A_RATE='"+TRANSFORM(THISFORM.TEXT3.VALUE, '99.99')+"',"+"A_RATE1='"+TRANSFORM(THISFORM.TEXT3.VALUE, '99.99')+"',"+"A_RATE2='"+TRANSFORM(THISFORM.TEXT6.VALUE, '99.99')+"',"+"A_RATE3='"+TRANSFORM(THISFORM.TEXT9.VALUE, '99.99')+"',"+"A_RATE4='"+TRANSFORM(THISFORM.TEXT12.VALUE, '99.99')+"',"+"A_RATE5='"+TRANSFORM(THISFORM.TEXT15.VALUE, '99.99')+"',"+"A_NOMI_RATE1='"+TRANSFORM(THISFORM.TEXT2.VALUE, '999999999999999')+"',"+"A_NOMI_RATE2='"+TRANSFORM(THISFORM.TEXT5.VALUE, '999999999999999')+"',"+"A_NOMI_RATE3='"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"',"+"A_NOMI_RATE4='"+TRANSFORM(THISFORM.TEXT11.VALUE, '999999999999999')+"',"+"A_NOMI_RATE5='"+TRANSFORM(THISFORM.TEXT14.VALUE, '999999999999999')+"',"+"A_TYPE_RATE='"+STR(THISFORM.OPTIONGROUP1.VALUE)+"' where "+"kantor='"+DEFAKANTOR+"' and jenis='1' and sandi='"+THISFORM.MYSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
CASE THISFORM.MYPILIHAN=2
CSQL = "UPDATE setsandi_tab set "+"P_RATE='"+TRANSFORM(THISFORM.TEXT3.VALUE, '99.99')+"',"+"P_RATE1='"+TRANSFORM(THISFORM.TEXT3.VALUE, '99.99')+"',"+"P_RATE2='"+TRANSFORM(THISFORM.TEXT6.VALUE, '99.99')+"',"+"P_RATE3='"+TRANSFORM(THISFORM.TEXT9.VALUE, '99.99')+"',"+"P_RATE4='"+TRANSFORM(THISFORM.TEXT12.VALUE, '99.99')+"',"+"P_RATE5='"+TRANSFORM(THISFORM.TEXT15.VALUE, '99.99')+"',"+"P_NOMI_RATE1='"+TRANSFORM(THISFORM.TEXT2.VALUE, '999999999999999')+"',"+"P_NOMI_RATE2='"+TRANSFORM(THISFORM.TEXT5.VALUE, '999999999999999')+"',"+"P_NOMI_RATE3='"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"',"+"P_NOMI_RATE4='"+TRANSFORM(THISFORM.TEXT11.VALUE, '999999999999999')+"',"+"P_NOMI_RATE5='"+TRANSFORM(THISFORM.TEXT14.VALUE, '999999999999999')+"',"+"P_TYPE_RATE='"+STR(THISFORM.OPTIONGROUP1.VALUE)+"' where "+"kantor='"+DEFAKANTOR+"' and jenis='1' and sandi='"+THISFORM.MYSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
CASE THISFORM.MYPILIHAN=3
CSQL = "UPDATE setsandi_tab set "+"A_ADM='"+TRANSFORM(THISFORM.TEXT3.VALUE, '9999999999')+"',"+"A_ADM1='"+TRANSFORM(THISFORM.TEXT3.VALUE, '9999999999')+"',"+"A_ADM2='"+TRANSFORM(THISFORM.TEXT6.VALUE, '9999999999')+"',"+"A_ADM3='"+TRANSFORM(THISFORM.TEXT9.VALUE, '9999999999')+"',"+"A_ADM4='"+TRANSFORM(THISFORM.TEXT12.VALUE, '9999999999')+"',"+"A_ADM5='"+TRANSFORM(THISFORM.TEXT15.VALUE, '9999999999')+"',"+"A_NOMI_ADM1='"+TRANSFORM(THISFORM.TEXT2.VALUE, '999999999999999')+"',"+"A_NOMI_ADM2='"+TRANSFORM(THISFORM.TEXT5.VALUE, '999999999999999')+"',"+"A_NOMI_ADM3='"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"',"+"A_NOMI_ADM4='"+TRANSFORM(THISFORM.TEXT11.VALUE, '999999999999999')+"',"+"A_NOMI_ADM5='"+TRANSFORM(THISFORM.TEXT14.VALUE, '999999999999999')+"',"+"A_OPTADM='"+STR(THISFORM.OPTIONGROUP1.VALUE)+"' where "+"kantor='"+DEFAKANTOR+"' and jenis='1' and sandi='"+THISFORM.MYSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
CASE THISFORM.MYPILIHAN=4
CSQL = "UPDATE setsandi_tab set "+"P_ADM='"+TRANSFORM(THISFORM.TEXT3.VALUE, '9999999999')+"',"+"P_ADM1='"+TRANSFORM(THISFORM.TEXT3.VALUE, '9999999999')+"',"+"P_ADM2='"+TRANSFORM(THISFORM.TEXT6.VALUE, '9999999999')+"',"+"P_ADM3='"+TRANSFORM(THISFORM.TEXT9.VALUE, '9999999999')+"',"+"P_ADM4='"+TRANSFORM(THISFORM.TEXT12.VALUE, '9999999999')+"',"+"P_ADM5='"+TRANSFORM(THISFORM.TEXT15.VALUE, '9999999999')+"',"+"P_NOMI_ADM1='"+TRANSFORM(THISFORM.TEXT2.VALUE, '999999999999999')+"',"+"P_NOMI_ADM2='"+TRANSFORM(THISFORM.TEXT5.VALUE, '999999999999999')+"',"+"P_NOMI_ADM3='"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"',"+"P_NOMI_ADM4='"+TRANSFORM(THISFORM.TEXT11.VALUE, '999999999999999')+"',"+"P_NOMI_ADM5='"+TRANSFORM(THISFORM.TEXT14.VALUE, '999999999999999')+"',"+"P_OPTADM='"+STR(THISFORM.OPTIONGROUP1.VALUE)+"' where "+"kantor='"+DEFAKANTOR+"' and jenis='1' and sandi='"+THISFORM.MYSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDCASE
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_setproduk1_bunga.sct
***
*
***
*** simpanan_setproduk1_lainnya.scx
***
*
*
*  simpanan_setproduk1_lainnya.scx::Form1
**
PROCEDURE tampil
WITH THISFORM
.TEXT1.VALUE = BUKATGL
.TEXT2.VALUE = BUKAKUPON
.OPTIONGROUP1.VALUE = BERHADIAH
IF BERHADIAH=2
THISFORM.CONTAINER2.VISIBLE = .F.
ELSE
THISFORM.CONTAINER2.VISIBLE = .T.
ENDIF
.CONTAINER2.OPTIONGROUP1.VALUE = OPTHADIAH
.CONTAINER2.TEXT4.VALUE = KELIPATAN
.CONTAINER2.OPTIONGROUP2.VALUE = NOMORKUPON
.CONTAINER3.CHECK1.VALUE = TUTUPCEK1
.CONTAINER3.CHECK2.VALUE = TUTUPCEK2
.CONTAINER3.CHECK3.VALUE = TUTUPCEK3
.TEXT5.VALUE = TUTUPHARI
.TEXT6.VALUE = TUTUPSALDO
ENDWITH
ENDPROC
**
PROCEDURE menable
PARAMETER MKONDISI
THISFORM.TEXT1.ENABLED = MKONDISI
THISFORM.TEXT2.ENABLED = MKONDISI
THISFORM.TEXT5.ENABLED = MKONDISI
THISFORM.TEXT6.ENABLED = MKONDISI
THISFORM.CONTAINER2.TEXT4.ENABLED = MKONDISI
THISFORM.CONTAINER2.OPTIONGROUP1.ENABLED = MKONDISI
THISFORM.CONTAINER2.OPTIONGROUP2.ENABLED = MKONDISI
THISFORM.CONTAINER3.ENABLED = MKONDISI
THISFORM.CONTAINER1.ENABLED = MKONDISI
THISFORM.OPTIONGROUP1.ENABLED = MKONDISI
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MSANDI, MMODE
THISFORM.MYSANDI = MSANDI
THISFORM.TAMPIL()
THISFORM.LABEL22.CAPTION = "KETENTUAN LAINNYA"
IF MMODE="INPUT" .OR. MMODE="EDIT"
THISFORM.MENABLE(.T.)
THISFORM.CMDSIMPAN1.VISIBLE = .F.
ELSE
THISFORM.MENABLE(.F.)
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1_lainnya.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk1_lainnya.scx::Optiongroup1
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.CONTAINER2.VISIBLE = .T.
ELSE
THISFORM.CONTAINER2.VISIBLE = .F.
ENDIF
ENDPROC
**
*
*  simpanan_setproduk1_lainnya.scx::Cmdsimpan1
**
PROCEDURE Click
MSANDILAMA = THISFORM.MYSANDI
CSQL = "UPDATE setsandi_tab set "+"BUKATGL  ='"+STR(THISFORM.TEXT1.VALUE)+"',"+"BUKAKUPON='"+STR(THISFORM.TEXT2.VALUE)+"',"+"BERHADIAH='"+STR(THISFORM.OPTIONGROUP1.VALUE)+"',"+"OPTHADIAH='"+STR(THISFORM.CONTAINER2.OPTIONGROUP1.VALUE)+"',"+"KELIPATAN='"+STR(THISFORM.CONTAINER2.TEXT4.VALUE)+"',"+"NOMORKUPON='"+STR(THISFORM.CONTAINER2.OPTIONGROUP2.VALUE)+"',"+"TUTUPCEK1='"+STR(THISFORM.CONTAINER3.CHECK1.VALUE)+"', "+"TUTUPCEK2='"+STR(THISFORM.CONTAINER3.CHECK2.VALUE)+"', "+"TUTUPCEK3='"+STR(THISFORM.CONTAINER3.CHECK3.VALUE)+"', "+"TUTUPHARI='"+STR(THISFORM.TEXT5.VALUE)+"', "+"TUTUPSALDO='"+STR(THISFORM.TEXT6.VALUE)+"' "+"where kantor=?defakantor and sandi='"+MSANDILAMA+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
MESSAGEBOX("Gagal update data")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk1_lainnya.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_setproduk1_lainnya.sct
***
*
***
*** pinjaman_setproduk.scx
***
*
*
*  pinjaman_setproduk.scx::FORM1
**
PROCEDURE menable
PARAMETER MKONDISI
THIS.SETALL("enabled", MKONDISI, "Textbox")
THISFORM.COMBO1.ENABLED = MKONDISI
THISFORM.TEXT17.ENABLED = .F.
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MYMODE = MMODE
THISFORM.OLDSELECT = SELECT()
SELECT (THISFORM.OLDSELECT)
THISFORM.MSANDI = SANDI
THISFORM.TEXT7.VALUE = SANDI
THISFORM.TEXT8.VALUE = KETERANGAN
THISFORM.TEXT1.VALUE = KDHIT
THISFORM.TEXT15.VALUE = PEMBULATAN
THISFORM.TEXT5.VALUE = RATE
THISFORM.COMBO1.VALUE = PERIODE
THISFORM.TEXT1.VALUE = ADM
THISFORM.TEXT2.VALUE = PROV
THISFORM.TEXT3.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT4.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT13.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT9.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT10.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT11.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT12.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT3.VALUE = JURNAL_POKOK
THISFORM.TEXT4.VALUE = JURNAL_JASA
THISFORM.TEXT13.VALUE = JURNAL_DENDA
THISFORM.TEXT9.VALUE = JURNAL_ADM
THISFORM.TEXT10.VALUE = JURNAL_PROV
THISFORM.TEXT11.VALUE = JURNAL_YADIT
THISFORM.TEXT12.VALUE = JURNAL_PPAP
THISFORM.MENABLE(.F.)
THISFORM.MYMODE = MMODE
IF MMODE="INPUT"
THISFORM.MENABLE(.T.)
THISFORM.MYINPUT()
THISFORM.CMDKELUAR1.VISIBLE = .F.
THISFORM.CMDEDIT1.VISIBLE = .F.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.COMMAND1.ENABLED = .T.
THISFORM.COMMAND2.ENABLED = .T.
THISFORM.COMMAND3.ENABLED = .T.
THISFORM.COMMAND4.ENABLED = .T.
THISFORM.COMMAND5.ENABLED = .T.
THISFORM.COMMAND6.ENABLED = .T.
THISFORM.COMMAND7.ENABLED = .T.
ENDIF
IF MMODE="EDIT"
THISFORM.MENABLE(.T.)
THISFORM.CMDKELUAR1.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDEDIT1.VISIBLE = .F.
THISFORM.COMMAND1.ENABLED = .T.
THISFORM.COMMAND2.ENABLED = .T.
THISFORM.COMMAND3.ENABLED = .T.
THISFORM.COMMAND4.ENABLED = .T.
THISFORM.COMMAND5.ENABLED = .T.
THISFORM.COMMAND6.ENABLED = .T.
THISFORM.COMMAND7.ENABLED = .T.
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  pinjaman_setproduk.scx::Cmdsimpan1
**
PROCEDURE Click
IF THISFORM.MYMODE="INPUT"
CSQL = "insert into setsandi_pinj (kantor,sandi,keterangan,kdhit,pembulatan,"+"rate,adm,prov,periode,jurnal_pokok,jurnal_jasa,jurnal_denda,"+"jurnal_adm,jurnal_prov,jurnal_yadit,jurnal_ppap) value "+"('"+DEFAKANTOR+"','"+THISFORM.TEXT7.VALUE+"', '"+THISFORM.TEXT8.VALUE+"', '"+THISFORM.TEXT16.VALUE+"', '"+STR(THISFORM.TEXT15.VALUE)+"', '"+STR(THISFORM.TEXT5.VALUE)+"', '"+STR(THISFORM.TEXT1.VALUE)+"', '"+STR(THISFORM.TEXT2.VALUE)+"', '"+THISFORM.COMBO1.VALUE+"', '"+THISFORM.TEXT3.VALUE+"', '"+THISFORM.TEXT4.VALUE+"', '"+THISFORM.TEXT13.VALUE+"', '"+THISFORM.TEXT9.VALUE+"', '"+THISFORM.TEXT10.VALUE+"', '"+THISFORM.TEXT11.VALUE+"', '"+THISFORM.TEXT12.VALUE+"' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert")
ENDIF
ENDIF
IF THISFORM.MYMODE="EDIT"
CSQL = "update setsandi_pinj set "+"sandi='"+THISFORM.TEXT7.VALUE+"', "+"keterangan='"+THISFORM.TEXT8.VALUE+"', "+"kdhit='"+THISFORM.TEXT16.VALUE+"', "+"pembulatan='"+STR(THISFORM.TEXT15.VALUE)+"', "+"rate='"+STR(THISFORM.TEXT5.VALUE)+"', "+"adm='"+STR(THISFORM.TEXT1.VALUE)+"', "+"prov='"+STR(THISFORM.TEXT2.VALUE)+"', "+"periode='"+THISFORM.COMBO1.VALUE+"', "+"jurnal_pokok='"+THISFORM.TEXT3.VALUE+"', "+"jurnal_jasa='"+THISFORM.TEXT4.VALUE+"', "+"jurnal_denda='"+THISFORM.TEXT13.VALUE+"', "+"jurnal_adm='"+THISFORM.TEXT9.VALUE+"', "+"jurnal_prov='"+THISFORM.TEXT10.VALUE+"', "+"jurnal_yadit='"+THISFORM.TEXT11.VALUE+"', "+"jurnal_ppap='"+THISFORM.TEXT12.VALUE+"' "+"where sandi='"+THISFORM.TEXT7.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi set sandi='"+THISFORM.TEXT7.VALUE+"', keterangan='"+THISFORM.TEXT8.VALUE+"' "+"where kode='P001' and sandi='"+ALLTRIM(THISFORM.MSANDI)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_setproduk.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.MENABLE(.F.)
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDKELUAR1.VISIBLE = .T.
THISFORM.CMDEDIT1.VISIBLE = .T.
ENDPROC
**
*
*  pinjaman_setproduk.scx::Cmdedit1
**
PROCEDURE Click
THISFORM.MYMODE = "EDIT"
THISFORM.MENABLE(.T.)
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDKELUAR1.VISIBLE = .F.
THISFORM.CMDEDIT1.VISIBLE = .F.
THISFORM.COMBO1.ENABLED = .F.
THISFORM.COMMAND1.ENABLED = .T.
THISFORM.COMMAND2.ENABLED = .T.
THISFORM.COMMAND3.ENABLED = .T.
THISFORM.COMMAND4.ENABLED = .T.
THISFORM.COMMAND5.ENABLED = .T.
THISFORM.COMMAND6.ENABLED = .T.
THISFORM.COMMAND7.ENABLED = .T.
ENDPROC
**
*
*  pinjaman_setproduk.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_setproduk.scx::Command7
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT3.VALUE = MNOPER
THISFORM.TEXT3.SETFOCUS
ENDPROC
**
*
*  pinjaman_setproduk.scx::Command1
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT4.VALUE = MNOPER
THISFORM.TEXT4.SETFOCUS
ENDPROC
**
*
*  pinjaman_setproduk.scx::Command2
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT13.VALUE = MNOPER
THISFORM.TEXT13.SETFOCUS
ENDPROC
**
*
*  pinjaman_setproduk.scx::Command3
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT9.VALUE = MNOPER
THISFORM.TEXT9.SETFOCUS
ENDPROC
**
*
*  pinjaman_setproduk.scx::Command4
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT10.VALUE = MNOPER
THISFORM.TEXT10.SETFOCUS
ENDPROC
**
*
*  pinjaman_setproduk.scx::Command5
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT11.VALUE = MNOPER
THISFORM.TEXT11.SETFOCUS
ENDPROC
**
*
*  pinjaman_setproduk.scx::Command6
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT12.VALUE = MNOPER
THISFORM.TEXT12.SETFOCUS
ENDPROC
**
***
*** pinjaman_setproduk.sct
***
*
***
*** pinjaman_jaminan.scx
***
*
*
*  pinjaman_jaminan.scx::FORM1
**
PROCEDURE tampil
MYDATA = THISFORM.DATA1
THISFORM.GRID1.RECORDSOURCE = MYDATA
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 2
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOBERKAS"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "NOBERKAS"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 400
.COLUMN2.CONTROLSOURCE = "JENIS"
.COLUMN2.HEADER1.CAPTION = "JENIS JAMINAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, IIF(EMPTY(tglselesai),RGB(245,250,252),RGB(255,108,108)) , IIF(EMPTY(tglselesai),RGB(223,223,255),RGB(255,108,108))", "Column")
ENDPROC
**
PROCEDURE bacasql
MNOREK = THISFORM.NOREK
MDATA = THISFORM.DATA1
CSQL = "select * from pinjaman_jaminan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
THISFORM.MJENIS = JENIS
THISFORM.MNOBERKAS = NOBERKAS
ENDPROC
**
PROCEDURE tampil2
MJENIS = JENIS
MNOREK = THISFORM.NOREK
MNOBERKAS = NOBERKAS
THISFORM.TEXT1.VALUE = NOBERKAS
THISFORM.TEXT2.VALUE = JENIS
OLDSELECT = SELECT()
DO CASE
CASE ALLTRIM(MJENIS)="BPKB" .OR. ALLTRIM(MJENIS)="KENDARAAN"
THISFORM.BPKB.VISIBLE = .T.
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
CSQL = "select * from pinjaman_jaminan_bpkb where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.BPKB
.TEXT2.VALUE = MERK
.TEXT1.VALUE = TYPE
.TEXT17.VALUE = TAHUN
.TEXT3.VALUE = NOPOLISI
.TEXT4.VALUE = NOBPKB
.TEXT5.VALUE = WARNA
.TEXT11.VALUE = NORANGKA
.TEXT12.VALUE = NOMESIN
.TEXT13.VALUE = TGLSTNK
.TEXT6.VALUE = ATASNAMA
.TEXT7.VALUE = ALAMAT
.TEXT8.VALUE = KELENGKAPAN
.TEXT9.VALUE = PENGIKATAN
.TEXT10.VALUE = NILAI
.TEXT18.VALUE = ADJ_NILAI
.TEXT19.VALUE = ADJ_PPAP
.TEXT14.VALUE = TGLMASUK
.TEXT15.VALUE = TGLAMBIL
.TEXT16.VALUE = PENGAMBIL
ENDWITH
MPENGIKATAN = PENGIKATAN
USE
CSQL = "select keterangan from setsandi where kode='P009' and sandi='"+MPENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.BPKB.TEXT20.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
CASE ALLTRIM(MJENIS)="SERTIFIKAT" .OR. ALLTRIM(MJENIS)="TANAH"
THISFORM.SERTIFIKAT.VISIBLE = .T.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
CSQL = "select * from pinjaman_jaminan_sertifikat where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.SERTIFIKAT
.TEXT2.VALUE = STATUS
.TEXT3.VALUE = NOSERTIFIKAT
.TEXT4.VALUE = TGLSERTIFIKAT
.TEXT11.VALUE = NOSURATUKUR
.TEXT12.VALUE = TGLSURATUKUR
.TEXT5.VALUE = LUAS
.TEXT6.VALUE = NAMA
.TEXT7.VALUE = ALAMAT
.TEXT8.VALUE = KELENGKAPAN
.TEXT9.VALUE = PENGIKATAN
.TEXT10.VALUE = NILAI
.TEXT13.VALUE = NILAIHT
.TEXT1.VALUE = ADJ_NILAI
.TEXT14.VALUE = TGLMASUK
.TEXT15.VALUE = TGLAMBIL
.TEXT16.VALUE = PENGAMBIL
ENDWITH
MPENGIKATAN = PENGIKATAN
USE
CSQL = "select keterangan from setsandi where kode='P010' and sandi='"+MPENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.SERTIFIKAT.TEXT20.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
CASE ALLTRIM(MJENIS)="SIMPANAN"
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .T.
THISFORM.LAINNYA.VISIBLE = .F.
CSQL = "select * from pinjaman_jaminan_simpanan where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.SIMPANAN
.TEXT3.VALUE = NOREK
.TEXT4.VALUE = NAMA
.TEXT9.VALUE = JENIS
.TEXT5.VALUE = ALAMAT
.TEXT6.VALUE = JUMLAH
.TEXT7.VALUE = TGLBLOKIR
.TEXT8.VALUE = KELENGKAPAN
.TEXT10.VALUE = PENGIKATAN
.TEXT1.VALUE = ADJ_NILAI
.TEXT2.VALUE = ADJ_PPAP
.TEXT14.VALUE = TGLMASUK
.TEXT15.VALUE = TGLAMBIL
.TEXT16.VALUE = PENGAMBIL
ENDWITH
MPENGIKATAN = PENGIKATAN
USE
CSQL = "select keterangan from setsandi where kode='P011' and sandi='"+MPENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.SIMPANAN.TEXT20.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
CASE LEFT(ALLTRIM(MJENIS), 4)="LAIN"
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .T.
MNOREK = THISFORM.NOREK
CSQL = "select * from pinjaman_jaminan_lainnya where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
CEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.LAINNYA
.TEXT2.VALUE = NAMA
.TEXT3.VALUE = KETERANGAN
.TEXT4.VALUE = NILAI
.TEXT1.VALUE = ADJ_NILAI
.TEXT5.VALUE = ADJ_PPAP
.TEXT6.VALUE = PENGIKATAN
.TEXT14.VALUE = TGLMASUK
.TEXT15.VALUE = TGLAMBIL
.TEXT16.VALUE = PENGAMBIL
ENDWITH
MPENGIKATAN = PENGIKATAN
USE
CSQL = "select keterangan from setsandi where kode='P012' and sandi='"+MPENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.LAINNYA.TEXT20.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
OTHERWISE
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
ENDCASE
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK
THISFORM.OLDSELECT = SELECT()
THISFORM.NOREK = MNOREK
THISFORM.DATA1 = SYS(2015)
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  pinjaman_jaminan.scx::cmdexit
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_jaminan.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MJENIS = JENIS
THISFORM.MNOBERKAS = NOBERKAS
THISFORM.TAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
*
*  pinjaman_jaminan.scx::Cmdhapus
**
PROCEDURE Click
THISFORM.MYEDIT = "HAPUS"
YT = MESSAGEBOX("Data Benar Akan Dihapus", 4, "HAPUS DATA")
IF YT=6
MNOBERKASASAL = NOBERKAS
MNOREKASAL = NOREK
MJENISASAL = JENIS
MIDDATA = IDDATA
CSQL = "delete from pinjaman_jaminan where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  pinjaman_jaminan.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_jaminan.scx::Cmdedit
**
PROCEDURE Click
THISFORM.CMDEDIT.VISIBLE = .F.
THISFORM.CMDHAPUS.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .T.
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDKELUAR.VISIBLE = .F.
THISFORM.CMDINPUT.VISIBLE = .F.
THISFORM.CMDPRINT.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.GRID1.ENABLED = .F.
THISFORM.MYEDIT = "EDIT"
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  pinjaman_jaminan.scx::Cmdbatal
**
PROCEDURE Click
THISFORM.CMDEDIT.VISIBLE = .T.
THISFORM.CMDHAPUS.VISIBLE = .T.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDKELUAR.VISIBLE = .T.
THISFORM.CMDINPUT.VISIBLE = .T.
THISFORM.CMDPRINT.VISIBLE = .T.
THISFORM.CMDSELESAI.VISIBLE = .T.
THISFORM.TAMPIL()
ENDPROC
**
*
*  pinjaman_jaminan.scx::Cmdinput
**
PROCEDURE Click
THISFORM.CMDEDIT.VISIBLE = .F.
THISFORM.CMDHAPUS.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .T.
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDKELUAR.VISIBLE = .F.
THISFORM.CMDINPUT.VISIBLE = .F.
THISFORM.CMDPRINT.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.GRID1.ENABLED = .F.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
THISFORM.MYEDIT = "INPUT"
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
MNOBERKAS = AUTONOBERKAS()
THISFORM.TEXT1.VALUE = MNOBERKAS
THISFORM.TEXT2.VALUE = ''
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  pinjaman_jaminan.scx::cmdselesai
**
PROCEDURE Click
THISFORM.MYEDIT = "SELESAI"
THISFORM.CMDEDIT.VISIBLE = .F.
THISFORM.CMDHAPUS.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .T.
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDKELUAR.VISIBLE = .F.
THISFORM.CMDINPUT.VISIBLE = .F.
THISFORM.CMDPRINT.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
DO CASE
CASE ALLTRIM(THISFORM.TEXT2.VALUE)="KENDARAAN" .OR. ALLTRIM(THISFORM.TEXT2.VALUE)="BPKB"
THISFORM.BPKB.TEXT15.ENABLED = .T.
THISFORM.BPKB.TEXT16.ENABLED = .T.
CASE ALLTRIM(THISFORM.TEXT2.VALUE)="TANAH" .OR. ALLTRIM(THISFORM.TEXT2.VALUE)="SERTIFIKAT"
THISFORM.SERTIFIKAT.TEXT15.ENABLED = .T.
THISFORM.SERTIFIKAT.TEXT16.ENABLED = .T.
CASE ALLTRIM(THISFORM.TEXT2.VALUE)="SIMPANAN" .OR. ALLTRIM(THISFORM.TEXT2.VALUE)="DEPOSITO"
THISFORM.SIMPANAN.TEXT15.ENABLED = .T.
THISFORM.SIMPANAN.TEXT16.ENABLED = .T.
CASE LEFT(ALLTRIM(THISFORM.TEXT2.VALUE), 4)="LAIN"
THISFORM.LAINNYA.TEXT15.ENABLED = .T.
THISFORM.LAINNYA.TEXT16.ENABLED = .T.
ENDCASE
ENDPROC
**
*
*  pinjaman_jaminan.scx::bpkb
**
PROCEDURE Init
THIS.TOP = 236
THIS.LEFT = 10
THIS.BORDERWIDTH = 0
ENDPROC
**
*
*  pinjaman_jaminan.scx::Text9
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P009"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P009' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Pengikatan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.BPKB.TEXT20.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Pengikatan tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_jaminan.scx::sertifikat
**
PROCEDURE Init
THIS.TOP = 236
THIS.LEFT = 10
THIS.BORDERWIDTH = 0
ENDPROC
**
*
*  pinjaman_jaminan.scx::Text9
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P010"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P010' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Pengikatan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.SIMPANAN.TEXT20.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Pengikatan tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_jaminan.scx::Simpanan
**
PROCEDURE Init
THIS.TOP = 236
THIS.LEFT = 10
THIS.BORDERWIDTH = 0
ENDPROC
**
*
*  pinjaman_jaminan.scx::Text10
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P011"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P011' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Pengikatan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.SIMPANAN.TEXT20.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Pengikatan tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_jaminan.scx::LAINNYA
**
PROCEDURE Init
THIS.TOP = 236
THIS.LEFT = 10
THIS.BORDERWIDTH = 0
ENDPROC
**
*
*  pinjaman_jaminan.scx::Text6
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P012"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P012' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Pengikatan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.LAINNYA.TEXT20.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Pengikatan tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
*
*  pinjaman_jaminan.scx::Text1
**
PROCEDURE LostFocus
OLDSELECT = SELECT()
IF THISFORM.MYEDIT="INPUT" .OR. (THISFORM.MYEDIT="EDIT" .AND. ALLTRIM(THIS.VALUE)<>ALLTRIM(NOBERKAS))
CSQL = "select noberkas,jenis from pinjaman_jaminan where kantor='"+DEFAKANTOR+"' and noberkas='"+ALLTRIM(THIS.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOBERKAS = NOBERKAS
MJENIS = JENIS
USE
IF ALLTRIM(MNOBERKAS)=ALLTRIM(THIS.VALUE)
THISFORM.TEXT2.VALUE = MJENIS
DO CASE
CASE ALLTRIM(MJENIS)="BPKB" .OR. ALLTRIM(MJENIS)="KENDARAAN"
THISFORM.BPKB.VISIBLE = .T.
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
CSQL = "select * from pinjaman_jaminan_bpkb where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.BPKB
.TEXT2.VALUE = MERK
.TEXT1.VALUE = TYPE
.TEXT17.VALUE = TAHUN
.TEXT3.VALUE = NOPOLISI
.TEXT4.VALUE = NOBPKB
.TEXT5.VALUE = WARNA
.TEXT11.VALUE = NORANGKA
.TEXT12.VALUE = NOMESIN
.TEXT13.VALUE = TGLSTNK
.TEXT6.VALUE = ATASNAMA
.TEXT7.VALUE = ALAMAT
.TEXT8.VALUE = KELENGKAPAN
.TEXT9.VALUE = PENGIKATAN
.TEXT10.VALUE = NILAI
.TEXT18.VALUE = ADJ_NILAI
.TEXT19.VALUE = ADJ_PPAP
.TEXT14.VALUE = TGLMASUK
.TEXT15.VALUE = TGLAMBIL
.TEXT16.VALUE = PENGAMBIL
ENDWITH
MPENGIKATAN = PENGIKATAN
USE
CSQL = "select keterangan from setsandi where kode='P009' and sandi='"+MPENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.BPKB.TEXT20.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
CASE ALLTRIM(MJENIS)="SERTIFIKAT" .OR. ALLTRIM(MJENIS)="TANAH"
THISFORM.SERTIFIKAT.VISIBLE = .T.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
CSQL = "select * from pinjaman_jaminan_sertifikat where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.SERTIFIKAT
.TEXT2.VALUE = STATUS
.TEXT3.VALUE = NOSERTIFIKAT
.TEXT4.VALUE = TGLSERTIFIKAT
.TEXT11.VALUE = NOSURATUKUR
.TEXT12.VALUE = TGLSURATUKUR
.TEXT5.VALUE = LUAS
.TEXT6.VALUE = NAMA
.TEXT7.VALUE = ALAMAT
.TEXT8.VALUE = KELENGKAPAN
.TEXT9.VALUE = PENGIKATAN
.TEXT10.VALUE = NILAI
.TEXT13.VALUE = NILAIHT
.TEXT1.VALUE = ADJ_NILAI
.TEXT14.VALUE = TGLMASUK
.TEXT15.VALUE = TGLAMBIL
.TEXT16.VALUE = PENGAMBIL
ENDWITH
MPENGIKATAN = PENGIKATAN
USE
CSQL = "select keterangan from setsandi where kode='P010' and sandi='"+MPENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.SERTIFIKAT.TEXT20.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
CASE ALLTRIM(MJENIS)="SIMPANAN"
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .T.
THISFORM.LAINNYA.VISIBLE = .F.
CSQL = "select * from pinjaman_jaminan_simpanan where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.SIMPANAN
.TEXT3.VALUE = NOREK
.TEXT4.VALUE = NAMA
.TEXT9.VALUE = JENIS
.TEXT5.VALUE = ALAMAT
.TEXT6.VALUE = JUMLAH
.TEXT7.VALUE = TGLBLOKIR
.TEXT8.VALUE = KELENGKAPAN
.TEXT10.VALUE = PENGIKATAN
.TEXT1.VALUE = ADJ_NILAI
.TEXT2.VALUE = ADJ_PPAP
.TEXT14.VALUE = TGLMASUK
.TEXT15.VALUE = TGLAMBIL
.TEXT16.VALUE = PENGAMBIL
ENDWITH
MPENGIKATAN = PENGIKATAN
USE
CSQL = "select keterangan from setsandi where kode='P011' and sandi='"+MPENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.SIMPANAN.TEXT20.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
CASE LEFT(ALLTRIM(MJENIS), 4)="LAIN"
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .T.
MNOREK = THISFORM.NOREK
CSQL = "select * from pinjaman_jaminan_lainnya where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
CEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.LAINNYA
.TEXT2.VALUE = NAMA
.TEXT3.VALUE = KETERANGAN
.TEXT4.VALUE = NILAI
.TEXT1.VALUE = ADJ_NILAI
.TEXT5.VALUE = ADJ_PPAP
.TEXT6.VALUE = PENGIKATAN
.TEXT14.VALUE = TGLMASUK
.TEXT15.VALUE = TGLAMBIL
.TEXT16.VALUE = PENGAMBIL
ENDWITH
MPENGIKATAN = PENGIKATAN
USE
CSQL = "select keterangan from setsandi where kode='P012' and sandi='"+MPENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.LAINNYA.TEXT20.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
OTHERWISE
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
ENDCASE
ELSE
THISFORM.BPKB.SETALL("value", "", "Textbox")
THISFORM.SERTIFIKAT.SETALL("value", "", "Textbox")
THISFORM.SIMPANAN.SETALL("value", "", "Textbox")
THISFORM.LAINNYA.SETALL("value", "", "Textbox")
ENDIF
ENDIF
SELECT (OLDSELECT)
ENDPROC
**
*
*  pinjaman_jaminan.scx::Text2
**
PROCEDURE LostFocus
DO CASE
CASE THIS.VALUE="KENDARAAN" .OR. THIS.VALUE="BPKB"
THISFORM.BPKB.VISIBLE = .T.
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
THISFORM.BPKB.SETALL("enabled", .T., "Textbox")
THISFORM.BPKB.TEXT15.ENABLED = .F.
THISFORM.BPKB.TEXT16.ENABLED = .F.
THISFORM.BPKB.TEXT20.ENABLED = .F.
IF THISFORM.MYEDIT="INPUT"
THISFORM.BPKB.TEXT10.VALUE = 0
THISFORM.BPKB.TEXT18.VALUE = 0
THISFORM.BPKB.TEXT19.VALUE = 0
ENDIF
CASE THIS.VALUE="TANAH" .OR. THIS.VALUE="SERTIFIKAT"
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SERTIFIKAT.VISIBLE = .T.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
THISFORM.SERTIFIKAT.SETALL("enabled", .T., "Textbox")
THISFORM.SERTIFIKAT.TEXT15.ENABLED = .F.
THISFORM.SERTIFIKAT.TEXT16.ENABLED = .F.
THISFORM.SERTIFIKAT.TEXT20.ENABLED = .F.
IF THISFORM.MYEDIT="INPUT"
THISFORM.SERTIFIKAT.TEXT5.VALUE = 0
THISFORM.SERTIFIKAT.TEXT10.VALUE = 0
THISFORM.SERTIFIKAT.TEXT13.VALUE = 0
THISFORM.SERTIFIKAT.TEXT1.VALUE = 0
ENDIF
CASE THIS.VALUE="SIMPANAN"
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .T.
THISFORM.LAINNYA.VISIBLE = .F.
THISFORM.SIMPANAN.SETALL("enabled", .T., "Textbox")
THISFORM.SIMPANAN.TEXT15.ENABLED = .F.
THISFORM.SIMPANAN.TEXT16.ENABLED = .F.
THISFORM.SIMPANAN.TEXT20.ENABLED = .F.
IF THISFORM.MYEDIT="INPUT"
THISFORM.SIMPANAN.TEXT6.VALUE = 0
THISFORM.SIMPANAN.TEXT1.VALUE = 0
THISFORM.SIMPANAN.TEXT2.VALUE = 0
ENDIF
CASE LEFT(THIS.VALUE, 4)="LAIN"
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .T.
THISFORM.LAINNYA.SETALL("enabled", .T., "Textbox")
THISFORM.LAINNYA.TEXT15.ENABLED = .F.
THISFORM.LAINNYA.TEXT16.ENABLED = .F.
THISFORM.LAINNYA.TEXT20.ENABLED = .F.
IF THISFORM.MYEDIT="INPUT"
THISFORM.LAINNYA.TEXT4.VALUE = 0
THISFORM.LAINNYA.TEXT1.VALUE = 0
THISFORM.LAINNYA.TEXT5.VALUE = 0
ENDIF
OTHERWISE
THISFORM.BPKB.VISIBLE = .F.
THISFORM.SERTIFIKAT.VISIBLE = .F.
THISFORM.SIMPANAN.VISIBLE = .F.
THISFORM.LAINNYA.VISIBLE = .F.
NODEFAULT
THIS.SETFOCUS
RETURN
ENDCASE
ENDPROC
**
*
*  pinjaman_jaminan.scx::Cmdsimpan
**
PROCEDURE Click
OLDSELECT = SELECT()
THISFORM.CMDEDIT.VISIBLE = .T.
THISFORM.CMDHAPUS.VISIBLE = .T.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDKELUAR.VISIBLE = .T.
THISFORM.CMDINPUT.VISIBLE = .T.
THISFORM.CMDPRINT.VISIBLE = .T.
THISFORM.CMDSELESAI.VISIBLE = .T.
MNOBERKASASAL = THISFORM.MNOBERKAS
MNOREKASAL = THISFORM.NOREK
MJENISASAL = THISFORM.MJENIS
DO CASE
CASE THISFORM.MYEDIT="INPUT"
DO CASE
CASE THISFORM.TEXT2.VALUE="BPKB" .OR. THISFORM.TEXT2.VALUE="KENDARAAN"
WITH THISFORM.BPKB
CSQL = "INSERT into pinjaman_jaminan_bpkb (kantor,noberkas,merk,type,tahun,nomesin,"+"norangka,nobpkb,nopolisi,warna,tglstnk,kelengkapan,atasnama,"+"alamat,pengikatan,nilai,adj_nilai,adj_ppap,tglmasuk) value ("+"'"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+.TEXT17.VALUE+"',"+"'"+.TEXT12.VALUE+"',"+"'"+.TEXT11.VALUE+"',"+"'"+.TEXT4.VALUE+"',"+"'"+.TEXT3.VALUE+"',"+"'"+.TEXT5.VALUE+"',"+"'"+SQLDATE(.TEXT13.VALUE)+"',"+"'"+.TEXT8.VALUE+"',"+"'"+.TEXT6.VALUE+"',"+"'"+.TEXT7.VALUE+"',"+"'"+.TEXT9.VALUE+"',"+"'"+STR(.TEXT10.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+STR(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"')"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "insert into pinjaman_jaminan (kantor,norek,jenis,noberkas) value "+"(?DefaKantor,'"+MNOREKASAL+"','KENDARAAN','"+THISFORM.TEXT1.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BPKB.SETALL("enabled", .F., "textbox")
CASE THISFORM.TEXT2.VALUE="SERTIFIKAT" .OR. THISFORM.TEXT2.VALUE="TANAH"
WITH THISFORM.SERTIFIKAT
CSQL = "INSERT into pinjaman_jaminan_sertifikat (kantor,noberkas,status,nosertifikat,"+"tglsertifikat,nosuratukur,tglsuratukur,luas,nama,alamat, kelengkapan,"+"pengikatan,nilai,nilaiht,adj_nilai,tglmasuk) value ("+"'"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT3.VALUE+"',"+"'"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT11.VALUE+"',"+"'"+SQLDATE(.TEXT12.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+.TEXT6.VALUE+"',"+"'"+.TEXT7.VALUE+"',"+"'"+.TEXT8.VALUE+"',"+"'"+.TEXT9.VALUE+"',"+"'"+STR(.TEXT10.VALUE)+"',"+"'"+STR(.TEXT13.VALUE)+"',"+"'"+STR(.TEXT1.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"')"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "insert into pinjaman_jaminan (kantor,norek,jenis,noberkas) value "+"('"+DEFAKANTOR+"','"+THISFORM.NOREK+"','TANAH','"+THISFORM.TEXT1.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SERTIFIKAT.SETALL("enabled", .F., "textbox")
CASE THISFORM.TEXT2.VALUE="SIMPANAN" .OR. THISFORM.TEXT2.VALUE="DEPOSITO"
WITH THISFORM.SIMPANAN
CSQL = "INSERT into pinjaman_jaminan_simpanan (kantor,NOBERKAS,NOREK,JENIS,NAMA,ALAMAT,"+"JUMLAH,TGLBLOKIR,KELENGKAPAN,PENGIKATAN,ADJ_NILAI,ADJ_PPAP,TGLMASUK) value ("+"'"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+.TEXT3.VALUE+"',"+"'"+.TEXT9.VALUE+"',"+"'"+.TEXT4.VALUE+"',"+"'"+.TEXT5.VALUE+"',"+"'"+STR(.TEXT6.VALUE)+"',"+"'"+SQLDATE(.TEXT7.VALUE)+"',"+"'"+.TEXT8.VALUE+"',"+"'"+.TEXT10.VALUE+"',"+"'"+STR(.TEXT1.VALUE)+"',"+"'"+STR(.TEXT2.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"')"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "insert into pinjaman_jaminan (kantor,norek,jenis,noberkas) value "+"('"+DEFAKANTOR+"','"+THISFORM.NOREK+"','SIMPANAN','"+THISFORM.TEXT1.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SIMPANAN.SETALL("enabled", .F., "textbox")
CASE LEFT(THISFORM.TEXT2.VALUE, 4)="LAIN"
WITH THISFORM.LAINNYA
CSQL = "INSERT into pinjaman_jaminan_lainnya (kantor,noberkas,nama,keterangan,"+"pengikatan,nilai,adj_nilai,adj_ppap,tglmasuk) value ("+"'"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT3.VALUE+"',"+"'"+.TEXT6.VALUE+"',"+"'"+STR(.TEXT4.VALUE)+"',"+"'"+STR(.TEXT1.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"')"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "insert into pinjaman_jaminan (kantor,norek,jenis,noberkas) value "+"('"+DEFAKANTOR+"','"+THISFORM.NOREK+"','LAIN-LAIN','"+THISFORM.TEXT1.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SIMPANAN.SETALL("enabled", .F., "textbox")
OTHERWISE
ENDCASE
CASE THISFORM.MYEDIT="EDIT"
DO CASE
CASE THISFORM.TEXT2.VALUE="BPKB" .OR. THISFORM.TEXT2.VALUE="KENDARAAN"
WITH THISFORM.BPKB
CSQL = "update pinjaman_jaminan_bpkb set "+"noberkas='"+THISFORM.TEXT1.VALUE+"',"+"merk='"+.TEXT2.VALUE+"',"+"type='"+.TEXT1.VALUE+"',"+"tahun='"+.TEXT17.VALUE+"',"+"nomesin='"+.TEXT12.VALUE+"',"+"norangka='"+.TEXT11.VALUE+"',"+"nobpkb='"+.TEXT4.VALUE+"',"+"nopolisi='"+.TEXT3.VALUE+"',"+"warna='"+.TEXT5.VALUE+"',"+"tglstnk='"+SQLDATE(.TEXT13.VALUE)+"',"+"kelengkapan='"+.TEXT8.VALUE+"',"+"atasnama='"+.TEXT6.VALUE+"',"+"alamat='"+.TEXT7.VALUE+"',"+"pengikatan='"+.TEXT9.VALUE+"',"+"nilai='"+STR(.TEXT10.VALUE)+"',"+"adj_nilai='"+STR(.TEXT18.VALUE)+"',"+"adj_ppap='"+STR(.TEXT19.VALUE)+"',"+"tglmasuk='"+SQLDATE(.TEXT14.VALUE)+"' where noberkas='"+MNOBERKASASAL+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BPKB.SETALL("enabled", .F., "textbox")
CASE THISFORM.TEXT2.VALUE="SERTIFIKAT" .OR. THISFORM.TEXT2.VALUE="TANAH"
WITH THISFORM.SERTIFIKAT
CSQL = "update pinjaman_jaminan_sertifikat set"+"noberkas='"+THISFORM.TEXT1.VALUE+"',"+"status='"+.TEXT2.VALUE+"',"+"nosertifikat='"+.TEXT3.VALUE+"',"+"tglsertifikat='"+SQLDATE(.TEXT4.VALUE)+"',"+"nosuratukur='"+.TEXT11.VALUE+"',"+"tglsuratukur='"+SQLDATE(.TEXT12.VALUE)+"',"+"luas='"+STR(.TEXT5.VALUE)+"',"+"nama='"+.TEXT6.VALUE+"',"+"alamat='"+.TEXT7.VALUE+"',"+"kelengkapan='"+.TEXT8.VALUE+"',"+"pengikatan='"+.TEXT9.VALUE+"',"+"nilai='"+STR(.TEXT10.VALUE)+"',"+"nilaiht='"+STR(.TEXT13.VALUE)+"',"+"adj_nilai='"+STR(.TEXT1.VALUE)+"',"+"tglmasuk='"+SQLDATE(.TEXT14.VALUE)+"' where noberkas='"+MNOBERKASASAL+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SERTIFIKAT.SETALL("enabled", .F., "textbox")
CASE THISFORM.TEXT2.VALUE="SIMPANAN" .OR. THISFORM.TEXT2.VALUE="DEPOSITO"
WITH THISFORM.SIMPANAN
CSQL = "update pinjaman_jaminan_simpanan set "+"NOBERKAS='"+THISFORM.TEXT1.VALUE+"',"+"NOREK='"+.TEXT3.VALUE+"',"+"JENIS='"+.TEXT9.VALUE+"',"+"NAMA='"+.TEXT4.VALUE+"',"+"ALAMAT='"+.TEXT5.VALUE+"',"+"JUMLAH='"+STR(.TEXT6.VALUE)+"',"+"TGLBLOKIR='"+SQLDATE(.TEXT7.VALUE)+"',"+"KELENGKAPAN='"+.TEXT8.VALUE+"',"+"ADJ_NILAI='"+STR(.TEXT1.VALUE)+"',"+"ADJ_PPAP='"+STR(.TEXT2.VALUE)+"',"+"TGLMASUK='"+SQLDATE(.TEXT14.VALUE)+"' where noberkas='"+MNOBERKASASAL+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SIMPANAN.SETALL("enabled", .F., "textbox")
CASE LEFT(THISFORM.TEXT2.VALUE, 4)="LAIN"
WITH THISFORM.LAINNYA
CSQL = "update pinjaman_jaminan_lainnya set "+"noberkas='"+THISFORM.TEXT1.VALUE+"',"+"nama='"+.TEXT2.VALUE+"',"+"keterangan='"+.TEXT3.VALUE+"',"+"nilai='"+STR(.TEXT4.VALUE)+"',"+"adj_nilai='"+STR(.TEXT1.VALUE)+"',"+"adj_ppap='"+STR(.TEXT5.VALUE)+"',"+"tglmasuk='"+SQLDATE(.TEXT14.VALUE)+"' where noberkas='"+MNOBERKASASAL+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SIMPANAN.SETALL("enabled", .F., "textbox")
OTHERWISE
ENDCASE
CASE THISFORM.MYEDIT="SELESAI"
DO CASE
CASE THISFORM.TEXT2.VALUE="BPKB" .OR. THISFORM.TEXT2.VALUE="KENDARAAN"
WITH THISFORM.BPKB
CSQL = "update pinjaman_jaminan_bpkb set "+"tglambil='"+SQLDATE(.TEXT15.VALUE)+"',"+"pengambil='"+.TEXT16.VALUE+"' "+"where noberkas='"+MNOBERKASASAL+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BPKB.SETALL("enabled", .F., "textbox")
CASE THISFORM.TEXT2.VALUE="SERTIFIKAT" .OR. THISFORM.TEXT2.VALUE="TANAH"
WITH THISFORM.SERTIFIKAT
CSQL = "update pinjaman_jaminan_sertifikat set"+"tglambil='"+SQLDATE(.TEXT15.VALUE)+"',"+"pengambil='"+.TEXT16.VALUE+"' "+"where noberkas='"+MNOBERKASASAL+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SERTIFIKAT.SETALL("enabled", .F., "textbox")
CASE THISFORM.TEXT2.VALUE="SIMPANAN" .OR. THISFORM.TEXT2.VALUE="DEPOSITO"
WITH THISFORM.SIMPANAN
CSQL = "update pinjaman_jaminan_simpanan set "+"tglambil='"+SQLDATE(.TEXT15.VALUE)+"',"+"pengambil='"+.TEXT16.VALUE+"' "+"where noberkas='"+MNOBERKASASAL+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SIMPANAN.SETALL("enabled", .F., "textbox")
CASE LEFT(THISFORM.TEXT2.VALUE, 4)="LAIN"
WITH THISFORM.LAINNYA
CSQL = "update pinjaman_jaminan_lainnya set "+"tglambil='"+SQLDATE(.TEXT15.VALUE)+"',"+"pengambil='"+.TEXT16.VALUE+"' "+"where noberkas='"+MNOBERKASASAL+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.SIMPANAN.SETALL("enabled", .F., "textbox")
OTHERWISE
ENDCASE
ENDCASE
SELECT (OLDSELECT)
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.GRID1.ENABLED = .T.
THISFORM.GRID1.REFRESH
ENDPROC
**
***
*** pinjaman_jaminan.sct
***
*
***
*** bacasql.scx
***
*
*
*  bacasql.scx::Form1
**
PROCEDURE Init
PARAMETER CSQL
IF VARTYPE(CSQL)="X"
CSQL = ""
ENDIF
THISFORM.LABEL1.CAPTION = "TEST KONEKSI"
THISFORM.LABEL3.CAPTION = THIS.LABEL1.CAPTION
THISFORM.CSQL = CSQL
THISFORM.TIMER1.INTERVAL = 500
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.KELUAR
ENDIF
ENDPROC
**
*
*  bacasql.scx::Timer1
**
PROCEDURE Timer
THISFORM.LABEL3.FORECOLOR = IIF(THISFORM.LABEL3.FORECOLOR=RGB(0, 0, 0), RGB(255, 255, 255), RGB(0, 0, 0))
THISFORM.LABEL1.FORECOLOR = IIF(THISFORM.LABEL1.FORECOLOR=RGB(0, 0, 0), RGB(255, 255, 255), RGB(0, 0, 0))
THISFORM.LABEL3.CAPTION = "COBA BACA KONEKSI"
THISFORM.LABEL1.CAPTION = "COBA BACA KONEKSI"
OODBC = SQLSTRINGCONNECT(DEFACONNECT)
IF OODBC>0
THISFORM.LABEL3.CAPTION = "TERHUBUNG"
THISFORM.LABEL1.CAPTION = "TERHUBUNG"
IF  .NOT. EMPTY(THISFORM.CSQL)
THISFORM.LABEL3.CAPTION = "TERHUBUNG"
THISFORM.LABEL1.CAPTION = "TERHUBUNG"
ENDIF
THISFORM.RELEASE
ENDIF
ENDPROC
**
***
*** bacasql.sct
***
*
***
*** krd_angsuran.frx
***
*
***
*** krd_angsuran.frt
***
*
***
*** gl_jurnal_input.scx
***
*
*
*  gl_jurnal_input.scx::FORM1
**
PROCEDURE mytampil
JURNAL = THISFORM.MYDBFJURNAL
THISFORM.GRID1.RECORDSOURCE = JURNAL
GOTO TOP
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 4
.COLUMN1.WIDTH = 70
.COLUMN1.ALIGNMENT = 0
.COLUMN1.CONTROLSOURCE = "NOPER"
.COLUMN1.FORMAT = 'R'
.COLUMN1.INPUTMASK = DEFAFMTAKT
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "NOPER"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 320
.COLUMN2.CONTROLSOURCE = "KET"
.COLUMN2.HEADER1.CAPTION = "KETERANGAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 120
.COLUMN3.CONTROLSOURCE = "DEBET"
.COLUMN3.HEADER1.CAPTION = "DEBET"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN3.FORMAT = "Z"
.COLUMN3.INPUTMASK = "999,999,999,999"
.COLUMN3.ALIGNMENT = 1
.COLUMN4.WIDTH = 120
.COLUMN4.CONTROLSOURCE = "KREDIT"
.COLUMN4.HEADER1.CAPTION = "KREDIT"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN4.FORMAT = "Z"
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.ALIGNMENT = 1
ENDWITH
THISFORM.GRID1.REFRESH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
ENDPROC
**
PROCEDURE cekbalance
MBALANCE = 0
IF RECCOUNT()>0
MREK = IIF(RECNO()>RECCOUNT(), RECCOUNT(), RECNO())
SUM DEBET TO JDEBET 
SUM KREDIT TO JKREDIT 
MBALANCE = 0-(JDEBET-JKREDIT)
GOTO MREK
ENDIF
THISFORM.MBALANCE.VALUE = MBALANCE
ENDPROC
**
PROCEDURE tampil2
THISFORM.MTANGGAL.VALUE = TANGGAL
THISFORM.MBUKTI.VALUE = BUKTI
THISFORM.TEXT2.VALUE = NOPER
THISFORM.MKET.VALUE = KET
THISFORM.TEXT4.VALUE = DEBET
THISFORM.TEXT5.VALUE = KREDIT
MNOPER = NOPER
OLDSELECT = SELECT()
CSQL = "select noper,nama from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT3.VALUE = NAMA
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE Activate
IF THISFORM.MYMODE="HAPUS"
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=7
MESSAGEBOX("Hapus Data")
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
MTANGGAL = TANGGAL
MBUKTI = BUKTI
THISFORM.OLDSELECT = SELECT()
THISFORM.MYMODE = MMODE
THISFORM.MTANGGAL.FORMAT = "KD"
THISFORM.TEXT2.INPUTMASK = DEFAFMTAKT
THISFORM.MBUKTI.INPUTMASK = REPLICATE("!", 10)
THISFORM.CMDSIMPAN.ENABLED = .F.
THISFORM.STATUS = MMODE
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDHAPUS.VISIBLE = .F.
THISFORM.CMDOK.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDTAMBAH1.VISIBLE = .F.
THISFORM.MYDBFJURNAL = SYS(2015)
JURNAL = THISFORM.MYDBFJURNAL
CREATE CURSOR &JURNAL (IDTRANS INT(10),TANGGAL DATE(8), BUKTI CHAR(10), NOPER CHAR(10), KET CHAR(40),DEBET DOUBLE(15),KREDIT DOUBLE(15), INPOPR CHAR(4),FLAG CHAR(1))
IF MMODE="EDIT" .OR. MMODE="HAPUS" .OR. MMODE="TAMPIL"
CSQL = "select idtrans,tanggal,bukti,noper,keterangan,if(jumlah>0,jumlah,0) as debet, if(jumlah<0,0-jumlah,0) as kredit "+"from jurnal where tanggal='"+SQLDATE(MTANGGAL)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO WHILE  .NOT. EOF()
MIDTRANS = IDTRANS
MTANGGAL = TANGGAL
MBUKTI = BUKTI
MNOPER = NOPER
MKET = KETERANGAN
MDEBET = DEBET
MKREDIT = KREDIT
SELECT &JURNAL
APPEND BLANK
REPLACE IDTRANS WITH MIDTRANS
REPLACE TANGGAL WITH MTANGGAL, BUKTI WITH MBUKTI, NOPER WITH MNOPER
REPLACE KET WITH MKET, DEBET WITH MDEBET, KREDIT WITH MKREDIT
SELECT SMT
SKIP
ENDDO
USE
ENDIF
SELECT &JURNAL
THISFORM.MYTAMPIL()
THISFORM.TAMPIL2()
IF THISFORM.MYMODE="HAPUS"
THISFORM.CMDHAPUS.VISIBLE = .T.
ENDIF
IF THISFORM.MYMODE="INPUT" .OR. THISFORM.MYMODE="EDIT"
THISFORM.MTANGGAL.VALUE = TGLNOW
THISFORM.MTANGGAL.ENABLED = .T.
THISFORM.MBUKTI.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.MKET.ENABLED = .T.
THISFORM.TEXT4.ENABLED = .T.
THISFORM.TEXT5.ENABLED = .T.
IF THISFORM.MYMODE<>"INPUT"
THISFORM.MTANGGAL.VALUE = MTANGGAL
THISFORM.CMDTAMBAH1.VISIBLE = .T.
ENDIF
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDOK.VISIBLE = .T.
THISFORM.CMDSIMPAN.VISIBLE = .T.
ENDIF
IF THISFORM.MYMODE="TAMPIL"
THISFORM.MTANGGAL.ENABLED = .F.
THISFORM.MBUKTI.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.MKET.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.MYDBFJURNAL)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  gl_jurnal_input.scx::mket
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("KETERANGAN TIDAK BOLEH KOSONG", 16, "")
NODEFAULT
ENDIF
ENDPROC
**
*
*  gl_jurnal_input.scx::Cmdsimpan
**
PROCEDURE Click
JURNAL = THISFORM.MYDBFJURNAL
SELECT &JURNAL
GOTO TOP
DO WHILE  .NOT. EOF()
IF FLAG='*' .AND.  .NOT. EMPTY(IDTRANS)
CSQL = "update jurnal set tanggal='"+SQLDATE(TANGGAL)+"', bukti='"+BUKTI+"', "+"noper='"+NOPER+"', keterangan='"+KET+"', jumlah='"+TRANSFORM(IIF(DEBET>0, DEBET, 0-KREDIT), '999999999999999')+"' "+"where idtrans='"+STR(IDTRANS)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
SKIP
ENDDO
MADA = .F.
GOTO TOP
CSQL = 'insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) values '
DO WHILE  .NOT. EOF()
IF EMPTY(IDTRANS)
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TANGGAL)+"', '"+BUKTI+"', '"+NOPER+"', '"+KET+"', '"+TRANSFORM(IIF(DEBET>0, DEBET, 0-KREDIT), '999999999999999')+"' ), "
MADA = .T.
ENDIF
SKIP
ENDDO
IF MADA
CSQL = LEFT(CSQL, LEN(CSQL)-2)
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  gl_jurnal_input.scx::Grid1
**
PROCEDURE DblClick
THISFORM.STATUS = "EDIT"
THISFORM.CMDTAMBAH1.VISIBLE = .T.
ENDPROC
**
PROCEDURE Click
THISFORM.STATUS = "EDIT"
THISFORM.CMDTAMBAH1.VISIBLE = .T.
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .OR. NKEYCODE=3
THISFORM.CMDSIMPAN.SETFOCUS
ENDIF
ENDPROC
**
*
*  gl_jurnal_input.scx::Text2
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "GL01"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select noper,nama,kel,detail from perkiraan where noper='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Perkiraan tidak terbaca")
ENDIF
IF RECCOUNT()>0 .AND. DETAIL='Y'
THIS.VALUE = MSANDI
THISFORM.TEXT3.VALUE = NAMA
SELECT SMT
USE
SELECT (OLDSELECT)
ELSE
MESSAGEBOX("Kode Perkiraan tidak ada, Atau nomor tidak dapat digunakan transaksi")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
SELECT (OLDSELECT)
RETURN
ENDIF
ENDPROC
**
*
*  gl_jurnal_input.scx::Text4
**
PROCEDURE LostFocus
IF THIS.VALUE>0
THISFORM.TEXT5.VALUE = 0
THISFORM.CMDOK.SETFOCUS
ENDIF
ENDPROC
**
*
*  gl_jurnal_input.scx::Cmdbatal
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_jurnal_input.scx::CmdOK
**
PROCEDURE Click
SELECT (THISFORM.MYDBFJURNAL)
IF THISFORM.STATUS="EDIT"
IF THISFORM.MTANGGAL.VALUE<>TANGGAL
REPLACE TANGGAL WITH THISFORM.MTANGGAL.VALUE ALL
ENDIF
IF THISFORM.MBUKTI.VALUE<>BUKTI
REPLACE BUKTI WITH THISFORM.MBUKTI.VALUE ALL
ENDIF
REPLACE NOPER WITH THISFORM.TEXT2.VALUE
REPLACE KET WITH THISFORM.MKET.VALUE
REPLACE DEBET WITH THISFORM.TEXT4.VALUE
REPLACE KREDIT WITH THISFORM.TEXT5.VALUE
REPLACE FLAG WITH '*'
ELSE
APPEND BLANK
REPLACE TANGGAL WITH THISFORM.MTANGGAL.VALUE
REPLACE BUKTI WITH THISFORM.MBUKTI.VALUE
REPLACE NOPER WITH THISFORM.TEXT2.VALUE
REPLACE KET WITH THISFORM.MKET.VALUE
REPLACE DEBET WITH THISFORM.TEXT4.VALUE
REPLACE KREDIT WITH THISFORM.TEXT5.VALUE
REPLACE FLAG WITH '*'
ENDIF
MTANGGAL = TANGGAL
MBUKTI = BUKTI
MKET = KET
SUM (DEBET-KREDIT) TO MSLD 
THISFORM.MBALANCE.VALUE = MSLD
IF MSLD<>0 .AND. LEFT(THISFORM.MKET.VALUE, 10)<>"SALDO AWAL"
THISFORM.LABEL8.VISIBLE = .T.
THISFORM.CMDSIMPAN.ENABLED = .F.
ELSE
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.CMDSIMPAN.ENABLED = .T.
ENDIF
IF THISFORM.STATUS="INPUT"
THISFORM.MYTAMPIL()
IF MSLD<>0 .AND. LEFT(THISFORM.MKET.VALUE, 10)<>"SALDO AWAL"
THISFORM.MTANGGAL.VALUE = MTANGGAL
THISFORM.MBUKTI.VALUE = MBUKTI
THISFORM.MKET.VALUE = MKET
THISFORM.TEXT2.VALUE = ''
THISFORM.TEXT4.VALUE = IIF(MSLD>0, 0, 0-MSLD)
THISFORM.TEXT5.VALUE = IIF(MSLD>0, MSLD, 0)
THISFORM.TEXT2.SETFOCUS
RETURN
ELSE
THISFORM.CMDTAMBAH1.VISIBLE = .T.
ENDIF
ENDIF
THISFORM.GRID1.SETFOCUS
ENDPROC
**
*
*  gl_jurnal_input.scx::CmdTambah1
**
PROCEDURE Click
THISFORM.STATUS = "TAMBAH"
THISFORM.TEXT2.VALUE = ''
THISFORM.MKET.VALUE = ''
THISFORM.TEXT3.VALUE = ''
THISFORM.TEXT4.VALUE = 0
THISFORM.TEXT5.VALUE = 0
THISFORM.TEXT2.SETFOCUS
ENDPROC
**
*
*  gl_jurnal_input.scx::Command1
**
PROCEDURE Click
SELECT (THISFORM.MYDBFJURNAL)
DELETE
SUM (DEBET-KREDIT) TO MSLD 
THISFORM.MBALANCE.VALUE = MSLD
IF MSLD<>0 .AND. LEFT(THISFORM.MKET.VALUE, 10)<>"SALDO AWAL"
THISFORM.LABEL8.VISIBLE = .T.
THISFORM.CMDSIMPAN.ENABLED = .F.
ELSE
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.CMDSIMPAN.ENABLED = .T.
ENDIF
THISFORM.GRID1.SETFOCUS
ENDPROC
**
*
*  gl_jurnal_input.scx::CmdHapus
**
PROCEDURE Click
MHAPUS = MESSAGEBOX("HAPUS JURNAL"+CHR(13)+"BENAR DATA INI AKAN DIHAPUS", 20, "")
IF MHAPUS=6
CSQL = "Delete from jurnal where tanggal='"+SQLDATE(THISFORM.MTANGGAL.VALUE)+"' and bukti='"+THISFORM.MBUKTI.VALUE+"' and kantor='"+ALLTRIM(DEFAKANTOR)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
***
*** gl_jurnal_input.sct
***
*
***
*** form1.scx
***
*
*
*  form1.scx::Text15
**
PROCEDURE LostFocus
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  form1.scx::Text16
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  form1.scx::Command1
**
PROCEDURE Click
DO FORM frm_calender TO X
MESSAGEBOX(X)
ENDPROC
**
***
*** form1.sct
***
*
***
*** gl_inventaris_data.scx
***
*
*
*  gl_inventaris_data.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MDATA
SET DATE ITALIAN
SET CENTURY ON
THISFORM.MODE = MMODE
THISFORM.MNOMOR = NOMORID
THISFORM.TEXT11.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT10.INPUTMASK = DEFAFMTAKT
IF MMODE="TAMPIL" .OR. MMODE="EDIT" .OR. MMODE="HAPUS"
IF MMODE="TAMPIL" .OR. MMODE="HAPUS"
THISFORM.SETALL("Enabled", .F., "textbox")
IF MMODE="TAMPIL"
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ELSE
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND5.VISIBLE = .T.
ENDIF
ELSE
THISFORM.TEXT11.ENABLED = .T.
THISFORM.TEXT10.ENABLED = .T.
THISFORM.COMMAND4.ENABLED = .T.
THISFORM.COMMAND6.ENABLED = .T.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
ENDIF
WITH THISFORM
.TEXT41.VALUE = KODE
.TEXT42.VALUE = NAMA
.TEXT1.VALUE = TANGGAL
.TEXT2.VALUE = HARGA
.TEXT3.VALUE = GOL
.TEXT4.VALUE = LAMA
.TEXT5.VALUE = PENYUSUTAN
.TEXT6.VALUE = AKUMULASI
.TEXT7.VALUE = NILAIBUKU
.TEXT8.VALUE = TGLMUTASI
.TEXT9.VALUE = KETERANGAN
.TEXT11.VALUE = IIF(ISNULL(JUR_BIAYA), '', JUR_BIAYA)
.TEXT10.VALUE = IIF(ISNULL(JUR_AKUM), '', JUR_AKUM)
ENDWITH
ELSE
IF MMODE="INPUT"
THISFORM.TEXT11.ENABLED = .T.
THISFORM.TEXT10.ENABLED = .T.
THISFORM.COMMAND4.ENABLED = .T.
THISFORM.COMMAND6.ENABLED = .T.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
ENDIF
OLDDBF = SELECT()
CSQL = "SELECT MAX(kode) as nom from gl_inventaris order by kode"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MMAX = IIF(ISNULL(NOM), 0, VAL(NOM))
USE
SELECT (OLDDBF)
MMAX = MMAX+1
MNOM = RIGHT('000000'+ALLTRIM(STR(MMAX)), 6)
THISFORM.TEXT41.VALUE = MNOM
THISFORM.TEXT1.VALUE = TGLNOW
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Command5
**
PROCEDURE Click
CSQL = "delete from gl_inventaris where nomorid='"+STR(THISFORM.MNOMOR)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_data.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_data.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into gl_inventaris (kantor,kode,nama,tanggal,harga,gol,lama,penyusutan,"+"akumulasi,nilaibuku,tglmutasi,keterangan,jur_biaya,jur_akum) value "+"('"+DEFAKANTOR+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+SQLDATE(.TEXT1.VALUE)+"',"+"'"+STR(.TEXT2.VALUE)+"',"+"'"+.TEXT3.VALUE+"',"+"'"+STR(.TEXT4.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT6.VALUE)+"',"+"'"+STR(.TEXT7.VALUE)+"',"+"'"+SQLDATE(.TEXT8.VALUE)+"',"+"'"+.TEXT9.VALUE+"',"+"'"+.TEXT11.VALUE+"',"+"'"+.TEXT10.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "update gl_inventaris set "+"kode='"+.TEXT41.VALUE+"',"+"nama='"+.TEXT42.VALUE+"',"+"tanggal='"+SQLDATE(.TEXT1.VALUE)+"',"+"harga='"+STR(.TEXT2.VALUE)+"',"+"gol='"+.TEXT3.VALUE+"',"+"lama='"+STR(.TEXT4.VALUE)+"',"+"penyusutan='"+STR(.TEXT5.VALUE)+"',"+"akumulasi='"+STR(.TEXT6.VALUE)+"',"+"nilaibuku='"+STR(.TEXT7.VALUE)+"',"+"tglmutasi='"+SQLDATE(.TEXT8.VALUE)+"',"+"keterangan='"+.TEXT9.VALUE+"', "+"jur_biaya='"+.TEXT11.VALUE+"', "+"jur_akum='"+.TEXT10.VALUE+"' where nomorid='"+STR(THISFORM.MNOMOR)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_data.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_data.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Text2
**
PROCEDURE LostFocus
THISFORM.TEXT7.VALUE = THIS.VALUE
ENDPROC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
THISFORM.TEXT7.VALUE = THISFORM.TEXT2.VALUE
DO CASE
CASE THIS.VALUE="0"
THISFORM.TEXT4.VALUE = 0
THISFORM.TEXT5.VALUE = 0
THISFORM.TEXT6.VALUE = 0
THISFORM.TEXT11.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
CASE THIS.VALUE="1"
THISFORM.TEXT4.VALUE = 0048
THISFORM.TEXT5.VALUE = ROUND(THISFORM.TEXT2.VALUE/0048, 0)
CASE THIS.VALUE="2"
THISFORM.TEXT4.VALUE = 0096
THISFORM.TEXT5.VALUE = ROUND(THISFORM.TEXT2.VALUE/0096, 0)
CASE THIS.VALUE="3"
THISFORM.TEXT4.VALUE = (00192)
THISFORM.TEXT5.VALUE = ROUND(THISFORM.TEXT2.VALUE/(00192), 0)
CASE THIS.VALUE="4"
THISFORM.TEXT4.VALUE = (00240)
THISFORM.TEXT5.VALUE = ROUND(THISFORM.TEXT2.VALUE/(00240), 0)
OTHERWISE
MESSAGEBOX("Golongan Harus 0, 1 , 2, 3 atau 4", 16, "WARNING")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDCASE
THISFORM.TEXT8.VALUE = HITJT("BULANAN", THISFORM.TEXT4.VALUE, THISFORM.TEXT1.VALUE)
ENDPROC
**
*
*  gl_inventaris_data.scx::Text4
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE LostFocus
THISFORM.TEXT5.VALUE = ROUND(THISFORM.TEXT2.VALUE/THISFORM.TEXT4.VALUE, 0)
ENDPROC
**
*
*  gl_inventaris_data.scx::Text5
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Text7
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Text8
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Text9
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Text6
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_data.scx::Command1
**
PROCEDURE Click
DO FORM gl_inventaris_mutasi
ENDPROC
**
*
*  gl_inventaris_data.scx::Text10
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MNOPER WITH "GL01"
IF EMPTY(MNOPER)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THIS.VALUE = MNOPER
ENDIF
ELSE
MNOPER = THIS.VALUE
ENDIF
OLDSELE = SELECT()
CSQL = "select noper,nama,bukubantu,detail from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOPER=MNOPER .AND. DETAIL='Y'
USE
SELECT (OLDSELE)
RETURN
ELSE
MESSAGEBOX("Nomor tidak ketemu atau Nomor induk yg tidak dapat digunakan untuk transaksi", 16, "")
ENDIF
USE
SELECT (OLDSELE)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDPROC
**
*
*  gl_inventaris_data.scx::Text11
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MNOPER WITH "GL01"
IF EMPTY(MNOPER)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THIS.VALUE = MNOPER
ENDIF
ELSE
MNOPER = THIS.VALUE
ENDIF
OLDSELE = SELECT()
CSQL = "select noper,nama,bukubantu,detail from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOPER=MNOPER .AND. DETAIL='Y'
USE
SELECT (OLDSELE)
RETURN
ELSE
MESSAGEBOX("Nomor tidak ketemu atau Nomor induk yg tidak dapat digunakan untuk transaksi", 16, "")
ENDIF
USE
SELECT (OLDSELE)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDPROC
**
*
*  gl_inventaris_data.scx::Command6
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT11.VALUE = MNOPER
THISFORM.TEXT11.SETFOCUS
ENDPROC
**
*
*  gl_inventaris_data.scx::Command4
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.TEXT10.VALUE = MNOPER
THISFORM.TEXT10.SETFOCUS
ENDPROC
**
***
*** gl_inventaris_data.sct
***
*
***
*** gl_biayadimuka_data.scx
***
*
*
*  gl_biayadimuka_data.scx::Form1
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.BORDERSTYLE = 2
THISFORM.MODE = MMODE
IF MMODE="TAMPIL" .OR. MMODE="EDIT"
IF MMODE="TAMPIL"
THISFORM.SETALL("Enabled", .F., "textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
WITH THISFORM
.TEXT41.VALUE = KODE
.TEXT42.VALUE = NAMA
.TEXT1.VALUE = TANGGAL
.TEXT2.VALUE = BIAYA
.TEXT4.VALUE = LAMA
.TEXT5.VALUE = AMORTISASI
.TEXT6.VALUE = AKUMULASI
.TEXT7.VALUE = SISA
.TEXT8.VALUE = TGLMUTASI
.TEXT9.VALUE = KETERANGAN
ENDWITH
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Command3
**
PROCEDURE Click
MNOMOR = NOMOR
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into gl_biayadimuka (kantor,kode,nama,tanggal,biaya,lama,amortisasi,akumulasi,sisa,tglmutasi,keterangan) value "+"('"+DEFAKANTOR+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+SQLDATE(.TEXT1.VALUE)+"',"+"'"+STR(.TEXT2.VALUE)+"',"+"'"+STR(.TEXT4.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT6.VALUE)+"',"+"'"+STR(.TEXT7.VALUE)+"',"+"'"+SQLDATE(.TEXT8.VALUE)+"',"+"'"+.TEXT9.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "update gl_biayadimuka set "+"kode='"+.TEXT41.VALUE+"',"+"nama='"+.TEXT42.VALUE+"',"+"tanggal='"+SQLDATE(.TEXT1.VALUE)+"',"+"biaya='"+STR(.TEXT2.VALUE)+"',"+"lama='"+STR(.TEXT4.VALUE)+"',"+"amortisasi='"+STR(.TEXT5.VALUE)+"',"+"akumulasi='"+STR(.TEXT6.VALUE)+"',"+"sisa='"+STR(.TEXT7.VALUE)+"',"+"tglmutasi='"+SQLDATE(.TEXT8.VALUE)+"',"+"keterangan='"+.TEXT9.VALUE+"' where nomor='"+STR(MNOMOR)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Command1
**
PROCEDURE Click
DO FORM gl_bkbantu_mutasi WITH "TAMPIL", "BDD"
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text4
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
THISFORM.TEXT5.VALUE = INT(THISFORM.TEXT2.VALUE/THIS.VALUE)
THISFORM.TEXT7.VALUE = THISFORM.TEXT2.VALUE
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text5
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text7
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text8
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text9
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_biayadimuka_data.scx::Text6
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** gl_biayadimuka_data.sct
***
*
***
*** about.scx
***
*
*
*  about.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  about.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** about.sct
***
*
***
*** pinjaman_perhitungan.scx
***
*
*
*  pinjaman_perhitungan.scx::FORM1
**
PROCEDURE Unload
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK
THISFORM.SETALL("fontname", "Cambria", "Textbox")
THISFORM.OLDSELECT = SELECT()
MDENDA = HITDENDA(MNOREK, TGLNOW)
THISFORM.TEXT26.VALUE = MAX(0, MDENDA)
MCUR = SALDOKRD(MNOREK, TGLNOW)
SELECT (MCUR)
THISFORM.TEXT1.VALUE = JUMJDWPK
THISFORM.TEXT2.VALUE = PKAWAL
THISFORM.TEXT3.VALUE = JUMJDWBG
THISFORM.TEXT4.VALUE = BGAWAL
THISFORM.TEXT46.VALUE = MAX(JUMJDWPK, JUMJDWBG)
THISFORM.TEXT6.VALUE = PKAWAL+BGAWAL
WITH THISFORM
.TEXT16.VALUE = HARUSPKKE
.TEXT17.VALUE = HRSPK
.TEXT18.VALUE = HARUSBGKE
.TEXT19.VALUE = HRSBG
.TEXT49.VALUE = MAX(HARUSPKKE, HARUSBGKE)
.TEXT20.VALUE = HRSPK+HRSBG
.TEXT34.VALUE = IIF(NJDWPK=0, 0, 1)
.TEXT35.VALUE = NJDWPK
.TEXT36.VALUE = IIF(NJDWBG=0, 0, 1)
.TEXT37.VALUE = NJDWBG
.TEXT50.VALUE = IIF(NJDWPK+NJDWBG=0, 0, 1)
.TEXT38.VALUE = NJDWPK+NJDWBG
.TEXT39.VALUE = .TEXT16.VALUE+.TEXT34.VALUE
.TEXT40.VALUE = .TEXT17.VALUE+.TEXT35.VALUE
.TEXT41.VALUE = .TEXT18.VALUE+.TEXT36.VALUE
.TEXT42.VALUE = .TEXT19.VALUE+.TEXT37.VALUE
.TEXT53.VALUE = .TEXT49.VALUE+.TEXT50.VALUE
.TEXT43.VALUE = .TEXT20.VALUE+.TEXT38.VALUE
.TEXT29.VALUE = CEILING(KALIBYRPK)
.TEXT30.VALUE = BYRPK
.TEXT31.VALUE = CEILING(KALIBYRBG)
.TEXT32.VALUE = BYRBG
.TEXT52.VALUE = MIN(CEILING(KALIBYRPK), CEILING(KALIBYRBG))
.TEXT33.VALUE = BYRPK+BYRBG
.TEXT21.VALUE = .TEXT39.VALUE-.TEXT29.VALUE
.TEXT22.VALUE = .TEXT40.VALUE-.TEXT30.VALUE
.TEXT23.VALUE = .TEXT41.VALUE-.TEXT31.VALUE
.TEXT24.VALUE = .TEXT42.VALUE-.TEXT32.VALUE
.TEXT51.VALUE = .TEXT53.VALUE-.TEXT52.VALUE
.TEXT25.VALUE = .TEXT43.VALUE-.TEXT33.VALUE
.TEXT5.VALUE = .TEXT1.VALUE-.TEXT39.VALUE
.TEXT7.VALUE = SISAJDWPK
.TEXT8.VALUE = .TEXT3.VALUE-.TEXT41.VALUE
.TEXT9.VALUE = SISAJDWBG
.TEXT47.VALUE = MIN(.TEXT1.VALUE-.TEXT39.VALUE, .TEXT3.VALUE-.TEXT41.VALUE)
.TEXT10.VALUE = SISAJDWPK+SISAJDWBG
.TEXT11.VALUE = JUMJDWPK-CEILING(KALIBYRPK)
.TEXT12.VALUE = SISAPK
.TEXT13.VALUE = JUMJDWBG-CEILING(KALIBYRBG)
.TEXT14.VALUE = SISABG
.TEXT48.VALUE = MIN(JUMJDWPK-CEILING(KALIBYRPK), JUMJDWBG-CEILING(KALIBYRBG))
.TEXT15.VALUE = SISAPK+SISABG
.TEXT44.VALUE = .TEXT12.VALUE
.TEXT45.VALUE = .TEXT14.VALUE
.TEXT27.VALUE = SISABG*(3.0/4)
.TEXT28.VALUE = .TEXT44.VALUE+.TEXT45.VALUE+.TEXT26.VALUE-.TEXT27.VALUE
ENDWITH
DO CASE
CASE KOL='1'
THISFORM.LABEL23.CAPTION = "LANCAR"
CASE KOL='2'
THISFORM.LABEL23.CAPTION = "KURANG LANCAR"
CASE KOL='3'
THISFORM.LABEL23.CAPTION = "DIRAGUKAN"
CASE KOL='4'
THISFORM.LABEL23.CAPTION = "MACET"
ENDCASE
IF TGLJTEMPO>TGLNOW
MLEBIHJT = 0
ELSE
IF TGLNOW>=TGLJTEMPO .AND. TGLNOW<=MAJU1BLN(TGLJTEMPO)
MLEBIHJT = 1
ELSE
IF TGLNOW<=MAJU1BLN(MAJU1BLN(TGLJTEMPO))
MLEBIHJT = 2
ELSE
MLEBIHJT = 3
ENDIF
ENDIF
ENDIF
IF MLEBIHJT=0
THISFORM.LABEL22.CAPTION = "BELUM JATUH TEMPO"
ENDIF
IF MLEBIHJT=1
THISFORM.LABEL22.CAPTION = "JATUH TEMPO <=1 BULAN"
ENDIF
IF MLEBIHJT=2
THISFORM.LABEL22.CAPTION = "JATUH TEMPO <=2 BULAN"
ENDIF
IF MLEBIHJT=3
THISFORM.LABEL22.CAPTION = "JATUH TEMPO >2 BULAN"
ENDIF
ENDPROC
**
*
*  pinjaman_perhitungan.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** pinjaman_perhitungan.sct
***
*
***
*** set_laporan.scx
***
*
*
*  set_laporan.scx::Form1
**
PROCEDURE bacasql
MDATA = THISFORM.MYDBF
IF  .NOT. EMPTY(THISFORM.TEXT1.VALUE)
MFILTER = "concat(nama_menu,PENJELASAN) LIKE '%"+ALLTRIM(THISFORM.TEXT1.VALUE)+"%'"
ELSE
MFILTER = "1"
ENDIF
SQLKODE = ''
SQLKEL = ''
IF  .NOT. EMPTY(THISFORM.KODE)
SQLKODE = "dept='"+THISFORM.KODE+"' and "
ENDIF
IF  .NOT. EMPTY(THISFORM.KELOMPOK)
SQLKEL = "kel='"+THISFORM.KELOMPOK+"' and "
ENDIF
CSQL = "select * from set_print where "+SQLKODE+SQLKEL+MFILTER+" order by nomor"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX("Gagal baca data")
ENDIF
ENDPROC
**
PROCEDURE tampil
MDATA = THISFORM.MYDBF
THISFORM.GRID1.RECORDSOURCE = MDATA
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 60
.COLUMN1.CONTROLSOURCE = "NOMOR"
.COLUMN1.HEADER1.CAPTION = "NO.URUT"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "NAMA_MENU"
.COLUMN2.HEADER1.CAPTION = "NAMA LAPORAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 300
.COLUMN3.CONTROLSOURCE = "PENJELASAN"
.COLUMN3.HEADER1.CAPTION = "KETERANGAN"
.COLUMN3.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
ENDPROC
**
PROCEDURE tampil2
THISFORM.TEXT5.VALUE = DEPT
THISFORM.TEXT6.VALUE = KEL
THISFORM.TEXT3.VALUE = PENJELASAN
THISFORM.TEXT4.VALUE = NAMA_MENU
THISFORM.TEXT7.VALUE = NOMOR
ENDPROC
**
PROCEDURE menable
PARAMETER KONDISI
THISFORM.TEXT3.ENABLED = KONDISI
THISFORM.TEXT4.ENABLED = KONDISI
THISFORM.CMDINPUT1.VISIBLE =  .NOT. KONDISI
THISFORM.CMDEDIT1.VISIBLE =  .NOT. KONDISI
THISFORM.CMDHAPUS1.VISIBLE =  .NOT. KONDISI
THISFORM.CMDBATAL1.VISIBLE = KONDISI
THISFORM.CMDSIMPAN1.VISIBLE = KONDISI
THISFORM.CMDKELUAR1.VISIBLE =  .NOT. KONDISI
ENDPROC
**
PROCEDURE Init
PARAMETER MKODE, MKEL
IF VARTYPE(MKODE)="X" .OR. VARTYPE(MKODE)="L"
MKODE = ""
ENDIF
IF VARTYPE(MKEL)="X" .OR. VARTYPE(MKEL)="L"
MKEL = ""
ENDIF
THISFORM.KODE = MKODE
THISFORM.KELOMPOK = MKEL
THISFORM.OLDSELECT = SELECT()
THISFORM.MYDBF = SYS(2015)
THISFORM.MENABLE(.F.)
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  set_laporan.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  set_laporan.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
PROCEDURE DblClick
DO FORM set_laporan2 WITH "TAMPIL"
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM set_laporan2 WITH "TAMPIL"
ENDIF
ENDPROC
**
*
*  set_laporan.scx::Cmdhapus1
**
PROCEDURE Click
YT = MESSAGEBOX("Benar Data Akan dihapus", 36, "Hapus Data")
IF YT=6
CSQL = "delete from set_print where nomor='"+STR(NOMOR)+"' and template_id='"+TEMPLATE_ID+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  set_laporan.scx::Cmdsimpan1
**
PROCEDURE Click
MIDLAP = TEMPLATE_ID
THISFORM.MENABLE(.F.)
MKEL = IIF(THISFORM.COMBO1.VALUE="LAPORAN", '1', '2')
IF THISFORM.MYMODE="INPUT"
CSQL = "insert into man_atur_print (kdbank,kdkantor,dept,kel,template_id,nama_menu,penjelasan) value "+"(?defakdbank,?defakdkantor,?thisform.combo4.value,?mkel,?thisform.text2.value,"+"?thisform.text4.value,?thisform.text3.value)"
ELSE
CSQL = "update man_atur_print set dept=?thisform.combo4.value,"+"kel=?mkel,template_id=?thisform.text2.value,penjelasan=?thisform.text3.value, "+"nama_menu=?thisform.text4.value "+" where kdbank=?defakdbank and template_id=?midlap"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  set_laporan.scx::Cmdedit1
**
PROCEDURE Click
DO FORM set_laporan2 WITH "EDIT"
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  set_laporan.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.MENABLE(.F.)
ENDPROC
**
*
*  set_laporan.scx::Cmdinput1
**
PROCEDURE Click
DO FORM set_laporan2 WITH "INPUT", THISFORM.KODE
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  set_laporan.scx::Cmdfilter1
**
PROCEDURE Click
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
***
*** set_laporan.sct
***
*
***
*** set_laporan2.scx
***
*
*
*  set_laporan2.scx::FORM1
**
PROCEDURE Init
PARAMETER MMODE, MDEPT
THISFORM.TEMPLATE_ID = TEMPLATE_ID
THISFORM.TGLINPUT = TGLINP
WITH THISFORM
.TEXT5.VALUE = DEPT
.TEXT6.VALUE = KEL
.TEXT7.VALUE = NOMOR
.TEXT4.VALUE = NAMA_MENU
.TEXT1.VALUE = PENJELASAN
ENDWITH
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "TAMPIL"
ENDIF
IF VARTYPE(MDEPT)="X" .OR. VARTYPE(MDEPT)="L"
MDEPT = ""
ENDIF
THISFORM.CONTAINER2.OPTIONGROUP1.VALUE = OPT_TYPE
THISFORM.CONTAINER2.TEXT3.VALUE = THISFORM.TEXT4.VALUE
DO CASE
CASE MMODE="INPUT"
THISFORM.CONTAINER1.VISIBLE = .F.
THISFORM.CONTAINER2.VISIBLE = .T.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .T.
THISFORM.TEXT5.SETFOCUS
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
OLDSELECT = SELECT()
CSQL = "select MAX(nomor) as nomor from set_print where dept='"+MDEPT+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
USE
SELECT (OLDSELECT)
THISFORM.TEXT5.VALUE = MDEPT
THISFORM.TEXT6.VALUE = ''
THISFORM.TEXT7.VALUE = NOMOR+1
THISFORM.TEXT4.VALUE = ''
THISFORM.TEXT1.VALUE = ''
CASE MMODE="TAMPIL"
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CONTAINER1.VISIBLE = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT1.ENABLED = .F.
CASE MMODE="EDIT"
THISFORM.CONTAINER1.VISIBLE = .T.
THISFORM.CONTAINER2.VISIBLE = .F.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDPREVIEW2.VISIBLE = .T.
MTEMPLATE_ID = TEMPLATE_ID
MOPT_TYPE = OPT_TYPE
MFILE0 = ''
IF MOPT_TYPE=1
MFILE1 = SYS(2023)+"\"+ALLTRIM(MTEMPLATE_ID)+".FRX"
ELSE
MFILE1 = SYS(2023)+"\"+ALLTRIM(MTEMPLATE_ID)+".DOC"
ENDIF
THISFORM.CONTAINER1.TEXT2.VALUE = MFILE1
ENDCASE
THISFORM.MODE = MMODE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
IF  .NOT. EMPTY(THISFORM.FILENAME1)
DELETE FILE (THISFORM.FILENAME1)
ENDIF
IF  .NOT. EMPTY(THISFORM.FILENAME2)
DELETE FILE (THISFORM.FILENAME2)
ENDIF
ENDPROC
**
*
*  set_laporan2.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  set_laporan2.scx::Text4
**
PROCEDURE LostFocus
IF LASTKEY()=27
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDPROC
**
*
*  set_laporan2.scx::Text6
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE='1' .OR. THIS.VALUE='2')
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDPROC
**
*
*  set_laporan2.scx::Cmdcari1
**
FUNCTION Click
MDATAASAL = ALIAS()
IF THISFORM.CONTAINER2.OPTIONGROUP1.VALUE=1
IF THISFORM.CONTAINER2.OPTIONGROUP2.VALUE=2
GFILE = GETFILE('frx')
THISFORM.CONTAINER2.TEXT3.VALUE = GFILE
ELSE
DO FORM cari_format_lap TO MIDLAP WITH THISFORM.CONTAINER2.OPTIONGROUP1.VALUE
IF  .NOT. EMPTY(MIDLAP)
CSQL = "select template1,template2 from set_print where template_id=?midlap"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
LOCAL LCDIRECTORY
LCDIRECTORY = SYS(16)
LCDIRECTORY = ADDBS(JUSTPATH(SUBSTR(LCDIRECTORY, AT(' ', LCDIRECTORY, 2)+1)))
MFILE1 = LCDIRECTORY+THISFORM.CONTAINER2.TEXT4.VALUE+".FRX"
MISI = CAST(TEMPLATE1 AS W )
NHANDLE = FCREATE(MFILE1)
IF NHANDLE>0
FWRITE(NHANDLE, MISI)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Error, tidak bisa membuat file temporer!!")
THISFORM.RELEASE()
RETURN .F.
ENDIF
FCLOSE(NHANDLE)
MFILE2 = LCDIRECTORY+THISFORM.CONTAINER2.TEXT4.VALUE+".FRT"
MISI = CAST(TEMPLATE2 AS W )
NHANDLE = FCREATE(MFILE2)
IF NHANDLE>0
FWRITE(NHANDLE, MISI)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Error, tidak bisa membuat file temporer!!")
THISFORM.RELEASE()
RETURN .F.
ENDIF
FCLOSE(NHANDLE)
THISFORM.TEXT3.VALUE = MFILE1
USE
ENDIF
ENDIF
ELSE
IF THISFORM.CONTAINER2.OPTIONGROUP2.VALUE=2
GFILE = GETFILE('docx')
THISFORM.CONTAINER2.TEXT3.VALUE = GFILE
ELSE
MDATAASAL = ALIAS()
DO FORM cari_format_lap TO MIDLAP WITH THISFORM.CONTAINER2.OPTIONGROUP1.VALUE
IF  .NOT. EMPTY(MIDLAP)
CSQL = "select template1,template2 from set_print where template_id=?midlap"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
LOCAL LCDIRECTORY
LCDIRECTORY = SYS(16)
LCDIRECTORY = ADDBS(JUSTPATH(SUBSTR(LCDIRECTORY, AT(' ', LCDIRECTORY, 2)+1)))
MFILE1 = LCDIRECTORY+THISFORM.CONTAINER2.TEXT4.VALUE+".DOC"
MISI = CAST(TEMPLATE1 AS W )
NHANDLE = FCREATE(MFILE1)
IF NHANDLE>0
FWRITE(NHANDLE, MISI)
FCLOSE(NHANDLE)
ELSE
FCLOSE(NHANDLE)
MESSAGEBOX("Error, tidak bisa membuat file temporer!!")
THISFORM.RELEASE()
RETURN .F.
ENDIF
THISFORM.CONTAINER2.TEXT3.VALUE = MFILE1
USE
ENDIF
ENDIF
ENDIF
SELECT &MDATAASAL
IF  .NOT. EMPTY(THISFORM.CONTAINER2.TEXT3.VALUE)
THISFORM.CONTAINER2.CMDEDIT1.VISIBLE = .T.
THISFORM.CONTAINER2.CMDPREVIEW1.VISIBLE = .T.
THISFORM.CONTAINER2.CMDPRINT1.VISIBLE = .T.
ELSE
THISFORM.CONTAINER2.CMDEDIT1.VISIBLE = .F.
THISFORM.CONTAINER2.CMDPREVIEW1.VISIBLE = .F.
THISFORM.CONTAINER2.CMDPRINT1.VISIBLE = .F.
ENDIF
ENDFUNC
**
*
*  set_laporan2.scx::Optiongroup2
**
PROCEDURE InteractiveChange
DO CASE
CASE THIS.VALUE=1
THISFORM.CONTAINER2.CMDCARI1.VISIBLE = .F.
THISFORM.CONTAINER2.CMDINPUT1.VISIBLE = .T.
CASE THIS.VALUE=2 .OR. THIS.VALUE=3
THISFORM.CONTAINER2.CMDCARI1.VISIBLE = .T.
THISFORM.CONTAINER2.CMDINPUT1.VISIBLE = .F.
CASE THIS.VALUE=4
THISFORM.CONTAINER2.CMDCARI1.VISIBLE = .F.
THISFORM.CONTAINER2.CMDINPUT1.VISIBLE = .F.
ENDCASE
ENDPROC
**
*
*  set_laporan2.scx::Cmdprint1
**
PROCEDURE Click
IF THISFORM.OPTIONGROUP1.VALUE=1
THISFORM.HIDE()
REPORT FORM (THISFORM.CONTAINER2.TEXT3.VALUE) TO PRINTER NOWAIT
THISFORM.SHOW()
ELSE
THISFORM.WORD1.OPENWORD()
LOCAL NSIZE
IF THISFORM.WORD1.OPENDOCUMENT(THISFORM.CONTAINER2.TEXT3.VALUE)
THISFORM.WORD1.ACTIVATEDOCUMENT(THISFORM.CONTAINER2.TEXT3.VALUE)
THISFORM.WORD1.PRINTDOCUMENT()
THISFORM.WORD1.CLOSEDOCUMENT(THISFORM.CONTAINER2.TEXT3.VALUE)
ENDIF
THISFORM.WORD1.CLOSEWORD()
ENDIF
ENDPROC
**
*
*  set_laporan2.scx::Cmdedit1
**
PROCEDURE Click
IF THISFORM.CONTAINER2.OPTIONGROUP1.VALUE=1
LOCAL LCDIRECTORY
LCDIRECTORY = SYS(16)
LCDIRECTORY = ADDBS(JUSTPATH(SUBSTR(LCDIRECTORY, AT(' ', LCDIRECTORY, 2)+1)))
IF FILE(THISFORM.CONTAINER2.TEXT3.VALUE)
MODIFY REPORT (THISFORM.CONTAINER2.TEXT3.VALUE)
ENDIF
ELSE
THISFORM.WORD1.OPENWORD()
LOCAL NSIZE
IF THISFORM.WORD1.OPENDOCUMENT(THISFORM.CONTAINER2.TEXT3.VALUE)
THISFORM.WORD1.ACTIVATEDOCUMENT(THISFORM.CONTAINER2.TEXT3.VALUE)
THISFORM.WORD1.SETWINDOWSTATE(1)
THISFORM.WORD1.EDITDOCUMENT()
THISFORM.WORD1.CLOSEDOCUMENT(THISFORM.CONTAINER2.TEXT3.VALUE)
ENDIF
THISFORM.WORD1.CLOSEWORD()
ENDIF
ENDPROC
**
*
*  set_laporan2.scx::Cmdinput1
**
FUNCTION Click
IF THISFORM.CONTAINER2.OPTIONGROUP1.VALUE=1
LOCAL LCDIRECTORY
LCDIRECTORY = SYS(16)
LCDIRECTORY = ADDBS(JUSTPATH(SUBSTR(LCDIRECTORY, AT(' ', LCDIRECTORY, 2)+1)))
MODIFY REPORT FORCEPATH('new.FRX', LCDIRECTORY)
THISFORM.CONTAINER2.TEXT3.VALUE = LCDIRECTORY+"new.frx"
THISFORM.FILE1 = LCDIRECTORY+"new.frx"
THISFORM.FILE2 = LCDIRECTORY+"new.frt"
THISFORM.CONTAINER2.CMDEDIT1.VISIBLE = .T.
THISFORM.CONTAINER2.CMDPREVIEW1.VISIBLE = .T.
THISFORM.CONTAINER2.CMDPRINT1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
ELSE
LOCAL LCDIRECTORY
LCDIRECTORY = SYS(16)
LCDIRECTORY = ADDBS(JUSTPATH(SUBSTR(LCDIRECTORY, AT(' ', LCDIRECTORY, 2)+1)))
MFILE = LCDIRECTORY+"NEW.DOC"
NHANDLE = FCREATE(MFILE)
IF NHANDLE>0
FWRITE(NHANDLE, '')
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Error, tidak bisa membuat file temporer!!")
THISFORM.RELEASE()
RETURN .F.
ENDIF
THISFORM.WORD1.OPENWORD()
LOCAL NSIZE
IF THISFORM.WORD1.OPENDOCUMENT(MFILE)
THISFORM.WORD1.ACTIVATEDOCUMENT(MFILE)
THISFORM.WORD1.SETWINDOWSTATE(1)
THISFORM.WORD1.EDITDOCUMENT()
THISFORM.WORD1.CLOSEDOCUMENT(MFILE)
ELSE
MESSAGEBOX("Error, tidak bisa membuka file Result hasil edit!!")
ENDIF
THISFORM.WORD1.CLOSEWORD()
THISFORM.CONTAINER2.TEXT3.VALUE = MFILE
THISFORM.CONTAINER2.CMDEDIT1.VISIBLE = .T.
THISFORM.CONTAINER2.CMDPREVIEW1.VISIBLE = .T.
THISFORM.CONTAINER2.CMDPRINT1.VISIBLE = .T.
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.FILENAME1 = MFILE
ENDIF
ENDFUNC
**
*
*  set_laporan2.scx::Cmdpreview1
**
PROCEDURE Click
IF THISFORM.CONTAINER2.OPTIONGROUP1.VALUE=1
LOCAL LCDIRECTORY
MDBF = ALIAS()
LCDIRECTORY = SYS(16)
LCDIRECTORY = ADDBS(JUSTPATH(SUBSTR(LCDIRECTORY, AT(' ', LCDIRECTORY, 2)+1)))
REPORT FORM (THISFORM.CONTAINER2.TEXT3.VALUE) PREVIEW
SELECT (MDBF)
ELSE
THISFORM.WORD1.OPENWORD()
LOCAL NSIZE
IF THISFORM.WORD1.OPENDOCUMENT(THISFORM.CONTAINER2.TEXT3.VALUE)
THISFORM.WORD1.ACTIVATEDOCUMENT(THISFORM.CONTAINER2.TEXT3.VALUE)
THISFORM.WORD1.EDITDOCUMENT()
ENDIF
THISFORM.WORD1.CLOSEWORD()
ENDIF
ENDPROC
**
*
*  set_laporan2.scx::Cmdsimpan1
**
PROCEDURE Click
MKDLAP = THISFORM.TEXT5.VALUE
IF THISFORM.CONTAINER2.OPTIONGROUP1.VALUE=1
MFILE = ALLTRIM(THISFORM.CONTAINER1.TEXT2.VALUE)
MFILE = LEFT(MFILE, LEN(MFILE)-4)
MFILE1 = MFILE+'.FRX'
MFILE2 = MFILE+'.FRT'
NHANDLE = FOPEN(MFILE1)
IF NHANDLE>0
NSIZE = FSEEK(NHANDLE, 0, 2)
= FSEEK(NHANDLE, 0, 0)
HASIL = FREAD(NHANDLE, NSIZE)
ENDIF
FCLOSE(NHANDLE)
NHANDLE = FOPEN(MFILE2, 0)
IF NHANDLE>0
NSIZE = FSEEK(NHANDLE, 0, 2)
= FSEEK(NHANDLE, 0, 0)
HASIL2 = FREAD(NHANDLE, NSIZE)
ENDIF
FCLOSE(NHANDLE)
IF THISFORM.MODE="INPUT"
CSQL = "insert into set_print (nomor,template_id,dept,kel,nama_menu,penjelasan,opt_type,template1,template2) value "+"(?thisform.text7.value,?thisform.text4.value,?thisform.text5.value,?thisform.text6.value,"+"?thisform.text4.value,?thisform.text1.value,?thisform.container2.optiongroup1.Value, "+"?hasil,?hasil2)"
ELSE
CSQL = "update set_print set template1=?hasil, template2=?hasil2 "+"where template_id='"+THISFORM.TEMPLATE_ID+"' and tglinp=?thisform.tglinput"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update")
ENDIF
IF THISFORM.CONTAINER2.OPTIONGROUP2.VALUE<>2
ERASE &MFILE1
ERASE &MFILE2
ENDIF
THISFORM.RELEASE
ELSE
MFILE = ALLTRIM(THISFORM.CONTAINER2.TEXT3.VALUE)
NHANDLE = FOPEN(MFILE)
HASIL = ''
HASIL2 = ''
IF NHANDLE>0
NSIZE = FSEEK(NHANDLE, 0, 2)
= FSEEK(NHANDLE, 0, 0)
HASIL = FREAD(NHANDLE, NSIZE)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Error, file tidak bisa membuka")
ENDIF
MHASIL = CAST(HASIL AS W )
IF THISFORM.MODE="INPUT"
CSQL = "insert into set_print (nomor,template_id,dept,kel,nama_menu,penjelasan,opt_type,template1,template2) value "+"('"+STR(THISFORM.TEXT7.VALUE)+"','"+THISFORM.TEXT4.VALUE+"','"+THISFORM.TEXT5.VALUE+"','"+THISFORM.TEXT6.VALUE+"','"+THISFORM.TEXT4.VALUE+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.CONTAINER2.OPTIONGROUP1.VALUE)+"',?hasil,?hasil2)"
ELSE
CSQL = "update set_print set template1=?mhasil where template_id='"+THISFORM.TEMPLATE_ID+"' and tglinp=?thisform.tglinput"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update")
ENDIF
IF THISFORM.CONTAINER2.OPTIONGROUP2.VALUE<>2
ERASE &MFILE1
ENDIF
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  set_laporan2.scx::Text2
**
PROCEDURE LostFocus
IF LASTKEY()=27
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDPROC
**
*
*  set_laporan2.scx::Cmdedit1
**
FUNCTION Click
MFILE = THISFORM.CONTAINER1.TEXT2.VALUE
MEXT = SUBSTR(ALLTRIM(MFILE), RAT('.', MFILE)+1)
IF MEXT="FRX"
IF FILE(MFILE)
MODIFY REPORT (MFILE)
ENDIF
ERASE &MFILE 
ELSE
CTEMPLATE1 = CAST(TEMPLATE1 AS W )
NHANDLE = FCREATE(MFILE)
IF NHANDLE>0
FWRITE(NHANDLE, CTEMPLATE1)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Error, tidak bisa membuat file temporer!!")
ERASE &MFILE
THISFORM.RELEASE()
RETURN .F.
ENDIF
THISFORM.WORD1.OPENWORD()
LOCAL NSIZE
IF THISFORM.WORD1.OPENDOCUMENT(MFILE)
THISFORM.WORD1.ACTIVATEDOCUMENT(MFILE)
THISFORM.WORD1.SETWINDOWSTATE(1)
THISFORM.WORD1.EDITDOCUMENT()
THISFORM.WORD1.CLOSEDOCUMENT(MFILE)
ENDIF
THISFORM.WORD1.CLOSEWORD()
ERASE &MFILE
ENDIF
ENDFUNC
**
*
*  set_laporan2.scx::Cmdpreview2
**
FUNCTION Click
MTEMPLATE_ID = THISFORM.CONTAINER1.TEXT2.VALUE
IF OPT_TYPE=1
CTEMPLATE1 = CAST(TEMPLATE1 AS W )
MFILE1 = ALLTRIM(MTEMPLATE_ID)+".FRX"
NHANDLE = FCREATE(MFILE1)
IF NHANDLE>0
FWRITE(NHANDLE, CTEMPLATE1)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Tidak dapat membuat file dummy1")
RETURN .F.
ENDIF
MFILE2 = SYS(2023)+"\"+ALLTRIM(MTEMPLATE_ID)+".FRT"
CTEMPLATE2 = CAST(TEMPLATE2 AS W )
NHANDLE = FCREATE(MFILE2)
IF NHANDLE>0
FWRITE(NHANDLE, CTEMPLATE2)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Tidak dapat membuat file dummy2")
RETURN .F.
ENDIF
ELSE
CTEMPLATE1 = CAST(TEMPLATE1 AS W )
MFILE1 = ALLTRIM(MTEMPLATE_ID)
NHANDLE = FCREATE(MFILE1)
IF NHANDLE>0
FWRITE(NHANDLE, CTEMPLATE1)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Tidak dapat membuat file dummy3")
RETURN .F.
ENDIF
ENDIF
IF OPT_TYPE=1
REPORT FORM (MFILE1) PREVIEW
DELETE &MFILE1
DELETE &MFILE2
ELSE
THISFORM.WORD1.OPENWORD()
LOCAL NSIZE
IF THISFORM.WORD1.OPENDOCUMENT(MFILE1)
THISFORM.WORD1.ACTIVATEDOCUMENT(MFILE1)
CSQL = "select a.*,nama,b.tanggal as tglanggota,alamat,desa,kecamatan,kota,ibu,agama from pinjaman as a, anggota as b where a.cif=b.cif limit 1"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MNOREK = NOREK
FOR I = 1 TO FCOUNT()
A = FIELD(I)
DO CASE
CASE VARTYPE(&A)="D"
MVAR=DTOC(&A)
CASE VARTYPE(&A)="N"
MVAR=ALLTRIM(TRANSFORM(&A,'999,999,999,999'))
OTHERWISE
MVAR=&A
ENDCASE
KATA = "THISFORM.word1.findreplace('<<"+A+">>','"+ALLTRIM(MVAR)+"')"
&KATA
ENDFOR
KATA = "THISFORM.word1.findreplace('<<hari>>','"+TRANSFORM(DAY(TANGGAL), '99')+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<namahari>>','"+NAMAHARI(TANGGAL)+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<terbilang(pokok)>>','"+TERBILANG(POKOK)+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<terbilang(lama)>>','"+TERBILANG(LAMA)+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<terbilang(rate)>>','"+TERBILANG(RATE)+"')"
&KATA
CSQL = "select pokok as jdwpokok, jasa as jdwjasa from pinjaman_jadwal where norek='"+MNOREK+"' limit 1"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
KATA = "THISFORM.word1.findreplace('<<jdwpokok>>','"+ALLTRIM(TRANSFORM(JDWPOKOK, '999,999,999,999'))+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<jdwjasa>>','"+ALLTRIM(TRANSFORM(JDWJASA, '999,999,999,999'))+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<jdwpokok+jdwjasa>>','"+ALLTRIM(TRANSFORM(JDWPOKOK+JDWJASA, '999,999,999,999'))+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<terbilang(jdwpokok)>>','"+TERBILANG(JDWPOKOK)+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<terbilang(jdwjasa)>>','"+TERBILANG(JDWJASA)+"')"
&KATA
KATA = "THISFORM.word1.findreplace('<<terbilang(jdwpokok+jdwjasa)>>','"+TERBILANG(JDWPOKOK+JDWJASA)+"')"
&KATA
USE
SELECT (OLDSELECT)
THISFORM.WORD1.EDITDOCUMENT()
ENDIF
THISFORM.WORD1.CLOSEWORD()
DELETE &MFILE1
ENDIF
ENDFUNC
**
***
*** set_laporan2.sct
***
*
***
*** pros1.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
FUNCTION bacaTempWord
PARAMETER CTEKS
LOCAL I, J, NFIELDLEN, CFIELDNAME, NTEXTLEN
NTEXTLEN = LEN(CTEKS)
J = 0
NFIELDLEN = 0
FOR I = 1 TO NTEXTLEN
IF J=0
IF SUBSTR(CTEKS, I, 1)='['
J = I
NFIELDLEN = 1
ENDIF
ELSE
NFIELDLEN = NFIELDLEN+1
IF SUBSTR(CTEKS, I, 1)=']'
CFIELDNAME = SUBSTR(CTEKS, J+1, NFIELDLEN-2)
CFIELDVALUE = ALLTRIM(EVALUATE(CFIELDNAME))
CTEKS = STUFF(CTEKS, J, NFIELDLEN, CFIELDVALUE)
J = 0
NFIELDLEN = 0
ENDIF
ENDIF
ENDFOR
RETURN CTEKS
ENDFUNC
**
FUNCTION cetaktemp
PARAMETER MTEMPLATE_ID, MNAMA_MENU, MKEY
MNOREK = MKEY
OLDSELECT1 = SELECT()
CSQL = "select * from set_print where template_id='"+MTEMPLATE_ID+"' and nama_menu='"+MNAMA_MENU+"' and dept<>''"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
CTEMPLATE1 = CAST(TEMPLATE1 AS W )
MDEPT = DEPT
MKEL = KEL
MTEMPLATE_ID = TEMPLATE_ID
MOPT_TYPE = OPT_TYPE
MFILE0 = ''
IF OPT_TYPE=1
MFILE1 = SYS(2023)+"\"+ALLTRIM(MTEMPLATE_ID)+".FRX"
ELSE
MFILE1 = SYS(2023)+"\"+ALLTRIM(MTEMPLATE_ID)+".DOC"
ENDIF
NHANDLE = FCREATE(MFILE1)
IF NHANDLE>0
FWRITE(NHANDLE, CTEMPLATE1)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Tidak dapat membuat file dummy")
RETURN .F.
ENDIF
IF MOPT_TYPE=1
CTEMPLATE2 = CAST(TEMPLATE2 AS W )
MFILE0 = SYS(2023)+"\"+ALLTRIM(MTEMPLATE_ID)+".FRT"
NHANDLE = FCREATE(MFILE0)
IF NHANDLE>0
FWRITE(NHANDLE, CTEMPLATE2)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Tidak dapat membuat file dummy")
RETURN .F.
ENDIF
REPORT FORM (MFILE1) PREVIEW
ENDIF
USE
IF MOPT_TYPE=2
NHANDLE = FCREATE(MFILE1)
IF NHANDLE>0
FWRITE(NHANDLE, CTEMPLATE1)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("Tidak dapat membuat file dummy")
RETURN .F.
ENDIF
WORD1 = NEWOBJECT('word')
WORD1.OPENWORD()
WORD1.OPENDOCUMENT(MFILE1)
WORD1.ACTIVATEDOCUMENT(MFILE1)
DO CASE
CASE MDEPT="KRD" .OR. MDEPT="PIN"
OLDSELECT = SELECT()
CSQL = "select a.*,nama,tanggallhr,tempatlhr,alamat,desa,kecamatan,kota,pekerjaan,ibu,agama from pinjaman as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
FOR I = 1 TO FCOUNT()
A = FIELD(I)
DO CASE
CASE VARTYPE(&A)="D"
MVAR=DTOC(&A)
CASE VARTYPE(&A)="N"
MVAR=ALLTRIM(TRANSFORM(&A,'999,999,999,999'))
OTHERWISE
MVAR=&A
ENDCASE
KATA = "word1.findreplace('<<"+A+">>','"+ALLTRIM(MVAR)+"')"
&KATA
ENDFOR
KATA = "word1.findreplace('<<defapimpinan>>','"+ALLTRIM(DEFAPIMPINAN)+"')"
&KATA
KATA = "word1.findreplace('<<hari>>','"+TRANSFORM(DAY(TANGGAL), '99')+"')"
&KATA
KATA = "word1.findreplace('<<namahari>>','"+NAMAHARI(TANGGAL)+"')"
&KATA
KATA = "word1.findreplace('<<uraitgl(tanggal)>>','"+URAITGL(TANGGAL)+"')"
&KATA
KATA = "word1.findreplace('<<uraitgl(tgljtempo)>>','"+URAITGL(TGLJTEMPO)+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(pokok)>>','"+TERBILANG(POKOK)+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(lama)>>','"+TERBILANG(LAMA)+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(rate)>>','"+TERBILANG(RATE)+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(adm)>>','"+TERBILANG(ADM)+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(provisi)>>','"+TERBILANG(PROVISI)+"')"
&KATA
CSQL = "select pokok as jdwpokok, jasa as jdwjasa from pinjaman_jadwal where norek='"+MNOREK+"' limit 1"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
KATA = "word1.findreplace('<<jdwpokok>>','"+ALLTRIM(TRANSFORM(JDWPOKOK, '999,999,999,999'))+"')"
&KATA
KATA = "word1.findreplace('<<jdwjasa>>','"+ALLTRIM(TRANSFORM(JDWJASA, '999,999,999,999'))+"')"
&KATA
KATA = "word1.findreplace('<<jdwpokok+jdwjasa>>','"+ALLTRIM(TRANSFORM(JDWPOKOK+JDWJASA, '999,999,999,999'))+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(jdwpokok)>>','"+TERBILANG(JDWPOKOK)+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(jdwjasa)>>','"+TERBILANG(JDWJASA)+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(jdwpokok+jdwjasa)>>','"+TERBILANG(JDWPOKOK+JDWJASA)+"')"
&KATA
CSQL = "select * from pinjaman_jaminan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "JMN")
IF NOREK=MNOREK
DO WHILE  .NOT. EOF()
MNOBERKAS = NOBERKAS
DO CASE
CASE JENIS="KENDARAAN"
CSQL = "select * from pinjaman_jaminan_bpkb where noberkas='"+MNOBERKAS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
KATA = "word1.findreplace('<<BPKB.MERK>>','"+ALLTRIM(MERK)+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.TYPE>>','"+ALLTRIM(TYPE)+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.TAHUN>>','"+ALLTRIM(TAHUN)+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.NOMESIN>>','"+ALLTRIM(NOMESIN)+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.NORANGKA>>','"+ALLTRIM(NORANGKA)+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.NOBPKB>>','"+ALLTRIM(NOBPKB)+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.NOPOLISI>>','"+TRANSFORM(NOPOLISI, '@R !!-!!!!-!!!!')+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.WARNA>>','"+ALLTRIM(WARNA)+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.NAMA>>','"+ALLTRIM(ATASNAMA)+"')"
&KATA 
KATA = "word1.findreplace('<<BPKB.ALAMAT>>','"+ALLTRIM(ALAMAT)+"')"
&KATA 
CASE JENIS="SERTIFIKAT"
CSQL = "select * from pinjaman_jaminan_sertifikat where noberkas='"+MNOBERKAS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
KATA = "word1.findreplace('<<SERTIFIKAT.STATUS>>','"+ALLTRIM(STATUS)+"')"
&KATA 
KATA = "word1.findreplace('<<SERTIFIKAT.NOSERTIFIKAT>>','"+ALLTRIM(NOSERTIFIKAT)+"')"
&KATA 
KATA = "word1.findreplace('<<SERTIFIKAT.TGLSERTIFIKAT>>','"+DTOC(TGLSERTIFIKAT)+"')"
&KATA 
KATA = "word1.findreplace('<<SERTIFIKAT.NOSURATUKUR>>','"+ALLTRIM(NOSURATUKUR)+"')"
&KATA 
KATA = "word1.findreplace('<<SERTIFIKAT.TGLSURATUKUR>>','"+DTOC(TGLSURATUKUR)+"')"
&KATA 
KATA = "word1.findreplace('<<SERTIFIKAT.LUAS>>','"+ALLTRIM(TRANSFORM(LUAS, '999,999,999,999'))+"')"
&KATA 
KATA = "word1.findreplace('<<SERTIFIKAT.NAMA>>','"+ALLTRIM(NAMA)+"')"
&KATA 
KATA = "word1.findreplace('<<SERTIFIKAT.ALAMAT>','"+ALLTRIM(ALAMAT)+"')"
&KATA 
CASE JENIS="SIMPANAN"
CSQL = "select * from pinjaman_jaminan_simpanan where noberkas='"+MNOBERKAS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
CASE JENIS="LAIN"
CSQL = "select * from pinjaman_jaminan_lain where noberkas='"+MNOBERKAS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
ENDCASE
SELECT JMN
SKIP
ENDDO
USE
ENDIF
SELECT SMT
USE
SELECT (OLDSELECT)
CASE MDEPT="SIM"
OLDSELECT = SELECT()
CSQL = "select a.*,nama,b.tanggal as tglanggota,alamat,desa,kecamatan,kota,ibu,agama from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MKEY+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
FOR I = 1 TO FCOUNT()
A = FIELD(I)
DO CASE
CASE VARTYPE(&A)="D"
MVAR=DTOC(&A)
CASE VARTYPE(&A)="N"
MVAR=ALLTRIM(TRANSFORM(&A,'999,999,999,999'))
OTHERWISE
MVAR=IIF(ISNULL(&A),'',&A)
ENDCASE
KATA = "word1.findreplace('<<"+A+">>','"+MVAR+"')"
&KATA
ENDFOR
KATA = "word1.findreplace('<<defapimpinan>>','"+ALLTRIM(DEFAPIMPINAN)+"')"
&KATA
KATA = "word1.findreplace('<<terbilang(pokok)>>','"+TERBILANG(POKOK)+" Rupiah"+"')"
&KATA
KATA = "word1.findreplace('<<uraitgl(tanggal)>>','"+URAITGL(TANGGAL)+"')"
&KATA
KATA = "word1.findreplace('<<defakota>>','"+ALLTRIM(DEFAKOTA)+"')"
&KATA
MNOREK = NOREK
USE
CSQL = "select * from simpanan_bilyet where norek=?mnorek"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
FOR I = 1 TO FCOUNT()
A = FIELD(I)
DO CASE
CASE VARTYPE(&A)="D"
MVAR=DTOC(&A)
CASE VARTYPE(&A)="N"
MVAR=ALLTRIM(TRANSFORM(&A,'999,999,999,999'))
OTHERWISE
MVAR=IIF(ISNULL(&A),'',&A)
ENDCASE
KATA = "word1.findreplace('<<"+A+">>','"+MVAR+"')"
&KATA
ENDFOR
USE
SELECT (OLDSELECT)
CASE MDEPT="JMN"
CASE MDEPT="AGT"
OLDSELECT = SELECT()
CSQL = "select * from anggota where cif='"+MKEY+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
FOR I = 1 TO FCOUNT()
A = FIELD(I)
DO CASE
CASE VARTYPE(&A)="D"
MVAR=DTOC(&A)
CASE VARTYPE(&A)="N"
MVAR=ALLTRIM(TRANSFORM(&A,'999,999,999,999'))
OTHERWISE
MVAR=&A
ENDCASE
KATA = "word1.findreplace('<<"+A+">>','"+MVAR+"')"
&KATA
ENDFOR
USE
SELECT (OLDSELECT)
CASE MDEPT="KAS"
OLDSELECT = SELECT()
CSQL = "select * from kasir where tanggal='"+MKEY+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
FOR I = 1 TO FCOUNT()
A = FIELD(I)
DO CASE
CASE VARTYPE(&A)="D"
MVAR=DTOC(&A)
CASE VARTYPE(&A)="N"
MVAR=ALLTRIM(TRANSFORM(&A,'999,999,999,999'))
OTHERWISE
MVAR=&A
ENDCASE
KATA = "word1.findreplace('<<"+A+">>','"+MVAR+"')"
&KATA
ENDFOR
USE
SELECT (OLDSELECT)
CASE MDEPT="ANG"
CASE MDEPT="JDW"
ENDCASE
WORD1.SETWINDOWSTATE(1)
WORD1.EDITDOCUMENT()
WORD1.SAVEASDOCUMENT(MFILE1)
IF  .NOT. DEFAUSERID="IMR"
WORD1.PRINTDOCUMENT()
WORD1.CLOSEDOCUMENT(MFILE1)
WORD1.CLOSEWORD()
ENDIF
ELSE
DO CASE
CASE MDEPT="KRD" .OR. MDEPT="PIN"
OLDSELECT = SELECT()
CSQL = "select * from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PINJAMAN")
MCIF = CIF
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "ANGGOTA")
CSQL = "select * from pinjaman_jadwal where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "JADWAL")
CSQL = "select * from pinjaman_mutasi where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "ANGSUR")
IF DEFAUSERID="IMR"
REPORT FORM (MFILE1) PREVIEW
ELSE
REPORT FORM (MFILE1) TO PRINTER
ENDIF
SELECT PINJAMAN
USE
SELECT ANGGOTA
USE
SELECT JADWAL
USE
SELECT ANGSUR
USE
SELECT (OLDSELECT)
CASE MDEPT="SIM"
CASE MDEPT="JMN"
CASE MDEPT="AGT"
CASE MDEPT="KAS"
CASE MDEPT="ANG"
CASE MDEPT="JDW"
ENDCASE
ENDIF
IF MOPT_TYPE=1
DELETE FILE (MFILE0)
ENDIF
SELECT (OLDSELECT1)
ENDFUNC
**
FUNCTION noanggnext
LOCAL OLDSELECT, NOAKHIR, MTAHUN, MNOANGG, MNOMOR
OLDSELECT = SELECT()
MCARA = "1"
DO CASE
CASE MCARA='1'
CSQL = "select MAX(cif) as nomer from anggota"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
RETURN ''
ENDIF
NOAKHIR = NOMER
USE
SELECT (OLDSELECT)
MNOANGG = VAL(ALLTRIM(NOAKHIR))
PANJANG = LEN(ALLTRIM(NOAKHIR))
MNOANGG = MNOANGG+1
MNOMOR = RIGHT('0000000000000'+ALLTRIM(STR(MNOANGG)), PANJANG)
MNOANGG = MNOMOR
CASE MCARA='2'
CSQL = "select MAX(cif) as nomer from anggota"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
RETURN ''
ENDIF
NOAKHIR = NOMER
USE
SELECT (OLDSELECT)
MTAHUN = LEFT(NOAKHIR, 2)
IF MTAHUN<>RIGHT(ALLTRIM(STR(YEAR(DATE()))), 2)
MNOANGG = RIGHT(ALLTRIM(STR(YEAR(DATE()))), 2)+".0000001"
ELSE
MNOANGG = VAL(SUBSTR(NOAKHIR, 4, 7))
PANJANG = LEN(ALLTRIM(NOAKHIR))-3
MNOANGG = MNOANGG+1
MNOMOR = RIGHT('0000000000000'+ALLTRIM(STR(MNOANGG)), PANJANG)
MNOANGG = MTAHUN+"."+MNOMOR
ENDIF
CASE MCARA='3'
ENDCASE
RETURN MNOANGG
ENDFUNC
**
PROCEDURE setperkiraan
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** vfxoffce.vcx
***
*
*
*  vfxoffce.vcx::excel
**
PROCEDURE activatesheet
LPARAMETERS TCWB, TCSHEET
THIS.OEXCEL.WORKBOOKS(TCWB).WORKSHEETS(TCSHEET).ACTIVATE()
ENDPROC
**
PROCEDURE closeexcel
IF ( .NOT. ISNULL(THIS.OEXCEL))
WAIT WINDOW NOWAIT "Closing Excel. Please wait..."
THIS.OEXCEL.QUIT()
THIS.OEXCEL = .NULL.
WAIT CLEAR
ENDIF
ENDPROC
**
PROCEDURE closeworkbook
LPARAMETERS TCWB
WITH THIS.OEXCEL
.WORKBOOKS(TCWB).CLOSE()
ENDWITH
ENDPROC
**
FUNCTION copysheet
LPARAMETERS TCSOURCEWB, TCSOURCESHEET, TCTARGETWB
WITH THIS.OEXCEL
IF ( .NOT. EMPTY(TCTARGETWB))
.SHEETS(TCSOURCESHEET).COPY(.WORKBOOKS(TCTARGETWB).SHEETS(1))
ELSE
.SHEETS(TCSOURCESHEET).SELECT
.SHEETS(TCSOURCESHEET).COPY
TCTARGETWB = .ACTIVEWORKBOOK.FULLNAME
ENDIF
ENDWITH
RETURN THIS.SHEETNAME(TCTARGETWB)
ENDFUNC
**
FUNCTION getvalue
LPARAMETERS TCRANGE
LOCAL LCRETVAL
WITH THIS.OEXCEL
LCRETVAL = .ACTIVESHEET.RANGE(TCRANGE).VALUE
ENDWITH
RETURN LCRETVAL
ENDFUNC
**
PROCEDURE lockcells
LPARAMETERS TCWB, TCSHEET, TCRANGE, TCPWD, TLLOCK
WITH THIS.OEXCEL
IF (EMPTY(TCWB))
TCWB = THIS.WORKBOOKNAME()
ENDIF
IF (EMPTY(TCSHEET))
TCSHEET = THIS.SHEETNAME(TCWB)
ENDIF
.WORKBOOKS(TCWB).WORKSHEETS(TCSHEET).RANGE(TCRANGE).LOCKED = TLLOCK
ENDWITH
ENDPROC
**
FUNCTION openexcel
LPARAMETERS TLFORCENEWINSTANCE, TLVISIBLE, TNWINDOWSTATE
LOCAL LLRETVAL, LCERROR, LLGETOBJECTFAILED
WAIT WINDOW NOWAIT "Opening Excel. Please wait..."
IF  .NOT. TLFORCENEWINSTANCE
LCERROR = ON("error")
LLGETOBJECTFAILED = .F.
ON ERROR LLGETOBJECTFAILED=.t.
THIS.OEXCEL = GETOBJECT( , "Excel.Application.8")
ON ERROR &LCERROR
ENDIF
IF LLGETOBJECTFAILED .OR. TLFORCENEWINSTANCE
THIS.OEXCEL = CREATEOBJECT("Excel.Application.8")
ENDIF
IF (TYPE("this.oExcel")="O" .AND.  .NOT. ISNULL(THIS.OEXCEL))
IF (TLVISIBLE)
THIS.OEXCEL.VISIBLE = .T.
IF ( .NOT. EMPTY(TNWINDOWSTATE))
ENDIF
ENDIF
LLRETVAL = .T.
ELSE
= MESSAGEBOX("NIS Export", 16, "Unable to start Excel. NIS Export failed")
LLRETVAL = .F.
ENDIF
WAIT CLEAR
RETURN LLRETVAL
ENDFUNC
**
PROCEDURE openworkbook
LPARAMETERS TCWB
WITH THIS.OEXCEL
.WORKBOOKS.OPEN(TCWB)
ENDWITH
ENDPROC
**
PROCEDURE protectsheet
LPARAMETERS TCWB, TCSHEET, TCPWD
WITH THIS.OEXCEL
IF (EMPTY(TCWB))
TCWB = THIS.WORKBOOKNAME()
ENDIF
IF (EMPTY(TCSHEET))
TCSHEET = THIS.SHEETNAME()
ENDIF
.WORKBOOKS(TCWB).WORKSHEETS(TCSHEET).PROTECT(TCPWD, .T., .T., .T.)
ENDWITH
ENDPROC
**
PROCEDURE release
RELEASE THIS
ENDPROC
**
PROCEDURE saveasworkbook
LPARAMETERS TCWB, TCSHEET, TCFILENAME, TCFILEFORMAT
IF (EMPTY(TCFILEFORMAT))
TCFILEFORMAT = "NORMAL"
ENDIF
TCFILEFORMAT = UPPER(TCFILEFORMAT)
WITH THIS.OEXCEL
.WORKBOOKS(TCWB).WORKSHEETS(TCSHEET).ACTIVATE()
DO CASE
CASE TCFILEFORMAT=="EXCEL4"
.WORKBOOKS(TCWB).SAVEAS(TCFILENAME, 33)
CASE TCFILEFORMAT=="EXCEL5"
.WORKBOOKS(TCWB).SAVEAS(TCFILENAME, 39)
CASE TCFILEFORMAT=="NORMAL"
.WORKBOOKS(TCWB).SAVEAS(TCFILENAME, -4143)
CASE TCFILEFORMAT=="TEXT"
.WORKBOOKS(TCWB).SAVEAS(TCFILENAME, 0)
CASE TCFILEFORMAT=="WK1"
.WORKBOOKS(TCWB).SAVEAS(TCFILENAME, 5)
CASE TCFILEFORMAT=="WK3"
.WORKBOOKS(TCWB).SAVEAS(TCFILENAME, 15)
CASE TCFILEFORMAT=="WK4"
.WORKBOOKS(TCWB).SAVEAS(TCFILENAME, 38)
CASE TCFILEFORMAT=="CSV"
.WORKBOOKS(TCWB).SAVEAS(TCFILENAME, 6)
ENDCASE
ENDWITH
ENDPROC
**
PROCEDURE setvalue
LPARAMETERS TCRANGE, TCVALUE, TLLOCK
WITH THIS.OEXCEL
.ACTIVESHEET.RANGE(TCRANGE).VALUE = TCVALUE
.ACTIVESHEET.RANGE(TCRANGE).LOCKED = TLLOCK
ENDWITH
ENDPROC
**
FUNCTION sheetname
LPARAMETERS TCWORKBOOKNAME
LOCAL LCSHEETNAME
LCSHEETNAME = ""
IF (EMPTY(TCWORKBOOKNAME))
TCWORKBOOKNAME = THIS.WORKBOOKNAME()
ENDIF
IF ( .NOT. EMPTY(TCWORKBOOKNAME))
WITH THIS.OEXCEL
LCSHEETNAME = .WORKBOOKS(TCWORKBOOKNAME).ACTIVESHEET.NAME
ENDWITH
ENDIF
RETURN LCSHEETNAME
ENDFUNC
**
PROCEDURE unprotectsheet
LPARAMETERS TCWB, TCSHEET, TCPASSWORD
WITH THIS.OEXCEL
.WORKBOOKS(TCWB).WORKSHEETS(TCSHEET).UNPROTECT(TCPASSWORD)
ENDWITH
ENDPROC
**
FUNCTION workbookname
LOCAL LCWORKBOOKNAME
LCWORKBOOKNAME = ""
WITH THIS.OEXCEL
IF (.WORKBOOKS.COUNT>0)
LCWORKBOOKNAME = .ACTIVEWORKBOOK.FULLNAME
ELSE
LCWORKBOOKNAME = ""
ENDIF
ENDWITH
RETURN LCWORKBOOKNAME
ENDFUNC
**
PROCEDURE setwindowstate
LPARAMETERS TNWINDOWSTATE
THIS.OEXCEL.WINDOWSTATE = TNWINDOWSTATE
ENDPROC
**
FUNCTION addworkbook
LOCAL LCWORKBOOKNAME
WITH THIS.OEXCEL
.WORKBOOKS.ADD()
LCWORKBOOKNAME = .ACTIVEWORKBOOK.FULLNAME
ENDWITH
RETURN LCWORKBOOKNAME
ENDFUNC
**
PROCEDURE setcolorpattern
LPARAMETERS TCRANGE, TNCOLINDEX, TNPATTERN, TNPATTERNCOLINDEX
WITH THIS.OEXCEL
.ACTIVESHEET.RANGE(TCRANGE).INTERIOR.COLORINDEX = TNCOLINDEX
.ACTIVESHEET.RANGE(TCRANGE).INTERIOR.PATTERN = TNPATTERN
.ACTIVESHEET.RANGE(TCRANGE).INTERIOR.PATTERNCOLORINDEX = TNPATTERNCOLINDEX
ENDWITH
ENDPROC
**
PROCEDURE passthrough
LPARAMETERS TCCOMMAND
WITH THIS.OEXCEL
&TCCOMMAND
ENDWITH
ENDPROC
**
PROCEDURE setformula
LPARAMETERS TCRANGE, TCFORMULA
WITH THIS.OEXCEL
IF (LEFT(TCFORMULA, 1)="=")
.ACTIVESHEET.RANGE(TCRANGE).FORMULA = TCFORMULA
ELSE
= MESSAGEBOX("Formula must begin with '='", 64, "Excel")
ENDIF
ENDWITH
ENDPROC
**
PROCEDURE autofill
LPARAMETERS TCSOURCERANGE, TCTARGETRANGE
LOCAL LCCOMMAND
LCCOMMAND = 'Set sourceRange = .ActiveSheet.Range("'+TCSOURCERANGE+'") : '+'Set fillRange = .ActiveSheet.Range("'+TCTARGETRANGE+'") : '+'sourceRange.AutoFill Destination:=fillRange'
THIS.PASSTHROUGH(LCCOMMAND)
ENDPROC
**
FUNCTION getrow
LPARAMETERS TCREF
LOCAL LNSTART, LCROW
LCROW = ""
LNSTART = 1
DO WHILE (LNSTART<=LEN(TCREF) .AND.  .NOT. ISDIGIT(SUBSTR(TCREF, LNSTART)))
LNSTART = LNSTART+1
ENDDO
IF (ISDIGIT(SUBSTR(TCREF, LNSTART)))
LCROW = SUBSTR(TCREF, LNSTART)
ENDIF
RETURN LCROW
ENDFUNC
**
PROCEDURE border
LPARAMETERS TCRANGE, TNLINESTYLE, TNWEIGHT, TNCOLORINDEX
WITH THIS.OEXCEL
.ACTIVESHEET.RANGE(TCRANGE).SELECT
LOCAL LNLINE
FOR LNLINE = THIS.XLEDGELEFT TO THIS.XLINSIDEHORIZONTAL
.ACTIVESHEET.RANGE(TCRANGE).BORDERS(LNLINE).LINESTYLE = TNLINESTYLE
.ACTIVESHEET.RANGE(TCRANGE).BORDERS(LNLINE).WEIGHT = TNWEIGHT
.ACTIVESHEET.RANGE(TCRANGE).BORDERS(LNLINE).COLORINDEX = TNCOLORINDEX
ENDFOR
ENDWITH
ENDPROC
**
*
*  vfxoffce.vcx::word
**
PROCEDURE readbookmarks
LOCAL LNCOUNTMARKS, LNI
LNCOUNTMARKS = THIS.OWORD.ACTIVEDOCUMENT.BOOKMARKS.COUNT
DIMENSION THIS.ABOOKMARKS[LNCOUNTMARKS]
FOR LNI = 1 TO LNCOUNTMARKS
THIS.ABOOKMARKS[LNI] = THIS.OWORD.ACTIVEDOCUMENT.BOOKMARKS(LNI).NAME
ENDFOR
ENDPROC
**
FUNCTION opendocument
LPARAMETERS LCDOCUMENTTOOPEN
LCDOCUMENTTOOPEN = ALLTRIM(LCDOCUMENTTOOPEN)
IF TYPE("this.oWord.Name")="U"
= MESSAGEBOX("Word tidak ada / active", 0064, _SCREEN.CAPTION)
RETURN .F.
ENDIF
LOCAL LCERROR, LLOPENOK
LCERROR = ON("error")
LLOPENOK = .T.
ON ERROR LLOPENOK=.f.
THIS.OWORD.DOCUMENTS.OPEN(LCDOCUMENTTOOPEN)
ON ERROR &LCERROR
THIS.LOPENDOCUMENT_OK = LLOPENOK
IF  .NOT. THIS.LOPENDOCUMENT_OK
= MESSAGEBOX("Can't open Document "+LCDOCUMENTTOOPEN+".", 0064, _SCREEN.CAPTION)
RETURN .F.
ELSE
RETURN .T.
ENDIF
ENDFUNC
**
FUNCTION closedocument
LPARAMETERS LCDOCUMENTTOCLOSE
LOCAL LNPARAMETERS
LNPARAMETERS = PARAMETERS()
IF  .NOT. THIS.CHECKWORD(.F.)
RETURN .F.
ENDIF
LCDOCUMENTTOCLOSE = IIF(LNPARAMETERS<1, THIS.OWORD.ACTIVEDOCUMENT.NAME, ALLTRIM(LCDOCUMENTTOCLOSE))
IF TYPE("this.oWord.Documents(lcDocumenttoClose)")="O"
WAIT WINDOW NOWAIT "Closing document "+LCDOCUMENTTOCLOSE+". Please wait..."
IF THIS.NSAVECHANGES=-2
THIS.ACTIVATEDOCUMENT(LCDOCUMENTTOCLOSE)
THIS.OWORD.ACTIVATE
THIS.OWORD.ACTIVEDOCUMENT.CLOSE(THIS.NSAVECHANGES)
ELSE
THIS.OWORD.DOCUMENTS(LCDOCUMENTTOCLOSE).CLOSE(THIS.NSAVECHANGES)
ENDIF
WAIT CLEAR
ENDIF
ENDFUNC
**
PROCEDURE setwindowstate
LPARAMETERS LPN1
LPN1 = IIF(PARAMETERS()<1, 2, LPN1)
IF TYPE("this.oWord.Name")<>"U"
THIS.OWORD.WINDOWSTATE = LPN1
ENDIF
ENDPROC
**
PROCEDURE editdocument
WITH THIS.OWORD
.VISIBLE = .T.
.WINDOWSTATE = 1
.ACTIVATE()
THIS.SETWINDOWSTATE()
ENDWITH
ENDPROC
**
FUNCTION closeword
IF TYPE("this.oWord.Name")="U"
RETURN .F.
ENDIF
THIS.OWORD.QUIT()
ENDFUNC
**
FUNCTION saveasdocument
LPARAMETERS LCSAVEAS
IF PARAMETERS()<1
LCSAVEAS = SYS(2015)
ENDIF
THIS.OWORD.WORDBASIC.FILESAVEAS(LCSAVEAS)
RETURN (LCSAVEAS)
ENDFUNC
**
PROCEDURE inserttext
LPARAMETERS LCTEXT
THIS.OWORD.SELECTION.TEXT = LCTEXT
ENDPROC
**
PROCEDURE gotobookmark
LPARAMETERS LCBOOKMARK
THIS.OWORD.SELECTION.GOTO(-1,  ,  , LCBOOKMARK)
ENDPROC
**
FUNCTION printdocument
IF  .NOT. THIS.CHECKWORD(.T.)
RETURN .F.
ENDIF
THIS.OWORD.WORDBASIC.FILEPRINT(1)
ENDFUNC
**
PROCEDURE gotopofdocument
THIS.OWORD.SELECTION.HOMEKEY(6)
ENDPROC
**
PROCEDURE tab
THIS.OWORD.SELECTION.MOVERIGHT(12)
ENDPROC
**
PROCEDURE insertsymbol
LPARAMETERS LNSYMBOL, LCFONT, LLUNICODE
DO CASE
CASE PARAMETERS()=1
CASE PARAMETERS()=2
CASE PARAMETERS()=3
ENDCASE
ENDPROC
**
PROCEDURE insertformtext
LPARAMETERS LCNAME, LCTEXT
THIS.OWORD.ACTIVEDOCUMENT.FORMFIELDS(LCNAME).RESULT = LCTEXT
ENDPROC
**
FUNCTION closealldocuments
IF  .NOT. THIS.CHECKWORD(.F.)
RETURN .F.
ENDIF
THIS.OWORD.DOCUMENTS.CLOSE(THIS.NSAVECHANGES)
ENDFUNC
**
FUNCTION printalldocuments
IF  .NOT. THIS.CHECKWORD(.T.)
RETURN .F.
ENDIF
LOCAL LNI
WITH THIS
FOR LNI = 1 TO .OWORD.DOCUMENTS.COUNT
.ACTIVATEDOCUMENT(.OWORD.DOCUMENT(LNI).NAME)
.PRINTDOCUMENT()
ENDFOR
.ACTIVATEDOCUMENT(.OWORD.DOCUMENT(1).NAME)
ENDWITH
ENDFUNC
**
FUNCTION closemydocuments
IF  .NOT. THIS.CHECKWORD(.F.)
RETURN .F.
ENDIF
LOCAL LNI, LCDOCUMENTTOCLOSE
WITH THIS
LNI = 1
LCDOCUMENTTOCLOSE = GETARG(.COPENDOCUMENTS, LNI)
DO WHILE  .NOT. EMPTY(LCDOCUMENTTOCLOSE)
.CLOSEDOCUMENT(LCDOCUMENTTOCLOSE)
LNI = LNI+1
LCDOCUMENTTOCLOSE = GETARG(.COPENDOCUMENTS, LNI)
ENDDO
ENDWITH
ENDFUNC
**
FUNCTION printmydocuments
IF  .NOT. THIS.CHECKWORD(.T.)
RETURN .F.
ENDIF
LOCAL LNI, LCDOCUMENTTOPRINT
WITH THIS
LNI = 1
LCDOCUMENTTOPRINT = GETARG(.COPENDOCUMENTS, LNI)
DO WHILE  .NOT. EMPTY(LCDOCUMENTTOPRINT)
.ACTIVATEDOCUMENT(LCDOCUMENTTOPRINT)
.PRINTDOCUMENT()
LNI = LNI+1
LCDOCUMENTTOPRINT = GETARG(.COPENDOCUMENTS, LNI)
ENDDO
.ACTIVATEDOCUMENT(GETARG(.COPENDOCUMENTS, 1))
ENDWITH
ENDFUNC
**
FUNCTION checkword
LPARAMETERS GETMESSAGE
IF TYPE("this.oWord.Name")<>"U" .AND. THIS.OWORD.DOCUMENTS.COUNT>0
RETURN .T.
ELSE
IF GETMESSAGE
= MESSAGEBOX("Word is no longer aktiv or no document is open!", 0064, _SCREEN.CAPTION)
ENDIF
RETURN .F.
ENDIF
ENDFUNC
**
PROCEDURE openasdocument
LPARAMETERS LCDOCUMENTTOOPEN
LCDOCUMENTTOOPEN = ALLTRIM(LCDOCUMENTTOOPEN)
LOCAL LCERROR, LLOPENOK
LCERROR = ON("error")
LLOPENOK = .T.
ON ERROR LLOPENOK=.f.
THIS.OWORD.DOCUMENTS.OPENASDOCUMENT(LCDOCUMENTTOOPEN)
ON ERROR &LCERROR
THIS.LOPENDOCUMENT_OK = LLOPENOK
IF  .NOT. THIS.LOPENDOCUMENT_OK
= MESSAGEBOX("Can't open Document "+LCDOCUMENTTOOPEN+".", 0064, _SCREEN.CAPTION)
ENDIF
ENDPROC
**
PROCEDURE adddocument
LPARAMETERS LCTEMPLATE
LCTEMPLATE = ALLTRIM(LCTEMPLATE)
LOCAL LCERROR, LLOPENOK
LCERROR = ON("error")
LLOPENOK = .T.
ON ERROR LLOPENOK=.f.
THIS.OWORD.DOCUMENTS.ADD(LCTEMPLATE)
ON ERROR &LCERROR
THIS.LOPENDOCUMENT_OK = LLOPENOK
IF  .NOT. THIS.LOPENDOCUMENT_OK
= MESSAGEBOX("Can't add new Document from template "+LCTEMPLATE+".", 0064, _SCREEN.CAPTION)
ENDIF
ENDPROC
**
PROCEDURE activatedocument
LPARAMETERS LCDOCUMENTTOACTIVATE
LCDOCUMENTTOAVTIVATE = ALLTRIM(LCDOCUMENTTOACTIVATE)
THIS.OWORD.DOCUMENTS(LCDOCUMENTTOACTIVATE).ACTIVATE()
ENDPROC
**
PROCEDURE insertautotext
LPARAMETERS LCAUTOTEXT
THIS.OWORD.ACTIVEDOCUMENT.ATTACHEDTEMPLATE.AUTOTEXTENTRIES(LCAUTOTEXT).INSERT(THIS.OWORD.SELECTION.RANGE, .T.)
ENDPROC
**
PROCEDURE deleteselection
LPARAMETERS TNUNIT, TNCOUNT
IF EMPTY(TNUNIT)
TNUNIT = 1
ENDIF
IF EMPTY(TNCOUNT)
TNCOUNT = 1
ENDIF
THIS.OWORD.SELECTION.DELETE(TNUNIT, TNCOUNT)
ENDPROC
**
FUNCTION printpreview
IF  .NOT. THIS.CHECKWORD(.T.)
RETURN .F.
ENDIF
THIS.OWORD.WORDBASIC.FILEPREVIEW(1)
ENDFUNC
**
PROCEDURE openword
LPARAMETERS LLFORCENEWINSTANCE
LOCAL LCERROR, LLGETOBJECTFAILED
IF  .NOT. LLFORCENEWINSTANCE
LCERROR = ON("error")
LLGETOBJECTFAILED = .F.
ON ERROR LLGETOBJECTFAILED=.t.
THIS.OWORD = GETOBJECT( , "Word.Application.8")
ON ERROR &LCERROR
ENDIF
IF LLGETOBJECTFAILED .OR. LLFORCENEWINSTANCE
THIS.OWORD = CREATEOBJECT("Word.Application.8")
ENDIF
ENDPROC
**
PROCEDURE findreplace
LPARAMETERS LCTEXT, LCREPLACE
THIS.OWORD.SELECTION.HOMEKEY(6)
THIS.OWORD.SELECTION.FIND.EXECUTE(LCTEXT,  ,  ,  ,  ,  ,  ,  ,  , LCREPLACE, 2)
ENDPROC
**
FUNCTION findmacro
LCTEXT1 = '<<'
LCTEXT2 = '>>'
THIS.OWORD.SELECTION.HOMEKEY(6)
AA = ''
DO WHILE EOF()
SKIP
ENDDO
RETURN THIS.OWORD.SELECTION.RESULT
ENDFUNC
**
***
*** vfxoffce.vct
***
*
***
*** pros_krd.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
PROCEDURE PinjMenuHit
PARAMETER MMENUKE
HIDE POPUP MENUHITPINJ
IF EMPTY(MNOREK)
RETURN
ENDIF
DO CASE
CASE MMENUKE=1
DO FORM pinjaman_perhitungan WITH MNOREK
CASE MMENUKE=2
HITDENDA(MNOREK, TGLNOW, "c:\PELUNASAN.TXT")
ENDCASE
SHOW POPUP MENUHITPINJ
RETURN
ENDPROC
**
FUNCTION saldokrd
PARAMETER MNOREK, XXTGL
LOCAL MBUNGA, JDWPK, JDWBG, BYRPK, BYRBG, SLDPK, SLDBG, MRATE, WJBPK, WJBBG, JDWKE, ANGSKE, HARUSKE
LOCAL MSISAPK, MSISABG, KALIPK, KALIBG, ODPK, ODBG, TGLODPK, TGLODBG
LOCAL NJDWPK, NJDWBG, MSISA, MTGLKHBYR, MHRSPK, MHRSBG, MSISAJDWPK, MSISAJDWBG
OLDSELECT = SELECT()
CREATE CURSOR SALDOKRD (NOREK C (25), TGLJTEMPO D, KOL C (1), PLAFON N (15), PKAWAL N (15), BGAWAL N (15), SISAPK N (15), SISABG N (15), HRSPK N (15), HRSBG N (15), SISAJDWPK N (15), SISAJDWBG N (15), KALIPK N (5, 1), KALIBG N (5, 1), JUMJDWPK N (3), JUMJDWBG N (3), ODPK N (15), ODBG N (15), TGLODPK DATE, TGLODBG DATE, WJBPK N (15), WJBBG N (15), JDWKE INT (3), ANGSKE INT (3), HARUSPKKE INT (3), HARUSBGKE INT (3), NJDWPK N (15), NJDWBG N (15), MTGLKHBYR DATE, BYRPK N (15), BYRBG N (15), DENDA N (10), KALIBYRPK N (3), KALIBYRBG N (3), JAMINAN C (100), TAKSASI N (15), PPAP N (15), PPAP1 N (15), BGAKRUAL N (15), KONTIJENSI N (15), ADM N (15), PROVISI N (15), BIAYA N (15))
KREDIT = SYS(2015)
ANGSUR = SYS(2015)
JADWAL = SYS(2015)
CJAMINAN = SYS(2015)
CBPKB = SYS(2015)
CSERTIFIKAT = SYS(2015)
CSIMPANAN = SYS(2015)
CLAIN = SYS(2015)
CSQL = "select * from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, KREDIT)
IF ISNULL(NOREK)
USE
SELECT (OLDSELECT)
RETURN
ENDIF
CSQL = "select * from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(XXTGL)+"' order by tanggal"
LCEK = SQLEXEC(OODBC, CSQL, ANGSUR)
CSQL = "select * from pinjaman_jadwal where norek='"+MNOREK+"' order by tanggal"
LCEK = SQLEXEC(OODBC, CSQL, JADWAL)
CSQL = "select * from pinjaman_jaminan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, CJAMINAN)
SELECT &ANGSUR
INDEX ON NOREK+DTOS(TANGGAL) TAG ANGSUR
SELECT &JADWAL
INDEX ON NOREK+DTOS(TANGGAL) TAG JADWAL
SET NEAR ON
SELECT &KREDIT
XXTGL = IIF(XXTGL>TGLLUNAS .AND.  .NOT. EMPTY(TGLLUNAS), TGLLUNAS, XXTGL)
MTGLREALISASI = TANGGAL
SELECT &KREDIT
STORE 0 TO MBUNGA, JDWPK, JDWBG, BYRPK, BYRBG, SLDPK, SLDBG, MRATE, WJBPK, WJBBG, JDWKE, ANGSKE, HARUSPKKE, HARUSBGKE, MSISAPK, MSISABG, KALIPK, KALIBG, ODPK, ODBG, NJDWPK, NJDWBG, MSISA
STORE 0 TO VSISAPK
STORE CTOD('  -  -    ') TO TGLODPK, TGLODBG, MTGLKHBYR
STORE 0 TO JPK, JBG, MPKAWAL, MBGAWAL, MHRSPK, MHRSBG, MPKNOW, MBGNOW
STORE 0 TO MKLBYRPK, MKLBYRBG, MSISAJDWPK, MSISAJDWBG
MRATE = RATE
DO CASE
CASE KDHIT='A' .OR. KDHIT='B' .OR. KDHIT='D' .OR. KDHIT='E' .OR. KDHIT='I' .OR. KDHIT='J' .OR. KDHIT='M'
SELECT &ANGSUR
SUM POKOK TO BYRPK 
SUM JASA TO BYRBG 
GOTO TOP
MTGLAKHIR = TANGGAL
SCAN
MTGLAKHIR = MAX(MTGLAKHIR, TANGGAL)
ENDSCAN
JANGSURAN = BYRPK+BYRBG
SLDPK = BYRPK
SLDBG = BYRBG
TBUNGA = 0
SELECT &JADWAL
GOTO TOP
MANGBG = JASA
DO WHILE  .NOT. EOF()
IF XXTGL<TANGGAL
EXIT
ENDIF
IF .T.
JDWKE = JDWKE+1
IF SLDPK<POKOK
TGLODPK = IIF(EMPTY(TGLODPK), TANGGAL, TGLODPK)
IF SLDPK>0
KALIPK = KALIPK+((POKOK-SLDPK)/POKOK)
ODPK = ODPK+(POKOK-SLDPK)
ELSE
KALIPK = KALIPK+1
ODPK = ODPK+POKOK
ENDIF
ELSE
MKLBYRPK = MKLBYRPK+1
ENDIF
SLDPK = SLDPK-(MIN(POKOK, SLDPK))
ENDIF
IF .T.
IF SLDBG<JASA
TGLODBG = IIF(EMPTY(TGLODBG), TANGGAL, TGLODBG)
IF SLDBG>0
KALIBG = KALIBG+((JASA-SLDBG)/JASA)
ODBG = ODBG+(JASA-SLDBG)
ELSE
KALIBG = KALIBG+1
ODBG = ODBG+JASA
ENDIF
ELSE
MKLBYRBG = MKLBYRBG+1
ENDIF
SLDBG = SLDBG-MIN(JASA, SLDBG)
ENDIF
IF TANGGAL<=XXTGL
JDWPK = JDWPK+POKOK
JDWBG = JDWBG+JASA
TBUNGA = TBUNGA+JASA
ENDIF
JANGSURAN = JANGSURAN-(POKOK+JASA)
IF JANGSURAN>=0
ANGSKE = ANGSKE+1
ENDIF
IF TANGGAL<=AKHIRBLN(XXTGL)
IF POKOK>0
HARUSPKKE = HARUSPKKE+1
ENDIF
IF JASA>0
HARUSBGKE = HARUSBGKE+1
ENDIF
ENDIF
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
IF POKOK>0
JPK = JPK+1
ENDIF
IF JASA>0
JBG = JBG+1
ENDIF
MPKAWAL = MPKAWAL+POKOK
MBGAWAL = MBGAWAL+JASA
IF TANGGAL<AWALBLN(XXTGL)
MHRSPK = MHRSPK+POKOK
MHRSBG = MHRSBG+JASA
ELSE
MSISAJDWPK = MSISAJDWPK+POKOK
MSISAJDWBG = MSISAJDWBG+JASA
ENDIF
IF XXTGL<TANGGAL .AND. TANGGAL<AKHIRBLN(XXTGL)
NJDWPK = POKOK
NJDWBG = JASA
ENDIF
SKIP
ENDDO
SELECT &KREDIT
MSISAPK = POKOK-BYRPK
MSISABG = JASA-BYRBG
CASE KDHIT='C'
SELECT &ANGSUR
SUM POKOK TO BYRPK 
SUM JASA TO BYRBG 
GOTO TOP
MTGLAKHIR = TANGGAL
SCAN
MTGLAKHIR = MAX(MTGLAKHIR, TANGGAL)
ENDSCAN
JANGSURAN = BYRPK+BYRBG
SLDPK = BYRPK
SLDBG = BYRBG
TBUNGA = 0
SELECT &JADWAL
GOTO TOP
MANGBG = JASA
DO WHILE  .NOT. EOF()
IF XXTGL<TANGGAL
EXIT
ENDIF
IF .T.
JDWKE = JDWKE+1
IF SLDPK<POKOK
TGLODPK = IIF(EMPTY(TGLODPK), TANGGAL, TGLODPK)
IF SLDPK>0
KALIPK = KALIPK+((POKOK-SLDPK)/POKOK)
ODPK = ODPK+(POKOK-SLDPK)
ELSE
KALIPK = KALIPK+1
ODPK = ODPK+POKOK
ENDIF
ELSE
IF POKOK>0
MKLBYRPK = MKLBYRPK+1
ENDIF
ENDIF
SLDPK = SLDPK-(MIN(POKOK, SLDPK))
ENDIF
IF .T.
IF SLDBG<JASA
TGLODBG = IIF(EMPTY(TGLODBG), TANGGAL, TGLODBG)
IF SLDBG>0
KALIBG = KALIBG+((JASA-SLDBG)/JASA)
ODBG = ODBG+(JASA-SLDBG)
ELSE
KALIBG = KALIBG+1
ODBG = ODBG+JASA
ENDIF
ELSE
IF JASA>0
MKLBYRBG = MKLBYRBG+1
ENDIF
ENDIF
SLDBG = SLDBG-MIN(JASA, SLDBG)
ENDIF
IF TANGGAL<=XXTGL
JDWPK = JDWPK+POKOK
JDWBG = JDWBG+JASA
TBUNGA = TBUNGA+JASA
ENDIF
JANGSURAN = JANGSURAN-(POKOK+JASA)
IF JANGSURAN>=0
ANGSKE = ANGSKE+1
ENDIF
IF TANGGAL<=AKHIRBLN(XXTGL)
IF POKOK>0
HARUSPKKE = HARUSPKKE+1
ENDIF
IF JASA>0
HARUSBGKE = HARUSBGKE+1
ENDIF
ENDIF
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
IF POKOK>0
JPK = JPK+1
ENDIF
IF JASA>0
JBG = JBG+1
ENDIF
MPKAWAL = MPKAWAL+POKOK
MBGAWAL = MBGAWAL+JASA
IF TANGGAL<AWALBLN(XXTGL)
MHRSPK = MHRSPK+POKOK
MHRSBG = MHRSBG+JASA
ELSE
MSISAJDWPK = MSISAJDWPK+POKOK
MSISAJDWBG = MSISAJDWBG+JASA
ENDIF
IF XXTGL<TANGGAL .AND. TANGGAL<AKHIRBLN(XXTGL)
NJDWPK = POKOK
NJDWBG = JASA
ENDIF
SKIP
ENDDO
SELECT &KREDIT
MSISAPK = POKOK-BYRPK
MSISABG = JASA-BYRBG
CASE KDHIT='F' .OR. KDHIT='G'
PKPINJ = POKOK
TGLPINJ = TANGGAL
TGLANGSURPK = TANGGAL
TGLANGSURBG = TANGGAL
MRATE = RATE
MBG = 0
STORE 0 TO BYRPK, BYRBG, JMLMACRO
SELECT &ANGSUR
GOTO TOP
DO WHILE .T.
TGLPINJ=MAJU1BLN(TGLPINJ,&KREDIT->TANGGAL)
MBG = 0
SELECT &ANGSUR
TGLHIT = TGLPINJ
IF  .NOT. EOF() .AND. NOREK=MNOREK .AND. TANGGAL<=TGLPINJ .AND. TANGGAL<=XXTGL
DO WHILE  .NOT. EOF()
IF NOREK<>MNOREK .OR. TANGGAL>TGLPINJ .OR. TANGGAL>XXTGL
EXIT
ENDIF
IF POKOK>0
PKPINJ = PKPINJ-POKOK
TGLHIT = TANGGAL
ENDIF
MBG = ROUND((MRATE/100)*PKPINJ, 0)
BYRPK = BYRPK+POKOK
BYRBG = BYRBG+JASA
SKIP
ENDDO
ELSE
MBG = ROUND((MRATE/100)*PKPINJ, 0)
ENDIF
IF TGLPINJ>AKHIRBLN(XXTGL)
EXIT
ENDIF
JMLMACRO = JMLMACRO+1
V = ALLTRIM(STR(JMLMACRO))
JDWCTGL&V=TGLPINJ
JDWCPK&V=IIF(&KREDIT->TGLJTEMPO<=TGLPINJ,PKPINJ,0)
JDWCBG&V=MBG
ENDDO
JANGSURAN = BYRBG
SELECT &ANGSUR
GOTO TOP
MJDWPK = 0
MJDWBG = 0
STORE 0 TO MBYRPK, MBYRBG
DO WHILE  .NOT. EOF()
IF NOREK<>MNOREK .OR. TANGGAL>XXTGL
EXIT
ENDIF
MBYRPK = MBYRPK+POKOK
MBYRBG = MBYRBG+JASA
MTGLKHBYR = TANGGAL
SKIP
ENDDO
VKD = 1
TGLANGSURPK = CTOD('  -  -    ')
TGLANGSURBG = CTOD('  -  -    ')
FOR AKE = 1 TO JMLMACRO
V = ALLTRIM(STR(AKE))
JANGSURAN=JANGSURAN-JDWCBG&V  
IF JANGSURAN>=0
ANGSKE = ANGSKE+1
ELSE
MKLBYRBG = MKLBYRBG+1
ENDIF
IF JDWCTGL&V<=AKHIRBLN(XXTGL) 
IF JDWCPK&V>0 
HARUSPKKE = HARUSPKKE+1
ENDIF
IF JDWCBG&V>0
HARUSBGKE = HARUSBGKE+1
ENDIF
ENDIF
IF MONTH(JDWCTGL&V)=MONTH(XXTGL) .AND. YEAR(JDWCTGL&V)=YEAR(XXTGL)
NJDWPK=JDWCPK&V  
NJDWBG=JDWCBG&V  
WJBBG=JDWCBG&V  
WJBBG=IIF(DAY(XXTGL)<=DAY(JDWCTGL&V),WJBBG,0)
ENDIF
JDWKE = JDWKE+1
MJDWPK=MJDWPK+JDWCPK&V
MJDWBG=MJDWBG+JDWCBG&V
TGLAKHJDW=JDWCTGL&V
IF ROUND(MBYRBG,0)<ROUND(JDWCBG&V,0) .AND.EMPTY(TGLANGSURBG)
TGLANGSURBG=JDWCTGL&V
ENDIF
IF ROUND(MBYRBG,0)<ROUND(JDWCBG&V,0)
TGLODBG=IIF(EMPTY(TGLODBG),JDWCTGL&V,TGLODBG)
IF MBYRBG>0
ODBG=ODBG+(ROUND(JDWCBG&V,0)-MBYRBG)
ELSE
KALIBG = KALIBG+1
ODBG=ODBG+ROUND(JDWCBG&V,0)
ENDIF
ENDIF
MBYRBG=MBYRBG-JDWCBG&V
ENDFOR
ODBG = IIF(WJBBG>0, MAX(ODBG-WJBBG, 0), ODBG)
MSISAPK=&KREDIT->POKOK-BYRPK
MSISABG = MJDWBG-MBYRBG
IF XXTGL>&KREDIT->TGLJTEMPO
KALIPK = 1
ODPK = MSISAPK
TGLODPK=&KREDIT->TGLJTEMPO
WJBPK = 0
ELSE
KALIPK = 0
ODPK = 0
ENDIF
CASE KDHIT='H'
PKPINJ=&KREDIT->POKOK
TGLPINJ=&KREDIT->TANGGAL
TGLANGSURPK=&KREDIT->TANGGAL
TGLANGSURBG =&KREDIT->TANGGAL
MBG = 0
JMLHR = 0
STORE 0 TO BYRPK, BYRBG, JMLMACRO, JDWC
CSQL = "select MAX(tanggal) as tanggal from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(XXTGL)+"' and kode='"+DEFAPINJASA+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MTGLBYRBG = IIF(ISNULL(TANGGAL), XXTGL, TANGGAL)
TGLANGSURBG = IIF(EMPTY(MTGLBYRBG), XXTGL, MTGLBYRBG)
CSQL = "select MAX(tanggal) as tanggal from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(XXTGL)+"' and kode<>'"+DEFAPINJASA+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MTGLBYRPK = IIF(ISNULL(TANGGAL), XXTGL, TANGGAL)
TGLANGSURPK = IIF(EMPTY(MTGLBYRPK), XXTGL, MTGLBYRPK)
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(XXTGL)+"'  group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "Smt")
MSALDORK = IIF(ISNULL(DEBET), 0, DEBET)-IIF(ISNULL(KREDIT), 0, KREDIT)
MSISAPK = MSALDORK
MSISABG = (XXTGL-MAX(MTGLBYRPK, MTGLBYRBG))*(MRATE/36500)*MSISAPK
MHARI = DAY(MTGLREALISASI)
DO WHILE .T.
MM = "CTOD('"+RIGHT("00"+ALLTRIM(STR(MHARI)), 2)+"-"+RIGHT("00"+ALLTRIM(STR(MONTH(TGLANGSURBG))), 2)+"-"+ALLTRIM(STR(YEAR(TGLANGSURBG)))+"')"
MTGLJDW=&MM
IF  .NOT. EMPTY(MTGLJDW)
EXIT
ENDIF
MHARI = MHARI-1
ENDDO
KALIBG = 0
DO WHILE .T.
MTGLJDW = MAJU1BLN(MTGLJDW)
IF XXTGL<MTGLJDW
EXIT
ENDIF
KALIBG = KALIBG+1
ENDDO
IF KALIBG>0
ODBG = MSISABG
ELSE
ODBG = 0
ENDIF
IF XXTGL>&KREDIT->TGLJTEMPO
KALIPK = 1
ODPK = MSISAPK
TGLODPK=MIN(&KREDIT->TGLJTEMPO,TGLANGSURPK)
WJBBG = 0
ELSE
KALIPK = 0
ODPK = 0
KALIPK = 0
ODPK = 0
TGLODPK = CTOD('  -  -    ')
WJBPK = 0
ENDIF
ENDCASE
SELECT &KREDIT
KALIPK = IIF(KALIPK=0 .AND. ODPK>0, 1, KALIPK)
KALIBG = IIF(KALIBG=0 .AND. ODBG>0, 1, KALIBG)
IF ODPK<0
ODPK = ODPK+WJBPK
WJBPK = 0
ENDIF
IF ODBG<0
ODBG = ODBG+WJBBG
WJBBG = 0
ENDIF
IF WJBPK>MSISAPK
WJBPK = MSISAPK
ENDIF
IF WJBBG>MSISABG
WJBBG = MSISABG
ENDIF
VLAMA=JANGKAWAKTU(&KREDIT->TGLMULAI,&KREDIT->TGLJTEMPO)
VSISAPK = MSISAPK
VSISABG = MSISABG
VKALIPK = KALIPK
VKALIBG = KALIBG
VODPK = ODPK
VODBG = ODBG
VTGLODPK = TGLODPK
VTGLODBG = TGLODBG
VWJBPK = WJBPK
VWJBBG = WJBBG
VJDWKE = JDWKE
VANGSKE = ANGSKE
VHARUSPKKE = HARUSPKKE
VHARUSBGKE = HARUSBGKE
VNJDWPK = NJDWPK
VNJDWBG = NJDWBG
VMTGLKHBYR = MTGLKHBYR
VBYRPK = BYRPK
VBYRBG = BYRBG
VTAKSASI = 0
VJAMINAN = ''
KOLEKTA = '1'
IF &KREDIT->TGLJTEMPO>XXTGL
MLEBIHJT = 0
ELSE
MTGLJTEMPO=&KREDIT->TGLJTEMPO      
IF XXTGL>=MTGLJTEMPO .AND. XXTGL<=MAJU1BLN(MTGLJTEMPO)
MLEBIHJT = 1
ELSE
IF XXTGL<=MAJU1BLN(MAJU1BLN(MTGLJTEMPO))
MLEBIHJT = 2
ELSE
MLEBIHJT = 3
ENDIF
ENDIF
ENDIF
ANGSBULANAN = 'Y'
MKDHIT=&KREDIT->KDHIT
IF MKDHIT='K' .OR. MKDHIT='L' .OR. MKDHIT='M' .OR. MKDHIT='F' .OR. MKDHIT='H'
DNGANGSURAN = 'T'
ELSE
IF MKDHIT='E' .OR. MKDHIT='I' .OR. MKDHIT='J'
ANGSBULANAN = 'T'
ENDIF
DNGANGSURAN = 'Y'
ENDIF
IF DNGANGSURAN='Y'
IF &KREDIT->KPR='T' OR EMPTY(&KREDIT->KPR)      
IF ANGSBULANAN='T'
IF VKALIPK<=1 .AND. VKALIBG<=1 .AND. MLEBIHJT=0
KOLEKTA = '1'
ELSE
IF (VKALIPK<=3 .AND. VKALIBG<=3) .OR. MLEBIHJT=1
KOLEKTA = '2'
ELSE
IF (VKALIPK<=6 .AND. VKALIBG<=6) .OR. MLEBIHJT=2
KOLEKTA = '3'
ELSE
KOLEKTA = '4'
ENDIF
ENDIF
ENDIF
ELSE
IF VKALIPK<=3 .AND. VKALIBG<=3 .AND. MLEBIHJT=0
KOLEKTA = '1'
ELSE
IF (VKALIPK<=6 .AND. VKALIBG<=6) .AND. MLEBIHJT<2
KOLEKTA = '2'
ELSE
IF (VKALIPK<=12 .AND. VKALIBG<=12) .AND. MLEBIHJT<3
KOLEKTA = '3'
ELSE
KOLEKTA = '4'
ENDIF
ENDIF
ENDIF
ENDIF
ELSE
IF VKALIPK<=6 .AND. VKALIBG<=6 .AND. MLEBIHJT=0
KOLEKTA = '1'
ELSE
IF (VKALIPK<=9 .AND. VKALIBG<=9) .OR. MLEBIHJT=1
KOLEKTA = '2'
ELSE
IF (VKALIPK<=30 .AND. VKALIBG<=30) .OR. MLEBIHJT=2
KOLEKTA = '3'
ELSE
KOLEKTA = '4'
ENDIF
ENDIF
ENDIF
ENDIF
ELSE
IF VKALIBG<=3 .AND. MLEBIHJT=0
KOLEKTA = '1'
ELSE
IF VKALIBG<=6 .OR. MLEBIHJT=1
KOLEKTA = '2'
ELSE
IF VKALIBG<=12 .OR. MLEBIHJT=2
KOLEKTA = '3'
ELSE
KOLEKTA = '4'
ENDIF
ENDIF
ENDIF
ENDIF
SELECT &CJAMINAN
STORE 0 TO MNILAIOLD, MPPAP1
GOTO TOP
MTAKSASI = 0
N = 0
DO WHILE  .NOT. EOF()
N = N+1
MNOBERKAS = NOBERKAS
DO CASE
CASE RTRIM(JENIS)='KENDARAAN'
CSQL = "select * from pinjaman_jaminan_bpkb where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF N=1
IF NOBERKAS=MNOBERKAS .AND. (EMPTY(TGLAMBIL) .OR. TGLAMBIL>MTGL)
MJAMINAN = 'KENDARAAN '+ALLTRIM(ALLTRIM(MERK)+' '+ALLTRIM(TYPE)+' '+TAHUN+' '+ALLTRIM(NOBPKB)+TRANSFORM(NOPOLISI, '@R !!-!!!!-!!'))
MNILAIOLD = MNILAIOLD+(NILAI*0.75 )
MTAKSASI = MTAKSASI+NILAI
CSQL = "select ket2,ket3 from setsandi where kode='P009' and sandi='"+PENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MFIELD = ALLTRIM(KET2)
MFIELD = IIF(EMPTY(MFIELD), "NILAI", MFIELD)
MPROSEN = VAL(KET3)
USE
SELECT SMT
MPPAP1=MPPAP1+(&MFIELD*(MPROSEN/100))
ELSE
N = 0
ENDIF
ELSE
IF NOBERKAS=MNOBERKAS .AND. (EMPTY(TGLAMBIL) .OR. TGLAMBIL>MTGL)
N = N-1
ELSE
MNILAIOLD = MNILAIOLD+(NILAI*0.75 )
MTAKSASI = MTAKSASI+NILAI
CSQL = "select ket2,ket3 from setsandi where kode='P009' and sandi='"+PENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MFIELD = ALLTRIM(KET2)
MFIELD = IIF(EMPTY(MFIELD), "NILAI", MFIELD)
MPROSEN = VAL(KET3)
USE
SELECT SMT
MPPAP1=MPPAP1+(&MFIELD*(MPROSEN/100))
ENDIF
ENDIF
USE
CASE RTRIM(JENIS)='TANAH'
CSQL = "select * from pinjaman_jaminan_sertifikat where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF N=1
IF NOBERKAS=MNOBERKAS .AND. (EMPTY(TGLAMBIL) .OR. TGLAMBIL>MTGL)
MJAMINAN = 'TANAH '+ALLTRIM(STATUS)+' '+ALLTRIM(NOSERTIFIKAT)+' '+ALLTRIM(STR(LUAS, 12))
MTAKSASI = MTAKSASI+NILAI
MNILAIOLD = MNILAIOLD+(NILAI*0.75 )
CSQL = "select ket2,ket3 from setsandi where kode='P010' and sandi='"+PENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MFIELD = ALLTRIM(KET2)
MFIELD = IIF(EMPTY(MFIELD), "NILAI", MFIELD)
MPROSEN = VAL(KET3)
USE
SELECT SMT
MPPAP1=MPPAP1+(&MFIELD*(MPROSEN/100))
ELSE
N = 0
ENDIF
ELSE
IF NOBERKAS=MNOBERKAS .AND. (EMPTY(TGLAMBIL) .OR. TGLAMBIL>MTGL)
N = N-1
ELSE
MNILAIOLD = MNILAIOLD+(NILAI*0.75 )
MTAKSASI = MTAKSASI+NILAI
CSQL = "select ket2,ket3 from setsandi where kode='P010' and sandi='"+PENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MFIELD = ALLTRIM(KET2)
MFIELD = IIF(EMPTY(MFIELD), "NILAI", MFIELD)
MPROSEN = VAL(KET3)
USE
SELECT SMT
MPPAP1=MPPAP1+(&MFIELD*(MPROSEN/100))
ENDIF
ENDIF
USE
CASE RTRIM(JENIS)='SIMPANAN'
CSQL = "select * from pinjaman_jaminan_simpanan where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF N=1
IF NOBERKAS=MNOBERKAS .AND. (EMPTY(TGLAMBIL) .OR. TGLAMBIL>MTGL)
MJAMINAN = ALLTRIM(JENIS)+' AN.'+ALLTRIM(NAMA)+' '+TRANSFORM(JUMLAH, '999,999,999,999')
MTAKSASI = MTAKSASI+JUMLAH
MNILAIOLD = MNILAIOLD+JUMLAH
CSQL = "select ket2,ket3 from setsandi where kode='P011' and sandi='"+PENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MFIELD = ALLTRIM(KET2)
MFIELD = IIF(EMPTY(MFIELD), "NOMINAL", MFIELD)
MPROSEN = VAL(KET3)
USE
SELECT SMT
MPPAP1=MPPAP1+(&MFIELD*(MPROSEN/100))
ELSE
N = 0
ENDIF
ELSE
IF NOBERKAS=MNOBERKAS .AND. (EMPTY(TGLAMBIL) .OR. TGLAMBIL>MTGL)
N = N-1
ELSE
MTAKSASI = MTAKSASI+NOMINAL
MNILAIOLD = MNILAIOLD+NOMINAL
CSQL = "select ket2,ket3 from setsandi where kode='P011' and sandi='"+PENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MFIELD = ALLTRIM(KET2)
MFIELD = IIF(EMPTY(MFIELD), "NOMINAL", MFIELD)
MPROSEN = VAL(KET3)
USE
SELECT SMT
MPPAP1=MPPAP1+(&MFIELD*(MPROSEN/100))
ENDIF
ENDIF
USE
OTHERWISE
CSQL = "select * from pinjaman_jaminan_lainnya where noberkas='"+ALLTRIM(MNOBERKAS)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF N=1
IF NOBERKAS=MNOBERKAS .AND. (EMPTY(TGLAMBIL) .OR. TGLAMBIL>MTGL)
MJAMINAN = ALLTRIM(KETERANGAN)
MTAKSASI = MTAKSASI+NILAI
CSQL = "select ket2,ket3 from setsandi where kode='P012' and sandi='"+PENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MFIELD = ALLTRIM(KET2)
MFIELD = IIF(EMPTY(MFIELD), "NILAI", MFIELD)
MPROSEN = VAL(KET3)
USE
SELECT SMT
MPPAP1=MPPAP1+(&MFIELD*(MPROSEN/100))
ELSE
N = 0
ENDIF
ELSE
IF NOBERKAS=MNOBERKAS .AND. (EMPTY(TGLAMBIL) .OR. TGLAMBIL>MTGL)
N = N-1
ELSE
MTAKSASI = MTAKSASI+NILAI
CSQL = "select ket2,ket3 from setsandi where kode='P012' and sandi='"+PENGIKATAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MFIELD = ALLTRIM(KET2)
MFIELD = IIF(EMPTY(MFIELD), "NILAI", MFIELD)
MPROSEN = VAL(KET3)
USE
SELECT SMT
MPPAP1=MPPAP1+(&MFIELD*(MPROSEN/100))
ENDIF
ENDIF
USE
ENDCASE
SELECT &CJAMINAN
SKIP
ENDDO
MJAMINAN = ''
IF N>1
MJAMINAN = ALLTRIM(MJAMINAN)+SPACE(50-LEN(ALLTRIM(MJAMINAN)))
MJAMINAN = LEFT(MJAMINAN, 0037)
MJAMINAN = MJAMINAN+' ('+STR(N, 2)+' Jaminan)'
ELSE
MJAMINAN = ALLTRIM(MJAMINAN)+SPACE(50)
MJAMINAN = LEFT(MJAMINAN, 50)
ENDIF
DO CASE
CASE KOLEKTA='1'
MPPAP = (0.005*1.0)*MSISAPK
MPPAPOLD = MPPAP
CASE KOLEKTA='2'
MPPAP = IIF(MSISAPK-MPPAP1<0, 0, (0.1^1)*(MSISAPK-MPPAP1))
MPPAPOLD = IIF(MSISAPK-MNILAIOLD<0, 0, (0.1^1)*(MSISAPK-MNILAIOLD))
CASE KOLEKTA='3'
MPPAP = IIF(MSISAPK-MPPAP1<0, 0, (0.5^1)*(MSISAPK-MPPAP1))
MPPAPOLD = IIF(MSISAPK-MNILAIOLD<0, 0, (0.5^1)*(MSISAPK-MNILAIOLD))
CASE KOLEKTA='4'
MPPAP = IIF(MSISAPK-MPPAP1<0, 0, 001*(MSISAPK-MPPAP1))
MPPAPOLD = IIF(MSISAPK-MNILAIOLD<0, 0, 001*(MSISAPK-MNILAIOLD))
ENDCASE
SELECT SALDOKRD
APPEND BLANK
REPLACE NOREK WITH &KREDIT->NOREK
REPLACE TGLJTEMPO WITH &KREDIT->TGLJTEMPO
REPLACE KOL WITH KOLEKTA
REPLACE PLAFON WITH &KREDIT->POKOK
REPLACE PKAWAL WITH MPKAWAL, BGAWAL WITH MBGAWAL
REPLACE JUMJDWPK WITH JPK, JUMJDWBG WITH JBG
REPLACE HRSPK WITH MHRSPK, HRSBG WITH MHRSBG
REPLACE SISAJDWPK WITH MSISAJDWPK, SISAJDWBG WITH MSISAJDWBG
REPLACE SISAPK WITH IIF(ISNULL(VSISAPK), 0, VSISAPK), SISABG WITH VSISABG, KALIPK WITH VKALIPK
REPLACE KALIBG WITH VKALIBG, ODPK WITH VODPK, ODBG WITH VODBG, TGLODPK WITH VTGLODPK
REPLACE KALIBYRPK WITH MKLBYRPK, KALIBYRBG WITH MKLBYRBG
REPLACE TGLODBG WITH VTGLODBG, WJBPK WITH VWJBPK, WJBBG WITH VWJBBG, JDWKE WITH VJDWKE
REPLACE ANGSKE WITH VANGSKE, HARUSPKKE WITH VHARUSPKKE, HARUSBGKE WITH VHARUSBGKE, NJDWPK WITH VNJDWPK
REPLACE NJDWBG WITH VNJDWBG, MTGLKHBYR WITH VMTGLKHBYR, BYRPK WITH VBYRPK, BYRBG WITH VBYRBG
REPLACE JAMINAN WITH MJAMINAN, TAKSASI WITH MTAKSASI, PPAP WITH IIF(ISNULL(MPPAP), 0, MPPAP), PPAP1 WITH IIF(ISNULL(MPPAP1), 0, MPPAP1)
SELECT &KREDIT
USE
SELECT &ANGSUR
USE
SELECT &JADWAL
USE
SELECT &CJAMINAN
USE
SELECT SALDOKRD
MDATA = ALIAS()
SELECT (OLDSELECT)
RETURN MDATA
ENDFUNC
**
PROCEDURE buatjdw
PARAMETER MNOREK
LOCAL N, XPOKOK, XBUNGA
OLDSELECT = SELECT()
CSQL = "select norek,a.kdhit,pokok,jasa,a.rate as rate,lama,tanggal,tglmulai,tgljtempo,b.pembulatan as pembulatan from pinjaman as a left join setsandi_pinj as b on a.jenis=b.sandi where norek='"+ALLTRIM(MNOREK)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = NOREK
MKDHIT = KDHIT
MPOKOK = POKOK
MJASA = JASA
MRATE = RATE
MLAMA = LAMA
MTANGGAL = TANGGAL
MTGLANGSUR = TGLMULAI
MTGLJTEMPO = TGLJTEMPO
BULATKE = IIF(ISNULL(PEMBULATAN), 0, PEMBULATAN)
USE
SELECT (OLDSELECT)
MMINGGU = ((MTGLJTEMPO-MTGLANGSUR)/7)+1
MTGLANG = MTGLANGSUR
MBUNGA = MJASA
MANGSURAN = ROUND((MPOKOK+MBUNGA)/MLAMA, 0)
VERSI = MKDHIT
MSISA = MPOKOK
DO CASE
CASE VERSI='A'
N = 1
JMLBUNGA = 0
JMLPOKOK = 0
XPOKOK = ROUND(MPOKOK/MLAMA, 0)
MANGSURAN = PEMBULATAN(MANGSURAN, BULATKE)
XBUNGA = MANGSURAN-XPOKOK
JMLBUNGA = 0
DO WHILE N<=MLAMA
IF N=MLAMA
XBUNGA = MBUNGA-JMLBUNGA
XPOKOK = MPOKOK-JMLPOKOK
ENDIF
JMLBUNGA = JMLBUNGA+XBUNGA
JMLPOKOK = JMLPOKOK+XPOKOK
CSQL = "insert ignore into pinjaman_jadwal (kantor,norek,tanggal,pokok,jasa,opt) value ('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(XPOKOK)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
MTGLANG = MAJU1BLN(MTGLANG, MTANGGAL)
N = N+1
ENDDO
RETURN
CASE VERSI='B' .AND.  .NOT. (EMPTY(MTGLANGSUR) .OR. EMPTY(MTGLJTEMPO))
N = 1
JMLBUNGA = 0
JMLPOKOK = 0
MTGLANG1 = MTGLANG
MANGSURAN = PEMBULATAN(MANGSURAN, BULATKE)
DO WHILE N<=MLAMA
IF N=MLAMA
XPOKOK = MPOKOK-JMLPOKOK
XBUNGA = MANGSURAN-XPOKOK
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(XPOKOK)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
XBUNGA = ROUND((((MLAMA+1-N)*2)/(MLAMA*(MLAMA+1)))*MBUNGA, 0)
XPOKOK = MANGSURAN-XBUNGA
JMLBUNGA = JMLBUNGA+XBUNGA
JMLPOKOK = JMLPOKOK+XPOKOK
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(XPOKOK)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF MONTH(MTGLANG)<>IIF(MONTH(MTGLANG1)=12, 1, MONTH(MTGLANG1)+1)
MTGLANG = MTGLANG-1
ENDIF
MTGLANG1 = MTGLANG
MTGLANG = MAJU1BLN(MTGLANG, MTGLANGSUR)
N = N+1
ENDDO
CASE VERSI='C'
N = 1
XPOKOK = MPOKOK
XBUNGA = ROUND((MRATE*MPOKOK)/100, 0)
XBUNGA = PEMBULATAN(XBUNGA, BULATKE)
DO WHILE .T.
IF MTGLANG>=MTGLJTEMPO
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(XPOKOK)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
EXIT
ELSE
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(0)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MTGLANG = MAJU1BLN(MTGLANG)
N = N+1
ENDDO
CASE VERSI='D'
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(MPOKOK)+"','"+STR(MBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
CASE VERSI='E'
MTGLANG = MTGLANGSUR
XPOKOK = ROUND(MPOKOK/((MTGLJTEMPO-MTGLANGSUR)+1), 0)
XBUNGA = ROUND(MBUNGA/((MTGLJTEMPO-MTGLANGSUR)+1), 0)
JMLBUNGA = 0
JMLPOKOK = 0
MANGSURAN = (MPOKOK+MBUNGA)/((MTGLJTEMPO-MTGLANGSUR)+1)
MANGSURAN = PEMBULATAN(MANGSURAN, BULATKE)
N = 1
DO WHILE N<=((MTGLJTEMPO-MTGLANGSUR)+1)
IF MTGLANG>=MTGLJTEMPO
XBUNGA = MBUNGA-JMLBUNGA
XPOKOK = MPOKOK-JMLPOKOK
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(XPOKOK)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
EXIT
ENDIF
JMLBUNGA = JMLBUNGA+XBUNGA
JMLPOKOK = JMLPOKOK+XPOKOK
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(XPOKOK)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
N = N+1
MTGLANG = MTGLANG+1
ENDDO
CASE VERSI='F'
N = 1
XPOKOK = ROUND(MPOKOK/MLAMA, 0)
XPOKOK = PEMBULATAN(XPOKOK, BULATKE)
XBUNGA = ROUND((MRATE*MPOKOK)/100, 0)
XBUNGA = PEMBULATAN(XBUNGA, BULATKE)
MSISA = MPOKOK
DO WHILE .T.
IF N=MLAMA
XPOKOK = MSISA
ENDIF
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(XPOKOK)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF N=MLAMA
EXIT
ENDIF
MSISA = MSISA-XPOKOK
XBUNGA = ROUND((MRATE*MSISA)/100, 0)
XBUNGA = PEMBULATAN(XBUNGA, BULATKE)
MTGLANG = MAJU1BLN(MTGLANG)
N = N+1
ENDDO
CASE VERSI='I'
N = 1
JMLBUNGA = 0
JMLPOKOK = 0
XPOKOK = ROUND(MPOKOK/MMINGGU, 0)
XBUNGA = ROUND(MBUNGA/MMINGGU, 0)
DO WHILE N<=MMINGGU
IF N=MMINGGU
XBUNGA = MBUNGA-JMLBUNGA
XPOKOK = MPOKOK-JMLPOKOK
ENDIF
JMLBUNGA = JMLBUNGA+XBUNGA
JMLPOKOK = JMLPOKOK+XPOKOK
CSQL = "insert into pinjaman_jadwal (norek,tanggal,pokok,jasa,opt) value ('"+MNOREK+"','"+SQLDATE(MTGLANG)+"','"+STR(XPOKOK)+"','"+STR(XBUNGA)+"','"+"OPT"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
MTGLANG = MTGLANG+7
N = N+1
ENDDO
ENDCASE
RETURN
ENDPROC
**
FUNCTION HITDENDA
PARAMETER MNOREK, PTGLHITLUNAS, MFILE
CURKRD = "KRD"
CURJDW = "JDW"
CURANGS = "ANGS"
LOCAL XTGL, OLDSELECT
OLDSELECT = SELECT()
XPARA = 'Y'
CSQL = "select * from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, CURKRD)
CSQL = "select * from pinjaman_mutasi where norek='"+MNOREK+"' order by tanggal"
LCEK = SQLEXEC(OODBC, CSQL, CURANGS)
CSQL = "select * from pinjaman_jadwal where norek='"+MNOREK+"' order by tanggal"
LCEK = SQLEXEC(OODBC, CSQL, CURJDW)
PDENDA = DEFAPROSENDENDA
PHARI = DEFATENORDENDA
PPENAL = 0
PBIAYATT = 0
MCIF = KRD.CIF
CSQL = "select nama from anggota where cif=?mcif"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNAMA = NAMA
USE
SELECT (CURKRD)
MPOKOKPINJ = KRD.POKOK
MTGLMULAI = KRD.TGLMULAI
MTGLJTEMPO = KRD.TGLJTEMPO
CREATE CURSOR PELUNASAN (NO N (3), KDDATA C (3), TGLJDW D, JDWPOKOK N (15), JDWBUNGA N (15), JDWJUMLAH N (15), TGLBAYAR D, BKTBAYAR C (10), BYRPOKOK N (15), BYRBUNGA N (15), BYRDENDA N (15), BYRJUMLAH N (15), KURANGBYR N (15), LAMA N (8), DENDA N (15), KURANGDENDA N (15), TEST N (10))
NOMORCTK = 0
BGNOW = 0
MBYRPK = 0
SELECT (CURKRD)
MNOREK = NOREK
MTANGGAL = TANGGAL
MTGLJTEMPO = TGLJTEMPO
MLAMA = LAMA
MBUNGAAWAL = JASA
MPOKOKAWAL = POKOK
JMLANGSURAN = (POKOK+JASA)/MLAMA
MKDHIT = KDHIT
BPTGLANALI = PTGLHITLUNAS
SELECT (CURJDW)
GOTO TOP
MTOTANGS = POKOK+JASA
SELECT (CURKRD)
STORE 0 TO MTOTAL, MDENDA, BDENDA, MTOTJML, MTOTPOKOK, MTOTBUNGA, MTOTBUNGA, MTOTDENDA, MMAJU, JDWPK, JDWBG
STORE 0 TO MTOTPOKOK1, MTOTBUNGA1, MTOTJML1, MDENDA1, MTOTDENDA1
LIN = .F.
HABIS = .T.
ANGHABIS = .F.
JDWHABIS = .F.
MSISA = 0
MKURANG = 0
PID = "A"
SELECT (CURJDW)
GOTO TOP
SELECT (CURANGS)
GOTO TOP
SELECT (CURJDW)
MTGLJADWAL = TANGGAL
MPOKOK = POKOK
MBUNGA = JASA
MJDWPERBULAN = MPOKOK+MBUNGA
MJADWAL = 0
MSELESAI = .F.
BRS = .T.
DO WHILE  .NOT. EOF()
SELECT (CURJDW)
IF PTGLHITLUNAS-TANGGAL>0
IF MTOTAL<=0
MTGLJADWAL = TANGGAL
MJADWAL = (POKOK+JASA)
MTOTAL = MTOTAL+MJADWAL
SELECT PELUNASAN
NOMORCTK = NOMORCTK+1
APPEND BLANK
REPLACE NO WITH NOMORCTK, KDDATA WITH 'HIT', TGLJDW WITH JDW.TANGGAL
REPLACE JDWPOKOK WITH JDW.POKOK, JDWBUNGA WITH JDW.JASA
REPLACE JDWJUMLAH WITH JDW.POKOK+JDW.JASA
MSISA = MSISA+MJADWAL
BRS = .F.
ELSE
MJADWAL = 0
MTOTAL = MSISA
NOMORCTK = NOMORCTK+1
SELECT PELUNASAN
APPEND BLANK
REPLACE NO WITH NOMORCTK, KDDATA WITH 'HIT', TGLJDW WITH CTOD('  -  -   ')
REPLACE JDWPOKOK WITH 0, JDWBUNGA WITH 0
REPLACE JDWJUMLAH WITH 0
BRS = .F.
ENDIF
SELECT (CURANGS)
DO WHILE .T.
IF EOF() .OR. TANGGAL>PTGLHITLUNAS
MSELESAI = .T.
EXIT
ENDIF
MTGLANGSUR = TANGGAL
MBUKTI = BUKTI
IF MTOTAL>MJADWAL
MLAMBAT = MAX(MAX(MTGLANGSUR, MTANGGAL)-MTGLJADWAL, 0)
MKURANG = MKURANG+(IIF(MJADWAL>(0-MKURANG), (0-MKURANG), MJADWAL))
SELECT PELUNASAN
REPLACE TGLBAYAR WITH MTGLANGSUR, BKTBAYAR WITH MBUKTI
REPLACE BYRPOKOK WITH 0, BYRBUNGA WITH 0
REPLACE BYRDENDA WITH 0
REPLACE BYRJUMLAH WITH 0
REPLACE TEST WITH MTOTAL
CDENDA = 0
IF (MLAMBAT>PHARI)
CDENDA = (MLAMBAT/30)*(PDENDA/100)*MTOTAL
MDENDA = MDENDA+CDENDA
MTGLJADWAL = ANGS.TANGGAL
ENDIF
REPLACE KURANGBYR WITH MKURANG, LAMA WITH MLAMBAT
REPLACE DENDA WITH CDENDA, KURANGDENDA WITH MDENDA
ELSE
IF BRS
SELECT PELUNASAN
APPEND BLANK
REPLACE NO WITH NOMORCTK, KDDATA WITH 'HIT', TGLJDW WITH CTOD('  -  -   ')
REPLACE JDWPOKOK WITH 0, JDWBUNGA WITH 0
REPLACE JDWJUMLAH WITH 0
MJADWAL = 0
ENDIF
SELECT (CURANGS)
MTGLANGSUR = TANGGAL
MLAMBAT = MAX(MTGLANGSUR-MTGLJADWAL, 0)
MBUKTI = BUKTI
MKURANG = MKURANG+MJADWAL
SELECT PELUNASAN
REPLACE TGLBAYAR WITH ANGS.TANGGAL, BKTBAYAR WITH ANGS.BUKTI
REPLACE BYRPOKOK WITH ANGS.POKOK, BYRBUNGA WITH ANGS.JASA
REPLACE BYRDENDA WITH ANGS.DENDA
REPLACE BYRJUMLAH WITH ANGS.POKOK+ANGS.JASA
CDENDA = 0
IF (MLAMBAT>PHARI)
CDENDA = (MLAMBAT/30)*(PDENDA/100)*MTOTAL
MDENDA = MDENDA+CDENDA
MTGLJADWAL = ANGS.TANGGAL
ENDIF
MKURANG = MKURANG-(ANGS.POKOK+ANGS.JASA)
REPLACE KURANGBYR WITH MKURANG, LAMA WITH MLAMBAT
REPLACE DENDA WITH CDENDA, KURANGDENDA WITH MDENDA
REPLACE TEST WITH MTOTAL
MTOTAL = MTOTAL-(ANGS.POKOK+ANGS.JASA)
BRS = .T.
SELECT (CURANGS)
IF MTOTAL<=0
SKIP
EXIT
ENDIF
ENDIF
SELECT (CURANGS)
SKIP
ENDDO
ELSE
MSELESAI = .T.
ENDIF
IF MSELESAI
IF MKURANG<0
NOMORCTK = NOMORCTK+1
SELECT PELUNASAN
IF BRS
APPEND BLANK
REPLACE NO WITH NOMORCTK, KDDATA WITH 'HIT', TGLJDW WITH CTOD('  -  -   ')
REPLACE JDWPOKOK WITH 0, JDWBUNGA WITH 0
REPLACE JDWJUMLAH WITH 0
ENDIF
MLAMBAT = MAX(MAX(MTGLANGSUR, TGLJDW)-MTGLJADWAL, 0)
MKURANG = MKURANG+MJADWAL
MTOTAL = MTOTAL-MKURANG+MJADWAL
CDENDA = 0
IF (MLAMBAT>PHARI)
CDENDA = (MLAMBAT/30)*(PDENDA/100)*MTOTAL
MDENDA = MDENDA+CDENDA
MTGLJADWAL = ANGS.TANGGAL
ENDIF
REPLACE TGLBAYAR WITH MTGLANGSUR, BKTBAYAR WITH MBUKTI
REPLACE BYRPOKOK WITH 0, BYRBUNGA WITH 0
REPLACE BYRDENDA WITH 0
REPLACE BYRJUMLAH WITH 0
REPLACE KURANGBYR WITH MKURANG, LAMA WITH MLAMBAT
REPLACE DENDA WITH CDENDA, KURANGDENDA WITH 0
REPLACE TEST WITH MTOTAL
BRS = .T.
ENDIF
IF MKURANG>0
MLAMBAT = MAX(PTGLHITLUNAS-MTGLJADWAL, 0)
NOMORCTK = NOMORCTK+1
SELECT PELUNASAN
IF BRS
APPEND BLANK
REPLACE NO WITH NOMORCTK, KDDATA WITH 'HIT', TGLJDW WITH CTOD('  -  -   ')
REPLACE JDWPOKOK WITH 0, JDWBUNGA WITH 0
REPLACE JDWJUMLAH WITH 0
MJADWAL = 0
ENDIF
MTOTAL = MKURANG
MKURANG = MKURANG+(IIF(MJADWAL>(0-MKURANG), (0-MKURANG), MJADWAL))
CDENDA = 0
IF (MLAMBAT>PHARI)
CDENDA = (MLAMBAT/30)*(PDENDA/100)*MTOTAL
MDENDA = MDENDA+CDENDA
ENDIF
REPLACE TGLBAYAR WITH PTGLHITLUNAS, BKTBAYAR WITH ""
REPLACE BYRPOKOK WITH 0, BYRBUNGA WITH 0
REPLACE BYRDENDA WITH 0
REPLACE BYRJUMLAH WITH 0
REPLACE KURANGBYR WITH MKURANG, LAMA WITH MLAMBAT
REPLACE DENDA WITH CDENDA, KURANGDENDA WITH 0, TEST WITH MTOTAL
ENDIF
SELECT (CURJDW)
SKIP
DO WHILE  .NOT. EOF()
IF TANGGAL>PTGLHITLUNAS
EXIT
ENDIF
NOMORCTK = NOMORCTK+1
SELECT PELUNASAN
APPEND BLANK
REPLACE NO WITH NOMORCTK, KDDATA WITH 'HIT', TGLJDW WITH JDW.TANGGAL
REPLACE JDWPOKOK WITH JDW.POKOK, JDWBUNGA WITH JDW.JASA
REPLACE JDWJUMLAH WITH JDW.POKOK+JDW.JASA
MJADWAL = (JDW.POKOK+JDW.JASA)
MTGLJADWAL = JDW.TANGGAL
MTOTAL = JDW.POKOK+JDW.JASA
MLAMBAT = MAX(PTGLHITLUNAS-MTGLJADWAL, 0)
CDENDA = 0
IF (MLAMBAT>PHARI)
CDENDA = (MLAMBAT/30)*(PDENDA/100)*MTOTAL
MDENDA = MDENDA+CDENDA
ENDIF
MKURANG = MKURANG+(IIF(MJADWAL>(0-MKURANG), (0-MKURANG), MJADWAL))
REPLACE TGLBAYAR WITH PTGLHITLUNAS, BKTBAYAR WITH ""
REPLACE BYRPOKOK WITH 0, BYRBUNGA WITH 0
REPLACE BYRDENDA WITH 0
REPLACE BYRJUMLAH WITH 0
REPLACE KURANGBYR WITH MKURANG
REPLACE LAMA WITH MLAMBAT
REPLACE DENDA WITH CDENDA, KURANGDENDA WITH 0, TEST WITH MTOTAL
SELECT (CURJDW)
SKIP
ENDDO
EXIT
ENDIF
SELECT (CURJDW)
IF MTOTAL<=0
SKIP
ENDIF
ENDDO
SELECT (CURJDW)
DO WHILE  .NOT. EOF()
SELECT PELUNASAN
NOMORCTK = NOMORCTK+1
APPEND BLANK
REPLACE NO WITH NOMORCTK, KDDATA WITH 'JDW', TGLJDW WITH JDW.TANGGAL
REPLACE JDWPOKOK WITH JDW.POKOK, JDWBUNGA WITH JDW.JASA
REPLACE JDWJUMLAH WITH JDW.POKOK+JDW.JASA
SELECT (CURJDW)
SKIP
ENDDO
SELECT PELUNASAN
SUM JDWJUMLAH TO CJDWJUMLAH FOR KDDATA="HIT"
SUM BYRPOKOK TO CBYRPOKOK FOR KDDATA="HIT"
SUM BYRBUNGA TO CBYRBUNGA FOR KDDATA="HIT"
SUM BYRDENDA TO CBYRDENDA FOR KDDATA="HIT"
SUM DENDA TO CDENDA FOR KDDATA="HIT"
SUM JDWPOKOK TO CJDWPOKOK FOR KDDATA="JDW"
SUM JDWBUNGA TO CJDWBUNGA FOR KDDATA="JDW"
MDENDA = CDENDA-CBYRDENDA
MLUNAS = CJDWJUMLAH-(CBYRPOKOK+CBYRBUNGA)+CJDWPOKOK+MDENDA+(CJDWBUNGA*(1.0/4))
SELECT (CURKRD)
USE
SELECT (CURJDW)
USE
SELECT (CURANGS)
USE
SELECT PELUNASAN
IF  .NOT. (VARTYPE(MFILE)="X" .OR. EMPTY(MFILE))
SET CONSOLE OFF
SET ALTERNATE TO &MFILE 
SET ALTERNATE ON
?
? '                                                         PERHITUNGAN PELUNASAN                                                          '
? '----------------------------------------------------------------------------------------------------------------------------------------'
? 'Tanggal Perhitungan : '+DTOC(PTGLHITLUNAS)+'            No.Debitur : '+MNOREK
? 'Denda/Bln.      (%) : '+TRANSFORM(PDENDA, '99.999')+'                Nama       : '+MNAMA
? '----------------------------------------------------------------------------------------------------------------------------------------'
? 'Pinjaman Pokok      : '+TRANSFORM(MPOKOKPINJ, '999,999,999,999')
? 'Angsuran /Bln.      : '+TRANSFORM(MJDWPERBULAN, '999,999,999,999')
? 'Mulai Tanggal       : '+DTOC(MTGLMULAI)+' s/d. '+DTOC(MTGLJTEMPO)
? '----------------------------------------------------------------------------------------------------------------------------------------'
? 'Perhitungan angsuran :'
? 'Tgl.Jadwal        Jumlah  Tgl.Ang.   Bukti            Pokok         Bunga         Denda        Jumlah   Kurang Ang.   Lama   Khrs. Denda'
? '----------------------------------------------------------------------------------------------------------------------------------------'
SELECT PELUNASAN
LOCAL TJDWJUMLAH, TBYRPOKOK, TBYRBUNGA, TBYRDENDA, TKURANGBYR, TDENDA
STORE 0 TO TJDWJUMLAH, TBYRPOKOK, TBYRBUNGA, TBYRDENDA, TKURANGBYR, TDENDA
GOTO TOP
DO WHILE  .NOT. EOF()
IF KDDATA="JDW"
EXIT
ENDIF
? DTOC(TGLJDW)+' '+TRANSFORM(JDWJUMLAH, '9,999,999,999')+' '+DTOC(TGLBAYAR)+' '+BKTBAYAR+''+TRANSFORM(BYRPOKOK, '9,999,999,999')+' '+TRANSFORM(BYRBUNGA, '9,999,999,999')+' '+TRANSFORM(BYRDENDA, '9,999,999,999')+' '+TRANSFORM(BYRPOKOK+BYRBUNGA+BYRDENDA, '9,999,999,999')+' '+TRANSFORM(KURANGBYR, '9,999,999,999')+' '+TRANSFORM(LAMA, '99,999')+' '+TRANSFORM(DENDA, '9,999,999,999')
TJDWJUMLAH = TJDWJUMLAH+JDWJUMLAH
TBYRPOKOK = TBYRPOKOK+BYRPOKOK
TBYRBUNGA = TBYRBUNGA+BYRBUNGA
TBYRDENDA = TBYRDENDA+BYRDENDA
TKURANGBYR = TKURANGBYR+KURANGBYR
TDENDA = TDENDA+DENDA
SKIP
ENDDO
? '----------------------------------------------------------------------------------------------------------------------------------------'
? 'Total :    '+TRANSFORM(TJDWJUMLAH, '9,999,999,999')+'            '+'          '+''+TRANSFORM(TBYRPOKOK, '9,999,999,999')+' '+TRANSFORM(TBYRBUNGA, '9,999,999,999')+' '+TRANSFORM(TBYRDENDA, '9,999,999,999')+' '+TRANSFORM(TBYRPOKOK+TBYRBUNGA+TBYRDENDA, '9,999,999,999')+' '+'             '+' '+'      '+' '+TRANSFORM(TDENDA, '9,999,999,999')
?
? 'Jadwal yg masih harus dibayar :'
? 'Tgl.Jadwal         Pokok            Jasa           Jumlah '
? '----------------------------------------------------------------------------------------------------------------------------------------'
LOCAL TJDWPOKOK, TJDWBUNGA
STORE 0 TO TJDWPOKOK, TJDWBUNGA
DO WHILE  .NOT. EOF()
? DTOC(TGLJDW)+' '+TRANSFORM(JDWPOKOK, '9,999,999,999')+'    '+TRANSFORM(JDWBUNGA, '9,999,999,999')+'   '+TRANSFORM(JDWPOKOK+JDWBUNGA, '9,999,999,999')
TJDWPOKOK = TJDWPOKOK+JDWPOKOK
TJDWBUNGA = TJDWBUNGA+JDWBUNGA
SKIP
ENDDO
? '----------------------------------------------------------------------------------------------------------------------------------------'
? 'Total :    '+TRANSFORM(TJDWPOKOK, '9,999,999,999')+'    '+TRANSFORM(TJDWBUNGA, '9,999,999,999')+'   '+TRANSFORM(TJDWPOKOK+TJDWBUNGA, '9,999,999,999')
?
MKEWAJIBAN = TJDWJUMLAH-(TBYRPOKOK+TBYRBUNGA)
? 'Kewajiban Ang. yg belum dibayar:                                  '+TRANSFORM(MKEWAJIBAN, '9,999,999,999')
? 'Kekurangan Pokok Pinjaman      :                                  '+TRANSFORM(TJDWPOKOK, '9,999,999,999')
? 'Tambahan Bunga ( 25% x)        :                                  '+TRANSFORM(CJDWBUNGA*(1.0/4), '9,999,999,999')
? 'Denda angsuran                 :  '+TRANSFORM(TDENDA, '9,999,999,999')+' - '+TRANSFORM(TBYRDENDA, '9,999,999,999')+' = '+TRANSFORM(TDENDA-TBYRDENDA, '9,999,999,999')
? '                                ----------------------------------------------- +'
? '                               :                                  '+TRANSFORM(MKEWAJIBAN+TJDWPOKOK+TDENDA-TBYRDENDA+(CJDWBUNGA*(1.0/4)), '9,999,999,999')
? 'Biaya tagih / tarik            :                                              0'
? '                                ----------------------------------------------- +'
? 'Jumlah yang harus dibayar      :                                  '+TRANSFORM(MKEWAJIBAN+TJDWPOKOK+TDENDA-TBYRDENDA+(CJDWBUNGA*(1.0/4)), '9,999,999,999')
?
SET CONSOLE ON
SET ALTERNATE TO
BUKAFILE(MFILE,  , "open")
ENDIF
SELECT PELUNASAN
USE
SELECT (OLDSELECT)
RETURN MDENDA
ENDFUNC
**
PROCEDURE bayarangsur
PARAMETER MKAS, MNOREK, MTANGGAL, MBUKTI, MPOKOK, MBUNGA, MDENDA, MKDANGS, MSISABG
MJASARK = 0
OLDSELE = SELECT()
MCUR = SALDOKRD(MNOREK, MTANGGAL)
SELECT (MCUR)
MKOL_AWAL = KOL
USE
CSQL = "select kdhit,rate from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt001")
MKDHIT = KDHIT
MRATE = RATE
USE
SELECT (OLDSELE)
IF MKDHIT='H'
CSQL = "select MAX(tanggal) as tanggal from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(TGLNOW)+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MTGLMUTASI = IIF(ISNULL(TANGGAL), TGLNOW, TANGGAL)
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from pinjaman_mutasi where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt001")
MSALDO = DEBET-KREDIT
MJASARK = ROUND((TGLNOW-MTGLMUTASI)*(MRATE/36500)*MSALDO, 0)
IF MJASARK>0
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+MNOREK+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+MBUKTI+"',"+"'"+DEFAPINJASA+"',"+"'"+STR(MJASARK)+"',"+"'"+STR(0)+"',"+"'"+STR(MSALDO+MJASARK)+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+MNOREK+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+MBUKTI+"',"+"'"+IIF(MKAS="KAS", DEFAPINSTOR, DEFAPINPBK)+"',"+"'"+STR(0)+"',"+"'"+STR(MPOKOK)+"',"+"'"+STR(MSALDO+MJASARK-MPOKOK)+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,pokok,jasa,denda,opt) value "+"('"+DEFAKANTOR+"',"+"'"+MNOREK+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+MBUKTI+"',"+"'"+IIF(MKAS="KAS", DEFAPINSTOR, DEFAPINPBK)+"',"+"'"+STR(MPOKOK)+"',"+"'"+STR(MBUNGA)+"',"+"'"+STR(MDENDA)+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF MKDANGS='L'
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,pokok,jasa,denda,opt) value "+"('"+DEFAKANTOR+"',"+"'"+MNOREK+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+SQLDATE(MTANGGAL)+"',"+"'"+MBUKTI+"',"+"'"+IIF(MKAS="KAS", DEFAPINPOT, DEFAPINPOT)+"',"+"'0',"+"'"+STR(MSISABG-MBUNGA)+"',"+"'0',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman set tgllunas='"+SQLDATE(MTANGGAL)+"' where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
OLDSELE = SELECT()
MCUR = SALDOKRD(MNOREK, MTANGGAL)
SELECT (MCUR)
MKOLECT = KOL
MSISAPOKOK = SISAPK
MSISABUNGA = SISABG
MKALIPK = KALIPK
MKALIBG = KALIBG
MODPK = ODPK
MODBG = ODBG
MHARIPK = IIF(EMPTY(TGLODPK), 0, MTANGGAL-TGLODPK)
MHARIBG = IIF(EMPTY(TGLODBG), 0, MTANGGAL-TGLODBG)
MTGLOD = MAX(TGLODPK, TGLODBG)
MPPAP = PPAP
USE
SELECT (OLDSELE)
CSQL = "select norek from pinjaman_saldo where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF NOREK=MNOREK
CSQL = "UPDATE pinjaman_saldo set "+"sisapokok='"+STR(MSISAPOKOK)+"',"+"sisabunga='"+STR(MSISABUNGA)+"',"+"denda='"+'0'+"',"+"tunggpk='"+STR(MODPK)+"', "+"kalipk='"+STR(MKALIPK)+"', "+"haripk='"+STR(MHARIPK)+"', "+"tunggbg='"+STR(MODBG)+"', "+"kalibg='"+STR(MKALIBG)+"', "+"haribg='"+STR(MHARIBG)+"', "+"tglod='"+SQLDATE(MTGLOD)+"', "+"tglmacet='0000-00-00', "+"kol_awal='"+ALLTRIM(MKOL_AWAL)+"', "+"kol='"+ALLTRIM(MKOLECT)+"', "+"dpk='"+"0"+"', "+"ppap='"+STR(MPPAP)+"', "+"bgakrual='"+"0"+"', "+"kontijensi='"+"0"+"', "+"adm='"+"0"+"', "+"provisi='"+"0"+"', "+"biaya='"+"0"+"', "+"opt='"+DEFAUSERID+"' "+"where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTANGGAL)+"'"
ELSE
CSQL = "insert into pinjaman_saldo (kantor,norek,tanggal,sisapokok,sisabunga,denda,"+"tunggpk,kalipk,haripk,tunggbg,kalibg,haribg,tglod,tglmacet,kol_awal,kol,dpk,"+"ppap,bgakrual,kontijensi,adm,provisi,biaya,opt) value ('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTANGGAL)+"','"+STR(MSISAPOKOK)+"','"+STR(MSISABUNGA)+"','"+"0"+"','"+STR(MODPK)+"','"+STR(MKALIPK)+"','"+STR(MHARIPK)+"','"+STR(MODBG)+"','"+STR(MKALIBG)+"','"+STR(MHARIBG)+"','"+SQLDATE(MTGLOD)+"','"+"0000-00-00"+"','"+ALLTRIM(MKOL_AWAL)+"','"+ALLTRIM(MKOLECT)+"','"+"0"+"','"+STR(MPPAP)+"','"+"0"+"','"+"0"+"','"+"0"+"','"+"0"+"','"+"0"+"','"+DEFAUSERID+"')"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal baca data")
ENDIF
RETURN
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** kolektif.scx
***
*
*
*  kolektif.scx::PINJAMAN
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 10
.BACKCOLOR = RGB(236, 233, 216)
.COLUMN1.WIDTH = 40
.COLUMN1.CONTROLSOURCE = "KDTRANSAKSI"
.COLUMN1.HEADER1.CAPTION = "KD"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 75
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "NO.SLIP"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "NOREK"
.COLUMN3.HEADER1.CAPTION = "NO.REKENING"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 150
.COLUMN4.CONTROLSOURCE = "NAMA"
.COLUMN4.HEADER1.CAPTION = "NAMA"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 120
.COLUMN5.CONTROLSOURCE = "TABUNGAN"
.COLUMN5.HEADER1.CAPTION = "TABUNGAN"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 120
.COLUMN6.CONTROLSOURCE = "POKOK"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "ANGS. POKOK"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN7.WIDTH = 120
.COLUMN7.CONTROLSOURCE = "JASA"
.COLUMN7.INPUTMASK = "999,999,999,999"
.COLUMN7.ALIGNMENT = 1
.COLUMN7.HEADER1.CAPTION = "ANGS. JASA"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN7.INPUTMASK = "999,999,999,999"
.COLUMN8.WIDTH = 120
.COLUMN8.CONTROLSOURCE = "DENDA"
.COLUMN8.INPUTMASK = "999,999,999,999"
.COLUMN8.ALIGNMENT = 1
.COLUMN8.HEADER1.CAPTION = "ANGS. DENDA"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN8.INPUTMASK = "999,999,999,999"
.COLUMN9.WIDTH = 120
.COLUMN9.CONTROLSOURCE = "LAIN"
.COLUMN9.INPUTMASK = "999,999,999,999"
.COLUMN9.ALIGNMENT = 1
.COLUMN9.HEADER1.CAPTION = "LAIN - LAIN"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 10
.COLUMN9.INPUTMASK = "999,999,999,999"
.COLUMN10.WIDTH = 300
.COLUMN10.CONTROLSOURCE = "ALAMAT"
.COLUMN10.HEADER1.CAPTION = "ALAMAT"
.COLUMN10.HEADER1.FONTBOLD = .T.
.COLUMN10.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
IF THISFORM.STATUS="A"
CSQL = "select * from kolektif_hasil where "
ELSE
CSQL = "select * from kolektif_hasil where "
ENDIF
CSQL = CSQL+IIF(EMPTY(THISFORM.MFILTER.CAPTION), "1", THISFORM.MFILTER.CAPTION)
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA)
MNOREK = NOREK
USE
SELECT (THISFORM.OLDSELECT)
RETURN MNOREK
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MSTATUS
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "TAMPIL"
ENDIF
THISFORM.MODE = MMODE
THISFORM.CMDINPUT.ENABLED = IJINMODUL("COL", "INPUT")
THISFORM.CMDEDIT.ENABLED = IJINMODUL("COL", "EDIT")
THISFORM.CMDHAPUS.ENABLED = IJINMODUL("COL", "HAPUS")
THISFORM.CMDDETAIL.ENABLED = IJINMODUL("COL", "LAINNYA")
THISFORM.COMMAND6.ENABLED = IJINMODUL("COL", "CETAK")
THISFORM.OLDSELECT = SELECT()
IF VARTYPE(MSTATUS)="X" .OR. VARTYPE(MSTATUS)="L" .OR. MSTATUS="A"
THISFORM.LABEL2.CAPTION = "DAFTAR PEMBAYARAN KOLEKTIF"
MSTATUS = "A"
ELSE
THISFORM.LABEL2.CAPTION = "DAFTAR PEMBAYARAN KOLEKTIF(HISTORY)"
ENDIF
THISFORM.STATUS = MSTATUS
IF MMODE="TAMPIL"
THISFORM.MFILTER.CAPTION = "tgl='"+SQLDATE(TGLNOW)+"'"
ENDIF
THISFORM.MLIMIT.VALUE = 50
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
*
*  kolektif.scx::Cmdhapus
**
PROCEDURE Click
IF THISFORM.STATUS="A"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat dihapus", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  kolektif.scx::Cmdedit
**
PROCEDURE Click
IF THISFORM.STATUS="A"
MYDATA = THISFORM.DATA
IF KDTRANSAKSI="T"
IF TABUNGAN>=0
DO FORM kolektif_setortab WITH "EDIT"
ELSE
DO FORM kolektif_ambiltab WITH "EDIT"
ENDIF
ELSE
DO FORM kolektif_angsuran WITH "EDIT"
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat dikoreksi", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  kolektif.scx::Cmdinput
**
PROCEDURE Click
IF THISFORM.STATUS="A"
DEFINE POPUP POPUPKOL FROM 5, 1 FONT "Cambria", 12
DEFINE BAR 1 OF POPUPKOL PROMPT '\<1. INPUT PENERIMAAN ANGSURAN'
DEFINE BAR 2 OF POPUPKOL PROMPT '\<2. INPUT PENERIMAAN SIMPANAN'
DEFINE BAR 3 OF POPUPKOL PROMPT '\<3. INPUT PENGAMBILAN SIMPANAN'
ON SELECTION BAR 1 OF POPUPKOL DO FORM KOLEKTIF_ANGSURAN WITH "INPUT"
ON SELECTION BAR 2 OF POPUPKOL DO FORM KOLEKTIF_SETORTAB WITH "INPUT"
ON SELECTION BAR 3 OF POPUPKOL DO FORM KOLEKTIF_AMBILTAB WITH "INPUT"
ACTIVATE POPUP POPUPKOL
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat digunakan untuk input data", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  kolektif.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kolektif.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  kolektif.scx::Cmddatatop1
**
PROCEDURE Click
GOTO TOP
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  kolektif.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(a.cif),TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama),norek,b.tanggal,nopk)"+" LIKE "+UPPER(MFILTER)
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  kolektif.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  kolektif.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  kolektif.scx::Cmddatabott1
**
PROCEDURE Click
GOTO BOTTOM
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  kolektif.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  kolektif.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
IF KDTRANSAKSI="T"
IF TABUNGAN>=0
DO FORM kolektif_setortab WITH "TAMPIL"
ELSE
DO FORM kolektif_ambiltab WITH "TAMPIL"
ENDIF
ELSE
DO FORM kolektif_angsuran WITH "TAMPIL"
ENDIF
KEYBOARD '{LEFTARROW}'
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
*
*  kolektif.scx::Command6
**
PROCEDURE Click
DEFINE POPUP POPUPLAP FROM 5, 43 FONT "Cambria", 10
DEFINE BAR 1 OF POPUPLAP PROMPT 'Cetak Laporan .................. '
DEFINE BAR 2 OF POPUPLAP PROMPT 'Cetak Validasi ......................'
ON SELECTION BAR 1 OF POPUPLAP MESSAGEBOX("111111111111111111111111111")
ON SELECTION BAR 2 OF POPUPLAP MESSAGEBOX("2222222222222222222222222222221")
ACTIVATE POPUP POPUPLAP
ENDPROC
**
*
*  kolektif.scx::CmdDetail
**
PROCEDURE Click
IF KDTRANSAKSI="T"
IF TABUNGAN>=0
DO FORM kolektif_setortab WITH "TAMPIL"
ELSE
DO FORM kolektif_ambiltab WITH "TAMPIL"
ENDIF
ELSE
DO FORM kolektif_angsuran WITH "TAMPIL"
ENDIF
ENDPROC
**
***
*** kolektif.sct
***
*
***
*** kolektif_angsuran.scx
***
*
*
*  kolektif_angsuran.scx::Form1
**
PROCEDURE kosongkan
THISFORM.TEXT1.VALUE = ''
THISFORM.TEXT2.VALUE = ''
THISFORM.TEXT3.VALUE = ''
THISFORM.TEXT4.VALUE = ''
THISFORM.TEXT5.VALUE = ''
THISFORM.TEXT6.VALUE = 0
THISFORM.TEXT7.VALUE = 0
THISFORM.TEXT8.VALUE = 0
THISFORM.TEXT9.VALUE = 0
THISFORM.TEXT10.VALUE = 0
THISFORM.CONTAINER1.TEXT1.VALUE = ''
THISFORM.CONTAINER1.TEXT8.VALUE = ''
THISFORM.CONTAINER1.TEXT2.VALUE = ''
THISFORM.CONTAINER1.TEXT3.VALUE = ''
THISFORM.CONTAINER1.TEXT4.VALUE = 0
THISFORM.CONTAINER1.TEXT5.VALUE = 0
THISFORM.CONTAINER1.TEXT6.VALUE = 0
THISFORM.CONTAINER1.TEXT7.VALUE = 0
ENDPROC
**
PROCEDURE Activate
THISFORM.WINDOWSTATE = 2
ENDPROC
**
PROCEDURE Unload
IF THISFORM.MODE="INPUT"
SHOW POPUP POPUPKOL
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.OLDSELECT = SELECT()
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "INPUT"
ENDIF
THISFORM.MODE = "INPUT"
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = NOREK
THISFORM.COMMAND1.VISIBLE = .F.
IF MMODE="INPUT"
HIDE POPUP POPUPKOL
THISFORM.KOSONGKAN()
THISFORM.CONTAINER1.TEXT3.VALUE = TGLNOW
THISFORM.CONTAINER1.TEXT1.ENABLED = .T.
THISFORM.CONTAINER1.TEXT2.ENABLED = .T.
THISFORM.CONTAINER1.TEXT4.ENABLED = .T.
THISFORM.CONTAINER1.TEXT5.ENABLED = .T.
THISFORM.CONTAINER1.TEXT6.ENABLED = .T.
THISFORM.CONTAINER1.TEXT7.ENABLED = .T.
ELSE
CSQL = "select a.nama,a.alamat,a.kota,b.norek,b.marketing from pinjaman as b, anggota as a where a.cif=b.cif and norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = KOTA
THISFORM.TEXT5.VALUE = MARKETING
USE
SELECT (THISFORM.OLDSELECT)
THISFORM.TEXT6.VALUE = 0
THISFORM.TEXT7.VALUE = 0
THISFORM.TEXT8.VALUE = 0
THISFORM.TEXT9.VALUE = 0
THISFORM.CONTAINER1.TEXT1.VALUE = NOREK
THISFORM.CONTAINER1.TEXT8.VALUE = NAMA
THISFORM.CONTAINER1.TEXT2.VALUE = BUKTI
THISFORM.CONTAINER1.TEXT3.VALUE = TGL
THISFORM.CONTAINER1.TEXT4.VALUE = POKOK+JASA+DENDA
THISFORM.CONTAINER1.TEXT5.VALUE = POKOK
THISFORM.CONTAINER1.TEXT6.VALUE = JASA
THISFORM.CONTAINER1.TEXT7.VALUE = DENDA
ENDIF
DO CASE
CASE MMODE="EDIT"
THISFORM.CONTAINER1.TEXT1.ENABLED = .T.
THISFORM.CONTAINER1.TEXT2.ENABLED = .T.
THISFORM.CONTAINER1.TEXT4.ENABLED = .T.
THISFORM.CONTAINER1.TEXT5.ENABLED = .T.
THISFORM.CONTAINER1.TEXT6.ENABLED = .T.
THISFORM.CONTAINER1.TEXT7.ENABLED = .T.
CASE MMODE="TAMPIL"
THISFORM.CONTAINER1.TEXT1.ENABLED = .F.
THISFORM.CONTAINER1.TEXT2.ENABLED = .F.
THISFORM.CONTAINER1.TEXT4.ENABLED = .F.
THISFORM.CONTAINER1.TEXT5.ENABLED = .F.
THISFORM.CONTAINER1.TEXT6.ENABLED = .F.
THISFORM.CONTAINER1.TEXT7.ENABLED = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  kolektif_angsuran.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kolektif_angsuran.scx::Command3
**
PROCEDURE Click
WITH THISFORM.CONTAINER1
IF THISFORM.MODE="INPUT"
CSQL = "insert into kolektif_hasil (kantor,kodekolektor, kdtransaksi, tgl, bukti, norek, nama,alamat,kode,"+"pokok,jasa,denda, INPOPR) value "+"('"+DEFAKANTOR+"',"+"'"+"KD"+"',"+"'"+"A"+"',"+"'"+SQLDATE(.TEXT3.VALUE)+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+THISFORM.TEXT2.VALUE+"',"+"'"+THISFORM.TEXT3.VALUE+"',"+"'"+"01"+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT6.VALUE)+"',"+"'"+STR(.TEXT7.VALUE)+"',"+"'"+"OPR"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
MIDASAL = IDTRANS
CSQL = "update kolektif_hasil set "+"kodekolektor='"+"KD"+"',"+"kdtransaksi='"+"A"+"',"+"tgl='"+SQLDATE(.TEXT3.VALUE)+"',"+"bukti='"+.TEXT2.VALUE+"',"+"norek='"+.TEXT1.VALUE+"',"+"nama='"+THISFORM.TEXT2.VALUE+"',"+"alamat='"+THISFORM.TEXT3.VALUE+"',"+"kode='"+"01"+"',"+"pokok='"+STR(.TEXT5.VALUE)+"',"+"jasa='"+STR(.TEXT6.VALUE)+"',"+"denda='"+STR(.TEXT7.VALUE)+"',"+"EDTOPR='"+"OPR"+"' where idtrans='"+STR(MIDASAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.RELEASE
RETURN
ENDIF
ENDWITH
THISFORM.KOSONGKAN()
THISFORM.CONTAINER1.TEXT1.SETFOCUS
ENDPROC
**
*
*  kolektif_angsuran.scx::Text1
**
PROCEDURE LostFocus
IF LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
OLDSELECT = SELECT()
MNOREK = THIS.VALUE
IF EMPTY(THIS.VALUE)
DO FORM pinjaman TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
CSQL = "select a.norek,b.nama,b.alamat,b.kota,a.marketing from pinjaman as a, anggota as b where a.cif=b.cif and a.norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = NOREK
MSISAPOKOK = 0
MSISAJASA = 0
MSISADENDA = 0
MANGSPK = 0
MANGSBG = 0
MNAMA = NAMA
MALAMAT = ALAMAT
MKOTA = KOTA
MMARKETING = MARKETING
ADA = IIF(RECCOUNT()>0, .T., .F.)
USE
SELECT (OLDSELECT)
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.TEXT2.VALUE = MNAMA
THISFORM.CONTAINER1.TEXT8.VALUE = MNAMA
THISFORM.TEXT3.VALUE = MALAMAT
THISFORM.TEXT4.VALUE = MKOTA
THISFORM.TEXT5.VALUE = MMARKETING
THISFORM.TEXT6.VALUE = MSISAPOKOK
THISFORM.TEXT7.VALUE = MSISAJASA
THISFORM.TEXT8.VALUE = MSISADENDA
THISFORM.TEXT9.VALUE = MANGSPK
THISFORM.TEXT10.VALUE = MANGSBG
THISFORM.CONTAINER1.TEXT3.VALUE = TGLNOW
IF  .NOT. ADA .OR. EMPTY(THIS.VALUE)
MESSAGEBOX("DATA TIDAK ADA, CEK KEMBALI NOMOR REKENING", 16, "PERINGATAN")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THISFORM.CONTAINER1.TEXT2.VALUE = URUTBUKTI("KAS")
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  kolektif_angsuran.scx::Text7
**
PROCEDURE LostFocus
IF THISFORM.CONTAINER1.TEXT5.VALUE+THISFORM.CONTAINER1.TEXT6.VALUE+THISFORM.CONTAINER1.TEXT7.VALUE<>THISFORM.CONTAINER1.TEXT4.VALUE
MESSAGEBOX("JUMLAH TIDAK SAMA DENGAN RINCIAN PEMBAYARAN", 16, "PERHATIAN")
NODEFAULT
THISFORM.CONTAINER1.TEXT5.SETFOCUS
ENDIF
ENDPROC
**
*
*  kolektif_angsuran.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** kolektif_angsuran.sct
***
*
***
*** kolektif_setortab.scx
***
*
*
*  kolektif_setortab.scx::Form1
**
PROCEDURE kosongkan
THISFORM.TEXT1.VALUE = ''
THISFORM.TEXT2.VALUE = ''
THISFORM.TEXT3.VALUE = ''
THISFORM.TEXT4.VALUE = ''
THISFORM.TEXT5.VALUE = ''
THISFORM.TEXT6.VALUE = 0
THISFORM.TEXT7.VALUE = 0
THISFORM.TEXT8.VALUE = 0
THISFORM.TEXT9.VALUE = 0
THISFORM.CONTAINER1.TEXT1.VALUE = ''
THISFORM.CONTAINER1.TEXT5.VALUE = ''
THISFORM.CONTAINER1.TEXT2.VALUE = ''
THISFORM.CONTAINER1.TEXT3.VALUE = ''
THISFORM.CONTAINER1.TEXT4.VALUE = 0
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.OLDSELECT = SELECT()
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "INPUT"
ENDIF
THISFORM.MODE = "INPUT"
THISFORM.COMMAND1.VISIBLE = .F.
IF MMODE="INPUT"
HIDE POPUP POPUPKOL
THISFORM.KOSONGKAN()
THISFORM.CONTAINER1.TEXT3.VALUE = TGLNOW
THISFORM.CONTAINER1.TEXT1.ENABLED = .T.
THISFORM.CONTAINER1.TEXT2.ENABLED = .T.
THISFORM.CONTAINER1.TEXT4.ENABLED = .T.
ELSE
CSQL = "select a.nama,a.alamat,a.kota,b.norek,b.marketing from simpanan as b, anggota as a where a.cif=b.cif and norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = KOTA
THISFORM.TEXT5.VALUE = MARKETING
USE
SELECT (THISFORM.OLDSELECT)
THISFORM.TEXT6.VALUE = 0
THISFORM.TEXT7.VALUE = 0
THISFORM.TEXT8.VALUE = 0
THISFORM.TEXT9.VALUE = 0
THISFORM.CONTAINER1.TEXT1.VALUE = NOREK
THISFORM.CONTAINER1.TEXT5.VALUE = NAMA
THISFORM.CONTAINER1.TEXT2.VALUE = BUKTI
THISFORM.CONTAINER1.TEXT3.VALUE = TGL
THISFORM.CONTAINER1.TEXT4.VALUE = TABUNGAN
ENDIF
DO CASE
CASE MMODE="EDIT"
THISFORM.CONTAINER1.TEXT1.ENABLED = .T.
THISFORM.CONTAINER1.TEXT2.ENABLED = .T.
THISFORM.CONTAINER1.TEXT4.ENABLED = .T.
CASE MMODE="CARI"
THISFORM.CONTAINER1.TEXT1.ENABLED = .F.
THISFORM.CONTAINER1.TEXT2.ENABLED = .F.
THISFORM.CONTAINER1.TEXT4.ENABLED = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND1.VISIBLE = .T.
ENDCASE
ENDPROC
**
PROCEDURE Unload
IF THISFORM.MODE="INPUT"
SHOW POPUP POPUPKOL
ENDIF
ENDPROC
**
PROCEDURE Activate
THISFORM.WINDOWSTATE = 2
ENDPROC
**
*
*  kolektif_setortab.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kolektif_setortab.scx::Command3
**
PROCEDURE Click
WITH THISFORM.CONTAINER1
IF THISFORM.MODE="INPUT"
CSQL = "insert into kolektif_hasil (kantor,kodekolektor, kdtransaksi, tgl, bukti, norek, nama,alamat,kode, tabungan, INPOPR) value "+"('"+DEFAKANTOR+"',"+"'"+"KD"+"',"+"'"+"T"+"',"+"'"+SQLDATE(.TEXT3.VALUE)+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+THISFORM.TEXT2.VALUE+"',"+"'"+THISFORM.TEXT3.VALUE+"',"+"'"+"01"+"',"+"'"+STR(.TEXT4.VALUE)+"',"+"'"+"OPR"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
MIDASAL = IDTRANS
CSQL = "update kolektif_hasil set "+"kodekolektor='"+"KD"+"',"+"kdtransaksi='"+"T"+"',"+"tgl='"+SQLDATE(.TEXT3.VALUE)+"',"+"bukti='"+.TEXT2.VALUE+"',"+"norek='"+.TEXT1.VALUE+"',"+"nama='"+THISFORM.TEXT2.VALUE+"',"+"alamat='"+THISFORM.TEXT3.VALUE+"',"+"kode='"+"01"+"',"+"tabungan='"+STR(.TEXT4.VALUE)+"',"+"EDTOPR='"+"OPR"+"' where idtrans='"+STR(MIDASAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
ENDIF
THISFORM.RELEASE
RETURN
ENDIF
ENDWITH
THISFORM.KOSONGKAN()
THISFORM.CONTAINER1.TEXT1.SETFOCUS
ENDPROC
**
*
*  kolektif_setortab.scx::Text1
**
PROCEDURE LostFocus
IF LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
OLDSELECT = SELECT()
MNOREK = THIS.VALUE
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
CSQL = "select a.norek,a.saldo,b.nama,b.alamat,b.kota,a.marketing from simpanan as a, anggota as b where a.cif=b.cif and a.norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = NOREK
MSALDO = SALDO
MNAMA = NAMA
MALAMAT = ALAMAT
MKOTA = KOTA
MMARKETING = MARKETING
ADA = IIF(RECCOUNT()>0, .T., .F.)
USE
SELECT (OLDSELECT)
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.TEXT2.VALUE = MNAMA
THISFORM.CONTAINER1.TEXT5.VALUE = MNAMA
THISFORM.TEXT3.VALUE = MALAMAT
THISFORM.TEXT4.VALUE = MKOTA
THISFORM.TEXT5.VALUE = MMARKETING
THISFORM.TEXT6.VALUE = MSALDO
THISFORM.CONTAINER1.TEXT3.VALUE = TGLNOW
IF  .NOT. ADA .OR. EMPTY(THIS.VALUE)
MESSAGEBOX("DATA TIDAK ADA, CEK KEMBALI NOMOR REKENING", 16, "PERINGATAN")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THISFORM.CONTAINER1.TEXT2.VALUE = URUTBUKTI("KAS")
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  kolektif_setortab.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** kolektif_setortab.sct
***
*
***
*** kolektif_ambiltab.scx
***
*
*
*  kolektif_ambiltab.scx::Form1
**
PROCEDURE kosongkan
THISFORM.TEXT1.VALUE = ''
THISFORM.TEXT2.VALUE = ''
THISFORM.TEXT3.VALUE = ''
THISFORM.TEXT4.VALUE = ''
THISFORM.TEXT5.VALUE = ''
THISFORM.TEXT6.VALUE = 0
THISFORM.TEXT7.VALUE = 0
THISFORM.TEXT8.VALUE = 0
THISFORM.TEXT9.VALUE = 0
THISFORM.CONTAINER1.TEXT1.VALUE = ''
THISFORM.CONTAINER1.TEXT5.VALUE = ''
THISFORM.CONTAINER1.TEXT2.VALUE = ''
THISFORM.CONTAINER1.TEXT3.VALUE = ''
THISFORM.CONTAINER1.TEXT4.VALUE = 0
ENDPROC
**
PROCEDURE Unload
IF THISFORM.MODE="INPUT"
SHOW POPUP POPUPKOL
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.OLDSELECT = SELECT()
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "INPUT"
ENDIF
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = NOREK
THISFORM.COMMAND1.VISIBLE = .F.
IF MMODE="INPUT"
HIDE POPUP POPUPKOL
THISFORM.KOSONGKAN()
THISFORM.CONTAINER1.TEXT3.VALUE = TGLNOW
THISFORM.CONTAINER1.TEXT1.ENABLED = .T.
THISFORM.CONTAINER1.TEXT2.ENABLED = .T.
THISFORM.CONTAINER1.TEXT4.ENABLED = .T.
ELSE
CSQL = "select a.nama,a.alamat,a.kota,b.norek,b.marketing from simpanan as b, anggota as a where a.cif=b.cif and norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = KOTA
THISFORM.TEXT5.VALUE = MARKETING
USE
SELECT (THISFORM.OLDSELECT)
THISFORM.TEXT6.VALUE = 0
THISFORM.TEXT7.VALUE = 0
THISFORM.TEXT8.VALUE = 0
THISFORM.TEXT9.VALUE = 0
THISFORM.CONTAINER1.TEXT1.VALUE = NOREK
THISFORM.CONTAINER1.TEXT5.VALUE = NAMA
THISFORM.CONTAINER1.TEXT2.VALUE = BUKTI
THISFORM.CONTAINER1.TEXT3.VALUE = TGL
THISFORM.CONTAINER1.TEXT4.VALUE = 0-TABUNGAN
ENDIF
DO CASE
CASE MMODE="EDIT"
THISFORM.CONTAINER1.TEXT1.ENABLED = .T.
THISFORM.CONTAINER1.TEXT2.ENABLED = .T.
THISFORM.CONTAINER1.TEXT4.ENABLED = .T.
CASE MMODE="CARI"
THISFORM.CONTAINER1.TEXT1.ENABLED = .F.
THISFORM.CONTAINER1.TEXT2.ENABLED = .F.
THISFORM.CONTAINER1.TEXT4.ENABLED = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Activate
THISFORM.WINDOWSTATE = 2
ENDPROC
**
*
*  kolektif_ambiltab.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kolektif_ambiltab.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kolektif_ambiltab.scx::Command3
**
PROCEDURE Click
WITH THISFORM.CONTAINER1
IF THISFORM.MODE="INPUT"
CSQL = "insert into kolektif_hasil (kantor,kodekolektor, kdtransaksi, tgl, bukti, norek, nama,alamat,kode, tabungan, INPOPR) value "+"('"+DEFAKANTOR+"',"+"'"+"KD"+"',"+"'"+"T"+"',"+"'"+SQLDATE(.TEXT3.VALUE)+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+THISFORM.TEXT2.VALUE+"',"+"'"+THISFORM.TEXT3.VALUE+"',"+"'"+"01"+"',"+"'"+STR(0-.TEXT4.VALUE)+"',"+"'"+"OPR"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
MIDASAL = IDTRANS
CSQL = "update kolektif_hasil set "+"kodekolektor='"+"KD"+"',"+"kdtransaksi='"+"T"+"',"+"tgl='"+SQLDATE(.TEXT3.VALUE)+"',"+"bukti='"+.TEXT2.VALUE+"',"+"norek='"+.TEXT1.VALUE+"',"+"nama='"+THISFORM.TEXT2.VALUE+"',"+"alamat='"+THISFORM.TEXT3.VALUE+"',"+"kode='"+"01"+"',"+"tabungan='"+STR(0-.TEXT4.VALUE)+"',"+"EDTOPR='"+"OPR"+"' where idtrans='"+STR(MIDASAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
ENDIF
THISFORM.RELEASE
RETURN
ENDIF
ENDWITH
THISFORM.KOSONGKAN()
THISFORM.CONTAINER1.TEXT1.SETFOCUS
ENDPROC
**
*
*  kolektif_ambiltab.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
OLDSELECT = SELECT()
MNOREK = THIS.VALUE
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
CSQL = "select a.norek,a.saldo,b.nama,b.alamat,b.kota,a.marketing from simpanan as a, anggota as b where a.cif=b.cif and a.norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOREK = NOREK
MSALDO = SALDO
MNAMA = NAMA
MALAMAT = ALAMAT
MKOTA = KOTA
MMARKETING = MARKETING
ADA = IIF(RECCOUNT()>0, .T., .F.)
USE
SELECT (OLDSELECT)
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.TEXT2.VALUE = MNAMA
THISFORM.CONTAINER1.TEXT5.VALUE = MNAMA
THISFORM.TEXT3.VALUE = MALAMAT
THISFORM.TEXT4.VALUE = MKOTA
THISFORM.TEXT5.VALUE = MMARKETING
THISFORM.TEXT6.VALUE = MSALDO
THISFORM.CONTAINER1.TEXT3.VALUE = TGLNOW
IF  .NOT. ADA .OR. EMPTY(THIS.VALUE)
MESSAGEBOX("DATA TIDAK ADA, CEK KEMBALI NOMOR REKENING", 16, "PERINGATAN")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THISFORM.CONTAINER1.TEXT2.VALUE = URUTBUKTI("KAS")
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
***
*** kolektif_ambiltab.sct
***
*
***
*** data_variabel.scx
***
*
*
*  data_variabel.scx::Form1
**
PROCEDURE Init
MCUR = SELECT()
CREATE CURSOR VAR1 (FILENAME C (30), FTYPE C (20), UKURAN N (9))
SELECT (MCUR)
FOR A = 1 TO FCOUNT()
MNAMAFIELD = FIELD(A)
MTYPE = VARTYPE(FIELD(A))
MLEBAR = FSIZE(FIELD(A))
MTYPE = IIF(MTYPE="C", "CARACTER", IIF(MTYPE="D", "TANGGAL", IIF(MTYPE="N", "NUMERIC", "MEMO")))
SELECT VAR1
APPEND BLANK
REPLACE FILENAME WITH MNAMAFIELD, FTYPE WITH MTYPE, UKURAN WITH MLEBAR
SELECT (MCUR)
ENDFOR
THISFORM.GRID1.RECORDSOURCE = "var1"
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 150
.COLUMN1.CONTROLSOURCE = "filename"
.COLUMN1.HEADER1.CAPTION = "NAMA VARIABEL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 100
.COLUMN2.CONTROLSOURCE = "ftype"
.COLUMN2.HEADER1.CAPTION = "TYPE VARIABEL"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 80
.COLUMN3.CONTROLSOURCE = "ukuran"
.COLUMN3.HEADER1.CAPTION = "LEBAR DATA"
.COLUMN3.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.REFRESH
ENDPROC
**
***
*** data_variabel.sct
***
*
***
*** atur_hakakses.scx
***
*
*
*  atur_hakakses.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE9.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE8.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE7.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT16.VALUE = "KAS MASUK"
THISFORM.LABEL14.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE8.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE7.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT16.VALUE = "KAS KELUAR"
THISFORM.LABEL14.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
PROCEDURE bacadata
MKD = THISFORM.NOID
MDATA = THISFORM.DATA1
CSQL = "select *,md5(id) as kode from user_group where md5(id)=md5("+ALLTRIM(STR(MKD))+")"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampil
THISFORM.TEXT1.VALUE = NAMAGROUP
THISFORM.OPTIONGROUP1.VALUE = SETING
THISFORM.OPTIONGROUP2.VALUE = MASTER
THISFORM.OPTIONGROUP3.VALUE = TRANSAKSI
THISFORM.OPTIONGROUP4.VALUE = LAPORAN
THISFORM.OPTIONGROUP5.VALUE = PROSES
THISFORM.OPTIONGROUP6.VALUE = UTILITY
THISFORM.ANGG0.VALUE = VAL(SUBSTR(M_ANGGOTA, 1, 1))
THISFORM.ANGG1.VALUE = VAL(SUBSTR(M_ANGGOTA, 2, 1))
THISFORM.ANGG2.VALUE = VAL(SUBSTR(M_ANGGOTA, 3, 1))
THISFORM.ANGG3.VALUE = VAL(SUBSTR(M_ANGGOTA, 4, 1))
THISFORM.ANGG4.VALUE = VAL(SUBSTR(M_ANGGOTA, 5, 1))
THISFORM.ANGG5.VALUE = VAL(SUBSTR(M_ANGGOTA, 6, 1))
THISFORM.ANGG6.VALUE = VAL(SUBSTR(M_ANGGOTA, 7, 1))
THISFORM.SIMP0.VALUE = VAL(SUBSTR(M_SIMPANAN, 1, 1))
THISFORM.SIMP1.VALUE = VAL(SUBSTR(M_SIMPANAN, 2, 1))
THISFORM.SIMP2.VALUE = VAL(SUBSTR(M_SIMPANAN, 3, 1))
THISFORM.SIMP3.VALUE = VAL(SUBSTR(M_SIMPANAN, 4, 1))
THISFORM.SIMP4.VALUE = VAL(SUBSTR(M_SIMPANAN, 5, 1))
THISFORM.SIMP5.VALUE = VAL(SUBSTR(M_SIMPANAN, 6, 1))
THISFORM.SIMP6.VALUE = VAL(SUBSTR(M_SIMPANAN, 7, 1))
THISFORM.PINJ0.VALUE = VAL(SUBSTR(M_PINJAMAN, 1, 1))
THISFORM.PINJ1.VALUE = VAL(SUBSTR(M_PINJAMAN, 2, 1))
THISFORM.PINJ2.VALUE = VAL(SUBSTR(M_PINJAMAN, 3, 1))
THISFORM.PINJ3.VALUE = VAL(SUBSTR(M_PINJAMAN, 4, 1))
THISFORM.PINJ4.VALUE = VAL(SUBSTR(M_PINJAMAN, 5, 1))
THISFORM.PINJ5.VALUE = VAL(SUBSTR(M_PINJAMAN, 6, 1))
THISFORM.PINJ6.VALUE = VAL(SUBSTR(M_PINJAMAN, 7, 1))
THISFORM.KAS0.VALUE = VAL(SUBSTR(M_KASIR, 1, 1))
THISFORM.KAS1.VALUE = VAL(SUBSTR(M_KASIR, 2, 1))
THISFORM.KAS2.VALUE = VAL(SUBSTR(M_KASIR, 3, 1))
THISFORM.KAS3.VALUE = VAL(SUBSTR(M_KASIR, 4, 1))
THISFORM.KAS4.VALUE = VAL(SUBSTR(M_KASIR, 5, 1))
THISFORM.KAS5.VALUE = VAL(SUBSTR(M_KASIR, 6, 1))
THISFORM.KAS6.VALUE = VAL(SUBSTR(M_KASIR, 7, 1))
THISFORM.AKT0.VALUE = VAL(SUBSTR(M_AKUNTANSI, 1, 1))
THISFORM.AKT1.VALUE = VAL(SUBSTR(M_AKUNTANSI, 2, 1))
THISFORM.AKT2.VALUE = VAL(SUBSTR(M_AKUNTANSI, 3, 1))
THISFORM.AKT3.VALUE = VAL(SUBSTR(M_AKUNTANSI, 4, 1))
THISFORM.AKT4.VALUE = VAL(SUBSTR(M_AKUNTANSI, 5, 1))
THISFORM.AKT5.VALUE = VAL(SUBSTR(M_AKUNTANSI, 6, 1))
THISFORM.AKT6.VALUE = VAL(SUBSTR(M_AKUNTANSI, 7, 1))
THISFORM.COL0.VALUE = VAL(SUBSTR(M_KOLEKTOR, 1, 1))
THISFORM.COL1.VALUE = VAL(SUBSTR(M_KOLEKTOR, 2, 1))
THISFORM.COL2.VALUE = VAL(SUBSTR(M_KOLEKTOR, 3, 1))
THISFORM.COL3.VALUE = VAL(SUBSTR(M_KOLEKTOR, 4, 1))
THISFORM.COL4.VALUE = VAL(SUBSTR(M_KOLEKTOR, 5, 1))
THISFORM.COL5.VALUE = VAL(SUBSTR(M_KOLEKTOR, 6, 1))
THISFORM.COL6.VALUE = VAL(SUBSTR(M_KOLEKTOR, 7, 1))
THISFORM.USER0.VALUE = VAL(SUBSTR(M_USER, 1, 1))
THISFORM.USER1.VALUE = VAL(SUBSTR(M_USER, 2, 1))
THISFORM.USER2.VALUE = VAL(SUBSTR(M_USER, 3, 1))
THISFORM.USER3.VALUE = VAL(SUBSTR(M_USER, 4, 1))
THISFORM.USER4.VALUE = VAL(SUBSTR(M_USER, 5, 1))
THISFORM.USER5.VALUE = VAL(SUBSTR(M_USER, 6, 1))
THISFORM.USER6.VALUE = VAL(SUBSTR(M_USER, 7, 1))
THISFORM.SET0.VALUE = VAL(SUBSTR(M_SETTING, 1, 1))
THISFORM.SET1.VALUE = VAL(SUBSTR(M_SETTING, 2, 1))
THISFORM.SET2.VALUE = VAL(SUBSTR(M_SETTING, 3, 1))
THISFORM.SET3.VALUE = VAL(SUBSTR(M_SETTING, 4, 1))
THISFORM.SET4.VALUE = VAL(SUBSTR(M_SETTING, 5, 1))
THISFORM.SET5.VALUE = VAL(SUBSTR(M_SETTING, 6, 1))
THISFORM.SET6.VALUE = VAL(SUBSTR(M_SETTING, 7, 1))
THISFORM.OPTIONGROUP7.VALUE = R_ANGGOTA
THISFORM.OPTIONGROUP8.VALUE = R_SIMPANAN
THISFORM.OPTIONGROUP9.VALUE = R_PINJAMAN
THISFORM.OPTIONGROUP10.VALUE = R_KASIR
THISFORM.OPTIONGROUP11.VALUE = R_AKUNTANSI
THISFORM.OPTIONGROUP12.VALUE = R_LAIN
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.NOID = ID
THISFORM.OLDSELECT = SELECT()
THISFORM.DATA1 = SYS(2015)
THISFORM.MODE = MMODE
THISFORM.BACADATA()
THISFORM.TAMPIL()
IF MMODE="TAMPIL"
THISFORM.SETALL("enabled", .F., "optiongroup")
THISFORM.SETALL("enabled", .F., "checkbox")
THISFORM.TEXT1.ENABLED = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.CAPTION = "OK"
ENDIF
IF MMODE="INPUT"
THISFORM.TEXT1.VALUE = ''
THISFORM.SETALL("value", 2, "optiongroup")
THISFORM.SETALL("value", 0, "checkbox")
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  atur_hakakses.scx::Command3
**
PROCEDURE Click
MEDIT = THISFORM.MODE
IF MEDIT="TAMPIL"
THISFORM.RELEASE
ENDIF
IF MEDIT="INPUT"
CSQL = "insert into user_group (kantor,namagroup,"+"seting,master,transaksi, laporan, proses, utility,"+"m_anggota, m_simpanan, m_pinjaman, m_kasir, m_akuntansi, m_kolektor,m_user,m_setting,"+"r_anggota, r_simpanan, r_pinjaman, r_kasir, r_akuntansi, r_lain) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP1.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP2.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP3.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP4.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP5.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP6.VALUE))+"','"+ALLTRIM(STR(THISFORM.ANGG0.VALUE))+ALLTRIM(STR(THISFORM.ANGG1.VALUE))+ALLTRIM(STR(THISFORM.ANGG2.VALUE))+ALLTRIM(STR(THISFORM.ANGG3.VALUE))+ALLTRIM(STR(THISFORM.ANGG4.VALUE))+ALLTRIM(STR(THISFORM.ANGG5.VALUE))+ALLTRIM(STR(THISFORM.ANGG6.VALUE))+"','"+ALLTRIM(STR(THISFORM.SIMP0.VALUE))+ALLTRIM(STR(THISFORM.SIMP1.VALUE))+ALLTRIM(STR(THISFORM.SIMP2.VALUE))+ALLTRIM(STR(THISFORM.SIMP3.VALUE))+ALLTRIM(STR(THISFORM.SIMP4.VALUE))+ALLTRIM(STR(THISFORM.SIMP5.VALUE))+ALLTRIM(STR(THISFORM.SIMP6.VALUE))+"','"+ALLTRIM(STR(THISFORM.PINJ0.VALUE))+ALLTRIM(STR(THISFORM.PINJ1.VALUE))+ALLTRIM(STR(THISFORM.PINJ2.VALUE))+ALLTRIM(STR(THISFORM.PINJ3.VALUE))+ALLTRIM(STR(THISFORM.PINJ4.VALUE))+ALLTRIM(STR(THISFORM.PINJ5.VALUE))+ALLTRIM(STR(THISFORM.PINJ6.VALUE))+"','"+ALLTRIM(STR(THISFORM.KAS0.VALUE))+ALLTRIM(STR(THISFORM.KAS1.VALUE))+ALLTRIM(STR(THISFORM.KAS2.VALUE))+ALLTRIM(STR(THISFORM.KAS3.VALUE))+ALLTRIM(STR(THISFORM.KAS4.VALUE))+ALLTRIM(STR(THISFORM.KAS5.VALUE))+ALLTRIM(STR(THISFORM.KAS6.VALUE))+"','"+ALLTRIM(STR(THISFORM.AKT0.VALUE))+ALLTRIM(STR(THISFORM.AKT1.VALUE))+ALLTRIM(STR(THISFORM.AKT2.VALUE))+ALLTRIM(STR(THISFORM.AKT3.VALUE))+ALLTRIM(STR(THISFORM.AKT4.VALUE))+ALLTRIM(STR(THISFORM.AKT5.VALUE))+ALLTRIM(STR(THISFORM.AKT6.VALUE))+"','"+ALLTRIM(STR(THISFORM.COL0.VALUE))+ALLTRIM(STR(THISFORM.COL1.VALUE))+ALLTRIM(STR(THISFORM.COL2.VALUE))+ALLTRIM(STR(THISFORM.COL3.VALUE))+ALLTRIM(STR(THISFORM.COL4.VALUE))+ALLTRIM(STR(THISFORM.COL5.VALUE))+ALLTRIM(STR(THISFORM.COL6.VALUE))+"','"+ALLTRIM(STR(THISFORM.USER0.VALUE))+ALLTRIM(STR(THISFORM.USER1.VALUE))+ALLTRIM(STR(THISFORM.USER2.VALUE))+ALLTRIM(STR(THISFORM.USER3.VALUE))+ALLTRIM(STR(THISFORM.USER4.VALUE))+ALLTRIM(STR(THISFORM.USER5.VALUE))+ALLTRIM(STR(THISFORM.USER6.VALUE))+"','"+ALLTRIM(STR(THISFORM.SET0.VALUE))+ALLTRIM(STR(THISFORM.SET1.VALUE))+ALLTRIM(STR(THISFORM.SET2.VALUE))+ALLTRIM(STR(THISFORM.SET3.VALUE))+ALLTRIM(STR(THISFORM.SET4.VALUE))+ALLTRIM(STR(THISFORM.SET5.VALUE))+ALLTRIM(STR(THISFORM.SET6.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP7.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP8.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP9.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP10.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP11.VALUE))+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP12.VALUE))+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "update user_group set "+"namagroup='"+THISFORM.TEXT1.VALUE+"', seting='"+ALLTRIM(STR(THISFORM.OPTIONGROUP1.VALUE))+"', master='"+ALLTRIM(STR(THISFORM.OPTIONGROUP2.VALUE))+"', transaksi='"+ALLTRIM(STR(THISFORM.OPTIONGROUP3.VALUE))+"', laporan='"+ALLTRIM(STR(THISFORM.OPTIONGROUP4.VALUE))+"', proses='"+ALLTRIM(STR(THISFORM.OPTIONGROUP5.VALUE))+"', utility='"+ALLTRIM(STR(THISFORM.OPTIONGROUP6.VALUE))+"', m_anggota='"+ALLTRIM(STR(THISFORM.ANGG0.VALUE))+ALLTRIM(STR(THISFORM.ANGG1.VALUE))+ALLTRIM(STR(THISFORM.ANGG2.VALUE))+ALLTRIM(STR(THISFORM.ANGG3.VALUE))+ALLTRIM(STR(THISFORM.ANGG4.VALUE))+ALLTRIM(STR(THISFORM.ANGG5.VALUE))+ALLTRIM(STR(THISFORM.ANGG6.VALUE))+"', m_simpanan='"+ALLTRIM(STR(THISFORM.SIMP0.VALUE))+ALLTRIM(STR(THISFORM.SIMP1.VALUE))+ALLTRIM(STR(THISFORM.SIMP2.VALUE))+ALLTRIM(STR(THISFORM.SIMP3.VALUE))+ALLTRIM(STR(THISFORM.SIMP4.VALUE))+ALLTRIM(STR(THISFORM.SIMP5.VALUE))+ALLTRIM(STR(THISFORM.SIMP6.VALUE))+"', m_pinjaman='"+ALLTRIM(STR(THISFORM.PINJ0.VALUE))+ALLTRIM(STR(THISFORM.PINJ1.VALUE))+ALLTRIM(STR(THISFORM.PINJ2.VALUE))+ALLTRIM(STR(THISFORM.PINJ3.VALUE))+ALLTRIM(STR(THISFORM.PINJ4.VALUE))+ALLTRIM(STR(THISFORM.PINJ5.VALUE))+ALLTRIM(STR(THISFORM.PINJ6.VALUE))+"', m_kasir='"+ALLTRIM(STR(THISFORM.KAS0.VALUE))+ALLTRIM(STR(THISFORM.KAS1.VALUE))+ALLTRIM(STR(THISFORM.KAS2.VALUE))+ALLTRIM(STR(THISFORM.KAS3.VALUE))+ALLTRIM(STR(THISFORM.KAS4.VALUE))+ALLTRIM(STR(THISFORM.KAS5.VALUE))+ALLTRIM(STR(THISFORM.KAS6.VALUE))+"', m_akuntansi='"+ALLTRIM(STR(THISFORM.AKT0.VALUE))+ALLTRIM(STR(THISFORM.AKT1.VALUE))+ALLTRIM(STR(THISFORM.AKT2.VALUE))+ALLTRIM(STR(THISFORM.AKT3.VALUE))+ALLTRIM(STR(THISFORM.AKT4.VALUE))+ALLTRIM(STR(THISFORM.AKT5.VALUE))+ALLTRIM(STR(THISFORM.AKT6.VALUE))+"', m_kolektor='"+ALLTRIM(STR(THISFORM.COL0.VALUE))+ALLTRIM(STR(THISFORM.COL1.VALUE))+ALLTRIM(STR(THISFORM.COL2.VALUE))+ALLTRIM(STR(THISFORM.COL3.VALUE))+ALLTRIM(STR(THISFORM.COL4.VALUE))+ALLTRIM(STR(THISFORM.COL5.VALUE))+ALLTRIM(STR(THISFORM.COL6.VALUE))+"', m_user='"+ALLTRIM(STR(THISFORM.USER0.VALUE))+ALLTRIM(STR(THISFORM.USER1.VALUE))+ALLTRIM(STR(THISFORM.USER2.VALUE))+ALLTRIM(STR(THISFORM.USER3.VALUE))+ALLTRIM(STR(THISFORM.USER4.VALUE))+ALLTRIM(STR(THISFORM.USER5.VALUE))+ALLTRIM(STR(THISFORM.USER6.VALUE))+"', m_setting='"+ALLTRIM(STR(THISFORM.SET0.VALUE))+ALLTRIM(STR(THISFORM.SET1.VALUE))+ALLTRIM(STR(THISFORM.SET2.VALUE))+ALLTRIM(STR(THISFORM.SET3.VALUE))+ALLTRIM(STR(THISFORM.SET4.VALUE))+ALLTRIM(STR(THISFORM.SET5.VALUE))+ALLTRIM(STR(THISFORM.SET6.VALUE))+"',r_anggota='"+ALLTRIM(STR(THISFORM.OPTIONGROUP7.VALUE))+"', r_simpanan='"+ALLTRIM(STR(THISFORM.OPTIONGROUP8.VALUE))+"', r_pinjaman='"+ALLTRIM(STR(THISFORM.OPTIONGROUP9.VALUE))+"', r_kasir='"+ALLTRIM(STR(THISFORM.OPTIONGROUP10.VALUE))+"',r_akuntansi='"+ALLTRIM(STR(THISFORM.OPTIONGROUP11.VALUE))+"',r_lain='"+ALLTRIM(STR(THISFORM.OPTIONGROUP12.VALUE))+"' where id=?id"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(LCEK)
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  atur_hakakses.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  atur_hakakses.scx::angg
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.ANGG1.VALUE = 1
THISFORM.ANGG2.VALUE = 1
THISFORM.ANGG3.VALUE = 1
THISFORM.ANGG4.VALUE = 1
THISFORM.ANGG5.VALUE = 1
THISFORM.ANGG6.VALUE = 1
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::simp
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.SIMP1.VALUE = 1
THISFORM.SIMP2.VALUE = 1
THISFORM.SIMP3.VALUE = 1
THISFORM.SIMP4.VALUE = 1
THISFORM.SIMP5.VALUE = 1
THISFORM.SIMP6.VALUE = 1
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::pinj
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.PINJ1.VALUE = 1
THISFORM.PINJ2.VALUE = 1
THISFORM.PINJ3.VALUE = 1
THISFORM.PINJ4.VALUE = 1
THISFORM.PINJ5.VALUE = 1
THISFORM.PINJ6.VALUE = 1
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::mkas
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.KAS1.VALUE = 1
THISFORM.KAS2.VALUE = 1
THISFORM.KAS3.VALUE = 1
THISFORM.KAS4.VALUE = 1
THISFORM.KAS5.VALUE = 1
THISFORM.KAS6.VALUE = 1
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::akt
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.AKT1.VALUE = 1
THISFORM.AKT2.VALUE = 1
THISFORM.AKT3.VALUE = 1
THISFORM.AKT4.VALUE = 1
THISFORM.AKT5.VALUE = 1
THISFORM.AKT6.VALUE = 1
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::col
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.COL1.VALUE = 1
THISFORM.COL2.VALUE = 1
THISFORM.COL3.VALUE = 1
THISFORM.COL4.VALUE = 1
THISFORM.COL5.VALUE = 1
THISFORM.COL6.VALUE = 1
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::Text1
**
PROCEDURE LostFocus
OLDSELECT = SELECT()
IF THISFORM.MODE="INPUT"
CSQL = "select namagroup from user_group where namagroup='"+ALLTRIM(THIS.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT0")
MNAMA = NAMAGROUP
USE
SELECT (OLDSELECT)
IF MNAMA=ALLTRIM(THIS.VALUE)
MESSAGEBOX("Nama Group Sudah ada, buat dengan nama group yang berbeda", 64, "")
NODEFAULT
RETURN
ENDIF
IF ALLTRIM(THIS.VALUE)="ADMIN"
THISFORM.SETALL("value", 1, "optiongroup")
THISFORM.SETALL("value", 1, "checkbox")
ENDIF
ENDIF
IF THISFORM.MODE="EDIT" .AND. THIS.VALUE<>NAMAGROUP
CSQL = "select namagroup from user_group where namagroup='"+ALLTRIM(THIS.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT0")
MNAMA = NAMAGROUP
USE
SELECT (OLDSELECT)
IF MNAMA=ALLTRIM(THIS.VALUE)
MESSAGEBOX("Nama Group Sudah ada, buat dengan nama group yang berbeda", 64, "")
NODEFAULT
RETURN
ENDIF
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::user
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.USER1.VALUE = 1
THISFORM.USER2.VALUE = 1
THISFORM.USER3.VALUE = 1
THISFORM.USER4.VALUE = 1
THISFORM.USER5.VALUE = 1
THISFORM.USER6.VALUE = 1
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::set
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.SET1.VALUE = 1
THISFORM.SET2.VALUE = 1
THISFORM.SET3.VALUE = 1
THISFORM.SET4.VALUE = 1
THISFORM.SET5.VALUE = 1
THISFORM.SET6.VALUE = 1
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::angg0
**
PROCEDURE InteractiveChange
IF THIS.VALUE=0
THISFORM.ANGG.ENABLED = .F.
THISFORM.ANGG1.ENABLED = .F.
THISFORM.ANGG2.ENABLED = .F.
THISFORM.ANGG3.ENABLED = .F.
THISFORM.ANGG4.ENABLED = .F.
THISFORM.ANGG5.ENABLED = .F.
THISFORM.ANGG6.ENABLED = .F.
ELSE
THISFORM.ANGG.ENABLED = .T.
THISFORM.ANGG1.ENABLED = .T.
THISFORM.ANGG2.ENABLED = .T.
THISFORM.ANGG3.ENABLED = .T.
THISFORM.ANGG4.ENABLED = .T.
THISFORM.ANGG5.ENABLED = .T.
THISFORM.ANGG6.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::simp0
**
PROCEDURE InteractiveChange
IF THIS.VALUE=0
THISFORM.SIMP.ENABLED = .F.
THISFORM.SIMP1.ENABLED = .F.
THISFORM.SIMP2.ENABLED = .F.
THISFORM.SIMP3.ENABLED = .F.
THISFORM.SIMP4.ENABLED = .F.
THISFORM.SIMP5.ENABLED = .F.
THISFORM.SIMP6.ENABLED = .F.
ELSE
THISFORM.SIMP.ENABLED = .T.
THISFORM.SIMP1.ENABLED = .T.
THISFORM.SIMP2.ENABLED = .T.
THISFORM.SIMP3.ENABLED = .T.
THISFORM.SIMP4.ENABLED = .T.
THISFORM.SIMP5.ENABLED = .T.
THISFORM.SIMP6.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::pinj0
**
PROCEDURE InteractiveChange
IF THIS.VALUE=0
THISFORM.PINJ.ENABLED = .F.
THISFORM.PINJ1.ENABLED = .F.
THISFORM.PINJ2.ENABLED = .F.
THISFORM.PINJ3.ENABLED = .F.
THISFORM.PINJ4.ENABLED = .F.
THISFORM.PINJ5.ENABLED = .F.
THISFORM.PINJ6.ENABLED = .F.
ELSE
THISFORM.PINJ.ENABLED = .T.
THISFORM.PINJ1.ENABLED = .T.
THISFORM.PINJ2.ENABLED = .T.
THISFORM.PINJ3.ENABLED = .T.
THISFORM.PINJ4.ENABLED = .T.
THISFORM.PINJ5.ENABLED = .T.
THISFORM.PINJ6.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::kas0
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.MKAS.ENABLED = .T.
THISFORM.KAS1.ENABLED = .T.
THISFORM.KAS2.ENABLED = .T.
THISFORM.KAS3.ENABLED = .T.
THISFORM.KAS4.ENABLED = .T.
THISFORM.KAS5.ENABLED = .T.
THISFORM.KAS6.ENABLED = .T.
ELSE
THISFORM.MKAS.ENABLED = .F.
THISFORM.KAS1.ENABLED = .F.
THISFORM.KAS2.ENABLED = .F.
THISFORM.KAS3.ENABLED = .F.
THISFORM.KAS4.ENABLED = .F.
THISFORM.KAS5.ENABLED = .F.
THISFORM.KAS6.ENABLED = .F.
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::akt0
**
PROCEDURE InteractiveChange
IF THIS.VALUE=0
THISFORM.AKT.ENABLED = .F.
THISFORM.AKT1.ENABLED = .F.
THISFORM.AKT2.ENABLED = .F.
THISFORM.AKT3.ENABLED = .F.
THISFORM.AKT4.ENABLED = .F.
THISFORM.AKT5.ENABLED = .F.
THISFORM.AKT6.ENABLED = .F.
ELSE
THISFORM.AKT.ENABLED = .T.
THISFORM.AKT1.ENABLED = .T.
THISFORM.AKT2.ENABLED = .T.
THISFORM.AKT3.ENABLED = .T.
THISFORM.AKT4.ENABLED = .T.
THISFORM.AKT5.ENABLED = .T.
THISFORM.AKT6.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::col0
**
PROCEDURE InteractiveChange
IF THIS.VALUE=0
THISFORM.COL.ENABLED = .F.
THISFORM.COL1.ENABLED = .F.
THISFORM.COL2.ENABLED = .F.
THISFORM.COL3.ENABLED = .F.
THISFORM.COL4.ENABLED = .F.
THISFORM.COL5.ENABLED = .F.
THISFORM.COL6.ENABLED = .F.
ELSE
THISFORM.COL.ENABLED = .T.
THISFORM.COL1.ENABLED = .T.
THISFORM.COL2.ENABLED = .T.
THISFORM.COL3.ENABLED = .T.
THISFORM.COL4.ENABLED = .T.
THISFORM.COL5.ENABLED = .T.
THISFORM.COL6.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::user0
**
PROCEDURE InteractiveChange
IF THIS.VALUE=0
THISFORM.USER.ENABLED = .F.
THISFORM.USER1.ENABLED = .F.
THISFORM.USER2.ENABLED = .F.
THISFORM.USER3.ENABLED = .F.
THISFORM.USER4.ENABLED = .F.
THISFORM.USER5.ENABLED = .F.
THISFORM.USER6.ENABLED = .F.
ELSE
THISFORM.USER.ENABLED = .T.
THISFORM.USER1.ENABLED = .T.
THISFORM.USER2.ENABLED = .T.
THISFORM.USER3.ENABLED = .T.
THISFORM.USER4.ENABLED = .T.
THISFORM.USER5.ENABLED = .T.
THISFORM.USER6.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  atur_hakakses.scx::set0
**
PROCEDURE InteractiveChange
IF THIS.VALUE=0
THISFORM.SET.ENABLED = .F.
THISFORM.SET1.ENABLED = .F.
THISFORM.SET2.ENABLED = .F.
THISFORM.SET3.ENABLED = .F.
THISFORM.SET4.ENABLED = .F.
THISFORM.SET5.ENABLED = .F.
THISFORM.SET6.ENABLED = .F.
ELSE
THISFORM.SET.ENABLED = .T.
THISFORM.SET1.ENABLED = .T.
THISFORM.SET2.ENABLED = .T.
THISFORM.SET3.ENABLED = .T.
THISFORM.SET4.ENABLED = .T.
THISFORM.SET5.ENABLED = .T.
THISFORM.SET6.ENABLED = .T.
ENDIF
ENDPROC
**
***
*** atur_hakakses.sct
***
*
***
*** atur_user.scx
***
*
*
*  atur_user.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE9.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE8.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE7.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT16.VALUE = "KAS MASUK"
THISFORM.LABEL14.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE8.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE7.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT16.VALUE = "KAS KELUAR"
THISFORM.LABEL14.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
PROCEDURE bacadata
CSQL = "select * from user_group where namagroup='SUPER ADMIN'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MIDGROUP = ID
MDATA = THISFORM.DATA1
IF IJINMODUL("USER", "ALL")
CSQL = "select * from user where kantor='"+DEFAKANTOR+"' or namagroup=md5('"+ALLTRIM(STR(MIDGROUP))+"')"
ELSE
CSQL = "select * from user where userid='"+DEFAUSERID+"'"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
RETURN
ENDIF
ENDPROC
**
PROCEDURE tampil
MYDATA = THISFORM.DATA1
SELECT (MYDATA)
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "USERID"
.COLUMN1.HEADER1.CAPTION = "USER ID"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 500
.COLUMN3.CONTROLSOURCE = "ALAMAT"
.COLUMN3.HEADER1.CAPTION = "ALAMAT"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("USER", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("USER", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("USER", "HAPUS")
THISFORM.CMDRESETPASS.VISIBLE = IJINMODUL("USER", "ADMIN")
THISFORM.CMDGROUP.VISIBLE = IJINMODUL("USER", "ADMIN")
THISFORM.DATA1 = SYS(2015)
THISFORM.BACADATA()
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  atur_user.scx::Grid1
**
PROCEDURE DblClick
DO FORM atur_user_data WITH "TAMPIL"
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM atur_user_data WITH "TAMPIL"
ENDIF
ENDPROC
**
*
*  atur_user.scx::cmdinput
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
OLDSELECT = SELECT()
CSQL = "select id from user_group where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MID = ID
MADA = RECCOUNT()
USE
SELECT (OLDSELECT)
IF MADA=0
MESSAGEBOX("Belum ada group user, Buat group dulu", 64, "")
RETURN
ENDIF
DO FORM atur_user_data WITH "INPUT"
THISFORM.BACADATA()
THISFORM.TAMPIL()
ENDPROC
**
*
*  atur_user.scx::cmdedit
**
PROCEDURE Click
OLDSELECT = SELECT()
CSQL = "select id from user_group where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MID = ID
USE
SELECT (OLDSELECT)
IF MID=0
MESSAGEBOX("Tidak ada Data", 64, "")
RETURN
ENDIF
DO FORM atur_user_data WITH "EDIT"
THISFORM.BACADATA()
THISFORM.TAMPIL()
ENDPROC
**
*
*  atur_user.scx::cmdhapus
**
PROCEDURE Click
OLDSELECT = SELECT()
CSQL = "select id from user_group where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MID = ID
USE
SELECT (OLDSELECT)
IF MID=0
MESSAGEBOX("Tidak ada Data", 64, "")
RETURN
ENDIF
CSQL = "delete from user where id='"+ALLTRIM(STR(ID))+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BACADATA()
THISFORM.TAMPIL()
ENDPROC
**
*
*  atur_user.scx::cmdgroup
**
PROCEDURE Click
DO FORM atur_group
ENDPROC
**
*
*  atur_user.scx::cmdgantipass
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
IF USERID<>DEFAUSERID
MESSAGEBOX("Maaf anda tidak berhak merubah password orang lain")
ELSE
DO FORM atur_pass_ganti WITH "EDIT", ID
ENDIF
ENDPROC
**
*
*  atur_user.scx::cmdresetpass
**
PROCEDURE Click
MYDATA = THISFORM.DATA1
SELECT (MYDATA)
DO FORM atur_pass_ganti WITH "RESET", USERID
ENDPROC
**
***
*** atur_user.sct
***
*
***
*** atur_user_data.scx
***
*
*
*  atur_user_data.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE9.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE8.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE7.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT16.VALUE = "KAS MASUK"
THISFORM.LABEL14.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE8.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE7.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT16.VALUE = "KAS KELUAR"
THISFORM.LABEL14.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
CSQL = "select * from user"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampil
MYDATA = THISFORM.DATA1
SELECT (MYDATA)
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "USERID"
.COLUMN1.HEADER1.CAPTION = "USER ID"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 500
.COLUMN3.CONTROLSOURCE = "ALAMAT"
.COLUMN3.HEADER1.CAPTION = "ALAMAT"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
LOCAL OLDSELECT
THISFORM.MODE = MMODE
THISFORM.IDDATA = ID
OLDSELECT = SELECT()
CSQL = "select namagroup from user_group"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
FOR A = 1 TO RECCOUNT()
THISFORM.COMBO1.ADDITEM(NAMAGROUP)
SKIP
ENDFOR
USE
SELECT (OLDSELECT)
LOCAL KATA, X
KATA = ''
A = INT(RAND()*10000)
KATA = RIGHT('0000'+ALLTRIM(STR(A)), 4)
MGROUP = ALLTRIM(NAMAGROUP)
CSQL = "select namagroup from user_group where md5(id)='"+MGROUP+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNAMAGROUP = NAMAGROUP
USE
SELECT (OLDSELECT)
IF MMODE="INPUT"
THISFORM.TEXT1.VALUE = ''
THISFORM.TEXT2.VALUE = ''
THISFORM.TEXT3.VALUE = ''
THISFORM.COMBO1.VALUE = ''
THISFORM.TEXT4.VALUE = KATA
THISFORM.TEXT5.VALUE = 0
ELSE
THISFORM.TEXT1.VALUE = USERID
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.COMBO1.VALUE = MNAMAGROUP
THISFORM.TEXT5.VALUE = BATASKAS
THISFORM.TEXT1.ENABLED = .F.
IF MMODE="TAMPIL"
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.COMBO1.ENABLED = .F.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.CAPTION = "OK"
ENDIF
ENDIF
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  atur_user_data.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  atur_user_data.scx::Command5
**
PROCEDURE Click
MID = ALLTRIM(STR(THISFORM.IDDATA))
IF THISFORM.MODE="TAMPIL"
THISFORM.RELEASE
RETURN
ENDIF
IF  .NOT. EMPTY(THISFORM.TEXT1.VALUE) .AND.  .NOT. EMPTY(THISFORM.COMBO1.VALUE)
CSQL = "select id from user_group where namagroup='"+ALLTRIM(THISFORM.COMBO1.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MIDGROUP = ALLTRIM(STR(ID))
USE
IF THISFORM.MODE="INPUT"
CSQL = "INSERT into user (kantor,userid,nama,alamat,namagroup,password,tglbuka,tglupdate, tglakhir,bataskas) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+CEKCHAR(THISFORM.TEXT2.VALUE)+"',"+"'"+CEKCHAR(THISFORM.TEXT3.VALUE)+"',"+"md5('"+MIDGROUP+"'),"+"md5('"+ALLTRIM(THISFORM.TEXT4.VALUE)+"'),"+"'"+SQLDATE(TGLNOW)+"',"+"'"+SQLDATE(TGLNOW)+"',"+"'"+SQLDATE(TGLNOW+180)+"',"+"'"+TRANSFORM(THISFORM.TEXT5.VALUE, '999999999999')+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "UPDATE user set "+"userid='"+THISFORM.TEXT1.VALUE+"',"+"nama='"+CEKCHAR(THISFORM.TEXT2.VALUE)+"',"+"alamat='"+CEKCHAR(THISFORM.TEXT3.VALUE)+"',"+"namagroup=md5('"+MIDGROUP+"'),"+"password=md5('"+ALLTRIM(THISFORM.TEXT4.VALUE)+"'),"+"tglupdate='"+SQLDATE(TGLNOW)+"',"+"tglakhir='"+SQLDATE(TGLNOW+180)+"', "+"bataskas='"+TRANSFORM(THISFORM.TEXT5.VALUE, '999999999999')+"' "+"where id='"+MID+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
THISFORM.RELEASE
ELSE
MESSAGEBOX("ISIAN TIDAK LENGKAP", 16, "PERHATIAN")
THISFORM.TEXT1.SETFOCUS
ENDIF
ENDPROC
**
*
*  atur_user_data.scx::Text1
**
PROCEDURE LostFocus
OLDSELECT = SELECT()
CSQL = "select * from user where userid='"+ALLTRIM(THIS.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT0")
MUSERID = USERID
USE
SELECT (OLDSELECT)
IF USERID=ALLTRIM(THIS.VALUE)
MESSAGEBOX("Nama UserId sudah dipakai, mohon untuk ganti dengan nama lain", 64, "")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** atur_user_data.sct
***
*
***
*** atur_group.scx
***
*
*
*  atur_group.scx::Form1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE9.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE8.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE7.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT16.VALUE = "KAS MASUK"
THISFORM.LABEL14.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE8.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE7.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT16.VALUE = "KAS KELUAR"
THISFORM.LABEL14.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL9.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
CSQL = "select namagroup,id from user_group"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampil
MYDATA = THISFORM.DATA1
SELECT (MYDATA)
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 1
.COLUMN1.WIDTH = 300
.COLUMN1.CONTROLSOURCE = "NAMAGROUP"
.COLUMN1.HEADER1.CAPTION = "NAMA GROUP"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.OLDSELECT = SELECT()
THISFORM.DATA1 = SYS(2015)
THISFORM.BACADATA()
THISFORM.TAMPIL()
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("USER", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("USER", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("USER", "HAPUS")
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  atur_group.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM atur_hakakses WITH "TAMPIL"
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM atur_hakakses WITH "TAMPIL"
ENDPROC
**
*
*  atur_group.scx::cmdinput
**
PROCEDURE Click
DO FORM atur_hakakses WITH "INPUT"
MREC = RECNO()
THISFORM.BACADATA()
THISFORM.TAMPIL()
IF MREC>0
GOTO MREC
ENDIF
ENDPROC
**
*
*  atur_group.scx::cmdedit
**
PROCEDURE Click
DO FORM atur_hakakses WITH "EDIT"
MREC = RECNO()
THISFORM.BACADATA()
THISFORM.TAMPIL()
GOTO MREC
ENDPROC
**
*
*  atur_group.scx::cmdhapus
**
PROCEDURE Click
MID = ID
CSQL = "delete from user_group where id='"+STR(MID)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BACADATA()
THISFORM.TAMPIL()
ENDPROC
**
***
*** atur_group.sct
***
*
***
*** pros_menu.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
PROCEDURE main_menu
DEFINE MENU XMFORM BAR IN XMFORM
DEFINE PAD _1 OF XMFORM PROMPT '\<System' KEY ALT+S
DEFINE PAD _2 OF XMFORM PROMPT 'Se\<tting' SKIP FOR  .NOT. IJINMENU("MASTER") KEY ALT+M
DEFINE PAD _3 OF XMFORM PROMPT '\<Transaksi' SKIP FOR  .NOT. IJINMENU("TRANSAKSI") KEY ALT+T
DEFINE PAD _4 OF XMFORM PROMPT '\<Laporan' SKIP FOR  .NOT. IJINMENU("LAPORAN") KEY ALT+L
DEFINE PAD _5 OF XMFORM PROMPT '\<Proses' SKIP FOR  .NOT. IJINMENU("PROSES") KEY ALT+P
DEFINE PAD _6 OF XMFORM PROMPT '\<Utility' SKIP FOR  .NOT. IJINMENU("UTILITY") KEY ALT+U
DEFINE PAD _7 OF XMFORM PROMPT '\<About' KEY ALT+A
ON PAD _1 OF XMFORM ACTIVATE POPUP XLOGIN
ON PAD _2 OF XMFORM ACTIVATE POPUP XMASTER
ON PAD _3 OF XMFORM ACTIVATE POPUP XTRANSAKSI
ON PAD _4 OF XMFORM ACTIVATE POPUP XREPORT
ON PAD _5 OF XMFORM ACTIVATE POPUP XPROSES
ON PAD _6 OF XMFORM ACTIVATE POPUP XUTIL
ON PAD _7 OF XMFORM ACTIVATE POPUP XABOUT
DEFINE POPUP XLOGIN MARGIN
DEFINE BAR 1 OF XLOGIN PROMPT '\<Profil Client' SKIP FOR  .NOT. IJINMENU("SET") COLOR SCHEME 3
DEFINE BAR 2 OF XLOGIN PROMPT '\<Profil Lembaga' SKIP FOR DEFAIDGROUP<>'ADMIN' COLOR SCHEME 3
DEFINE BAR 3 OF XLOGIN PROMPT '\----'
DEFINE BAR 4 OF XLOGIN PROMPT 'Set \<User Login & Password' PICTURE ".\image\user.png" COLOR SCHEME 3
IF DEFAMASUK
DEFINE BAR 5 OF XLOGIN PROMPT '\<Logout' STYLE 'BI' PICTURE ".\image\key.ico"
ELSE
DEFINE BAR 5 OF XLOGIN PROMPT '\<Login' STYLE 'BI' PICTURE ".\image\key.ico"
ENDIF
DEFINE BAR 6 OF XLOGIN PROMPT 'E\<xit' KEY CTRL+X, 'Ctrl+X'
ON SELECTION BAR 1 OF XLOGIN DO FORM SETTING
ON SELECTION BAR 2 OF XLOGIN DO FORM SETTING2
ON SELECTION BAR 4 OF XLOGIN DO FORM ATUR_USER
ON SELECTION BAR 5 OF XLOGIN DO FORM FRM_LOGIN
ON SELECTION BAR 6 OF XLOGIN OXMENU.RELEASE 			
DEFINE POPUP XMASTER SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XMASTER PROMPT '---- Pinjaman-----' STYLE 'BI' SKIP COLOR SCHEME 3
DEFINE BAR 2 OF XMASTER PROMPT 'Produk Pinjaman'
ON SELECTION BAR 2 OF XMASTER DO FORM SETSANDI WITH "P001","TAMPIL" 
DEFINE BAR 3 OF XMASTER PROMPT 'Cara Perhitungan Jasa Pinjaman' COLOR SCHEME 3
ON SELECTION BAR 3 OF XMASTER DO FORM SETSANDI WITH "P002","TAMPIL" 
DEFINE BAR 4 OF XMASTER PROMPT 'Jenis Penggunaan' COLOR SCHEME 3
ON SELECTION BAR 4 OF XMASTER DO FORM SETSANDI WITH "P005","TAMPIL" 
DEFINE BAR 5 OF XMASTER PROMPT 'Sektor Ekonomi' COLOR SCHEME 3
ON SELECTION BAR 5 OF XMASTER DO FORM SETSANDI WITH "P006","TAMPIL" 
DEFINE BAR 6 OF XMASTER PROMPT 'Sumber Pelunasan' COLOR SCHEME 3
ON SELECTION BAR 6 OF XMASTER DO FORM SETSANDI WITH "P007","TAMPIL" 
DEFINE BAR 7 OF XMASTER PROMPT '\-'
DEFINE BAR 8 OF XMASTER PROMPT '---- Simpanan-----' STYLE 'BI' SKIP COLOR SCHEME 3
DEFINE BAR 9 OF XMASTER PROMPT 'Produk Simpanan' COLOR SCHEME 3
ON SELECTION BAR 9 OF XMASTER DO FORM SETSANDI WITH "S001","TAMPIL"  
DEFINE BAR 10 OF XMASTER PROMPT 'Cara Perhitungan ' COLOR SCHEME 3
ON SELECTION BAR 10 OF XMASTER DO FORM SETSANDI WITH "S002","TAMPIL"  
DEFINE BAR 11 OF XMASTER PROMPT 'Kelompok Simpanan' COLOR SCHEME 3
ON SELECTION BAR 11 OF XMASTER DO FORM SETSANDI WITH "S003","TAMPIL"
DEFINE BAR 12 OF XMASTER PROMPT '\-'
DEFINE BAR 13 OF XMASTER PROMPT '---- Akuntansi-----' STYLE 'BI' SKIP COLOR SCHEME 3
DEFINE BAR 14 OF XMASTER PROMPT 'Kode Perkiraan' COLOR SCHEME 3
ON SELECTION BAR 14 OF XMASTER DO FORM SETSANDI WITH "GL01","TAMPIL"
DEFINE BAR 15 OF XMASTER PROMPT '\-'
DEFINE BAR 16 OF XMASTER PROMPT 'Pengikatan Barang Bergerak' COLOR SCHEME 3
ON SELECTION BAR 16 OF XMASTER DO FORM SETSANDI WITH "P009","TAMPIL"
DEFINE BAR 17 OF XMASTER PROMPT 'Pengikatan Tanah dan Bangunan' COLOR SCHEME 3
ON SELECTION BAR 17 OF XMASTER DO FORM SETSANDI WITH "P010","TAMPIL"
DEFINE BAR 18 OF XMASTER PROMPT 'Pengikatan Jaminan Simpanan' COLOR SCHEME 3
ON SELECTION BAR 18 OF XMASTER DO FORM SETSANDI WITH "P011","TAMPIL"        
DEFINE BAR 19 OF XMASTER PROMPT 'Pengikatan Jaminan Lain-Lain' COLOR SCHEME 3
ON SELECTION BAR 19 OF XMASTER DO FORM SETSANDI WITH "P012","TAMPIL" 
DEFINE BAR 20 OF XMASTER PROMPT '\-'
DEFINE BAR 21 OF XMASTER PROMPT 'Daftar Kolektor' COLOR SCHEME 3
ON SELECTION BAR 21 OF XMASTER DO FORM SETSANDI WITH "C002","TAMPIL" 
DEFINE BAR 22 OF XMASTER PROMPT 'Daftar Instansi' COLOR SCHEME 3
ON SELECTION BAR 22 OF XMASTER DO FORM SETSANDI WITH "P003","TAMPIL" 
DEFINE BAR 23 OF XMASTER PROMPT 'Wilayah Pinjaman' COLOR SCHEME 3
ON SELECTION BAR 23 OF XMASTER DO FORM SETSANDI WITH "P004","TAMPIL"        
DEFINE BAR 24 OF XMASTER PROMPT 'Daftar Notaris' COLOR SCHEME 3
ON SELECTION BAR 24 OF XMASTER DO FORM SETSANDI WITH "P013","TAMPIL" 
DEFINE BAR 25 OF XMASTER PROMPT 'Daftar Asuransi' COLOR SCHEME 3
ON SELECTION BAR 25 OF XMASTER DO FORM SETSANDI WITH "P014","TAMPIL" 
DEFINE BAR 26 OF XMASTER PROMPT 'Kode Marketing' COLOR SCHEME 3
ON SELECTION BAR 26 OF XMASTER DO FORM SETSANDI WITH "A001","TAMPIL"
DEFINE BAR 27 OF XMASTER PROMPT 'Kode Kota' COLOR SCHEME 3
ON SELECTION BAR 27 OF XMASTER DO FORM SETSANDI WITH "A002","TAMPIL"
ON BAR 9 OF XMASTER ACTIVATE POPUP XPRODUK
DEFINE POPUP XPRODUK SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XPRODUK PROMPT "Produk Simpanan / Tabungan"
DEFINE BAR 2 OF XPRODUK PROMPT "Produk Simpanan Berjangka"
DEFINE BAR 3 OF XPRODUK PROMPT "Modal Penyertaan"
ON SELECTION BAR 1 OF XPRODUK DO FORM SETSANDI WITH "S01A","TAMPIL"
ON SELECTION BAR 2 OF XPRODUK DO FORM SETSANDI WITH "S01B","TAMPIL"
ON SELECTION BAR 3 OF XPRODUK DO FORM SETSANDI WITH "S01C","TAMPIL"
DEFINE POPUP XTRANSAKSI MARGIN
DEFINE BAR 1 OF XTRANSAKSI PROMPT 'Kasir' STYLE 'BI' SKIP PICTURE '.\image\Bank Teller 2.png' COLOR SCHEME 3
DEFINE BAR 2 OF XTRANSAKSI PROMPT 'Transaksi Kas dan Non Kas' SKIP FOR  .NOT. IJINMODUL("KAS", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 2 OF XTRANSAKSI DO FORM KASIR
DEFINE BAR 3 OF XTRANSAKSI PROMPT '\----'
DEFINE BAR 4 OF XTRANSAKSI PROMPT 'Bagian Pinjaman / Pembiayaan' STYLE 'BI' SKIP PICTURE '.\image\loan.png' COLOR SCHEME 3
DEFINE BAR 5 OF XTRANSAKSI PROMPT 'Daftar Pinjaman / Pembiayaan' SKIP FOR  .NOT. IJINMODUL("PINJ", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 5 OF XTRANSAKSI DO FORM PINJAMAN WITH "TAMPIL","A" 
DEFINE BAR 6 OF XTRANSAKSI PROMPT 'Penerimaan Angsuran' SKIP FOR  .NOT. IJINMODUL("PINJ", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 6 OF XTRANSAKSI DO FORM PINJAMAN WITH "TAMPIL","B"
DEFINE BAR 7 OF XTRANSAKSI PROMPT 'Data History Pinjaman' SKIP FOR  .NOT. IJINMODUL("PINJ", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 7 OF XTRANSAKSI DO FORM PINJAMAN WITH "TAMPIL","P"  
DEFINE BAR 8 OF XTRANSAKSI PROMPT '\----'
DEFINE BAR 9 OF XTRANSAKSI PROMPT 'Bagian Simpanan / Funding' STYLE 'BI' SKIP PICTURE '.\image\bank 4 add.png' COLOR SCHEME 3
DEFINE BAR 10 OF XTRANSAKSI PROMPT 'Daftar Simpanan ' SKIP FOR  .NOT. IJINMODUL("SIMP", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 10 OF XTRANSAKSI DO FORM SIMPANAN WITH "TAMPIL","A" 
DEFINE BAR 11 OF XTRANSAKSI PROMPT 'Simpanan Di Blokir ' SKIP FOR  .NOT. IJINMODUL("SIMP", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 11 OF XTRANSAKSI DO FORM SIMPANAN WITH "TAMPIL","B" 
DEFINE BAR 12 OF XTRANSAKSI PROMPT 'Auto debet Simpanan ' SKIP FOR  .NOT. IJINMODUL("SIMP", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 12 OF XTRANSAKSI DO FORM SIMPANAN WITH "TAMPIL","D" 
DEFINE BAR 13 OF XTRANSAKSI PROMPT 'Data History Simpanan' SKIP FOR  .NOT. IJINMODUL("SIMP", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 13 OF XTRANSAKSI DO FORM SIMPANAN WITH "TAMPIL","P"
DEFINE BAR 14 OF XTRANSAKSI PROMPT '\----'
DEFINE BAR 15 OF XTRANSAKSI PROMPT 'Keanggotaan' STYLE 'BI' SKIP COLOR SCHEME 3
DEFINE BAR 16 OF XTRANSAKSI PROMPT 'Daftar Anggota Koperasi' SKIP FOR  .NOT. IJINMODUL("ANGG", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 16 OF XTRANSAKSI DO FORM ANGGOTA WITH "TAMPIL","A" 
DEFINE BAR 17 OF XTRANSAKSI PROMPT 'History Anggota Koperasi' SKIP FOR  .NOT. IJINMODUL("ANGG", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 17 OF XTRANSAKSI DO FORM ANGGOTA WITH "TAMPIL","P"
DEFINE BAR 18 OF XTRANSAKSI PROMPT '\----'
DEFINE BAR 19 OF XTRANSAKSI PROMPT 'Bagian Akuntansi' STYLE 'BI' SKIP PICTURE '.\image\Scale.png' COLOR SCHEME 3
DEFINE BAR 20 OF XTRANSAKSI PROMPT 'Jurnal Transaksi' SKIP FOR  .NOT. IJINMODUL("AKT", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 20 OF XTRANSAKSI DO FORM GL_JURNAL
DEFINE BAR 21 OF XTRANSAKSI PROMPT 'Daftar Perkiraan Akuntansi' SKIP FOR  .NOT. IJINMODUL("AKT", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 21 OF XTRANSAKSI DO FORM GL_PERKIRAAN
DEFINE BAR 22 OF XTRANSAKSI PROMPT 'Daftar Inventaris' SKIP FOR  .NOT. IJINMODUL("AKT", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 22 OF XTRANSAKSI DO FORM GL_INVENTARIS
DEFINE BAR 23 OF XTRANSAKSI PROMPT '\----'
DEFINE BAR 24 OF XTRANSAKSI PROMPT 'Kolektif' STYLE 'BI' SKIP COLOR SCHEME 3
DEFINE BAR 25 OF XTRANSAKSI PROMPT 'Pembayaran Kolektif Instansi' SKIP FOR  .NOT. IJINMODUL("COL", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 25 OF XTRANSAKSI DO FORM INSTANSI_MASUK
DEFINE BAR 26 OF XTRANSAKSI PROMPT 'Pembayaran Petugas Kolektor' SKIP FOR  .NOT. IJINMODUL("COL", "VIEW") COLOR SCHEME 3
ON SELECTION BAR 26 OF XTRANSAKSI DO FORM COL1_MASUK
DEFINE POPUP XREPORT MARGIN RELATIVE SCROLL COLOR SCHEME 4
DEFINE BAR 1 OF XREPORT PROMPT 'Laporan Keanggotaan' COLOR SCHEME 3
DEFINE BAR 2 OF XREPORT PROMPT 'Laporan Simpanan' PICTURE '.\image\bank 4 add.png' COLOR SCHEME 3
DEFINE BAR 3 OF XREPORT PROMPT 'Laporan Pinjaman' PICTURE '.\image\loan.png' COLOR SCHEME 3
DEFINE BAR 4 OF XREPORT PROMPT 'Laporan Kasir' PICTURE '.\image\Bank Teller 2.png' COLOR SCHEME 3
DEFINE BAR 5 OF XREPORT PROMPT 'Laporan Akuntansi' PICTURE '.\image\Scale.png' COLOR SCHEME 3
DEFINE BAR 6 OF XREPORT PROMPT 'Laporan Kolektor' COLOR SCHEME 3
ON BAR 1 OF XREPORT ACTIVATE POPUP XLAPANGGOTA
DEFINE POPUP XLAPANGGOTA SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XLAPANGGOTA PROMPT "1. Laporan Daftar Anggota"
DEFINE BAR 2 OF XLAPANGGOTA PROMPT "2. Laporan Rincian SHU"
ON SELECTION BAR 1 OF XLAPANGGOTA DO FORM ANGG_LAP WITH 1
ON SELECTION BAR 2 OF XLAPANGGOTA DO FORM ANGG_LAP WITH 2
ON BAR 2 OF XREPORT ACTIVATE POPUP XLAPSIMPANAN
DEFINE POPUP XLAPSIMPANAN SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XLAPSIMPANAN PROMPT "1. Laporan Pembukaan rekening Baru"
DEFINE BAR 2 OF XLAPSIMPANAN PROMPT "2. Laporan Mutasi Simpanan"
DEFINE BAR 3 OF XLAPSIMPANAN PROMPT "3. Laporan Nominatif Simpanan"
DEFINE BAR 4 OF XLAPSIMPANAN PROMPT "4. Laporan Penutupan Rekening"
DEFINE BAR 5 OF XLAPSIMPANAN PROMPT "5. Laporan Nominatif Rinci"
DEFINE BAR 6 OF XLAPSIMPANAN PROMPT "6. Laporan Simpanan Instansi"
ON SELECTION BAR 1 OF XLAPSIMPANAN DO FORM SIMP_LAP WITH 1
ON SELECTION BAR 2 OF XLAPSIMPANAN DO FORM SIMP_LAP WITH 2
ON SELECTION BAR 3 OF XLAPSIMPANAN DO FORM SIMP_LAP WITH 3
ON SELECTION BAR 4 OF XLAPSIMPANAN DO FORM SIMP_LAP WITH 4
ON SELECTION BAR 5 OF XLAPSIMPANAN DO FORM SIMP_LAP WITH 5
ON BAR 6 OF XLAPSIMPANAN ACTIVATE POPUP XLAPSIMP_INST
DEFINE POPUP XLAPSIMP_INST SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XLAPSIMP_INST PROMPT "1. Daftar Mutasi Pengambilan Simpanan"
DEFINE BAR 2 OF XLAPSIMP_INST PROMPT "2. Laporan ....."
ON SELECTION BAR 1 OF XLAPSIMP_INST DO FORM ANGG_LAP WITH 1
ON SELECTION BAR 2 OF XLAPSIMP_INST DO FORM ANGG_LAP WITH 2
ON BAR 3 OF XREPORT ACTIVATE POPUP XLAPPINJAMAN
DEFINE POPUP XLAPPINJAMAN SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XLAPPINJAMAN PROMPT "1. Laporan Realisasi Pinjaman"
DEFINE BAR 2 OF XLAPPINJAMAN PROMPT "2. Laporan Penerimaan Angsuran"
DEFINE BAR 3 OF XLAPPINJAMAN PROMPT "3. Laporan Nominatif Pinjaman"
DEFINE BAR 4 OF XLAPPINJAMAN PROMPT "4. Laporan Pelunasan Pinjaman"
DEFINE BAR 5 OF XLAPPINJAMAN PROMPT "5. Laporan Non Performing Loan (NPL)"
DEFINE BAR 6 OF XLAPPINJAMAN PROMPT "6. Laporan Nasabah Belum Bayar"
DEFINE BAR 7 OF XLAPPINJAMAN PROMPT "7. Laporan Mutasi Rekening Koran"
ON SELECTION BAR 1 OF XLAPPINJAMAN DO FORM PINJ_LAP WITH 1
ON SELECTION BAR 2 OF XLAPPINJAMAN DO FORM PINJ_LAP WITH 2
ON SELECTION BAR 3 OF XLAPPINJAMAN DO FORM PINJ_LAP WITH 3
ON SELECTION BAR 4 OF XLAPPINJAMAN DO FORM PINJ_LAP WITH 4
ON BAR 5 OF XLAPPINJAMAN ACTIVATE POPUP XLAPPINJ_NPL
DEFINE POPUP XLAPPINJ_NPL SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XLAPPINJ_NPL PROMPT "1. Rekapitulasi NPL"
DEFINE BAR 2 OF XLAPPINJ_NPL PROMPT "2. Rekap NPL Per Instansi"
DEFINE BAR 3 OF XLAPPINJ_NPL PROMPT "3. Rekap NPL Per Marketing"
DEFINE BAR 4 OF XLAPPINJ_NPL PROMPT "4. Rekap NPL Per Wilayah"
DEFINE BAR 5 OF XLAPPINJ_NPL PROMPT "5. Rekap NPL Per Produk"
DEFINE BAR 6 OF XLAPPINJ_NPL PROMPT "6. Rekap NPL Per Sektor Ekonomi"
ON SELECTION BAR 1 OF XLAPPINJ_NPL DO FORM PINJ_LAP WITH 5
ON SELECTION BAR 2 OF XLAPPINJ_NPL DO FORM PINJ_LAP WITH 6
ON SELECTION BAR 3 OF XLAPPINJ_NPL DO FORM PINJ_LAP WITH 9
ON SELECTION BAR 4 OF XLAPPINJ_NPL DO FORM PINJ_LAP WITH 10
ON SELECTION BAR 5 OF XLAPPINJ_NPL DO FORM PINJ_LAP WITH 11
ON SELECTION BAR 6 OF XLAPPINJ_NPL DO FORM PINJ_LAP WITH 12
ON SELECTION BAR 7 OF XLAPPINJAMAN DO FORM PINJ_LAP WITH 8
ON BAR 4 OF XREPORT ACTIVATE POPUP XLAPKASIR
DEFINE POPUP XLAPKASIR SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XLAPKASIR PROMPT "1. Laporan Penerimaan Kas"
DEFINE BAR 2 OF XLAPKASIR PROMPT "2. Laporan Mutasi Non Kas"
DEFINE BAR 3 OF XLAPKASIR PROMPT "3. Laporan Rincian Uang Kas"
ON SELECTION BAR 1 OF XLAPKASIR DO FORM KAS_LAP WITH 1
ON SELECTION BAR 2 OF XLAPKASIR DO FORM KAS_LAP WITH 2
ON SELECTION BAR 3 OF XLAPKASIR DO FORM KAS_LAP WITH 3
ON BAR 5 OF XREPORT ACTIVATE POPUP XLAPAKUNTANSI
DEFINE POPUP XLAPAKUNTANSI SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XLAPAKUNTANSI PROMPT "1. Laporan Neraca"
DEFINE BAR 2 OF XLAPAKUNTANSI PROMPT "2. Laporan Laba Rugi"
DEFINE BAR 3 OF XLAPAKUNTANSI PROMPT "3. Laporan Neraca Perbandingan"
DEFINE BAR 4 OF XLAPAKUNTANSI PROMPT "4. Laporan Laba Rugi Perbandingan"
DEFINE BAR 5 OF XLAPAKUNTANSI PROMPT "5. Laporan Neraca Harian"
DEFINE BAR 6 OF XLAPAKUNTANSI PROMPT "6. Laporan Laba Rugi Harian"
DEFINE BAR 7 OF XLAPAKUNTANSI PROMPT "7. Laporan Rincian Transaksi"
DEFINE BAR 8 OF XLAPAKUNTANSI PROMPT "8. Laporan Rekap Buku Besar"
DEFINE BAR 9 OF XLAPAKUNTANSI PROMPT "9. Daftar Inventaris"
DEFINE BAR 10 OF XLAPAKUNTANSI PROMPT "10. Rincian Aktiva"
DEFINE BAR 11 OF XLAPAKUNTANSI PROMPT "11. Rincian Pasiva"
DEFINE BAR 12 OF XLAPAKUNTANSI PROMPT "12.Rincian Pendapatan"
DEFINE BAR 13 OF XLAPAKUNTANSI PROMPT "13.Rincian Biaya"
DEFINE BAR 14 OF XLAPAKUNTANSI PROMPT "14.Cetak Jurnal Transaksi"
DEFINE BAR 15 OF XLAPAKUNTANSI PROMPT "15.Cetak Neraca dan Laba/rugi"
DEFINE BAR 16 OF XLAPAKUNTANSI PROMPT '16.Laporan Rekap Transaksi'
ON SELECTION BAR 1 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 1  
ON SELECTION BAR 2 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 2  
ON SELECTION BAR 3 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 3  
ON SELECTION BAR 4 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 4  
ON SELECTION BAR 5 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 9  
ON SELECTION BAR 6 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 10  
ON SELECTION BAR 7 OF XLAPAKUNTANSI DO FORM GL_LAP2 WITH 1  
ON SELECTION BAR 8 OF XLAPAKUNTANSI DO FORM GL_LAP2 WITH 2  
ON SELECTION BAR 9 OF XLAPAKUNTANSI DO FORM GL_LAP2 WITH 4  
ON SELECTION BAR 10 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 5  
ON SELECTION BAR 11 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 6  
ON SELECTION BAR 12 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 7  
ON SELECTION BAR 13 OF XLAPAKUNTANSI DO FORM GL_LAP1 WITH 8  
ON SELECTION BAR 14 OF XLAPAKUNTANSI DO FORM GL_LAP2 WITH 3  
ON SELECTION BAR 15 OF XLAPAKUNTANSI DO FORM GL_LAP2 WITH 8  
ON SELECTION BAR 16 OF XLAPAKUNTANSI DO FORM GL_LAP2 WITH 10	
ON BAR 6 OF XREPORT ACTIVATE POPUP XLAPKOLEKTOR
DEFINE POPUP XLAPKOLEKTOR SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XLAPKOLEKTOR PROMPT "1. Daftar Tagihan Instansi"
DEFINE BAR 2 OF XLAPKOLEKTOR PROMPT "2. Laporan Rekap Transaksi"
DEFINE BAR 3 OF XLAPKOLEKTOR PROMPT "3. Laporan Daftar Kolektor"
ON SELECTION BAR 1 OF XLAPKOLEKTOR DO FORM COL_LAP WITH 1  
ON SELECTION BAR 2 OF XLAPKOLEKTOR DO FORM COL_LAP WITH 1  
ON SELECTION BAR 3 OF XLAPKOLEKTOR DO FORM COL_LAP WITH 1  
DEFINE POPUP XPROSES MARGIN
DEFINE BAR 1 OF XPROSES PROMPT '1. Proses Harian' COLOR SCHEME 3
DEFINE BAR 2 OF XPROSES PROMPT '2. Proses Hitung Perbagian' COLOR SCHEME 3
DEFINE BAR 3 OF XPROSES PROMPT '3. Proses Perubahan Ketentuan' SKIP FOR DEFAIDGROUP<>'ADMIN' COLOR SCHEME 3
DEFINE BAR 4 OF XPROSES PROMPT '4. Proses Hitung Ulang Saldo' COLOR SCHEME 3
DEFINE BAR 5 OF XPROSES PROMPT '\-'
DEFINE BAR 6 OF XPROSES PROMPT '5. ACC Pengeluaran' SKIP FOR  .NOT. IJINACC() COLOR SCHEME 3
DEFINE BAR 7 OF XPROSES PROMPT '\-'
DEFINE BAR 8 OF XPROSES PROMPT '6. Verifikasi Proses Harian' SKIP FOR  .NOT. IJINACC() COLOR SCHEME 3
DEFINE BAR 9 OF XPROSES PROMPT '\-'
DEFINE BAR 10 OF XPROSES PROMPT '7. Proses Tutup Buku' SKIP FOR  .NOT. IJINACC() COLOR SCHEME 3
DEFINE BAR 11 OF XPROSES PROMPT '8. Batal Proses Tutup Buku' SKIP FOR  .NOT. IJINACC() COLOR SCHEME 3
ON SELECTION BAR 1 OF XPROSES PROSHARIAN(0)
ON SELECTION BAR 2 OF XPROSES PROSHARIAN(1)
ON SELECTION BAR 3 OF XPROSES DO FORM PROSES_RUBAH
ON SELECTION BAR 4 OF XPROSES DO FORM PROSES_CEKSALDO
ON SELECTION BAR 6 OF XPROSES DO FORM ACC
ON SELECTION BAR 8 OF XPROSES DO FORM ACC_HARIAN1
ON SELECTION BAR 10 OF XPROSES DO FORM PROSES_TUTUPBUKU
ON SELECTION BAR 11 OF XPROSES DO FORM PROSES_BATALTUTUP
DEFINE POPUP XUTIL MARGIN
DEFINE BAR 1 OF XUTIL PROMPT "Pembatasan Tanggal" COLOR SCHEME 3
ON SELECTION BAR 1 OF XUTIL DO FORM ATUR_TANGGAL  
DEFINE BAR 2 OF XUTIL PROMPT "Setting Laporan" COLOR SCHEME 3
ON BAR 2 OF XUTIL ACTIVATE POPUP XUTIL_LAP
DEFINE POPUP XUTIL_LAP SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XUTIL_LAP PROMPT "1. Setting Laporan / Cetakan"
DEFINE BAR 2 OF XUTIL_LAP PROMPT "2. Setting Posisi Cetakan"
ON SELECTION BAR 1 OF XUTIL_LAP DO FORM SET_LAPORAN
ON SELECTION BAR 2 OF XUTIL_LAP DO FORM FORM_OPTION_CETAK
DEFINE BAR 3 OF XUTIL PROMPT "Sms GateWay" COLOR SCHEME 3
ON SELECTION BAR 3 OF XUTIL DO FORM SMSGATEWAY1  
DEFINE BAR 4 OF XUTIL PROMPT "Backup databased" COLOR SCHEME 3
ON SELECTION BAR 4 OF XUTIL DO FORM FORM_BACKUPDATA  
DEFINE BAR 5 OF XUTIL PROMPT "Perbaikan Transaksi Simpanan" COLOR SCHEME 3
ON SELECTION BAR 5 OF XUTIL DO FORM A_PERBAIKAN_SIMPANAN
DEFINE BAR 6 OF XUTIL PROMPT "Cek Transaksi" COLOR SCHEME 3
ON SELECTION BAR 6 OF XUTIL DO FORM CEK_TRANSAKSI   
DEFINE BAR 7 OF XUTIL PROMPT "Pengaturan Lainnya" COLOR SCHEME 3
ON BAR 7 OF XUTIL ACTIVATE POPUP XUTIL_LAINNYA
DEFINE POPUP XUTIL_LAINNYA SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF XUTIL_LAINNYA PROMPT "1. Reset Tanggal Proses"
DEFINE BAR 2 OF XUTIL_LAINNYA PROMPT "2. Proses Pelunasan sld 0"
DEFINE BAR 3 OF XUTIL_LAINNYA PROMPT "3. Proses Tutup Otomatis Simpanan"
ON SELECTION BAR 1 OF XUTIL_LAINNYA DO FORM FORM_RESETPROSES
ON SELECTION BAR 2 OF XUTIL_LAINNYA DO FORM FORM_AUTOLUNAS
ON SELECTION BAR 3 OF XUTIL_LAINNYA DO FORM FORM_AUTOTUTUP
DEFINE BAR 8 OF XUTIL PROMPT "Perbaikan Data" COLOR SCHEME 3
ON SELECTION BAR 8 OF XUTIL DO FORM A_PERBAIKAN_TABLE
DEFINE POPUP XABOUT MARGIN
DEFINE BAR 1 OF XABOUT PROMPT "About"
DEFINE BAR 2 OF XABOUT PROMPT "Registrasi Program"
ON SELECTION BAR 1 OF XABOUT DO FORM ABOUT
ON SELECTION BAR 2 OF XABOUT DO FORM REGISTER
ACTIVATE MENU XMFORM
ENDPROC
**
PROCEDURE coba
DEFINE WINDOW WCOBA FROM 1, 1 TO 20, 30 CLOSE ZOOM TITLE "Parent" IN DESKTOP
MODIFY REPORT c:\ctk_buku_mutasi.frx NOWAIT IN WCOBA
ACTIVATE WINDOW WCOBA
ACTIVATE SCREEN
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** atur_pass_ganti.scx
***
*
*
*  atur_pass_ganti.scx::FORM1
**
PROCEDURE Init
PARAMETER MMODE, MID
THISFORM.MODE = MMODE
THISFORM.IDDATA = MID
IF MMODE="RESET"
THISFORM.TEXT4.ENABLED = .T.
THISFORM.LABEL2.CAPTION = "RESET PASSWORD"
THISFORM.CAPTION = ":: RESET PASSWORD ::"
THISFORM.LABEL1.CAPTION = "PASSWORD ADMIN :"
THISFORM.LABEL5.CAPTION = "USER ID ADMIN :"
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT2.PASSWORDCHAR = ""
THISFORM.TEXT2.VALUE = ''
THISFORM.TEXT2.ENABLED = .F.
ELSE
THISFORM.TEXT4.VALUE = _USERS
ENDIF
THISFORM.TEXT1.VALUE = SPACE(30)
THISFORM.TEXT2.VALUE = SPACE(30)
THISFORM.TEXT3.VALUE = SPACE(30)
ENDPROC
**
PROCEDURE Unload
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  atur_pass_ganti.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  atur_pass_ganti.scx::Command5
**
PROCEDURE Click
OLDDBF = SELECT()
MID = THISFORM.IDDATA
IF THISFORM.MODE="RESET"
CSQL = "select * from user where userid='"+THISFORM.TEXT4.VALUE+"' and password=md5('"+ALLTRIM(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT0")
IF USERID=THISFORM.TEXT4.VALUE
MIDGROUP = ALLTRIM(NAMAGROUP)
CSQL = "select namagroup from user_group where md5(id)='"+MIDGROUP+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF NAMAGROUP<>"ADMIN"
MESSAGEBOX("HARUS MENGGUNAKAN PASSWORD ADMIN")
SELECT (OLDDBF)
RETURN
ENDIF
ELSE
MESSAGEBOX("MAAF ANDA TIDAK BERHAK MELAKUKAN RESET PASSWORD", 16, "")
SELECT (OLDDBF)
RETURN
ENDIF
MESSAGEBOX(ALLTRIM(THISFORM.TEXT2.VALUE))
CSQL = "UPDATE user set stat='0', password=md5('"+ALLTRIM(THISFORM.TEXT2.VALUE)+"') where id='"+STR(MID)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Perintah Salah :"+CHR(13)+CSQL, 16, "PERINGATAN")
ENDIF
THISFORM.RELEASE
ELSE
IF THISFORM.TEXT2.VALUE<>THISFORM.TEXT3.VALUE
MESSAGEBOX("Password tidak sama", 0, "")
RETURN
ENDIF
CSQL = "UPDATE user set stat='1', password=md5('"+ALLTRIM(THISFORM.TEXT2.VALUE)+"') where id='"+STR(MID)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Perintah Salah :"+CHR(13)+CSQL, 16, "PERINGATAN")
ENDIF
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  atur_pass_ganti.scx::Text1
**
PROCEDURE LostFocus
IF THISFORM.MODE="RESET"
THISFORM.TEXT2.VALUE = ""
ELSE
CSQL = "select userid from user where userid='"+ALLTRIM(THISFORM.TEXT4.VALUE)+"' and password=md5('"+ALLTRIM(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT01")
IF USERID<>THISFORM.TEXT4.VALUE
MESSAGEBOX("Password Anda Salah", 16, "PERINGATAN")
NODEFAULT
RETURN
ENDIF
ENDIF
ENDPROC
**
*
*  atur_pass_ganti.scx::Text3
**
PROCEDURE LostFocus
IF THIS.VALUE<>THISFORM.TEXT2.VALUE
MESSAGEBOX("PASSWORD YANG ANDA MASUKKAN TIDAK SAMA"+CHR(13)+"HARAP PERIKSA LAGI", 16, "PERINGATAN")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  atur_pass_ganti.scx::Text4
**
PROCEDURE LostFocus
IF THISFORM.MODE="RESET"
THISFORM.TEXT2.VALUE = "123"
ELSE
IF ALLTRIM(THIS.VALUE)<>ALLTRIM(_PASWD)
MESSAGEBOX("Password Anda Salah", 16, "PERINGATAN")
NODEFAULT
RETURN
ENDIF
ENDIF
ENDPROC
**
***
*** atur_pass_ganti.sct
***
*
***
*** gl_inventaris_mutasi.scx
***
*
*
*  gl_inventaris_mutasi.scx::FORM1
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
MNOREK = ALLTRIM(STR(THISFORM.NOREKASAL))
CSQL = "select * from gl_inventaris_mutasi where nomorid='"+ALLTRIM(MNOREK)+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
ENDPROC
**
PROCEDURE tampilkan
MYDATA = THISFORM.DATA1
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 6
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 90
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 250
.COLUMN3.CONTROLSOURCE = "KETERANGAN"
.COLUMN3.HEADER1.CAPTION = "KETERANGAN"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 100
.COLUMN4.CONTROLSOURCE = "DEBET"
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.ALIGNMENT = 1
.COLUMN4.HEADER1.CAPTION = "MUTASI DEBET"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "kredit"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "MUTASI KREDIT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.COLUMN6.WIDTH = 100
.COLUMN6.CONTROLSOURCE = "saldo"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "SALDO"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 9
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.DATA1 = SYS(2015)
THISFORM.OLDSELECT = SELECT()
THISFORM.NOREKASAL = NOMORID
THISFORM.TEXT32.VALUE = NAMA
THISFORM.TEXT33.VALUE = TANGGAL
THISFORM.TEXT1.VALUE = HARGA
THISFORM.TEXT2.VALUE = NILAIBUKU
THISFORM.LAMA = LAMA
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into pinjaman (tanggal, bukti, norek, nopk, kdhit, marketing, cif, pokok, rate, lama, tglmulai, tgljtempo, adm, provisi, jenis, kelompok, wilayah, penggunaan, sektor, sumber) value "+"('"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT34.VALUE+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+STR(.TEXT38.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"',"+"'"+STR(.TEXT39.VALUE)+"',"+"'"+STR(.TEXT40.VALUE)+"',"+"'"+.TEXT21.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+.TEXT22.VALUE+"',"+"'"+.TEXT27.VALUE+"',"+"'"+.TEXT24.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',"+"bukti='"+.TEXT34.VALUE+"',"+"norek='"+.TEXT32.VALUE+"',"+"nopk='"+.TEXT33.VALUE+"',"+"kdhit='"+.TEXT41.VALUE+"',"+"marketing='"+.TEXT42.VALUE+"',"+"cif='"+.TEXT1.VALUE+"',"+"pokok='"+STR(.TEXT38.VALUE)+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"lama='"+STR(.TEXT18.VALUE)+"',"+"tglmulai='"+SQLDATE(.TEXT19.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT14.VALUE)+"',"+"adm='"+STR(.TEXT39.VALUE)+"',"+"provisi='"+STR(.TEXT40.VALUE)+"',"+"jenis='"+.TEXT21.VALUE+"',"+"kelompok='"+.TEXT25.VALUE+"',"+"wilayah='"+.TEXT26.VALUE+"',"+"penggunaan='"+.TEXT22.VALUE+"',"+"sektor='"+.TEXT27.VALUE+"',"+"sumber='"+.TEXT24.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="HAPUS"
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Text32
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Command6
**
PROCEDURE Click
SELECT (THISFORM.OLDSELECT)
MNOMORID = NOMORID
OLDSELECT = SELECT()
CSQL = "select a.*,b.nama from gl_inventaris_mutasi as a left join gl_inventaris as b on a.nomorid=b.nomorid and a.nomorid='"+STR(MNOMORID)+"' order by a.mutasiid"
LCEK = SQLEXEC(OODBC, CSQL, "SMT0")
REPORT FORM akt_invent_mutasi PREVIEW
USE
SELECT (OLDSELECT)
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::CmdBuatJdw
**
PROCEDURE Click
DO FORM gl_inventaris_koreksi WITH THISFORM.NOREKASAL, THISFORM.TEXT2.VALUE
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Cmdkeluar2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Cmdkeluar1
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
YT = MESSAGEBOX("Tanggal : "+DTOC(TANGGAL)+" Bukti : "+BUKTI+" Benar data akan dihapus", 4, "")
IF YT=6
CSQL = "delete from gl_inventaris_mutasi where nomorid=?nomorid and mutasiid=?mutasiid"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
*
*  gl_inventaris_mutasi.scx::Cmdkeluar3
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
MNOID = THISFORM.NOREKASAL
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from gl_inventaris_mutasi where nomorid=?mnoid group by nomorid"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("gagal 1")
ENDIF
MMUTASI = IIF(ISNULL(KREDIT), 0, KREDIT)-IIF(ISNULL(DEBET), 0, DEBET)
MBUKU = THISFORM.TEXT1.VALUE-MMUTASI
CSQL = "update gl_inventaris set akumulasi='"+STR(MMUTASI)+"', nilaibuku='"+STR(MBUKU)+"' where nomorid='"+STR(MNOID)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal 2")
ENDIF
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
***
*** gl_inventaris_mutasi.sct
***
*
***
*** pros_proses.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
PROCEDURE pros_inv
PARAMETER MTGL1, MBUKTI
CSQL = "select * from gl_inventaris where nilaibuku>'0'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
LOCAL MNOMOR, MTANGGAL, MHARGA, MLAMA, MTGLAWAL, MTGLAKHIR, MKE, MPERBULAN, MHARUS, MSEKARANG
GOTO TOP
DO WHILE  .NOT. EOF()
MNOMOR = NOMOR
MTANGGAL = TGLPEROLEHAN
MHARGA = VAL(HARGA)
MLAMA = LAMA
MTGLAWAL = AWALBLN(MTANGGAL)
MTGLAKHIR = AWALBLN(MTGL1)
MKE = ((YEAR(MTGLAKHIR)-YEAR(MTGLAWAL))*12)+(MONTH(MTGLAKHIR)-MONTH(MTGLAWAL))+1
MPERBULAN = PENYUSUTAN
MHARUS = MKE*MPERBULAN
MSEKARANG = VAL(NILAIBUKU)-(MHARGA-MHARUS)
IF MSEKARANG<>0
CSQL = "insert into gl_inventaris_mutasi (nobuku,tanggal, bukti, keterangan, debet, kredit) value "+"('"+ALLTRIM(STR(MNOMOR))+"',"+"'"+SQLDATE(MTGL1)+"',"+"'"+MBUKTI+"',"+"'"+"PENYUSUTAN BY SYSTEM"+"',"+"'"+STR(IIF(MSEKARANG>0, MSEKARANG, 0))+"',"+"'"+STR(IIF(MSEKARANG<0, 0-MSEKARANG, 0))+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT SMT
USE
ENDPROC
**
PROCEDURE pros_BDD
PARAMETER MTGL1, MBUKTI
CSQL = "select * from gl_biayadimuka where sisa>'0'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
LOCAL MNOMOR, MNAMA, MTANGGAL, MHARGA, MLAMA, MTGLAWAL, MTGLAKHIR, MKE, MPERBULAN, MHARUS, MSEKARANG
GOTO TOP
DO WHILE  .NOT. EOF()
MNOMOR = NOMOR
MNAMA = NAMA
MKETERANGAN = KETERANGAN
MTANGGAL = TANGGAL
MBIAYA = VAL(BIAYA)
MLAMA = LAMA
MTGLAWAL = MTANGGAL
MAMORPERHARI = INT(MBIAYA/(TGLAKHIR-TANGGAL))
MLAMAHARI = MTGL1-MTANGGAL
MPERBULAN = PENYUSUTAN
MHARUS = MLAMAHARI*MAMORPERHARI
MSEKARANG = VAL(SISA)-(MBIAYA-MHARUS)
IF MSEKARANG<>0
CSQL = "insert into gl_biayadimuka_mutasi (nobuku,tanggal, bukti, keterangan, debet, kredit) value "+"('"+ALLTRIM(STR(MNOMOR))+"',"+"'"+SQLDATE(MTGL1)+"',"+"'"+MBUKTI+"',"+"'"+"AMORTISASI BY SYSTEM"+"',"+"'"+STR(IIF(MSEKARANG>0, MSEKARANG, 0))+"',"+"'"+STR(IIF(MSEKARANG<0, 0-MSEKARANG, 0))+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT SMT
USE
ENDPROC
**
PROCEDURE pros_Akrual_ABA
PARAMETER MTGL1, MBUKTI
CSQL = "select *,"+"@sldaw=(SELECT saldo from gl_antarbank_akrual where nomorbuku=a.nomorbuku and tanggal='"+SQLDATE(MTGL1-1)+"') as sldawal "+"@ppap1=(SELECT SUM(ppap_debet)-SUM(ppap_kredit) from gl_antarbank_akrual where nomorbuku=a.nomorbuku and tanggal>='"+SQLDATE(AWALBLN(MTGL1))+"' and tanggal<'"+SQLDATE(MTGL1)+"') as jumppap "+" from gl_antarbank"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
GOTO TOP
DO WHILE  .NOT. EOF()
MSALDO = VAL(SALDO)
MJUMMTS = MSALDO-SLDAWAL
MBUNGA = MJUMMTS*(RATE/365)
MPAJAK = IIF(MSALDO>7500000, MBUNGA*(1.0/5), 0)
MPPAP = JUMPPAP
MHRSPPAP = MSALDO*(1.0/200)
MPPAPNOW = MHRSPPAP-MPPAP
IF MBUNGA<>0 .OR. MPPAPNOW<>0
CSQL = "insert into gl_antarbank_akrual (nomorbuku,tanggal,bukti,keterangan,saldo,bg_debet,"+"bg_kredit,pj_debet,pj_kredit,ppap_debet,ppap_kredit) value "+"('"+ALLTRIM(STR(MNOMOR))+"',"+"'"+SQLDATE(MTGL1)+"',"+"'"+MBUKTI+"',"+"'"+"AKRUAL ABA BY SYSTEM"+"',"+"'"+STR(MSALDO)+"',"+"'"+STR(IIF(MBUNGA>0, MBUNGA, 0))+"',"+"'"+STR(0)+"',"+"'"+STR(IIF(MPAJAK>0, MPAJAK, 0))+"',"+"'"+STR(0)+"',"+"'"+STR(IIF(MPPAPNOW>0, MPPAPNOW, 0))+"',"+"'"+STR(IIF(MPPAPNOW<0, 0-MPPAPNOW, 0))+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT SMT
USE
ENDPROC
**
PROCEDURE pros_Akrual_PINJ
PARAMETER MTGL1, MBUKTI
CSQL = "select *,"+"@sldaw=(SELECT saldo from pinjaman_akrual where nomorbuku=a.nomorbuku and tanggal='"+SQLDATE(MTGL1-1)+"') as sldawal "+"@ppap1=(SELECT SUM(ppap_debet)-SUM(ppap_kredit) from gl_antarbank_akrual where nomorbuku=a.nomorbuku and tanggal>='"+SQLDATE(AWALBLN(MTGL1))+"' and tanggal<'"+SQLDATE(MTGL1)+"') as jumppap "+" from pinjaman_akrual"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
GOTO TOP
DO WHILE  .NOT. EOF()
MSALDO = VAL(SALDO)
MJUMMTS = MSALDO-SLDAWAL
MBUNGA = MJUMMTS*(RATE/365)
MPAJAK = IIF(MSALDO>7500000, MBUNGA*(1.0/5), 0)
MPPAP = JUMPPAP
MHRSPPAP = MSALDO*(1.0/200)
MPPAPNOW = MHRSPPAP-MPPAP
IF MBUNGA<>0 .OR. MPPAPNOW<>0
CSQL = "insert into gl_antarbank_akrual (nomorbuku,tanggal,bukti,keterangan,saldo,bg_debet,"+"bg_kredit,pj_debet,pj_kredit,ppap_debet,ppap_kredit) value "+"('"+ALLTRIM(STR(MNOMOR))+"',"+"'"+SQLDATE(MTGL1)+"',"+"'"+MBUKTI+"',"+"'"+"AKRUAL ABA BY SYSTEM"+"',"+"'"+STR(MSALDO)+"',"+"'"+STR(IIF(MBUNGA>0, MBUNGA, 0))+"',"+"'"+STR(0)+"',"+"'"+STR(IIF(MPAJAK>0, MPAJAK, 0))+"',"+"'"+STR(0)+"',"+"'"+STR(IIF(MPPAPNOW>0, MPPAPNOW, 0))+"',"+"'"+STR(IIF(MPPAPNOW<0, 0-MPPAPNOW, 0))+"',"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT SMT
USE
ENDPROC
**
PROCEDURE pros_Akrual_ABA
PARAMETER MTGL1, MBUKTI
CSQL = "select *,"+"@sldaw=(SELECT saldo from gl_antarbank where nomorbuku=a.nomorbuku and tanggal='"+SQLDATE(MTGL1-1)+"') as sldawal "+"@ppap1=(SELECT SUM(ppap_debet)-SUM(ppap_kredit) from gl_antarbank where nomorbuku=a.nomorbuku and tanggal>='"+SQLDATE(AWALBLN(MTGL1))+"' and tanggal<'"+SQLDATE(MTGL1)+"') as jumppap "+" from gl_antarbank"
CSQL = SQLEXEC(OODBC, CSQL, "SMT")
GOTO TOP
DO WHILE  .NOT. EOF()
MSALDO = VAL(SALDO)
MJUMMTS = MSALDO-SLDAWAL
MBUNGA = MJUMMTS*(RATE/365)
MPAJAK = IIF(MSALDO>7500000, MBUNGA*(1.0/5), 0)
MPPAP = JUMPPAP
MHRSPPAP = MSALDO*(1.0/200)
MPPAPNOW = MHRSPPAP-MPPAP
IF MBUNGA<>0 .OR. MPPAPNOW<>0
CSQL = "insert into gl_antarbank_akrual (nomorbuku,tanggal,bukti,keterangan,saldo,bg_debet,"+"bg_kredit,pj_debet,pj_kredit,ppap_debet,ppap_kredit) value "+"('"+ALLTRIM(STR(MNOMOR))+"',"+"'"+SQLDATE(MTGL1)+"',"+"'"+MBUKTI+"',"+"'"+"AKRUAL ABA BY SYSTEM"+"',"+"'"+STR(MSALDO)+"',"+"'"+STR(IIF(MBUNGA>0, MBUNGA, 0))+"',"+"'"+STR(0)+"',"+"'"+STR(IIF(MPAJAK>0, MPAJAK, 0))+"',"+"'"+STR(0)+"',"+"'"+STR(IIF(MPPAPNOW>0, MPPAPNOW, 0))+"',"+"'"+STR(IIF(MPPAPNOW<0, 0-MPPAPNOW, 0))+"',"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT SMT
USE
ENDPROC
**
PROCEDURE pros_neraca
PARAMETER MTGL1
CSQL = "delete from neraca where tanggal='"+SQLDATE(MTGL1)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MSQL = "insert into neraca (tanggal,noper,saldoawal) value "
CSQL = "select noper,@msld:=(select saldo from neraca where noper=a.noper "+" and tanggal<'"+SQLDATE(MTGL1)+"' order by tanggal desc limit 0,1) as saldo "+"from perkiraan as a"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO WHILE  .NOT. EOF()
MSALDO = IIF(ISNULL(SALDO), 0, VAL(SALDO))
MSQL = MSQL+"('"+SQLDATE(MTGL1)+"','"+ALLTRIM(NOPER)+"','"+STR(MSALDO)+"'),"
SKIP
ENDDO
MSQL = LEFT(MSQL, LEN(MSQL)-1)
USE
LCEK = SQLEXEC(OODBC, MSQL)
CSQL = "select noper from jurnal where tanggal='"+SQLDATE(MTGL)+"' group by noper "
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO WHILE  .NOT. EOF()
MNOPER = NOPER
CSQL = "select SUM(jumlah) as jml from jurnal where noper='"+MNOPER+"' and tanggal='"+SQLDATE(MTGL1)+"' and jumlah>0"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MJUMDEBET = JML
CSQL = "select SUM(jumlah) as jml from jurnal where noper='"+MNOPER+"' and tanggal='"+SQLDATE(MTGL1)+"' and jumlah<0"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MJUMKREDIT = JML
USE
CSQL = "UPDATE neraca set debet='"+STR(MJUMDEBET)+"', kredit='"+STR(MJUMKREDIT)+"' where noper='"+MNOPER+"' and tanggal='"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT SMT
SKIP
ENDDO
RETURN
ENDPROC
**
PROCEDURE hit_posneraca
PARAMETER MNOPER, MTGL1, MTGL2
MTGL = MTGL1
DO WHILE .T.
IF MTGL>MTGL2
EXIT
ENDIF
CSQL = "select saldo from neraca where noper='"+MNOPER+"' "+"and tanggal<'"+SQLDATE(MTGL)+"' order by tanggal desc limit 1"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MSALDO = IIF(ISNULL(SALDO) .OR. EMPTY(SALDO), 0, SALDO)
CSQL = "UPDATE neraca set saldoawal='"+STR(MSALDO)+"' where noper='"+MNOPER+"' and tanggal='"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MTGL = MTGL+1
ENDDO
RETURN
ENDPROC
**
PROCEDURE hitneraca
PARAMETER MKANTOR, MNOPER, MTANGGAL
IF EMPTY(MNOPER) .OR. EMPTY(MTANGGAL)
RETURN
ENDIF
CSQL = "select * from perkiraan where noper='"+MNOPER+"' "
LCEK = SQLEXEC(OODBC, CSQL)
IF MTANGGAL<>TGLNOW
CSQL = "insert into log_memo (bag,tanggal,bukti,keterangan,jumlah,opt,catatan) value "+"('AKT','"+SQLDATE(MTANGGAL)+"','"+"bukti"+"','KETERANGAN','0','opt','catatan')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Beri keterangan log")
ENDIF
ENDIF
CSQL = "select sum(case when jumlah>0 then jumlah else 0 end) as jdebet, "+"SUM(case when jumlah<0 then jumlah else 0 end) as jkredit from jurnal where tanggal='"+SQLDATE(MTANGGAL)+"' and noper='"+ALLTRIM(MNOPER)+"' and kantor='"+MKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal Proses hitung neraca")
ENDIF
MDEBET = IIF(ISNULL(JDEBET), 0, JDEBET)
MKREDIT = IIF(ISNULL(JKREDIT), 0, JKREDIT)
USE
MSALDOAWAL = BACANERACA(MKANTOR, MNOPER, MTANGGAL, "AWAL")
CSQL = "select noper,saldo from neraca where noper=?mNoper and kantor=?mKantor and tanggal=?mtanggal"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("cek jurnal gagal")
ENDIF
IF ALLTRIM(NOPER)=ALLTRIM(MNOPER)
CSQL = "update neraca set saldoawal='"+TRANSFORM(MSALDOAWAL, '9999999999999')+"',debet='"+TRANSFORM(MDEBET, '9999999999999')+"',kredit='"+TRANSFORM(MKREDIT, '9999999999999')+"', saldo='"+TRANSFORM(MSALDOAWAL+MDEBET+MKREDIT, '9999999999999')+"' where noper='"+ALLTRIM(MNOPER)+"' and tanggal='"+SQLDATE(MTANGGAL)+"' and kantor='"+MKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Update Neraca")
ENDIF
ELSE
IF MDEBET<>0 .OR. MKREDIT<>0
CSQL = "insert ignore into neraca (kantor,noper,tanggal,saldoawal,debet,kredit,saldo) value "+"('"+MKANTOR+"','"+ALLTRIM(MNOPER)+"','"+SQLDATE(MTANGGAL)+"','"+TRANSFORM(MSALDOAWAL, '9999999999999')+"','"+TRANSFORM(MDEBET, '9999999999999')+"','"+TRANSFORM(MKREDIT, '9999999999999')+"','"+TRANSFORM(MSALDOAWAL+MDEBET+MKREDIT, '9999999999999')+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert neraca")
ENDIF
ENDIF
ENDIF
ENDPROC
**
PROCEDURE hitlaba
PARAMETER MTGL
FORMULALABA = ALLTRIM(DEFANOPERFORMULA)
IF OCCURS("+", FORMULALABA)>0
MFORMULA = STRTRAN(FORMULALABA, "+", "%' or noper like '")
MFORMULA = "noper like '"+MFORMULA+"%'"
ELSE
MFORMULA = "noper like '"+FORMULALABA+"%'"
ENDIF
CSQL = "select SUM(debet+kredit) as sld from neraca where tanggal='"+SQLDATE(MTGL)+"' and ("+MFORMULA+")"
LCEK = SQLEXEC(OODBC, CSQL, "xx")
MSALDO1 = IIF(ISNULL(SLD), 0, SLD)
MSALDOAWAL = BACANERACA(DEFAKANTOR, DEFANOPERPHUNOW, MTGL, "AWAL")
CSQL = "select noper from neraca where noper='"+DEFANOPERPHUNOW+"' and tanggal='"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF NOPER=ALLTRIM(DEFANOPERPHUNOW)
MESSAGEBOX("UPDATE")
MESSAGEBOX(DEFANOPERPHUNOW)
MESSAGEBOX(MSALDOAWAL)
MESSAGEBOX(MSALDO1)
CSQL = "update neraca set saldoawal='"+TRANSFORM(MSALDOAWAL, '9999999999999')+"', debet='"+TRANSFORM(IIF(MSALDO1>0, MSALDO1, 0), '9999999999999')+"', kredit='"+TRANSFORM(IIF(MSALDO1<0, MSALDO1, 0), '9999999999999')+"', saldo='"+TRANSFORM(MSALDOAWAL+MSALDO1, '9999999999999')+"' "+" where noper='"+DEFANOPERPHUNOW+"' and tanggal='"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "insert into neraca (kantor,noper,tanggal,saldoawal,debet,kredit,saldo) value "+"('"+DEFAKANTOR+"','"+ALLTRIM(DEFANOPERPHUNOW)+"','"+SQLDATE(MTGL)+"','"+TRANSFORM(MSALDOAWAL, '9999999999999')+"','"+TRANSFORM(IIF(MSALDO1>0, MSALDO1, 0), '9999999999999')+"','"+TRANSFORM(IIF(MSALDO1<0, MSALDO1, 0), '9999999999999')+"','"+TRANSFORM(MSALDOAWAL+MSALDO1, '9999999999999')+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDPROC
**
PROCEDURE pros_vld_inv
PARAMETER MTGL1
CSQL = "select * from gl_inventaris where nilaibuku>'0'"
CSQL = SQLEXEC(OODBC, CSQL, "SMT")
LOCAL MNOMOR, MTANGGAL, MHARGA, MLAMA, MTGLAWAL, MTGLAKHIR, MKE, MPERBULAN, MHARUS, MSEKARANG
GOTO TOP
DO WHILE  .NOT. EOF()
MNOMOR = NOMOR
MTANGGAL = TGLPEROLEHAN
MHARGA = VAL(HARGA)
MLAMA = LAMA
MTGLAWAL = AWALBLN(MTANGGAL)
MTGLAKHIR = AWALBLN(MTGL1)
MKE = ((YEAR(MTGLAKHIR)-YEAR(MTGLAWAL))*12)+(MONTH(MTGLAKHIR)-MONTH(MTGLAWAL))+1
MPERBULAN = PENYUSUTAN
MHARUS = MKE*MPERBULAN
MSEKARANG = VAL(NILAIBUKU)-(MHARGA-MHARUS)
IF MSEKARANG<>0
CSQL = "insert into log_valid (modul,keterangan) value "+"('"+"INVENTARIS"+"',"+"'"+"KETERANGAN"+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT SMT
USE
ENDPROC
**
PROCEDURE validasi
PARAMETER MTGL
CSQL = "select * from anggota where MONTH(tanggallhr)='"+STR(MONTH(MTGL))+" and DAY(tanggallhr)='"+STR(DAY(MTGL))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
? '-----------------------------------------------------------'
? ' DAFTAR NASABAH ULANG TAHUN '
? '==========================================================='
ENDIF
DO WHILE  .NOT. EOF()
? CIF, ' ', NAMA, ' ', ALAMAT, ' ', DESA, ' ', KECAMATAN, ' ', PHONE
SKIP
ENDDO
CSQL = "select * from simpanan_blokir where (tglcabut='0000-00-00' or tglcabut>'"+SQLDATE(MTGL)+"') and "+"tglakhirblokir='"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO WHILE  .NOT. EOF()
? '------------------------------------------------------'
? 'SURAT BLOKIR JATUH TEMPO'
? '======================================================'
? NOREK, ' ', TANGGAL, ' ', SALDOBLOKIR, ' ', KETERANGAN
SKIP
ENDDO
IF RECCOUNT()>0
? '------------------------------------------------------'
ENDIF
USE
CSQL = "select dept,norek,tanggal,catatan,jumlah,vld,vld2,tglvalid from catatan where vld='2' and "+"((vld2=1 and tglvalid>=mtgl) or (vld2='2' and tglvalid=mtgl) or (vld2='3' and DAY(tglvalid)='"+STR(DAY(MTGL))+"')) order by dept"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca catatan")
RETURN
ENDIF
IF RECCOUNT()>0
? '-----------------------------------------------------------'
? ' CATATAN'
? '==========================================================='
ENDIF
GOTO TOP
DO WHILE  .NOT. EOF()
SKIP
ENDDO
ENDPROC
**
PROCEDURE jumneraca
PARAMETER XNOPER
LOCAL MDUMMY, MTANGGAL, MDEBET, MKREDIT, MAWAL
MDUMMY = "DUMMY"
CSQL = "select MAX(tanggal) as tgl from neraca where noper='"+XNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDUMMY)
MTANGGAL = TGL
USE
IF MTANGGAL=TGLNOW
MAWAL = 0
ELSE
CSQL = "select saldo from neraca where noper='"+XNOPER+"' and tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDUMMY)
MAWAL = VAL(SALDO)
ENDIF
CSQL = "select jumlah from jurnal where jumlah>0 and noper='"+XNOPER+"' and tanggal='"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDUMMY)
MDEBET = VAL(JUMLAH)
CSQL = "select jumlah from jurnal where jumlah<=0 and noper='"+XNOPER+"' and tanggal='"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDUMMY)
MKREDIT = VAL(JUMLAH)
CSQL = "select noper from neraca where noper='"+XNOPER+"' and tanggal='"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDUMMY)
IF NOPER<>XNOPER
CSQL = "insert into neraca set kantor='"+DEFAKANTOR+"', tanggal='"+SQLDATE(TGLNOW)+"', "+"noper='"+XNOPER+"', saldoawal='"+STR(MAWAL)+"',debet='"+STR(MDEBET)+"',kredit='"+STR(MKREDIT)+"',saldo='"+STR(MAWAL+MDEBET-MKREDIT)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
MESSAGEBOX(MAWAL)
MESSAGEBOX(MDEBET)
MESSAGEBOX(MKREDIT)
MESSAGEBOX(MAWAL+MDEBET-MKREDIT)
CSQL = "UPDATE neraca set saldoawal='"+STR(MAWAL)+", debet='"+STR(MDEBET)+"', kredit='"+STR(MKREDIT)+"', saldo='"+STR(MAWAL+MDEBET-MKREDIT)+"' WHERE noper='"+XNOPER+"' and tanggal='"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
? CSQL
MESSAGEBOX(LCEK)
ENDIF
ENDPROC
**
PROCEDURE cekdata
RETURN
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** gl_inventaris_koreksi.scx
***
*
*
*  gl_inventaris_koreksi.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOMOR, MNILAIBUKU
THISFORM.PEROLEHAN = MNILAIBUKU
THISFORM.TEXT41.VALUE = MNOMOR
THISFORM.TEXT42.VALUE = TGLNOW
THISFORM.TEXT1.VALUE = ''
THISFORM.TEXT3.VALUE = MNILAIBUKU
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Command3
**
PROCEDURE Click
MNOMOR = THISFORM.TEXT41.VALUE
WITH THISFORM
CSQL = "insert into gl_inventaris_mutasi (kantor,nomorid,tanggal,bukti,keterangan,debet,kredit) value "+"('"+DEFAKANTOR+"',"+"'"+STR(.TEXT41.VALUE)+"',"+"'"+SQLDATE(.TEXT42.VALUE)+"',"+"'"+.TEXT1.VALUE+"',"+"'"+.TEXT2.VALUE+"',"+"'"+STR(.TEXT4.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT * FROM gl_inventaris_mutasi WHERE kantor=?kantor AND nomorid=?nomorid"
LCEK = SQLEXEC(OODBC, CSQL, "smt01")
GOTO TOP
MSALDO = THISFORM.PEROLEHAN
DO WHILE  .NOT. EOF()
MSALDO = MSALDO+DEBET-KREDIT
CSQL = "select saldo from gl_inventaris_mutasi where mutasiid=?mutasiid"
LCEK = SQLEXEC(OODBC, CSQL, "smt02")
VSALDO = SALDO
USE
SELECT SMT01
IF VSALDO<>MSALDO
CSQL = "update gl_inventaris_mutasi set saldo=?msaldo where mutasiid=?mutasiid"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SKIP
ENDDO
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
THISFORM.TEXT7.VALUE = THISFORM.TEXT2.VALUE
DO CASE
CASE THIS.VALUE="I"
THISFORM.TEXT4.VALUE = 0048
THISFORM.TEXT5.VALUE = INT(THISFORM.TEXT2.VALUE/0048)
CASE THIS.VALUE="II"
THISFORM.TEXT4.VALUE = 0096
THISFORM.TEXT5.VALUE = INT(THISFORM.TEXT2.VALUE/0096)
CASE THIS.VALUE="III"
THISFORM.TEXT4.VALUE = (00192)
THISFORM.TEXT5.VALUE = INT(THISFORM.TEXT2.VALUE/(00192))
OTHERWISE
MESSAGEBOX("Golongan Debitur hanya untuk 3 golongan", 16, "WARNING")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDCASE
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Text4
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE-THISFORM.TEXT5.VALUE
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Text5
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE-THISFORM.TEXT5.VALUE
ENDPROC
**
*
*  gl_inventaris_koreksi.scx::Text6
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** gl_inventaris_koreksi.sct
***
*
***
*** gl_ksd_data.scx
***
*
*
*  gl_ksd_data.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
IF MMODE="TAMPIL" .OR. MMODE="EDIT"
IF MMODE="TAMPIL"
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
WITH THISFORM
.TEXT41.VALUE = NOMORBUKU
.TEXT42.VALUE = TANGGAL
.TEXT1.VALUE = BUKTI
.TEXT2.VALUE = NAMA
.TEXT3.VALUE = KETERANGAN
.TEXT4.VALUE = PETUGAS
.TEXT5.VALUE = VAL(AWAL)
.TEXT6.VALUE = VAL(MUTASI)
.TEXT7.VALUE = VAL(SALDO)
ENDWITH
ENDIF
IF MMODE="INPUT"
THISFORM.SETALL("enabled", .T., "textbox")
WITH THISFORM
.TEXT41.ENABLED = .F.
.TEXT41.VALUE = ''
.TEXT42.VALUE = TGLNOW
.TEXT1.VALUE = ''
.TEXT2.VALUE = ''
.TEXT3.VALUE = ''
.TEXT4.VALUE = ''
.TEXT5.VALUE = 0
.TEXT6.VALUE = 0
.TEXT7.VALUE = 0
.TEXT6.ENABLED = .F.
.TEXT7.ENABLED = .F.
ENDWITH
ENDIF
IF MMODE="EDIT"
THISFORM.SETALL("enabled", .T., "textbox")
THISFORM.TEXT41.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
ENDIF
ENDPROC
**
*
*  gl_ksd_data.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_ksd_data.scx::Command3
**
PROCEDURE Click
MNOMOR = NOMORBUKU
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into gl_ksd (kantor,noper,nomorbuku,tanggal,bukti,nama,keterangan,petugas,awal,mutasi,saldo) value "+"('"+DEFAKANTOR+"',"+"'"+"NOPER"+"',"+"'"+.TEXT41.VALUE+"',"+"'"+SQLDATE(.TEXT42.VALUE)+"',"+"'"+.TEXT1.VALUE+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT3.VALUE+"',"+"'"+.TEXT4.VALUE+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT6.VALUE)+"',"+"'"+STR(.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "update gl_ksd set "+"tanggal='"+SQLDATE(.TEXT42.VALUE)+"',"+"bukti='"+.TEXT1.VALUE+"',"+"nama='"+.TEXT2.VALUE+"',"+"keterangan='"+.TEXT3.VALUE+"',"+"petugas='"+.TEXT4.VALUE+"',"+"awal='"+STR(.TEXT5.VALUE)+"',"+"saldo='"+STR(.TEXT7.VALUE)+"' "+"where nomorbuku='"+STR(MNOMOR)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_ksd_data.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_ksd_data.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_ksd_data.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_ksd_data.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_ksd_data.scx::Text4
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_ksd_data.scx::Text5
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT7.VALUE = THIS.VALUE-THISFORM.TEXT6.VALUE
ENDPROC
**
*
*  gl_ksd_data.scx::Text7
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_ksd_data.scx::Text6
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** gl_ksd_data.sct
***
*
***
*** gl_aba_data.scx
***
*
*
*  gl_aba_data.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
IF MMODE="TAMPIL" .OR. MMODE="EDIT"
IF MMODE="TAMPIL"
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
WITH THISFORM
.TEXT41.VALUE = NOMORID
.TEXT42.VALUE = TANGGAL
.TEXT1.VALUE = NOACCOUNT
.TEXT2.VALUE = NAMA
.TEXT3.VALUE = KETERANGAN
.COMBO1.VALUE = JENIS
.TEXT5.VALUE = RATE
.TEXT6.VALUE = JW
.TEXT7.VALUE = TGLJTEMPO
.TEXT8.VALUE = PROSEN_PPAP
.TEXT9.VALUE = AWAL
.TEXT10.VALUE = MUTASI
.TEXT11.VALUE = SALDO
.TEXT12.VALUE = PPAP
ENDWITH
ENDIF
IF MMODE="INPUT"
THISFORM.SETALL("enabled", .T., "textbox")
THISFORM.COMBO1.ENABLED = .T.
WITH THISFORM
.TEXT41.ENABLED = .F.
.TEXT41.VALUE = ''
.TEXT42.VALUE = TGLNOW
.TEXT1.VALUE = ''
.TEXT2.VALUE = ''
.TEXT3.VALUE = ''
.COMBO1.VALUE = 'TABUNGAN'
.TEXT5.VALUE = 0
.TEXT6.VALUE = 0
.TEXT7.VALUE = ''
.TEXT8.VALUE = 0.5 
.TEXT9.VALUE = 0
.TEXT10.VALUE = 0
.TEXT11.VALUE = 0
.TEXT12.VALUE = 0
.TEXT10.ENABLED = .F.
.TEXT11.ENABLED = .F.
.TEXT12.ENABLED = .F.
ENDWITH
ENDIF
IF MMODE="EDIT"
THISFORM.SETALL("enabled", .T., "textbox")
THISFORM.TEXT41.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_aba_data.scx::Command3
**
PROCEDURE Click
MNOMOR = NOMORID
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into gl_antarbank (kantor,tanggal,noaccount,nama,keterangan"+",jenis,rate,jw,tgljtempo,prosen_ppap,awal,mutasi,saldo,ppap) "+" value ("+"'"+DEFAKANTOR+"',"+"'"+SQLDATE(.TEXT42.VALUE)+"',"+"'"+.TEXT1.VALUE+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT3.VALUE+"',"+"'"+.COMBO1.VALUE+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT6.VALUE)+"',"+"'"+SQLDATE(.TEXT7.VALUE)+"',"+"'"+STR(.TEXT8.VALUE)+"',"+"'"+STR(.TEXT9.VALUE)+"',"+"'"+STR(.TEXT10.VALUE)+"',"+"'"+STR(.TEXT11.VALUE)+"',"+"'"+STR(.TEXT12.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "update gl_antarbank set "+"tanggal='"+SQLDATE(.TEXT42.VALUE)+"',"+"noaccount='"+.TEXT1.VALUE+"',"+"nama='"+.TEXT2.VALUE+"',"+"keterangan='"+.TEXT3.VALUE+"',"+"jenis='"+.COMBO1.VALUE+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"jw='"+STR(.TEXT6.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT7.VALUE)+"',"+"prosen_ppap='"+STR(.TEXT8.VALUE)+"',"+"awal='"+STR(.TEXT9.VALUE)+"',"+"mutasi='"+STR(.TEXT10.VALUE)+"',"+"saldo='"+STR(.TEXT11.VALUE)+"',"+"ppap='"+STR(.TEXT12.VALUE)+"' "+"where nomorid='"+STR(MNOMOR)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_aba_data.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text5
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text7
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text6
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text8
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text9
**
PROCEDURE InteractiveChange
THISFORM.TEXT11.VALUE = THIS.VALUE-THISFORM.TEXT10.VALUE
THISFORM.TEXT12.VALUE = THIS.VALUE*(THISFORM.TEXT8.VALUE/100)
ENDPROC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text10
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text11
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Text12
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Combo1
**
PROCEDURE LostFocus
IF THIS.VALUE="TABUNGAN"
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
ELSE
THISFORM.TEXT6.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  gl_aba_data.scx::Command1
**
PROCEDURE Click
DO FORM gl_bkbantu_mutasi WITH "TAMPIL", "ABA"
ENDPROC
**
*
*  gl_aba_data.scx::Command4
**
PROCEDURE Click
DO FORM gl_aba_pbk_bunga
ENDPROC
**
***
*** gl_aba_data.sct
***
*
***
*** pros_simp.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
FUNCTION saldosimp
PARAMETER MNOREK, MTANGGAL
LOCAL OLDSELECT
OLDSELECT = SELECT()
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTANGGAL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
USE
SELECT (OLDSELECT)
RETURN MSALDO
ENDFUNC
**
PROCEDURE cetakhead
IF MYPRINT("ON", "century gothic", 10)
MBRS = 3
MKOL = 10
@ MBRS+0, MKOL SAY NAMA
@ MBRS+1, MKOL SAY NOREK
@ MBRS+2, MKOL SAY ALAMAT
@ MBRS+3, MKOL SAY KOTA
ENDIF
MYPRINT("OFF")
RETURN
ENDPROC
**
PROCEDURE cetakhead1
PARAMETER MNOREK
OLDSELECT = SELECT()
CSQL = "select a.norek,b.nama,b.alamat,b.rt,b.desa,b.kecamatan,b.kota from simpanan as a, anggota as b where a.cif=b.cif and a.norek=?mnorek"
LCEK = SQLEXEC(OODBC, CSQL, "HEAD1")
MFRX = SYS(2023)+"\HEAD.FRX"
MFRT = STRTRAN(MFRX, ".FRX", ".FRT")
SELECT 0
USE ctk_buku_header.frx ALIAS CTK
SELECT * FROM CTK INTO TABLE &MFRX
USE
SELECT CTK
USE
USE &MFRX ALIAS TEST
SELECT 0
CSQL = "select * from set_cetakfrx where namafrx='BUKU_TAB_HEAD'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MHPOS = HPOS
MVPOS = VPOS
MVPOS1 = VPOS+2500
MVPOS2 = VPOS+2500+2187
USE
SELECT TEST
LOCATE FOR ALLTRIM(EXPR)="norek"
REPLACE VPOS WITH MVPOS, HPOS WITH MHPOS
LOCATE FOR ALLTRIM(UPPER(EXPR))="NAMA"
REPLACE VPOS WITH MVPOS1, HPOS WITH MHPOS
LOCATE FOR LEFT(ALLTRIM(UPPER(EXPR)), 7)="ALLTRIM"
REPLACE VPOS WITH MVPOS2, HPOS WITH MHPOS
USE
SELECT HEAD1
SET CONSOLE OFF
IF DEFAUSERID="IMR"
REPORT FORM (MFRX) PREVIEW
ELSE
REPORT FORM (MFRX) TO PRINTER
ENDIF
USE
SET CONSOLE ON
SELECT (OLDSELECT)
ERASE &MFRX 
ERASE &MFRT
ENDPROC
**
FUNCTION cetaktabungan
LPARAMETERS MIDDATA, MURUT
LOCAL OLDDBF
OLDDBF = SELECT()
MFRX = "d:\TAB.FRX"
MFRT = STRTRAN(MFRX, ".FRX", ".FRT")
SELECT 0
CSQL = "select * from set_cetakfrx where namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
STORE 0 TO MBARIS, MBRSHAL1, MHEIGHT, MANTARA, LNOMOR, LTANGGAL, LKODE, LDEBET, LKREDIT, LSALDO, LOPT
DO WHILE  .NOT. EOF()
DO CASE
CASE OBJCODE=1
MBARIS = BARIS
MBRSHAL1 = BRSHAL1
MHEIGHT = HEIGHT
MANTARA = ANTARA
CASE ALLTRIM(EXPR)="nomor"
LNOMOR = HPOS
CASE ALLTRIM(EXPR)="tanggal"
LTANGGAL = HPOS
CASE ALLTRIM(EXPR)="kode"
LKODE = HPOS
CASE ALLTRIM(EXPR)="debet"
LDEBET = HPOS
CASE ALLTRIM(EXPR)="kredit"
LKREDIT = HPOS
CASE ALLTRIM(EXPR)="saldo"
LSALDO = HPOS
CASE ALLTRIM(EXPR)="opt"
LOPT = HPOS
ENDCASE
SKIP
ENDDO
USE
SELECT 0
USE ctk_buku_mutasi.frx ALIAS CTK
SELECT * FROM CTK INTO TABLE &MFRX
USE
SELECT CTK
USE
USE &MFRX ALIAS TEST
LOCATE FOR OBJCODE=1
REPLACE HEIGHT WITH MHEIGHT
LOCATE FOR ALLTRIM(EXPR)="nomor"
REPLACE HPOS WITH LNOMOR
LOCATE FOR ALLTRIM(EXPR)="tanggal"
REPLACE HPOS WITH LTANGGAL
LOCATE FOR ALLTRIM(EXPR)="kode"
REPLACE HPOS WITH LKODE
LOCATE FOR ALLTRIM(EXPR)="debet"
REPLACE HPOS WITH LDEBET
LOCATE FOR ALLTRIM(EXPR)="kredit"
REPLACE HPOS WITH LKREDIT
LOCATE FOR ALLTRIM(EXPR)="saldo"
REPLACE HPOS WITH LSALDO
LOCATE FOR ALLTRIM(EXPR)="opt"
REPLACE HPOS WITH LOPT
USE
SELECT (OLDDBF)
LOCATE FOR IDDATA=MIDDATA
DO WHILE  .NOT. EOF()
SELECT 0
CREATE CURSOR ctkbuku2 (NOMOR INT (2), TANGGAL D, KODE C (2), DEBET INT (15), KREDIT INT (15), SALDO INT (15), OPT C (5))
SELECT CTKBUKU2
FOR AA = 1 TO MURUT+IIF(MURUT>MBRSHAL1, MANTARA, 0)
APPEND BLANK
ENDFOR
SELECT (OLDDBF)
DO WHILE  .NOT. EOF()
IF  .NOT. EMPTY(IDDATA)
MTANGGAL = TANGGAL
MKODE = KODE
MDEBET = DEBET
MKREDIT = KREDIT
MSALDO = SALDO
MOPT = OPT
REPLACE CETAKBUKU WITH '*'
CSQL = "update simpanan_mutasi set cetakbuku='*' where iddata='"+STR(IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT CTKBUKU2
APPEND BLANK
REPLACE NOMOR WITH MURUT, TANGGAL WITH MTANGGAL, KODE WITH MKODE
REPLACE DEBET WITH MDEBET, KREDIT WITH MKREDIT, SALDO WITH MSALDO, OPT WITH MOPT
IF MURUT=MBRSHAL1
FOR AA = 1 TO MANTARA
APPEND BLANK
ENDFOR
ENDIF
IF MURUT=MBARIS
MURUT = 1
EXIT
ENDIF
MURUT = MURUT+1
ENDIF
SELECT (OLDDBF)
SKIP
ENDDO
SELECT CTKBUKU2
GOTO TOP
LCOLDPRINTER = SET('PRINTER', 3)
SET PRINTER TO NAME (LCOLDPRINTER)
IF DEFAUSERID="IMR"
REPORT FORM ctk_buku_mutasi PREVIEW
ELSE
REPORT FORM ctk_buku_mutasi TO PRINTER
ENDIF
USE
SELECT (OLDSELE)
IF EOF()
EXIT
ENDIF
JWB = MESSAGEBOX("Cetak Halaman Berikutnya", 36, "")
IF JWB=7
EXIT
ENDIF
ENDDO
SELECT (OLDDBF)
RETURN MURUT
ENDFUNC
**
PROCEDURE simpanan_cetak_bilyet
PARAMETER MNOREK
RETURN
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** simpanan.scx
***
*
*
*  simpanan.scx::SIMPANAN
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 7
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "NOREK"
.COLUMN2.HEADER1.CAPTION = "NO.REKENING"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "CIF"
.COLUMN3.HEADER1.CAPTION = "NO.ANGGOTA"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 300
.COLUMN4.CONTROLSOURCE = "NAMA"
.COLUMN4.HEADER1.CAPTION = "NAMA"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 300
.COLUMN5.CONTROLSOURCE = "ALAMAT"
.COLUMN5.HEADER1.CAPTION = "ALAMAT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 200
.COLUMN6.CONTROLSOURCE = "KECAMATAN"
.COLUMN6.HEADER1.CAPTION = "KECAMATAN"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN7.WIDTH = 200
.COLUMN7.CONTROLSOURCE = "KOTA"
.COLUMN7.HEADER1.CAPTION = "KOTA"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
MJNS = ""
A = 1
IF THISFORM.CHECK1.VALUE=1
MJNS = MJNS+"jenis='1' or "
A = A+1
ENDIF
IF THISFORM.CHECK2.VALUE=1
MJNS = MJNS+"jenis='2' or "
A = A+1
ENDIF
IF THISFORM.CHECK3.VALUE=1
MJNS = MJNS+"jenis='3' or "
A = A+1
ENDIF
MJNS = IIF(EMPTY(MJNS), "", LEFT(MJNS, LEN(MJNS)-4))
MJNS = IIF(A=0, "", IIF(A=1, MJNS, " ("+MJNS+")"))
DO CASE
CASE THISFORM.STATUS="A"
CSQL = "select COUNT(b.nama) as jml from simpanan as a, anggota as b where a.tgltutup='0000-00-00' and a.cif=b.cif and "
CASE THISFORM.STATUS="P"
CSQL = "select COUNT(b.nama) as jml  from simpanan as a, anggota as b where a.tgltutup>'0000-00-00' and a.cif=b.cif and "
CASE THISFORM.STATUS="B"
CSQL = "select COUNT(b.nama) as jml  from simpanan_blokir as c left join simpanan as a on c.norek=a.norek left join anggota as b on a.cif=b.cif where  "
CASE THISFORM.STATUS="D"
CSQL = "select COUNT(b.nama) as jml  from simpanan_autodebet as c left join simpanan as a on c.norek=a.norek left join anggota as b on a.cif=b.cif where  "
ENDCASE
MFILTER = IIF(EMPTY(THISFORM.MFILTER.CAPTION) .AND. EMPTY(MJNS), "1", IIF(EMPTY(THISFORM.MFILTER.CAPTION), MJNS, THISFORM.MFILTER.CAPTION+' and '+MJNS))
CSQL = CSQL+MFILTER
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJML = IIF(ISNULL(JML), 0, IIF(VARTYPE(JML)="C", VAL(JML), JML))
THISFORM.JUMREC = MJML
THISFORM.HALAMAN = INT(MJML/THISFORM.MLIMIT.VALUE)
THISFORM.HALAMAN = IIF(THISFORM.HALAMAN<1, 1, THISFORM.HALAMAN)
IF THISFORM.HAL.VALUE=0
THISFORM.HAL.VALUE = THISFORM.HALAMAN
ELSE
THISFORM.HAL.VALUE = MIN(THISFORM.HALAMAN, THISFORM.HAL.VALUE)
ENDIF
MLIMIT = ALLTRIM(STR((THISFORM.HAL.VALUE-1)*THISFORM.MLIMIT.VALUE))+", "+ALLTRIM(STR(THISFORM.MLIMIT.VALUE))
DO CASE
CASE THISFORM.STATUS="A"
CSQL = "select b.iddata,b.cif_lama,b.nama,b.alamat,b.rt,b.desa,b.kecamatan,b.kota,b.ibu,b.phone,a.* from simpanan as a, anggota as b where a.tgltutup='0000-00-00' and a.cif=b.cif and "
CASE THISFORM.STATUS="P"
CSQL = "select b.iddata,b.cif_lama,b.nama,b.alamat,b.rt,b.desa,b.kecamatan,b.kota,b.ibu,a.* from simpanan as a, anggota as b where a.tgltutup>'0000-00-00' and a.cif=b.cif and "
CASE THISFORM.STATUS="B"
CSQL = "select b.iddata,b.cif_lama,a.*,a.norek,b.nama,b.alamat,b.rt,b.desa,b.kota from simpanan_blokir as c left join simpanan as a on a.norek=c.norek left join anggota as b on a.cif=b.cif where  "
CASE THISFORM.STATUS="D"
CSQL = "select b.iddata,b.cif_lama,a.*,a.norek,b.nama,b.alamat,b.rt,b.desa,b.kota from simpanan_autodebet as c left join simpanan as a on a.norek=c.norek left join anggota as b on a.cif=b.cif where  "
ENDCASE
CSQL = CSQL+MFILTER
CSQL = CSQL+" order by norek limit "+MLIMIT
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
RETURN
ENDIF
JMLDATA = RECCOUNT()
GOTO TOP
ENDPROC
**
PROCEDURE Activate
THISFORM.WINDOWSTATE = 2
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA)
MNOREK = NOREK
USE
SELECT (THISFORM.OLDSELECT)
RETURN MNOREK
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MSTATUS
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "TAMPIL"
ENDIF
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("SIMP", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("SIMP", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("SIMP", "HAPUS")
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
IF VARTYPE(MSTATUS)="X" .OR. VARTYPE(MSTATUS)="L" .OR. MSTATUS="A"
MSTATUS = "A"
ENDIF
DO CASE
CASE MSTATUS="A"
THISFORM.LABEL2.CAPTION = "DAFTAR SIMPANAN (AKTIF)"
CASE MSTATUS="B"
THISFORM.LABEL2.CAPTION = "DAFTAR BLOKIR SIMPANAN"
CASE MSTATUS="D"
THISFORM.LABEL2.CAPTION = "DAFTAR AUTODEBET SIMPANAN"
CASE MSTATUS="P"
THISFORM.LABEL2.CAPTION = "DAFTAR SIMPANAN (HISTORY)"
OTHERWISE
THISFORM.RELEASE
ENDCASE
THISFORM.STATUS = MSTATUS
IF MMODE="TAMPIL"
THISFORM.MFILTER.CAPTION = ""
ENDIF
THISFORM.MLIMIT.VALUE = 50
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
IF MMODE="CARI"
THISFORM.CMDCARI1.CLICK
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
*
*  simpanan.scx::Cmdhapus
**
PROCEDURE Click
IF THISFORM.STATUS="A"
MNOREK = NOREK
CSQL = "select * from simpanan_mutasi where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF NOREK=MNOREK
MESSAGEBOX("DATA TIDAK DAPAT DIHAPUS, KARENA MASIH TERDAPAT MUTASI")
RETURN
ENDIF
CSQL = "select * from simpanan_blokir where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tglcabut='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF NOREK=MNOREK
MESSAGEBOX("DATA TIDAK DAPAT DIHAPUS, TABUNGAN DIBLOKIR")
RETURN
ENDIF
CSQL = "delete from simpanan where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from simpanan_bilyet where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat dihapus", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  simpanan.scx::Cmdedit
**
PROCEDURE Click
IF THISFORM.STATUS="A"
MYDATA = THISFORM.DATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM .\form\simpanan_data WITH "EDIT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat dikoreksi", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  simpanan.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
IF THISFORM.STATUS="A"
MYDATA = THISFORM.DATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM ./form/simpanan_data TO MNOREK WITH "INPUT"
IF  .NOT. EMPTY(MNOREK)
THISFORM.MFILTER.CAPTION = "norek='"+MNOREK+"'"
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat digunakan untuk input data", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  simpanan.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::Cmddatatop1
**
PROCEDURE Click
IF THISFORM.HAL.VALUE=1
MESSAGEBOX("Halaman Pertama", 16, "")
RETURN
ENDIF
THISFORM.HAL.VALUE = THISFORM.HAL.VALUE-1
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(a.cif),TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama),a.norek,b.tanggal)"+" LIKE "+UPPER(MFILTER)
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  simpanan.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  simpanan.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::Cmddatabott1
**
PROCEDURE Click
IF THISFORM.HAL.VALUE=THISFORM.HALAMAN
MESSAGEBOX("Halaman Terakhir", 16, "")
RETURN
ENDIF
THISFORM.HAL.VALUE = THISFORM.HAL.VALUE+1
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::mLimit
**
PROCEDURE LostFocus
THISFORM.HAL.VALUE = 0
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE DblClick
IF THISFORM.MODE="CARI"
THISFORM.RELEASE
ELSE
DO FORM .\form\simpanan_data WITH "TAMPIL"
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
IF THISFORM.MODE="CARI"
THISFORM.RELEASE
ELSE
DO FORM .\form\simpanan_data WITH "TAMPIL"
ENDIF
KEYBOARD '{LEFTARROW}'
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
*
*  simpanan.scx::hal
**
PROCEDURE LostFocus
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::Check1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::Check2
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan.scx::Check3
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
***
*** simpanan.sct
***
*
***
*** simpanan_setproduk1_jurnal.scx
***
*
*
*  simpanan_setproduk1_jurnal.scx::FORM1
**
PROCEDURE myenable
PARAMETER MKONDISI
WITH THISFORM
.TEXT1.ENABLED = MKONDISI
.TEXT2.ENABLED = MKONDISI
.TEXT3.ENABLED = MKONDISI
.TEXT4.ENABLED = MKONDISI
.TEXT5.ENABLED = MKONDISI
.TEXT6.ENABLED = MKONDISI
.TEXT7.ENABLED = MKONDISI
.COMMAND1.ENABLED = MKONDISI
.COMMAND2.ENABLED = MKONDISI
.COMMAND3.ENABLED = MKONDISI
.COMMAND4.ENABLED = MKONDISI
.COMMAND5.ENABLED = MKONDISI
.COMMAND6.ENABLED = MKONDISI
.COMMAND7.ENABLED = MKONDISI
.CMDSIMPAN1.VISIBLE = MKONDISI
.CMDBATAL1.VISIBLE = MKONDISI
.CMDKELUAR1.VISIBLE =  .NOT. MKONDISI
ENDWITH
ENDPROC
**
PROCEDURE tampil
LOCAL OLDSELECT
OLDSELECT = SELECT()
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' and sandi='"+THISFORM.MYSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM
.TEXT8.VALUE = SANDI
.TEXT9.VALUE = KETERANGAN
.TEXT1.VALUE = JURNALTAB
.TEXT2.VALUE = JURNALUTANGBG
.TEXT3.VALUE = JURNALBUNGA
.TEXT4.VALUE = JURNALADM
.TEXT5.VALUE = JURNALADMTUTUP
.TEXT6.VALUE = JURNALPAJAK
.TEXT7.VALUE = JURNALKSD
ENDWITH
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE Init
PARAMETER MSANDI, MDEPT, MMODE
IF VARTYPE(MDEPT)="X"
MDEPT = ""
ENDIF
THISFORM.DEPT = MDEPT
THISFORM.MYSANDI = MSANDI
THISFORM.MYMODE = MMODE
THISFORM.DBFDATA = SYS(2015)
THISFORM.ADDOBJECT("mkop", "label")
THISFORM.MKOP.TOP = 5
THISFORM.MKOP.LEFT = 20
THISFORM.MKOP.WIDTH = THISFORM.WIDTH-50
THISFORM.MKOP.ALIGNMENT = 2
THISFORM.MKOP.HEIGHT = 23
THISFORM.MKOP.FONTSIZE = 14
THISFORM.MKOP.FONTBOLD = .T.
THISFORM.MKOP.CAPTION = "REKENING JURNAL"
THISFORM.MKOP.VISIBLE = .T.
THISFORM.MKOP.BACKSTYLE = 0
THISFORM.MKOP.FORECOLOR = RGB(255, 255, 255)
DO CASE
CASE MDEPT="TAB"
THISFORM.LABEL1.CAPTION = "SIMPANAN - Tabungan"
THISFORM.LABEL2.CAPTION = "UTANG BUNGA - Beban Jasa Tabungan yang masih harus dibayar"
THISFORM.LABEL3.CAPTION = "BEBAN BUNGA - Beban Jasa Tabungan "
THISFORM.LABEL4.CAPTION = "PENDAPATAN LAIN-LAIN - Biaya Administrasi"
THISFORM.LABEL5.CAPTION = "PENDAPATAN LAIN-LAIN - Biaya Administrasi Penutupan Rekening"
THISFORM.LABEL6.CAPTION = "KEWAJIBAN SEGERA - Potongan Pajak"
THISFORM.LABEL7.CAPTION = "KEWAJIBAN KEPADA NASABAH -  Hadiah dll"
CASE MDEPT="DEP"
THISFORM.LABEL1.CAPTION = "SIMPANAN - Simpanan Berjangka"
THISFORM.LABEL2.CAPTION = "UTANG BUNGA - Beban Jasa Simpanan Berjangka yang masih harus dibayar"
THISFORM.LABEL3.CAPTION = "BEBAN BUNGA - Beban Jasa Simpanan Berjangka"
THISFORM.LABEL4.CAPTION = "PENDAPATAN LAIN-LAIN - Administrasi"
THISFORM.LABEL5.CAPTION = "PENDAPATAN LAIN-LAIN - Pinalthy Penutupan Rekening"
THISFORM.LABEL6.CAPTION = "KEWAJIBAN SEGERA - Potongan Pajak"
THISFORM.LABEL7.CAPTION = "KEWAJIBAN KEPADA NASABAH -  Hadiah dll"
CASE MDEPT="SMK"
THISFORM.LABEL1.CAPTION = "SIMPANAN - Simpanan Setoran Modal Koperasi (SMK)"
THISFORM.LABEL2.CAPTION = "UTANG BUNGA - Beban Jasa SMK yang masih harus dibayar"
THISFORM.LABEL3.CAPTION = "BEBAN BUNGA - Beban Jasa SMK"
THISFORM.LABEL4.CAPTION = "PENDAPATAN LAIN-LAIN - Administrasi"
THISFORM.LABEL5.CAPTION = "PENDAPATAN LAIN-LAIN - Pinalthy Penutupan Rekening"
THISFORM.LABEL6.CAPTION = "KEWAJIBAN SEGERA - Potongan Pajak"
THISFORM.LABEL7.CAPTION = "KEWAJIBAN KEPADA NASABAH -  Hadiah dll"
OTHERWISE
THISFORM.LABEL1.CAPTION = "SIMPANAN - Tabungan"
THISFORM.LABEL2.CAPTION = "UTANG BUNGA - Beban Jasa Tabungan yang masih harus dibayar"
THISFORM.LABEL3.CAPTION = "BEBAN BUNGA - Beban Jasa Tabungan "
THISFORM.LABEL4.CAPTION = "PENDAPATAN LAIN-LAIN - Biaya Administrasi"
THISFORM.LABEL5.CAPTION = "PENDAPATAN LAIN-LAIN - Biaya Administrasi Penutupan Rekening"
THISFORM.LABEL6.CAPTION = "KEWAJIBAN SEGERA - Potongan Pajak"
THISFORM.LABEL7.CAPTION = "KEWAJIBAN KEPADA NASABAH -  Hadiah dll"
ENDCASE
WITH THISFORM
.TEXT8.INPUTMASK = "!!!!"
.TEXT9.INPUTMASK = REPLICATE('!', 20)
.TEXT1.INPUTMASK = DEFAFMTAKT
.TEXT2.INPUTMASK = DEFAFMTAKT
.TEXT3.INPUTMASK = DEFAFMTAKT
.TEXT4.INPUTMASK = DEFAFMTAKT
.TEXT5.INPUTMASK = DEFAFMTAKT
.TEXT6.INPUTMASK = DEFAFMTAKT
.TEXT7.INPUTMASK = DEFAFMTAKT
ENDWITH
IF THISFORM.MYMODE="EDIT"
THISFORM.MYENABLE(.T.)
THISFORM.TAMPIL()
ELSE
THISFORM.MYENABLE(.F.)
THISFORM.TAMPIL()
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  simpanan_setproduk1_jurnal.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Command1
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT1.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Command2
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT2.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Command3
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT3.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Command4
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT4.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Command5
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT5.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Command6
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT6.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Command7
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT7.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Cmdsimpan1
**
PROCEDURE Click
THISFORM.MYENABLE(.F.)
MSANDILAMA = THISFORM.MYSANDI
DO CASE
CASE THISFORM.DEPT="TAB"
MKODESIMP = '1'
CASE THISFORM.DEPT="DEP"
MKODESIMP = '2'
OTHERWISE
MKODESIMP = '3'
ENDCASE
WITH THISFORM
CSQL = "UPDATE setsandi_tab set "+"JURNALTAB=?thisform.text1.value,"+"JURNALUTANGBG=?thisform.text2.value,"+"JURNALBUNGA=?thisform.text3.value,"+"JURNALADM=?thisform.text4.value,"+"JURNALADMTUTUP=?thisform.text5.value,"+"JURNALPAJAK=?thisform.text6.value,"+"JURNALKSD=?thisform.text7.value "+"where kantor=?defakantor and jenis=?mkodesimp and sandi='"+MSANDILAMA+"'"
ENDWITH
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
MESSAGEBOX("Gagal update data")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk1_jurnal.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.MYENABLE(.F.)
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_setproduk1_jurnal.sct
***
*
***
*** setting.scx
***
*
*
*  setting.scx::FORM1
**
PROCEDURE tampil
THISFORM.CONTAINER1.VISIBLE = .T.
THISFORM.CONTAINER1.TOP = 35
THISFORM.CONTAINER1.LEFT = 3
WITH THISFORM.CONTAINER1
.TEXT1.VALUE = ALLTRIM(THISFORM.READINI1._READ('USERPROFIL', 'IDKANTOR'))
.TEXT2.VALUE = ALLTRIM(THISFORM.READINI1._READ('USERPROFIL', 'IDPENGGUNA'))
.TEXT3.VALUE = MYHOSTNAME()
.TEXT4.VALUE = MYIPADDRESS()
.TEXT5.VALUE = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'SERVER'))
.TEXT6.VALUE = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'DATABASED'))
.TEXT7.VALUE = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'USER'))
.TEXT8.VALUE = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'PASSWORD'))
CSQL = "select keterangan from setsandi where kantor='ID' and kode='KNT' and sandi='"+THISFORM.CONTAINER1.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.CONTAINER1.TEXT15.VALUE = KETERANGAN
ENDWITH
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.SETALL("enabled", .F., "textbox")
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  setting.scx::CmdEdit
**
PROCEDURE Click
THIS.VISIBLE = .F.
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDSIMPAN.VISIBLE = .T.
THISFORM.SETALL("enabled", .T., "textbox")
THISFORM.CONTAINER1.TEXT3.ENABLED = .F.
THISFORM.CONTAINER1.TEXT4.ENABLED = .F.
THISFORM.CONTAINER1.TEXT15.ENABLED = .F.
ENDPROC
**
*
*  setting.scx::CmdSimpan
**
PROCEDURE Click
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDEDIT.VISIBLE = .T.
THISFORM.SETALL("enabled", .F., "textbox")
THISFORM.READINI1._WRITE('USERPROFIL', 'IDKANTOR', THISFORM.CONTAINER1.TEXT1.VALUE)
THISFORM.READINI1._WRITE('USERPROFIL', 'IDPENGGUNA', THISFORM.CONTAINER1.TEXT2.VALUE)
THISFORM.READINI1._WRITE('USERPROFIL', 'IDKOMPUTER', THISFORM.CONTAINER1.TEXT3.VALUE)
THISFORM.READINI1._WRITE('USERPROFIL', 'IPADDRESS', THISFORM.CONTAINER1.TEXT4.VALUE)
THISFORM.READINI1._WRITE('CONECTION', 'SERVER', THISFORM.CONTAINER1.TEXT5.VALUE)
THISFORM.READINI1._WRITE('CONECTION', 'DATABASED', THISFORM.CONTAINER1.TEXT6.VALUE)
THISFORM.READINI1._WRITE('CONECTION', 'USER', THISFORM.CONTAINER1.TEXT7.VALUE)
THISFORM.READINI1._WRITE('CONECTION', 'PASSWORD', THISFORM.CONTAINER1.TEXT8.VALUE)
ENDPROC
**
*
*  setting.scx::CmdBatal
**
PROCEDURE Click
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDEDIT.VISIBLE = .T.
THISFORM.SETALL("enabled", .F., "textbox")
ENDPROC
**
***
*** setting.sct
***
*
***
*** buatini.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
PROCEDURE buatfileini
DO CREATEINI
LOCAL CFILE
CFILE = SYS(5)+SYS(2003)+"\TERRA.INI"
= MAKEFILE(CFILE)
= WRITEPRIVATEPROFILESECTION("NAMAKOP", 'KOPN=KSP "YAKIN"'+CHR(0), CFILE)
= WRITEPRIVATEPROFILESECTION("CONECTION", "server=localhost	"+CHR(0)+"user=root	"+CHR(0)+"password=123	"+CHR(0)+"databased=koperasi	"+CHR(0)+"# ----------- sms banking"+CHR(0)+"sms_port="+CHR(0)+"sms_baundrate="+CHR(0)+"# ----------- MDC"+CHR(0)+"mdc_port="+CHR(0)+"mdc_baundrate="+CHR(0)+"# ----------- BARCODE"+CHR(0)+"bar_port="+CHR(0)+"bar_baundrate="+CHR(0), CFILE)
= WRITEPRIVATEPROFILESECTION("IMAGE", "MAINICON=.\image\desktop.ico"+CHR(0)+"BACKLOGO="+CHR(0)+'HEADTOP=KSP "YAKIN"'+CHR(0), CFILE)
= WRITEPRIVATEPROFILESECTION("FORMAT", "ANGGOTA =!!.!!!!!!!"+CHR(0)+"SIMPANAN=!!!.!!.!!!!!!"+CHR(0)+"PINJAMAN=!!.!!.!!!!!"+CHR(0), CFILE)
= WRITEPRIVATEPROFILESECTION("KEYPRESS", "CKEYSEARCH=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890. -_/[],:", CFILE)
RETURN
ENDPROC
**
PROCEDURE bacapublic
RETURN
ENDPROC
**
PROCEDURE MakeFile
LPARAMETERS CFILE
IF FILE(CFILE)
DELETE FILE (CFILE)
ENDIF
HFILE = FCREATE(CFILE)
= FCLOSE(HFILE)
ENDPROC
**
PROCEDURE CreateINI
DECLARE WritePrivateProfileSection IN kernel32 STRING, STRING, STRING
DECLARE WritePrivateProfileString IN kernel32 STRING, STRING, STRING, STRING
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** mybacaini.vcx
***
*
*
*  mybacaini.vcx::winposnsize
**
FUNCTION _read
LPARAMETERS TCSECTION, TCKEYNAME
LOCAL LCINIFILE, LNERROR, LNRETVAL, LCBUFFER, LCRETVAL
_LCNMAPP = ALLTRIM(THIS.PARENT.NAME)
_LCLOKASI = SYS(5)+SYS(2003)+'\'+ALLTRIM(THIS._NMFILE)
LCBUFFER = SPACE(250)+CHR(0)
IF GETPRIVATEPROFILESTRING(TCSECTION, TCKEYNAME, "", @LCBUFFER, LEN(LCBUFFER), _LCLOKASI)>0
LCRETVAL = ALLTRIM(CHRTRAN(LCBUFFER, CHR(0), ""))
THIS.NLASTERROR = 0
ELSE
THIS.NLASTERROR = GETLASTERROR()
LCRETVAL = ""
ENDIF
RETURN LCRETVAL
ENDFUNC
**
FUNCTION _write
LPARAMETERS TCSECTION, TCKEYNAME, TCVALUE
LOCAL LCINIFILE, LNERROR, LNRETVAL, LCBUFFER, LNERROR
_LCNMAPP = ALLTRIM(THIS.PARENT.NAME)
_LCLOKASI = SYS(5)+SYS(2003)+'\'+ALLTRIM(THIS._NMFILE)
LNERROR = WRITEPRIVATEPROFILESTRING(TCSECTION, TCKEYNAME, TCVALUE, _LCLOKASI)
IF LNERROR=0
THIS.NLASTERROR = GETLASTERROR()
ELSE
THIS.NLASTERROR = 0
ENDIF
RETURN IIF(LNERROR=0, THIS.NLASTERROR, 0)
ENDFUNC
**
PROCEDURE Destroy
LCTOP = THIS.PARENT.TOP
LCLEFT = THIS.PARENT.LEFT
LCHEIGHT = THIS.PARENT.HEIGHT
LCWIDTH = THIS.PARENT.WIDTH
_LCNMAPP = ALLTRIM(THIS.PARENT.NAME)
THIS._WRITE(_LCNMAPP, "_Top", ALLTRIM(STR(LCTOP)))
THIS._WRITE(_LCNMAPP, "_Left", ALLTRIM(STR(LCLEFT)))
THIS._WRITE(_LCNMAPP, "_Height", ALLTRIM(STR(LCHEIGHT)))
THIS._WRITE(_LCNMAPP, "_Width", ALLTRIM(STR(LCWIDTH)))
THIS._WRITE(_LCNMAPP, "_Aktif", "no")
ENDPROC
**
PROCEDURE Init
LPARAMETERS TCINIFILE
IF  .NOT. EMPTY(TCINIFILE) .AND. TYPE("tcIniFile")="C"
THIS.CINIFILE = TCINIFILE
ELSE
THIS.CINIFILE = ""
ENDIF
DECLARE LONG GetPrivateProfileString IN WIN32API STRING, STRING, STRING, STRING @, LONG, STRING
DECLARE LONG WritePrivateProfileString IN WIN32API STRING, STRING, STRING, STRING
DECLARE LONG WritePrivateProfileSection IN WIN32API STRING, STRING, STRING
DECLARE LONG GetLastError IN WIN32API
SET TEXTMERGE ON NOSHOW
LCCEKFILE = FILE(ALLTRIM(THIS._NMFILE))
_LCNMAPP = ALLTRIM(THIS.PARENT.NAME)
THIS._ISAKTIF = "yes"
LCTOP = THIS.PARENT.TOP
LCLEFT = THIS.PARENT.LEFT
LCHEIGHT = THIS.PARENT.HEIGHT
LCWIDTH = THIS.PARENT.WIDTH
LCAKTIF = THIS._ISAKTIF
IF LCCEKFILE=.F.
LCHANDLEFILE = FCREATE(THIS._NMFILE)
TEXT
[<<lcCekFile>>]
_Top=<<ALLTRIM(STR(lcTop))>>
_Left=<<ALLTRIM(STR(lcleft))>>
_Height=<<ALLTRIM(STR(lcheight))>>
_Width=<<ALLTRIM(STR(lcwidth))>>
_Aktif='yes'

ENDTEXT
FCLOSE(LCHANDLEFILE)
THIS._WRITE(_LCNMAPP, "_Top", ALLTRIM(STR(LCTOP)))
THIS._WRITE(_LCNMAPP, "_Left", ALLTRIM(STR(LCLEFT)))
THIS._WRITE(_LCNMAPP, "_Height", ALLTRIM(STR(LCHEIGHT)))
THIS._WRITE(_LCNMAPP, "_Width", ALLTRIM(STR(LCWIDTH)))
ELSE
XLCTOP = VAL(THIS._READ(_LCNMAPP, "_Top"))
XLCLEFT = VAL(THIS._READ(_LCNMAPP, "_Left"))
XLCHEIGHT = VAL(THIS._READ(_LCNMAPP, "_Height"))
XLCWIDTH = VAL(THIS._READ(_LCNMAPP, "_Width"))
THIS._WRITE(_LCNMAPP, "_Aktif", "yes")
IF THIS._MOVEFORM=.T.
IF XLCTOP<=0
TEXT
[<<lcCekFile>>]
_Top=<<ALLTRIM(STR(lcTop))>>
_Left=<<ALLTRIM(STR(lcleft))>>
_Height=<<ALLTRIM(STR(lcheight))>>
_Width=<<ALLTRIM(STR(lcwidth))>>


ENDTEXT
THIS._WRITE(_LCNMAPP, "_Top", ALLTRIM(STR(LCTOP)))
THIS.PARENT.TOP = LCTOP
ELSE
THIS.PARENT.TOP = VAL(THIS._READ(_LCNMAPP, "_Top"))
ENDIF
IF XLCLEFT<=0
THIS._WRITE(_LCNMAPP, "_Left", ALLTRIM(STR(LCLEFT)))
THIS.PARENT.LEFT = LCLEFT
ELSE
THIS.PARENT.LEFT = VAL(THIS._READ(_LCNMAPP, "_Left"))
ENDIF
ENDIF
IF THIS._SIZEFORM=.T.
IF XLCHEIGHT<=0
THIS._WRITE(_LCNMAPP, "_Height", ALLTRIM(STR(LCHEIGHT)))
THIS.PARENT.HEIGHT = LCHEIGHT
ELSE
THIS.PARENT.HEIGHT = VAL(THIS._READ(_LCNMAPP, "_Height"))
ENDIF
IF XLCWIDTH<=0
THIS._WRITE(_LCNMAPP, "_Width", ALLTRIM(STR(LCWIDTH)))
THIS.PARENT.WIDTH = LCWIDTH
ELSE
THIS.PARENT.WIDTH = VAL(THIS._READ(_LCNMAPP, "_Width"))
ENDIF
ENDIF
ENDIF
ENDPROC
**
*
*  mybacaini.vcx::readini
**
FUNCTION _read
LPARAMETERS TCSECTION, TCKEYNAME
LOCAL LCINIFILE, LNERROR, LNRETVAL, LCBUFFER, LCRETVAL
_LCLOKASI = SYS(5)+SYS(2003)+'\'+ALLTRIM(THIS._NMFILE)
LCBUFFER = SPACE(250)+CHR(0)
IF GETPRIVATEPROFILESTRING(TCSECTION, TCKEYNAME, "", @LCBUFFER, LEN(LCBUFFER), _LCLOKASI)>0
LCRETVAL = ALLTRIM(CHRTRAN(LCBUFFER, CHR(0), ""))
THIS.NLASTERROR = 0
ELSE
THIS.NLASTERROR = GETLASTERROR()
LCRETVAL = ""
ENDIF
RETURN LCRETVAL
ENDFUNC
**
FUNCTION _write
LPARAMETERS TCSECTION, TCKEYNAME, TCVALUE
LOCAL LCINIFILE, LNERROR, LNRETVAL, LCBUFFER, LNERROR
_LCLOKASI = SYS(5)+SYS(2003)+'\'+ALLTRIM(THIS._NMFILE)
LNERROR = WRITEPRIVATEPROFILESTRING(TCSECTION, TCKEYNAME, TCVALUE, _LCLOKASI)
IF LNERROR=0
THIS.NLASTERROR = GETLASTERROR()
ELSE
THIS.NLASTERROR = 0
ENDIF
RETURN IIF(LNERROR=0, THIS.NLASTERROR, 0)
ENDFUNC
**
PROCEDURE Init
LPARAMETERS TCINIFILE
IF  .NOT. EMPTY(TCINIFILE) .AND. TYPE("tcIniFile")="C"
THIS.CINIFILE = TCINIFILE
ELSE
THIS.CINIFILE = ""
ENDIF
DECLARE LONG GetPrivateProfileString IN WIN32API STRING, STRING, STRING, STRING @, LONG, STRING
DECLARE LONG WritePrivateProfileString IN WIN32API STRING, STRING, STRING, STRING
DECLARE LONG WritePrivateProfileSection IN WIN32API STRING, STRING, STRING
DECLARE LONG GetLastError IN WIN32API
SET TEXTMERGE ON NOSHOW
LCCEKFILE = FILE(ALLTRIM(THIS._NMFILE))
_LCNMAPP = ALLTRIM(THIS.PARENT.NAME)
_LCLOKASI = SYS(5)+SYS(2003)+'\'+ALLTRIM(THIS._NMFILE)
IF LCCEKFILE=.F.
MESSAGEBOX('File .INI Tidak ditemukan...!')
ENDIF
ENDPROC
**
***
*** mybacaini.vct
***
*
***
*** gl_bkbantu_mutasi.scx
***
*
*
*  gl_bkbantu_mutasi.scx::Form1
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
MNOREK = THISFORM.NOREKASAL
DO CASE
CASE THISFORM.BAGIAN="ABA"
CSQL = "select * from gl_antarbank_akrual where nomorid='"+MNOREK+"'"
CASE THISFORM.BAGIAN="BDD"
CSQL = "select * from gl_biayadimuka_mutasi where nomorid='"+MNOREK+"'"
CASE THISFORM.BAGIAN="KSD"
CSQL = "select * from gl_ksd_akrual where nomorid='"+MNOREK+"'"
CASE THISFORM.BAGIAN="INV"
CSQL = "select * from gl_inventaris_mutasi where nomorid='"+MNOREK+"'"
ENDCASE
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampilkan
MYDATA = THISFORM.DATA1
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
IF THISFORM.BAGIAN="ABA"
.COLUMNCOUNT = 10
ELSE
.COLUMNCOUNT = 7
ENDIF
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "TGLMUTASI"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 200
.COLUMN3.CONTROLSOURCE = "KETERANGAN"
.COLUMN3.HEADER1.CAPTION = "KETERANGAN"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 100
.COLUMN4.CONTROLSOURCE = "VAL(DEBET)"
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.ALIGNMENT = 1
.COLUMN4.HEADER1.CAPTION = "DEBET"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "VAL(KREDIT)"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "KREDIT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.COLUMN6.WIDTH = 100
.COLUMN6.CONTROLSOURCE = "SALDO"
.COLUMN6.HEADER1.CAPTION = "SALDO"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 9
IF THISFORM.BAGIAN<>"ABA"
.COLUMN7.WIDTH = 50
.COLUMN7.CONTROLSOURCE = "OPT"
.COLUMN7.HEADER1.CAPTION = "OPT"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 9
ELSE
.COLUMN7.WIDTH = 100
.COLUMN7.CONTROLSOURCE = "BUNGA"
.COLUMN7.HEADER1.CAPTION = "BUNGA"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 9
.COLUMN8.WIDTH = 100
.COLUMN8.CONTROLSOURCE = "PAJAK"
.COLUMN8.HEADER1.CAPTION = "PAJAK"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 9
.COLUMN9.WIDTH = 100
.COLUMN9.CONTROLSOURCE = "PPAP"
.COLUMN9.HEADER1.CAPTION = "PPAP"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 9
.COLUMN10.WIDTH = 50
.COLUMN10.CONTROLSOURCE = "OPT"
.COLUMN10.HEADER1.CAPTION = "OPT"
.COLUMN10.HEADER1.FONTBOLD = .T.
.COLUMN10.HEADER1.FONTSIZE = 9
ENDIF
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(206,206,255) , RGB(113,113,255))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE tampil2
THISFORM.TEXT3.VALUE = KETERANGAN
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MBAG
DO CASE
CASE MBAG="ABA"
MJUDUL = "MUTASI SIMPANAN PADA BANK/KOPERASI LAIN"
CASE MBAG="BDD"
MJUDUL = "AMORTISASI BIAYA DIBAYAR DIMUKA"
CASE MBAG="KSD"
MJUDUL = "MUTASI KEWAJIBAN SEGERA DIBAYAR"
CASE MBAG="INV"
MJUDUL = "PENYUSUTAN INVENTARIS"
OTHERWISE
MJUDUL = ""
ENDCASE
THISFORM.BAGIAN = MBAG
THISFORM.LABEL17.CAPTION = MJUDUL
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = ALLTRIM(STR(NOMORID))
THISFORM.DATA1 = SYS(2015)
WITH THISFORM
IF MMODE='TAMPIL' .OR. MMODE='EDIT'
SELECT (THISFORM.OLDSELECT)
.TEXT32.VALUE = NOMORID
.TEXT33.VALUE = TANGGAL
.TEXT1.VALUE = NAMA
.TEXT2.VALUE = KETERANGAN
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.CMDKELUAR1.SETFOCUS
ENDIF
ENDIF
ENDWITH
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  gl_bkbantu_mutasi.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_bkbantu_mutasi.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into pinjaman (tanggal, bukti, norek, nopk, kdhit, marketing, cif, pokok, rate, lama, tglmulai, tgljtempo, adm, provisi, jenis, kelompok, wilayah, penggunaan, sektor, sumber) value "+"('"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT34.VALUE+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+STR(.TEXT38.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"',"+"'"+STR(.TEXT39.VALUE)+"',"+"'"+STR(.TEXT40.VALUE)+"',"+"'"+.TEXT21.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+.TEXT22.VALUE+"',"+"'"+.TEXT27.VALUE+"',"+"'"+.TEXT24.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',"+"bukti='"+.TEXT34.VALUE+"',"+"norek='"+.TEXT32.VALUE+"',"+"nopk='"+.TEXT33.VALUE+"',"+"kdhit='"+.TEXT41.VALUE+"',"+"marketing='"+.TEXT42.VALUE+"',"+"cif='"+.TEXT1.VALUE+"',"+"pokok='"+STR(.TEXT38.VALUE)+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"lama='"+STR(.TEXT18.VALUE)+"',"+"tglmulai='"+SQLDATE(.TEXT19.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT14.VALUE)+"',"+"adm='"+STR(.TEXT39.VALUE)+"',"+"provisi='"+STR(.TEXT40.VALUE)+"',"+"jenis='"+.TEXT21.VALUE+"',"+"kelompok='"+.TEXT25.VALUE+"',"+"wilayah='"+.TEXT26.VALUE+"',"+"penggunaan='"+.TEXT22.VALUE+"',"+"sektor='"+.TEXT27.VALUE+"',"+"sumber='"+.TEXT24.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="HAPUS"
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_bkbantu_mutasi.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  gl_bkbantu_mutasi.scx::Text32
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
ENDPROC
**
*
*  gl_bkbantu_mutasi.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_bkbantu_mutasi.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
***
*** gl_bkbantu_mutasi.sct
***
*
***
*** gl_aba_pbk_bunga.scx
***
*
*
*  gl_aba_pbk_bunga.scx::Form1
**
PROCEDURE Unload
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
THISFORM.OLDSELECT = SELECT()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  gl_aba_pbk_bunga.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_aba_pbk_bunga.scx::Command3
**
PROCEDURE Click
MNOMOR = NOMORID
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into gl_antarbank (kantor,tanggal,noaccount,nama,keterangan"+",jenis,rate,jw,tgljtempo,prosen_ppap,awal,mutasi,saldo,ppap) "+" value ("+"'"+DEFAKANTOR+"',"+"'"+SQLDATE(.TEXT42.VALUE)+"',"+"'"+.TEXT1.VALUE+"',"+"'"+.TEXT2.VALUE+"',"+"'"+.TEXT3.VALUE+"',"+"'"+.COMBO1.VALUE+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT6.VALUE)+"',"+"'"+SQLDATE(.TEXT7.VALUE)+"',"+"'"+STR(.TEXT8.VALUE)+"',"+"'"+STR(.TEXT9.VALUE)+"',"+"'"+STR(.TEXT10.VALUE)+"',"+"'"+STR(.TEXT11.VALUE)+"',"+"'"+STR(.TEXT12.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "update gl_antarbank set "+"tanggal='"+SQLDATE(.TEXT42.VALUE)+"',"+"noaccount='"+.TEXT1.VALUE+"',"+"nama='"+.TEXT2.VALUE+"',"+"keterangan='"+.TEXT3.VALUE+"',"+"jenis='"+.COMBO1.VALUE+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"jw='"+STR(.TEXT6.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT7.VALUE)+"',"+"prosen_ppap='"+STR(.TEXT8.VALUE)+"',"+"awal='"+STR(.TEXT9.VALUE)+"',"+"mutasi='"+STR(.TEXT10.VALUE)+"',"+"saldo='"+STR(.TEXT11.VALUE)+"',"+"ppap='"+STR(.TEXT12.VALUE)+"' "+"where nomorid='"+STR(MNOMOR)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_aba_pbk_bunga.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_pbk_bunga.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_pbk_bunga.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_pbk_bunga.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_aba_pbk_bunga.scx::Text5
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** gl_aba_pbk_bunga.sct
***
*
***
*** gl_cari_noper.scx
***
*
*
*  gl_cari_noper.scx::Form1
**
PROCEDURE bacasql
PERKIRAAN = THISFORM.MYDBFPERKIRAAN
THISFORM.GRID1.RECORDSOURCE = PERKIRAAN
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 80
.COLUMN1.INPUTMASK = DEFAFMTAKT
.COLUMN1.CONTROLSOURCE = "NOPER"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "NOPER"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA REKENING"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 60
.COLUMN3.CONTROLSOURCE = "KEL"
.COLUMN3.HEADER1.CAPTION = "KELOMPOK"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
ENDPROC
**
FUNCTION Unload
MASAL = THISFORM.DBFASAL
MCURSOR = THISFORM.MYDBFPERKIRAAN
SELECT &MCURSOR
USE
SELECT &MASAL
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
MCURSOR = SYS(2015)
MASAL = ALIAS()
THISFORM.DBFASAL = MASAL
CSQL = "select noper,nama,kel from perkiraan where 1"
LCEK = SQLEXEC(OODBC, CSQL, MCURSOR)
THISFORM.MYDBFPERKIRAAN = MCURSOR
THISFORM.TOP = 280
THISFORM.LEFT = 400
THISFORM.GRID1.RECORDSOURCE = MCURSOR
THISFORM.TEXT1.SETFOCUS
THISFORM.LABEL2.CAPTION = "CARI DAFTAR PERKIRAAN"
SELECT &MCURSOR
INDEX ON NOPER TO INDEX1
THISFORM.BACASQL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.CMDBATAL.CLICK
ENDIF
ENDPROC
**
*
*  gl_cari_noper.scx::Text1
**
PROCEDURE InteractiveChange
PERKIRAAN = THISFORM.MYDBFPERKIRAAN
SELECT &PERKIRAAN
MCARI = ALLTRIM(THIS.VALUE)
SET FILTER TO AT(MCARI, NOPER+NAMA)>0
THISFORM.GRID1.REFRESH
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDIF
IF NKEYCODE=24
NODEFAULT
KEYBOARD '{DNARROW}'
THISFORM.GRID1.SETFOCUS
ENDIF
ENDPROC
**
*
*  gl_cari_noper.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDIF
IF NKEYCODE=13
THISFORM.MYPILIH = NOPER
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  gl_cari_noper.scx::Cmdoke
**
PROCEDURE Click
THISFORM.MYPILIH = NOPER
THISFORM.RELEASE
ENDPROC
**
*
*  gl_cari_noper.scx::Cmdbatal
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_cari_noper.scx::Cmdinput
**
PROCEDURE Click
MCURSOR = THISFORM.MYDBFPERKIRAAN
DO FORM ./form/setsandi_data WITH "INPUT", "GL01", "NOMOR PERKIRAAN"
THISFORM.GRID1.REFRESH
ENDPROC
**
***
*** gl_cari_noper.sct
***
*
***
*** kas_adm.scx
***
*
*
*  kas_adm.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
IF MMODE<>"INPUT" .AND. MMODE<>"INSERT"
THISFORM.TANGGAL = TANGGAL
THISFORM.BUKTI = BUKTI
THISFORM.MODE = MMODE
THISFORM.TEXT7.VALUE = NOREK
WITH THISFORM
.TEXT8.VALUE = NAMA
.TEXT15.VALUE = ALAMAT
.TEXT17.VALUE = POKOK
.TEXT1.VALUE = ADM
.TEXT2.VALUE = PROVISI
.TEXT3.VALUE = MATERAI
.TEXT4.VALUE = NOTARIS
.TEXT9.VALUE = ASURANSI
.TEXT5.VALUE = LAINLAIN
ENDWITH
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
ENDIF
IF MMODE="INSERT" .OR. MMODE="INPUT"
THISFORM.TEXT7.ENABLED = .T.
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.TEXT3.ENABLED = .T.
THISFORM.TEXT4.ENABLED = .T.
THISFORM.TEXT5.ENABLED = .T.
ENDIF
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  kas_adm.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_adm.scx::Command3
**
PROCEDURE Click
REPLACE NOREK WITH THISFORM.TEXT7.VALUE
REPLACE NAMA WITH THISFORM.TEXT8.VALUE
REPLACE ALAMAT WITH THISFORM.TEXT15.VALUE
REPLACE POKOK WITH THISFORM.TEXT17.VALUE
REPLACE ADM WITH THISFORM.TEXT1.VALUE
REPLACE PROVISI WITH THISFORM.TEXT2.VALUE
REPLACE MATERAI WITH THISFORM.TEXT3.VALUE
REPLACE NOTARIS WITH THISFORM.TEXT4.VALUE
REPLACE ASURANSI WITH THISFORM.TEXT9.VALUE
REPLACE LAINLAIN WITH THISFORM.TEXT5.VALUE
THISFORM.RELEASE
ENDPROC
**
*
*  kas_adm.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_adm.scx::Text15
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="M" .OR. THIS.VALUE="K")
MESSAGEBOX("Gunakan Huruf "+CHR(13)+"M : Untuk Kas Masuk"+CHR(13)+"K  : Untuk Kas Keluar", 64, "TIDAK VALID")
THIS.SETFOCUS
NODEFAULT
ENDIF
THISFORM.UBAHWARNA(THIS.VALUE)
ENDPROC
**
*
*  kas_adm.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MBUKTI = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT = BUKTI
USE
SELECT (OLDSELECT)
IF ISNULL(MBKT) .OR. EMPTY(MBKT)
RETURN
ENDIF
MESSAGEBOX("Bukti Sudah Pernah Masuk", 0, "Validasi Bukti")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_adm.scx::Text7
**
FUNCTION LostFocus
OLDSELECT = SELECT()
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF THIS.VALUE=TRANSFORM(" ", DEFAFMTPINJ)
DO FORM pinjaman TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ELSE
MNOREK = TRIM(THIS.VALUE)
ENDIF
IF LASTKEY()<>13 .AND. THIS.VALUE=TRANSFORM(" ", DEFAFMTPINJ)
RETURN .T.
ENDIF
CSQL = "select kantor,norek,cif,pokok,adm,provisi,materai,notaris,asuransi,lainlain from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOREK<>MNOREK
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
IF ALLTRIM(NOREK)=ALLTRIM(MNOREK)
DEFAKANTORASAL = KANTOR
THISFORM.TEXT17.VALUE = IIF(THISFORM.TEXT17.VALUE=0, POKOK, THISFORM.TEXT17.VALUE)
THISFORM.TEXT1.VALUE = IIF(THISFORM.TEXT1.VALUE=0, ADM, THISFORM.TEXT1.VALUE)
THISFORM.TEXT2.VALUE = IIF(THISFORM.TEXT2.VALUE=0, PROVISI, THISFORM.TEXT2.VALUE)
THISFORM.TEXT3.VALUE = IIF(THISFORM.TEXT3.VALUE=0, MATERAI, THISFORM.TEXT3.VALUE)
THISFORM.TEXT4.VALUE = IIF(THISFORM.TEXT4.VALUE=0, NOTARIS, THISFORM.TEXT4.VALUE)
THISFORM.TEXT9.VALUE = IIF(THISFORM.TEXT9.VALUE=0, ASURANSI, THISFORM.TEXT9.VALUE)
THISFORM.TEXT5.VALUE = IIF(THISFORM.TEXT5.VALUE=0, LAINLAIN, THISFORM.TEXT5.VALUE)
ENDIF
MCIF = CIF
USE
CSQL = "select cif,nama,alamat from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT8.VALUE = NAMA
THISFORM.TEXT15.VALUE = ALAMAT
SELECT DUMMY01
REPLACE NAMA WITH THISFORM.TEXT8.VALUE
REPLACE ALAMAT WITH THISFORM.TEXT15.VALUE
SELECT SMT
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  kas_adm.scx::Text17
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT18.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_adm.scx::Text1
**
PROCEDURE LostFocus
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE RightClick
DO FORM gl_setnoper WITH "AKT_ADM"
ENDPROC
**
*
*  kas_adm.scx::Text2
**
PROCEDURE LostFocus
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE RightClick
DO FORM gl_setnoper WITH "AKT_PROV"
ENDPROC
**
*
*  kas_adm.scx::Text3
**
PROCEDURE LostFocus
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
*
*  kas_adm.scx::Text4
**
PROCEDURE LostFocus
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE RightClick
DO FORM gl_setnoper WITH "AKT_NOTARIS"
ENDPROC
**
*
*  kas_adm.scx::Text5
**
PROCEDURE LostFocus
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE RightClick
DO FORM gl_setnoper WITH "AKT_LAINLAIN"
ENDPROC
**
*
*  kas_adm.scx::Text6
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT18.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_adm.scx::Text9
**
PROCEDURE LostFocus
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
PROCEDURE RightClick
DO FORM gl_setnoper WITH "AKT_ASURANSI"
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT6.VALUE = THISFORM.TEXT1.VALUE+THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE+THISFORM.TEXT9.VALUE+THISFORM.TEXT5.VALUE
ENDPROC
**
***
*** kas_adm.sct
***
*
***
*** gl_setnoper.scx
***
*
*
*  gl_setnoper.scx::Form1
**
PROCEDURE Init
PARAMETER MKODE
DO CASE
CASE MKODE="NOPERSIMPK"
MKET = "Simpanan Pokok"
CASE MKODE="NOPERSIMWJB"
MKET = "Simpanan Wajib"
CASE MKODE="NOPERSIMSMK"
MKET = "Simpanan Modal Koperasi"
CASE MKODE="NOPERPENYERT"
MKET = "Simpanan Penyertaan"
OTHERWISE
MESSAGEBOX("KODE TIDAK TERDAFTAR")
THISFORM.RELEASE
ENDCASE
THISFORM.DEFANOPER = MKODE
THISFORM.TEXT1.VALUE = MKET
CSQL = "select a.keterangan,b.nama from setsandi as a left join perkiraan as b on a.keterangan=b.noper "+"where a.kantor='"+DEFAKANTOR+"' and a.kode='SYS' and a.sandi='PUB' and a.ket2='"+MKODE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT2")
THISFORM.TEXT2.VALUE = KETERANGAN
THISFORM.EDIT1.VALUE = NAMA
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  gl_setnoper.scx::Command2
**
PROCEDURE Click
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
ENDPROC
**
*
*  gl_setnoper.scx::Command3
**
PROCEDURE Click
CSQL = "delete from gl_defanoper where nama='"+THISFORM.DEFANOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "insert into gl_defanoper (nama,keterangan,noper) value ('"+THISFORM.DEFANOPER+"','"+THISFORM.EDIT1.VALUE+"','"+THISFORM.TEXT2.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.TEXT2.ENABLED = .F.
ENDPROC
**
*
*  gl_setnoper.scx::Text2
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
IF EMPTY(THIS.VALUE) .OR. ALLTRIM(THIS.VALUE)="."
DO FORM setsandi TO MNOPER WITH "GL01"
THIS.VALUE = MNOPER
ENDIF
OLDSELE = SELECT()
MNOPER = TRIM(THIS.VALUE)
CSQL = "select nama from perkiraan where noper='"+MNOPER+"'"
CEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.EDIT1.VALUE = NAMA
USE
SELECT (OLDSELE)
ENDFUNC
**
*
*  gl_setnoper.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_setnoper.scx::Command4
**
PROCEDURE Click
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.TEXT2.ENABLED = .T.
ENDPROC
**
***
*** gl_setnoper.sct
***
*
***
*** kas_kasharian.frx
***
*
***
*** kas_kasharian.frt
***
*
***
*** krd_nominatif2.frx
***
*
***
*** krd_nominatif2.frt
***
*
***
*** akt_neraca2.frx
***
*
***
*** akt_neraca2.frt
***
*
***
*** akt_neraca_harian1.frx
***
*
***
*** akt_neraca_harian1.frt
***
*
***
*** setting2.scx
***
*
*
*  setting2.scx::FORM1
**
PROCEDURE tampil
THISFORM.CONTAINER1.VISIBLE = .F.
THISFORM.CONTAINER1.TOP = 75
THISFORM.CONTAINER1.LEFT = 3
THISFORM.CONTAINER2.VISIBLE = .F.
THISFORM.CONTAINER2.TOP = 75
THISFORM.CONTAINER2.LEFT = 3
THISFORM.CONTAINER3.VISIBLE = .F.
THISFORM.CONTAINER3.TOP = 75
THISFORM.CONTAINER3.LEFT = 3
THISFORM.CONTAINER5.VISIBLE = .F.
THISFORM.CONTAINER5.TOP = 75
THISFORM.CONTAINER5.LEFT = 3
THISFORM.CONTAINER4.VISIBLE = .F.
THISFORM.CONTAINER4.TOP = 75
THISFORM.CONTAINER4.LEFT = 3
THISFORM.KPRI.VISIBLE = .F.
THISFORM.KPRI.TOP = 75
THISFORM.KPRI.LEFT = 3
DO CASE
CASE THISFORM.ACTIVEPAGE=1
THISFORM.CONTAINER1.VISIBLE = .T.
CASE THISFORM.ACTIVEPAGE=2
THISFORM.CONTAINER2.VISIBLE = .T.
CASE THISFORM.ACTIVEPAGE=3
THISFORM.CONTAINER3.VISIBLE = .T.
CASE THISFORM.ACTIVEPAGE=4
THISFORM.CONTAINER5.VISIBLE = .T.
CASE THISFORM.ACTIVEPAGE=5
THISFORM.CONTAINER4.VISIBLE = .T.
CASE THISFORM.ACTIVEPAGE=6
IF DEFAJENISKOP="KPRI"
THISFORM.KPRI.VISIBLE = .T.
ENDIF
ENDCASE
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.CONTAINER1
.TEXT1.VALUE = CARIPUBLIC("NAMA")
.TEXT2.VALUE = CARIPUBLIC("ALAMAT")
.TEXT3.VALUE = CARIPUBLIC("KOTA")
.TEXT4.VALUE = CARIPUBLIC("PHONE")
.TEXT5.VALUE = CARIPUBLIC("IDLEMBAGA")
.TEXT6.VALUE = CARIPUBLIC("PIMPINAN")
.TEXT7.VALUE = CARIPUBLIC("JABATAN")
.TEXT8.VALUE = CARIPUBLIC("PENGADILAN")
.COMBO1.VALUE = CARIPUBLIC("JENISKOP")
ENDWITH
WITH THISFORM.CONTAINER2
.TEXT1.VALUE = CARIPUBLIC("FMTANGG")
.TEXT2.VALUE = CARIPUBLIC("FMTSIMP")
.TEXT3.VALUE = CARIPUBLIC("FMTPINJ")
.TEXT4.VALUE = CARIPUBLIC("FMTPK")
.TEXT5.VALUE = CARIPUBLIC("FMTAKT")
.TEXT6.VALUE = CARIPUBLIC("NOPERKAS")
.TEXT7.VALUE = CARIPUBLIC("NOPERMATERAI")
.TEXT8.VALUE = CARIPUBLIC("NOPERNOTARIS")
.TEXT9.VALUE = CARIPUBLIC("NOPERPREMI")
.TEXT10.VALUE = CARIPUBLIC("NOPERBIAYA")
.TEXT11.VALUE = CARIPUBLIC("NOPERSURVEI")
.TEXT21.VALUE = CARIPUBLIC("NOPERTTPDEP")
.TEXT17.VALUE = CARIPUBLIC("NOPERAKA")
.TEXT18.VALUE = CARIPUBLIC("NOPERAKP")
.TEXT12.VALUE = CARIPUBLIC("NOPERSIMPK")
.TEXT13.VALUE = CARIPUBLIC("NOPERSIMWJB")
.TEXT14.VALUE = CARIPUBLIC("NOPERSIMSMK")
.TEXT15.VALUE = CARIPUBLIC("NOPERPENYERT")
.TEXT16.VALUE = CARIPUBLIC("NOPERLABALALU")
.TEXT19.VALUE = CARIPUBLIC("NOPERLABANOW")
.TEXT20.VALUE = CARIPUBLIC("NOPERFORMULA")
ENDWITH
WITH THISFORM.CONTAINER3
.TEXT1.VALUE = VAL(CARIPUBLIC("PROSENADM"))
.TEXT2.VALUE = VAL(CARIPUBLIC("PROSENPROVISI"))
.TEXT3.VALUE = VAL(CARIPUBLIC("PROSENDENDA"))
.TEXT4.VALUE = VAL(CARIPUBLIC("TENORDENDA"))
.TEXT9.VALUE = CARIPUBLIC("KETLAIN")
.TEXT8.VALUE = VAL(CARIPUBLIC("PROSENLAIN"))
.TEXT5.VALUE = VAL(CARIPUBLIC("NOMIPOKOK"))
.TEXT6.VALUE = VAL(CARIPUBLIC("NOMIWAJIB"))
.TEXT7.VALUE = VAL(CARIPUBLIC("NOMISMK"))
.CHECK1.VALUE = VAL(CARIPUBLIC("CTKVALIDASI"))
.TEXT10.VALUE = VAL(CARIPUBLIC("HARICTT"))
.TEXT11.VALUE = VAL(CARIPUBLIC("HARIULTAH"))
.TEXT12.VALUE = VAL(CARIPUBLIC("HARIJTANGS"))
.TEXT13.VALUE = VAL(CARIPUBLIC("HARIJTPINJ"))
ENDWITH
WITH THISFORM.CONTAINER5
.TEXT10.VALUE = CARIPUBLIC("TABSTOR")
.TEXT11.VALUE = CARIPUBLIC("TABAMB")
.TEXT13.VALUE = CARIPUBLIC("TABPBK")
.TEXT12.VALUE = CARIPUBLIC("TABBG")
.TEXT15.VALUE = CARIPUBLIC("TABEDT")
.TEXT14.VALUE = CARIPUBLIC("TABSLD")
.TEXT17.VALUE = CARIPUBLIC("TABPJK")
.TEXT16.VALUE = CARIPUBLIC("TABADM")
.TEXT32.VALUE = CARIPUBLIC("TABBGDEP")
.TEXT19.VALUE = CARIPUBLIC("DEPSTOR")
.TEXT18.VALUE = CARIPUBLIC("DEPBG")
.TEXT21.VALUE = CARIPUBLIC("DEPPJK")
.TEXT20.VALUE = CARIPUBLIC("DEPAMBBG")
.TEXT23.VALUE = CARIPUBLIC("DEPAMBPK")
.TEXT22.VALUE = CARIPUBLIC("DEPPBKBG")
.TEXT25.VALUE = CARIPUBLIC("DEPPBKPK1")
.TEXT24.VALUE = CARIPUBLIC("DEPPBKPK2")
.TEXT27.VALUE = CARIPUBLIC(("PINSTOR"))
.TEXT26.VALUE = CARIPUBLIC(("PINPBK"))
.TEXT29.VALUE = CARIPUBLIC(("PINPOT"))
.TEXT28.VALUE = CARIPUBLIC(("PINTRK"))
.TEXT31.VALUE = CARIPUBLIC(("PINPBK2"))
.TEXT30.VALUE = CARIPUBLIC(("PINJASA"))
ENDWITH
WITH THISFORM.CONTAINER4
.OPTIONGROUP1.VALUE = VAL(CARIPUBLIC("AKT_SYSTEM"))
IF .OPTIONGROUP1.VALUE=1
.CONTAINER1.CHECK1.ENABLED = .F.
.CONTAINER1.CHECK2.ENABLED = .F.
.CONTAINER1.CHECK3.ENABLED = .F.
.CONTAINER1.CHECK4.ENABLED = .F.
ELSE
.CONTAINER1.CHECK1.ENABLED = .T.
.CONTAINER1.CHECK2.ENABLED = .T.
.CONTAINER1.CHECK3.ENABLED = .T.
.CONTAINER1.CHECK4.ENABLED = .T.
ENDIF
.CONTAINER1.CHECK1.VALUE = VAL(CARIPUBLIC("AKRU_SIMPANAN"))
.CONTAINER1.CHECK2.VALUE = VAL(CARIPUBLIC("AKRU_PINJAMAN"))
.CONTAINER1.CHECK3.VALUE = VAL(CARIPUBLIC("AKRU_ADM"))
.CONTAINER1.CHECK4.VALUE = VAL(CARIPUBLIC("AKRU_BIAYA"))
.OPTIONGROUP2.VALUE = VAL(CARIPUBLIC("SUSUT_INV"))
.TEXT1.VALUE = CARIPUBLIC("NRC_AKT")
.TEXT2.VALUE = CARIPUBLIC("NRC_PSV")
.TEXT3.VALUE = CARIPUBLIC("NRC_ADM")
.TEXT4.VALUE = CARIPUBLIC("NRC_PO")
.TEXT9.VALUE = CARIPUBLIC("NRC_PL")
.TEXT5.VALUE = CARIPUBLIC("NRC_BO")
.TEXT6.VALUE = CARIPUBLIC("NRC_BB")
.TEXT7.VALUE = CARIPUBLIC("NRC_PNO")
.TEXT8.VALUE = CARIPUBLIC("NRC_BNO")
.TEXT10.VALUE = CARIPUBLIC("NRC_EKU")
.OPTIONGROUP3.VALUE = VAL(CARIPUBLIC("NRC_MODEL"))
ENDWITH
WITH THISFORM.KPRI
.TEXT1.VALUE = DEFASHU_RAT
.TEXT2.VALUE = DEFASHU_THR
.TEXT3.VALUE = DEFASHU_OPER
.TEXT4.VALUE = DEFASHU_SRG
.TEXT5.VALUE = DEFASHU_BEA
.TEXT6.VALUE = DEFASHU_DOOR
.TEXT7.VALUE = DEFASHU_TRAN
.TEXT8.VALUE = DEFASHU_TALI
.TEXT9.VALUE = DEFASHU_TUNJ1
.TEXT10.VALUE = DEFASHU_TUNJ2
.TEXT11.VALUE = DEFASHU_TUNJ3
.TEXT12.VALUE = DEFASHU_TUNJ4
.TEXT13.VALUE = DEFASHU_DPLK
.TEXT14.VALUE = DEFASHU_PEMEL
.TEXT15.VALUE = DEFASHU_LEMB
.TEXT31.VALUE = DEFASHU_RAT+DEFASHU_THR+DEFASHU_OPER+DEFASHU_SRG+DEFASHU_BEA+DEFASHU_DOOR+DEFASHU_TRAN+DEFASHU_TALI+DEFASHU_TUNJ1+DEFASHU_TUNJ2+DEFASHU_TUNJ3+DEFASHU_TUNJ4+DEFASHU_DPLK+DEFASHU_PEMEL+DEFASHU_LEMB
.TEXT1.VALUE = DEFAJURSHU_RAT
.TEXT2.VALUE = DEFAJURSHU_THR
.TEXT3.VALUE = DEFAJURSHU_OPER
.TEXT4.VALUE = DEFAJURSHU_SRG
.TEXT5.VALUE = DEFAJURSHU_BEA
.TEXT6.VALUE = DEFAJURSHU_DOOR
.TEXT7.VALUE = DEFAJURSHU_TRAN
.TEXT8.VALUE = DEFAJURSHU_TALI
.TEXT9.VALUE = DEFAJURSHU_TUNJ1
.TEXT10.VALUE = DEFAJURSHU_TUNJ2
.TEXT11.VALUE = DEFAJURSHU_TUNJ3
.TEXT12.VALUE = DEFAJURSHU_TUNJ4
.TEXT13.VALUE = DEFAJURSHU_DPLK
.TEXT14.VALUE = DEFAJURSHU_PEMEL
.TEXT15.VALUE = DEFAJURSHU_LEMB
ENDWITH
USE
ENDPROC
**
PROCEDURE simpan
PARAMETER MIDDATA, MDATA
LOCAL OLDSELE
OLDSELE = SELECT()
CSQL = "select ket2 from setsandi where ket2='"+MIDDATA+"' and kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal Baca setsandi")
ENDIF
IF KET2=MIDDATA
CSQL = "update setsandi set keterangan='"+MDATA+"' where ket2='"+MIDDATA+"' and kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into setsandi (kantor,kode,sandi,ket2,keterangan) value "+"('"+DEFAKANTOR+"','SYS','PUB','"+MIDDATA+"','"+MDATA+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.CONTAINER2.VISIBLE = .F.
IF DEFAUSERID='IMR'
THISFORM.COMMAND4.VISIBLE = .T.
ENDIF
DEFAFMTAKT = IIF(EMPTY(DEFAFMTAKT), '!!!!.!!!!!', DEFAFMTAKT)
THISFORM.CONTAINER2.TEXT6.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT7.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT8.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT9.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT10.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT11.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT17.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT18.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT12.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT13.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT14.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT15.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT16.INPUTMASK = DEFAFMTAKT
THISFORM.CONTAINER2.TEXT21.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT16.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT17.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT18.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT19.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT20.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT21.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT22.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT23.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT24.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT25.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT26.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT27.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT28.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT29.INPUTMASK = DEFAFMTAKT
THISFORM.KPRI.TEXT30.INPUTMASK = DEFAFMTAKT
THISFORM.ACTIVEPAGE = 1
THISFORM.COMMAND2.ENABLED = .F.
THISFORM.SETALL("enabled", .F., "textbox")
THISFORM.SETALL("enabled", .F., "combobox")
THISFORM.SETALL("enabled", .F., "checkbox")
THISFORM.SETALL("enabled", .F., "editbox")
THISFORM.SETALL("enabled", .F., "optiongroup")
THISFORM.KPRI.SETALL("enabled", .F., "commandbutton")
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.COMMAND1.ENABLED = .F.
MKANTOR = ALLTRIM(THISFORM.READINI1._READ('USERPROFIL', 'KDKANTOR'))
THISFORM.TEXT1.VALUE = MKANTOR
CSQL = "select keterangan from setsandi where kantor='ID' and kode='KNT' and sandi='"+MKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT0")
THISFORM.TEXT2.VALUE = KETERANGAN
USE
THISFORM.TAMPIL()
ENDPROC
**
*
*  setting2.scx::Command1
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT6.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT6.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text6
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
OLDSELE = SELECT()
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Text7
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
OLDSELE = SELECT()
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Text8
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
OLDSELE = SELECT()
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command2
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT7.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT7.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command3
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT8.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT8.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text9
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
OLDSELE = SELECT()
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command4
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT9.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT9.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text10
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
OLDSELE = SELECT()
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command5
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT10.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT10.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text11
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command6
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT11.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT11.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text12
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Text13
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command7
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT12.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT12.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command8
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT13.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT13.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text14
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command9
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT14.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT14.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text15
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command10
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT15.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT15.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text16
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command11
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT16.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT16.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text17
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command12
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT17.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT17.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text18
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command13
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT18.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT18.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text19
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command14
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT19.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT19.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text20
**
PROCEDURE LostFocus
THISFORM.CMDSIMPAN.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text21
**
PROCEDURE LostFocus
OLDSELE = SELECT()
IF EMPTY(THIS.VALUE)
RETURN
ENDIF
CSQL = "select detail from perkiraan where noper='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CRDT")
IF RECCOUNT()=0
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor tidak terdapat dalam daftar perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
IF DETAIL='T'
USE
SELECT (OLDSELE)
MESSAGEBOX("Nomor ini tidak dapat digunakan untuk transaksi,"+CHR(13)+"Cek Ulang Nomor Perkiraan", 16, "")
NODEFAULT
RETURN
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting2.scx::Command15
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.CONTAINER2.TEXT21.VALUE = MNOPER
THISFORM.CONTAINER2.TEXT21.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text1
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text2
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text3
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text4
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text5
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text6
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text7
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text8
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text9
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text10
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text11
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text12
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text13
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text14
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text15
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT31.VALUE = .TEXT1.VALUE+.TEXT2.VALUE+.TEXT3.VALUE+.TEXT4.VALUE+.TEXT5.VALUE+.TEXT6.VALUE+.TEXT7.VALUE+.TEXT8.VALUE+.TEXT9.VALUE+.TEXT10.VALUE+.TEXT11.VALUE+.TEXT12.VALUE+.TEXT13.VALUE+.TEXT14.VALUE+.TEXT15.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text30
**
PROCEDURE LostFocus
THISFORM.CMDSIMPAN.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command1
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT16.VALUE = MNOPER
THISFORM.KPRI.TEXT16.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command2
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT17.VALUE = MNOPER
THISFORM.KPRI.TEXT17.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command3
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT18.VALUE = MNOPER
THISFORM.KPRI.TEXT18.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command4
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT19.VALUE = MNOPER
THISFORM.KPRI.TEXT19.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command5
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT20.VALUE = MNOPER
THISFORM.KPRI.TEXT20.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command6
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT21.VALUE = MNOPER
THISFORM.KPRI.TEXT21.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command7
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT22.VALUE = MNOPER
THISFORM.KPRI.TEXT22.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command8
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT23.VALUE = MNOPER
THISFORM.KPRI.TEXT23.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command9
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT24.VALUE = MNOPER
THISFORM.KPRI.TEXT24.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command10
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT25.VALUE = MNOPER
THISFORM.KPRI.TEXT25.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command11
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT26.VALUE = MNOPER
THISFORM.KPRI.TEXT26.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command12
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT27.VALUE = MNOPER
THISFORM.KPRI.TEXT27.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command13
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT28.VALUE = MNOPER
THISFORM.KPRI.TEXT28.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command14
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT29.VALUE = MNOPER
THISFORM.KPRI.TEXT29.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command15
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT30.VALUE = MNOPER
THISFORM.KPRI.TEXT30.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text32
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT40.VALUE = .TEXT32.VALUE+.TEXT33.VALUE+.TEXT41.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text33
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT40.VALUE = .TEXT32.VALUE+.TEXT33.VALUE+.TEXT41.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text34
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT42.VALUE = .TEXT34.VALUE+.TEXT35.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text35
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT42.VALUE = .TEXT34.VALUE+.TEXT35.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Command16
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT16.VALUE = MNOPER
THISFORM.KPRI.TEXT16.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command17
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT17.VALUE = MNOPER
THISFORM.KPRI.TEXT17.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command18
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT18.VALUE = MNOPER
THISFORM.KPRI.TEXT18.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Command19
**
PROCEDURE Click
DO FORM setsandi TO MNOPER WITH "GL01"
IF LASTKEY()=27
RETURN
ENDIF
THISFORM.KPRI.TEXT19.VALUE = MNOPER
THISFORM.KPRI.TEXT19.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Text41
**
PROCEDURE InteractiveChange
WITH THISFORM.KPRI
.TEXT40.VALUE = .TEXT32.VALUE+.TEXT33.VALUE+.TEXT41.VALUE
ENDWITH
ENDPROC
**
*
*  setting2.scx::Text8
**
PROCEDURE LostFocus
THISFORM.CMDSIMPAN.SETFOCUS
ENDPROC
**
*
*  setting2.scx::Combo1
**
PROCEDURE Init
THIS.ADDITEM("KSP KONVENSIONAL")
THIS.ADDITEM("KPRI")
ENDPROC
**
PROCEDURE LostFocus
DEFAJENISKOP = THIS.VALUE
ENDPROC
**
*
*  setting2.scx::Optiongroup1
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.CONTAINER4.CONTAINER1.CHECK1.ENABLED = .F.
THISFORM.CONTAINER4.CONTAINER1.CHECK2.ENABLED = .F.
THISFORM.CONTAINER4.CONTAINER1.CHECK3.ENABLED = .F.
THISFORM.CONTAINER4.CONTAINER1.CHECK4.ENABLED = .F.
ELSE
THISFORM.CONTAINER4.CONTAINER1.CHECK1.ENABLED = .T.
THISFORM.CONTAINER4.CONTAINER1.CHECK2.ENABLED = .T.
THISFORM.CONTAINER4.CONTAINER1.CHECK3.ENABLED = .T.
THISFORM.CONTAINER4.CONTAINER1.CHECK4.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  setting2.scx::Text1
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Text2
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Text4
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Text5
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Text7
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Text8
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Text3
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Text6
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Text9
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::Command4
**
PROCEDURE Click
THISFORM.SIMPAN("NRC_AKT", THISFORM.CONTAINER4.TEXT1.VALUE)
THISFORM.SIMPAN("NRC_PSV", THISFORM.CONTAINER4.TEXT2.VALUE)
THISFORM.SIMPAN("NRC_ADM", THISFORM.CONTAINER4.TEXT3.VALUE)
THISFORM.SIMPAN("NRC_PO", THISFORM.CONTAINER4.TEXT4.VALUE)
THISFORM.SIMPAN("NRC_PL", THISFORM.CONTAINER4.TEXT9.VALUE)
THISFORM.SIMPAN("NRC_BO", THISFORM.CONTAINER4.TEXT5.VALUE)
THISFORM.SIMPAN("NRC_BB", THISFORM.CONTAINER4.TEXT6.VALUE)
THISFORM.SIMPAN("NRC_PNO", THISFORM.CONTAINER4.TEXT7.VALUE)
THISFORM.SIMPAN("NRC_BNO", THISFORM.CONTAINER4.TEXT8.VALUE)
THISFORM.SIMPAN("NRC_EKU", THISFORM.CONTAINER4.TEXT10.VALUE)
THISFORM.SIMPAN("NRC_MODEL", ALLTRIM(STR(THISFORM.CONTAINER4.OPTIONGROUP3.VALUE)))
OLDSELECT = SELECT()
CEKKELNERACA()
ENDPROC
**
*
*  setting2.scx::Text10
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Tidak Boleh Kosong")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  setting2.scx::CmdEdit
**
PROCEDURE Click
THIS.VISIBLE = .F.
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDSIMPAN.VISIBLE = .T.
THISFORM.SETALL("enabled", .T., "textbox")
THISFORM.SETALL("enabled", .T., "combobox")
THISFORM.SETALL("enabled", .T., "checkbox")
THISFORM.SETALL("enabled", .T., "editbox")
THISFORM.SETALL("enabled", .T., "optiongroup")
THISFORM.COMMAND1.ENABLED = .T.
DO CASE
CASE THISFORM.ACTIVEPAGE=1
THISFORM.CONTAINER1.TEXT1.SETFOCUS
CASE THISFORM.ACTIVEPAGE=2
THISFORM.CONTAINER2.SETALL("enabled", .T., "commandbutton")
THISFORM.CONTAINER2.TEXT1.SETFOCUS
CASE THISFORM.ACTIVEPAGE=3
THISFORM.CONTAINER3.TEXT1.SETFOCUS
CASE THISFORM.ACTIVEPAGE=4
THISFORM.CONTAINER5.TEXT10.SETFOCUS
CASE THISFORM.ACTIVEPAGE=5
THISFORM.CONTAINER4.COMMAND4.VISIBLE = .T.
CASE THISFORM.ACTIVEPAGE=5
THISFORM.KPRI.TEXT1.SETFOCUS
THISFORM.KPRI.SETALL("enabled", .T., "commandbutton")
THISFORM.KPRI.TEXT31.ENABLED = .F.
ENDCASE
ENDPROC
**
*
*  setting2.scx::Command2
**
PROCEDURE Click
THISFORM.ACTIVEPAGE = IIF(THISFORM.ACTIVEPAGE<2, 1, THISFORM.ACTIVEPAGE-1)
IF THISFORM.ACTIVEPAGE=1
THIS.ENABLED = .F.
ENDIF
THISFORM.COMMAND3.ENABLED = .T.
THISFORM.TAMPIL()
ENDPROC
**
*
*  setting2.scx::Command3
**
PROCEDURE Click
THISFORM.ACTIVEPAGE = IIF(THISFORM.ACTIVEPAGE>5, 6, THISFORM.ACTIVEPAGE+1)
IF THISFORM.ACTIVEPAGE=6
THIS.ENABLED = .F.
ENDIF
THISFORM.COMMAND2.ENABLED = .T.
THISFORM.TAMPIL()
ENDPROC
**
*
*  setting2.scx::CmdSimpan
**
PROCEDURE Click
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDEDIT.VISIBLE = .T.
THISFORM.SETALL("enabled", .F., "textbox")
THISFORM.SETALL("enabled", .F., "combobox")
THISFORM.SETALL("enabled", .F., "editbox")
THISFORM.CONTAINER2.SETALL("enabled", .F., "commandbutton")
THISFORM.SIMPAN("NAMA", THISFORM.CONTAINER1.TEXT1.VALUE)
THISFORM.SIMPAN("ALAMAT", THISFORM.CONTAINER1.TEXT2.VALUE)
THISFORM.SIMPAN("KOTA", THISFORM.CONTAINER1.TEXT3.VALUE)
THISFORM.SIMPAN("PHONE", THISFORM.CONTAINER1.TEXT4.VALUE)
THISFORM.SIMPAN("IDLEMBAGA", THISFORM.CONTAINER1.TEXT5.VALUE)
THISFORM.SIMPAN("PIMPINAN", THISFORM.CONTAINER1.TEXT6.VALUE)
THISFORM.SIMPAN("JABATAN", THISFORM.CONTAINER1.TEXT7.VALUE)
THISFORM.SIMPAN("PENGADILAN", THISFORM.CONTAINER1.TEXT8.VALUE)
THISFORM.SIMPAN("JENISKOP", THISFORM.CONTAINER1.COMBO1.VALUE)
THISFORM.SIMPAN("FMTANGG", THISFORM.CONTAINER2.TEXT1.VALUE)
THISFORM.SIMPAN("FMTSIMP", THISFORM.CONTAINER2.TEXT2.VALUE)
THISFORM.SIMPAN("FMTPINJ", THISFORM.CONTAINER2.TEXT3.VALUE)
THISFORM.SIMPAN("FMTPK", THISFORM.CONTAINER2.TEXT4.VALUE)
THISFORM.SIMPAN("FMTAKT", THISFORM.CONTAINER2.TEXT5.VALUE)
THISFORM.SIMPAN("NOPERKAS", THISFORM.CONTAINER2.TEXT6.VALUE)
THISFORM.SIMPAN("NOPERMATERAI", THISFORM.CONTAINER2.TEXT7.VALUE)
THISFORM.SIMPAN("NOPERNOTARIS", THISFORM.CONTAINER2.TEXT8.VALUE)
THISFORM.SIMPAN("NOPERPREMI", THISFORM.CONTAINER2.TEXT9.VALUE)
THISFORM.SIMPAN("NOPERBIAYA", THISFORM.CONTAINER2.TEXT10.VALUE)
THISFORM.SIMPAN("NOPERSURVEI", THISFORM.CONTAINER2.TEXT11.VALUE)
THISFORM.SIMPAN("NOPERTTPDEP", THISFORM.CONTAINER2.TEXT21.VALUE)
THISFORM.SIMPAN("NOPERAKA", THISFORM.CONTAINER2.TEXT17.VALUE)
THISFORM.SIMPAN("NOPERAKP", THISFORM.CONTAINER2.TEXT18.VALUE)
THISFORM.SIMPAN("NOPERSIMPK", THISFORM.CONTAINER2.TEXT12.VALUE)
THISFORM.SIMPAN("NOPERSIMWJB", THISFORM.CONTAINER2.TEXT13.VALUE)
THISFORM.SIMPAN("NOPERSIMSMK", THISFORM.CONTAINER2.TEXT14.VALUE)
THISFORM.SIMPAN("NOPERPENYERT", THISFORM.CONTAINER2.TEXT15.VALUE)
THISFORM.SIMPAN("NOPERLABALALU", THISFORM.CONTAINER2.TEXT16.VALUE)
THISFORM.SIMPAN("NOPERLABANOW", THISFORM.CONTAINER2.TEXT19.VALUE)
THISFORM.SIMPAN("NOPERFORMULA", THISFORM.CONTAINER2.TEXT20.VALUE)
THISFORM.SIMPAN("PROSENADM", ALLTRIM(TRANSFORM(THISFORM.CONTAINER3.TEXT1.VALUE, '99.99')))
THISFORM.SIMPAN("PROSENPROVISI", ALLTRIM(TRANSFORM(THISFORM.CONTAINER3.TEXT2.VALUE, '99.99')))
THISFORM.SIMPAN("PROSENDENDA", ALLTRIM(TRANSFORM(THISFORM.CONTAINER3.TEXT3.VALUE, '99.99')))
THISFORM.SIMPAN("TENORDENDA", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT4.VALUE)))
THISFORM.SIMPAN("KETLAIN", ALLTRIM(THISFORM.CONTAINER3.TEXT9.VALUE))
THISFORM.SIMPAN("PROSENLAIN", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT8.VALUE)))
THISFORM.SIMPAN("NOMIPOKOK", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT5.VALUE)))
THISFORM.SIMPAN("NOMIWAJIB", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT6.VALUE)))
THISFORM.SIMPAN("NOMISMK", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT7.VALUE)))
THISFORM.SIMPAN("CTKVALIDASI", ALLTRIM(STR(THISFORM.CONTAINER3.CHECK1.VALUE)))
THISFORM.SIMPAN("HARICTT", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT10.VALUE)))
THISFORM.SIMPAN("HARIULTAH", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT11.VALUE)))
THISFORM.SIMPAN("HARIJTANGS", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT12.VALUE)))
THISFORM.SIMPAN("HARIJTPINJ", ALLTRIM(STR(THISFORM.CONTAINER3.TEXT13.VALUE)))
THISFORM.SIMPAN("TABSTOR", ALLTRIM(THISFORM.CONTAINER5.TEXT10.VALUE))
THISFORM.SIMPAN("TABAMB", ALLTRIM(THISFORM.CONTAINER5.TEXT11.VALUE))
THISFORM.SIMPAN("TABPBK", ALLTRIM(THISFORM.CONTAINER5.TEXT13.VALUE))
THISFORM.SIMPAN("TABBG", ALLTRIM(THISFORM.CONTAINER5.TEXT12.VALUE))
THISFORM.SIMPAN("TABEDT", ALLTRIM(THISFORM.CONTAINER5.TEXT15.VALUE))
THISFORM.SIMPAN("TABSLD", ALLTRIM(THISFORM.CONTAINER5.TEXT14.VALUE))
THISFORM.SIMPAN("TABPJK", ALLTRIM(THISFORM.CONTAINER5.TEXT17.VALUE))
THISFORM.SIMPAN("TABADM", ALLTRIM(THISFORM.CONTAINER5.TEXT16.VALUE))
THISFORM.SIMPAN("TABBGDEP", ALLTRIM(THISFORM.CONTAINER5.TEXT32.VALUE))
THISFORM.SIMPAN("DEPSTOR", ALLTRIM(THISFORM.CONTAINER5.TEXT19.VALUE))
THISFORM.SIMPAN("DEPBG", ALLTRIM(THISFORM.CONTAINER5.TEXT18.VALUE))
THISFORM.SIMPAN("DEPPJK", ALLTRIM(THISFORM.CONTAINER5.TEXT21.VALUE))
THISFORM.SIMPAN("DEPAMBBG", ALLTRIM(THISFORM.CONTAINER5.TEXT20.VALUE))
THISFORM.SIMPAN("DEPAMBPK", ALLTRIM(THISFORM.CONTAINER5.TEXT23.VALUE))
THISFORM.SIMPAN("DEPPBKBG", ALLTRIM(THISFORM.CONTAINER5.TEXT22.VALUE))
THISFORM.SIMPAN("DEPPBKPK1", ALLTRIM(THISFORM.CONTAINER5.TEXT25.VALUE))
THISFORM.SIMPAN("DEPPBKPK2", ALLTRIM(THISFORM.CONTAINER5.TEXT24.VALUE))
THISFORM.SIMPAN("PINSTOR", ALLTRIM(THISFORM.CONTAINER5.TEXT27.VALUE))
THISFORM.SIMPAN("PINPBK", ALLTRIM(THISFORM.CONTAINER5.TEXT26.VALUE))
THISFORM.SIMPAN("PINPOT", ALLTRIM(THISFORM.CONTAINER5.TEXT29.VALUE))
THISFORM.SIMPAN("PINTRK", ALLTRIM(THISFORM.CONTAINER5.TEXT28.VALUE))
THISFORM.SIMPAN("PINPBK2", ALLTRIM(THISFORM.CONTAINER5.TEXT31.VALUE))
THISFORM.SIMPAN("PINJASA", ALLTRIM(THISFORM.CONTAINER5.TEXT30.VALUE))
THISFORM.SIMPAN("AKT_SYSTEM", ALLTRIM(STR(THISFORM.CONTAINER4.OPTIONGROUP1.VALUE)))
THISFORM.SIMPAN("AKRU_SIMPANAN", ALLTRIM(STR(THISFORM.CONTAINER4.CONTAINER1.CHECK1.VALUE)))
THISFORM.SIMPAN("AKRU_PINJAMAN", ALLTRIM(STR(THISFORM.CONTAINER4.CONTAINER1.CHECK2.VALUE)))
THISFORM.SIMPAN("AKRU_ADM", ALLTRIM(STR(THISFORM.CONTAINER4.CONTAINER1.CHECK3.VALUE)))
THISFORM.SIMPAN("AKRU_BIAYA", ALLTRIM(STR(THISFORM.CONTAINER4.CONTAINER1.CHECK4.VALUE)))
THISFORM.SIMPAN("SUSUT_INV", STR(THISFORM.CONTAINER4.OPTIONGROUP2.VALUE))
THISFORM.SIMPAN("NRC_AKT", THISFORM.CONTAINER4.TEXT1.VALUE)
THISFORM.SIMPAN("NRC_PSV", THISFORM.CONTAINER4.TEXT2.VALUE)
THISFORM.SIMPAN("NRC_ADM", THISFORM.CONTAINER4.TEXT3.VALUE)
THISFORM.SIMPAN("NRC_PO", THISFORM.CONTAINER4.TEXT4.VALUE)
THISFORM.SIMPAN("NRC_PL", THISFORM.CONTAINER4.TEXT9.VALUE)
THISFORM.SIMPAN("NRC_BO", THISFORM.CONTAINER4.TEXT5.VALUE)
THISFORM.SIMPAN("NRC_BB", THISFORM.CONTAINER4.TEXT6.VALUE)
THISFORM.SIMPAN("NRC_PNO", THISFORM.CONTAINER4.TEXT7.VALUE)
THISFORM.SIMPAN("NRC_BNO", THISFORM.CONTAINER4.TEXT8.VALUE)
THISFORM.SIMPAN("NRC_EKU", THISFORM.CONTAINER4.TEXT10.VALUE)
THISFORM.SIMPAN("NRC_MODEL", ALLTRIM(STR(THISFORM.CONTAINER4.OPTIONGROUP3.VALUE)))
THISFORM.SIMPAN("SHU_RAT", ALLTRIM(STR(THISFORM.KPRI.TEXT1.VALUE)))
THISFORM.SIMPAN("SHU_THR", ALLTRIM(STR(THISFORM.KPRI.TEXT2.VALUE)))
THISFORM.SIMPAN("SHU_OPER", ALLTRIM(STR(THISFORM.KPRI.TEXT3.VALUE)))
THISFORM.SIMPAN("SHU_SRG", ALLTRIM(STR(THISFORM.KPRI.TEXT4.VALUE)))
THISFORM.SIMPAN("SHU_BEA", ALLTRIM(STR(THISFORM.KPRI.TEXT5.VALUE)))
THISFORM.SIMPAN("SHU_DOOR", ALLTRIM(STR(THISFORM.KPRI.TEXT6.VALUE)))
THISFORM.SIMPAN("SHU_TRAN", ALLTRIM(STR(THISFORM.KPRI.TEXT7.VALUE)))
THISFORM.SIMPAN("SHU_TALI", ALLTRIM(STR(THISFORM.KPRI.TEXT8.VALUE)))
THISFORM.SIMPAN("SHU_TUNJ1", ALLTRIM(STR(THISFORM.KPRI.TEXT9.VALUE)))
THISFORM.SIMPAN("SHU_TUNJ2", ALLTRIM(STR(THISFORM.KPRI.TEXT10.VALUE)))
THISFORM.SIMPAN("SHU_TUNJ3", ALLTRIM(STR(THISFORM.KPRI.TEXT11.VALUE)))
THISFORM.SIMPAN("SHU_TUNJ4", ALLTRIM(STR(THISFORM.KPRI.TEXT12.VALUE)))
THISFORM.SIMPAN("SHU_DPLK", ALLTRIM(STR(THISFORM.KPRI.TEXT13.VALUE)))
THISFORM.SIMPAN("SHU_PEMEL", ALLTRIM(STR(THISFORM.KPRI.TEXT14.VALUE)))
THISFORM.SIMPAN("SHU_LEMB", ALLTRIM(STR(THISFORM.KPRI.TEXT15.VALUE)))
THISFORM.SIMPAN("JurSHU_RAT", ALLTRIM((THISFORM.KPRI.TEXT16.VALUE)))
THISFORM.SIMPAN("JurSHU_THR", ALLTRIM((THISFORM.KPRI.TEXT17.VALUE)))
THISFORM.SIMPAN("JurSHU_OPER", ALLTRIM((THISFORM.KPRI.TEXT18.VALUE)))
THISFORM.SIMPAN("JurSHU_SRG", ALLTRIM((THISFORM.KPRI.TEXT19.VALUE)))
THISFORM.SIMPAN("JurSHU_BEA", ALLTRIM((THISFORM.KPRI.TEXT20.VALUE)))
THISFORM.SIMPAN("JurSHU_DOOR", ALLTRIM((THISFORM.KPRI.TEXT21.VALUE)))
THISFORM.SIMPAN("JurSHU_TRAN", ALLTRIM((THISFORM.KPRI.TEXT22.VALUE)))
THISFORM.SIMPAN("JurSHU_TALI", ALLTRIM((THISFORM.KPRI.TEXT23.VALUE)))
THISFORM.SIMPAN("JurSHU_TUNJ1", ALLTRIM((THISFORM.KPRI.TEXT24.VALUE)))
THISFORM.SIMPAN("JurSHU_TUNJ2", ALLTRIM((THISFORM.KPRI.TEXT25.VALUE)))
THISFORM.SIMPAN("JurSHU_TUNJ3", ALLTRIM((THISFORM.KPRI.TEXT26.VALUE)))
THISFORM.SIMPAN("JurSHU_TUNJ4", ALLTRIM((THISFORM.KPRI.TEXT27.VALUE)))
THISFORM.SIMPAN("JurSHU_DPLK", ALLTRIM((THISFORM.KPRI.TEXT28.VALUE)))
THISFORM.SIMPAN("JurSHU_PEMEL", ALLTRIM((THISFORM.KPRI.TEXT29.VALUE)))
THISFORM.SIMPAN("JurSHU_LEMB", ALLTRIM((THISFORM.KPRI.TEXT30.VALUE)))
VARPUBLIC()
ENDPROC
**
*
*  setting2.scx::CmdBatal
**
PROCEDURE Click
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDSIMPAN.VISIBLE = .F.
THISFORM.CMDEDIT.VISIBLE = .T.
THISFORM.SETALL("enabled", .F., "textbox")
THISFORM.SETALL("enabled", .F., "combobox")
THISFORM.SETALL("enabled", .F., "editbox")
THISFORM.SETALL("enabled", .F., "checkbox")
THISFORM.SETALL("enabled", .F., "optiongroup")
THISFORM.CONTAINER2.SETALL("enabled", .F., "commandbutton")
ENDPROC
**
*
*  setting2.scx::Command1
**
PROCEDURE Click
OLDSELECT = SELECT()
DO FORM set_kantor TO MKANTOR
THISFORM.TEXT1.VALUE = MKANTOR
CSQL = "select keterangan from setsandi where kantor='ID' and kode='KNT' and sandi='"+MKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT0")
THISFORM.TEXT2.VALUE = KETERANGAN
SELECT (OLDSELECT)
ENDPROC
**
*
*  setting2.scx::Command4
**
PROCEDURE Click
DO FORM setting3
ENDPROC
**
***
*** setting2.sct
***
*
***
*** akt_labarugi_pabpr.frx
***
*
***
*** akt_labarugi_pabpr.frt
***
*
***
*** report2.frx
***
*
***
*** report2.frt
***
*
***
*** tab_rekkoran.frx
***
*
***
*** tab_rekkoran.frt
***
*
***
*** tab_nominatif_rinci.frx
***
*
***
*** tab_nominatif_rinci.frt
***
*
***
*** tab_mutasi_harian.frx
***
*
***
*** tab_mutasi_harian.frt
***
*
***
*** tab_baru.frx
***
*
***
*** tab_baru.frt
***
*
***
*** akt_transaksi_perperkiraan.frx
***
*
***
*** akt_transaksi_perperkiraan.frt
***
*
***
*** col_bayar.scx
***
*
*
*  col_bayar.scx::PINJAMAN
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
IF RECCOUNT()>0
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .T.
THISFORM.CONTAINER1.CMDLAIN.ENABLED = .T.
ELSE
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .F.
THISFORM.CONTAINER1.CMDLAIN.ENABLED = .F.
ENDIF
WITH THISFORM.CONTAINER1.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 16
.BACKCOLOR = RGB(198, 198, 255)
.COLUMN1.WIDTH = 40
.COLUMN1.CONTROLSOURCE = "INSTANSI"
.COLUMN1.HEADER1.CAPTION = "INSTANSI"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 75
.COLUMN2.CONTROLSOURCE = "NOANGG"
.COLUMN2.HEADER1.CAPTION = "NO.ANGG"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 200
.COLUMN3.CONTROLSOURCE = "NAMA"
.COLUMN3.HEADER1.CAPTION = "NAMA ANGGOTA"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "SIMPOKOK"
.COLUMN4.HEADER1.CAPTION = "SIMP.POKOK"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN4.ALIGNMENT = 1
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN5.WIDTH = 90
.COLUMN5.CONTROLSOURCE = "SIMWAJIB"
.COLUMN5.HEADER1.CAPTION = "SIM. WAJIB"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN6.WIDTH = 90
.COLUMN6.CONTROLSOURCE = "SIMSUKA"
.COLUMN6.HEADER1.CAPTION = "SIM MANASUKA"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN7.WIDTH = 90
.COLUMN7.CONTROLSOURCE = "MAPAN"
.COLUMN7.HEADER1.CAPTION = "MAPAN"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN7.INPUTMASK = "999,999,999,999"
.COLUMN7.ALIGNMENT = 1
.COLUMN8.WIDTH = 90
.COLUMN8.CONTROLSOURCE = "LAIN"
.COLUMN8.HEADER1.CAPTION = "LAIN"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN8.INPUTMASK = "999,999,999,999"
.COLUMN8.ALIGNMENT = 1
.COLUMN9.WIDTH = 200
.COLUMN9.CONTROLSOURCE = "KET"
.COLUMN9.HEADER1.CAPTION = "KETERANGAN"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 10
.COLUMN10.WIDTH = 50
.COLUMN10.CONTROLSOURCE = "RATE"
.COLUMN10.HEADER1.CAPTION = "RATE"
.COLUMN10.HEADER1.FONTBOLD = .T.
.COLUMN10.HEADER1.FONTSIZE = 10
.COLUMN10.INPUTMASK = "99,99"
.COLUMN10.ALIGNMENT = 1
.COLUMN11.WIDTH = 90
.COLUMN11.CONTROLSOURCE = "POKOK"
.COLUMN11.HEADER1.CAPTION = "PINJ.AWAL"
.COLUMN11.HEADER1.FONTBOLD = .T.
.COLUMN11.HEADER1.FONTSIZE = 10
.COLUMN11.INPUTMASK = "999,999,999,999"
.COLUMN11.ALIGNMENT = 1
.COLUMN12.WIDTH = 90
.COLUMN12.CONTROLSOURCE = "BULAN"
.COLUMN12.HEADER1.CAPTION = "BULAN ANGSURAN"
.COLUMN12.HEADER1.FONTBOLD = .T.
.COLUMN12.HEADER1.FONTSIZE = 10
.COLUMN13.WIDTH = 90
.COLUMN13.CONTROLSOURCE = "JW"
.COLUMN13.HEADER1.CAPTION = "JW"
.COLUMN13.HEADER1.FONTBOLD = .T.
.COLUMN13.HEADER1.FONTSIZE = 10
.COLUMN13.INPUTMASK = "999"
.COLUMN14.WIDTH = 90
.COLUMN14.CONTROLSOURCE = "ANGPOKOK"
.COLUMN14.HEADER1.CAPTION = "ANGS. POKOK"
.COLUMN14.HEADER1.FONTBOLD = .T.
.COLUMN14.HEADER1.FONTSIZE = 10
.COLUMN14.INPUTMASK = "999,999,999,999"
.COLUMN14.ALIGNMENT = 1
.COLUMN15.WIDTH = 90
.COLUMN15.CONTROLSOURCE = "ANGBUNGA"
.COLUMN15.HEADER1.CAPTION = "ANGS. BUNGA"
.COLUMN15.HEADER1.FONTBOLD = .T.
.COLUMN15.HEADER1.FONTSIZE = 10
.COLUMN15.INPUTMASK = "999,999,999,999"
.COLUMN15.ALIGNMENT = 1
.COLUMN16.WIDTH = 90
.COLUMN16.CONTROLSOURCE = "JMLPOTONGAN"
.COLUMN16.HEADER1.CAPTION = "JML POTONGAN"
.COLUMN16.HEADER1.FONTBOLD = .T.
.COLUMN16.HEADER1.FONTSIZE = 10
.COLUMN16.INPUTMASK = "999,999,999,999"
.COLUMN16.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.CONTAINER1.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(180,180,255) , RGB(198,198,255))", "Column")
THISFORM.CONTAINER1.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
CSQL = "select * from col_bayar where kantor='"+DEFAKANTOR+"' and "
CSQL = CSQL+"kode='"+THISFORM.KDCOLECTOR+"' and "
CSQL = CSQL+IIF(EMPTY(THISFORM.CONTAINER1.MFILTER.CAPTION), "1", THISFORM.CONTAINER1.MFILTER.CAPTION)
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
JMLDATA = RECCOUNT()
GOTO TOP
IF IJINMODUL("PINJ", "EDIT")
IF JMLDATA>0
ELSE
ENDIF
ENDIF
IF IJINMODUL("PINJ", "HAPUS")
IF JMLDATA>0
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .T.
ELSE
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .F.
ENDIF
ENDIF
IF IJINMODUL("PINJ", "CETAK")
IF JMLDATA>0
THISFORM.CONTAINER1.COMMAND6.ENABLED = .T.
ELSE
THISFORM.CONTAINER1.COMMAND6.ENABLED = .F.
ENDIF
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MSTATUS
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "TAMPIL"
ENDIF
THISFORM.CONTAINER1.CMDINPUT.ENABLED = IJINMODUL("COL", "INPUT")
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = IJINMODUL("COL", "HAPUS")
THISFORM.CONTAINER1.COMMAND6.ENABLED = IJINMODUL("COL", "CETAK")
THISFORM.TEXT2.VALUE = MONTH(TGLNOW)
THISFORM.TEXT4.VALUE = YEAR(TGLNOW)
THISFORM.MODE = MMODE
THISFORM.KDCOLECTOR = " "
THISFORM.OLDSELECT = SELECT()
IF VARTYPE(MSTATUS)="X" .OR. VARTYPE(MSTATUS)="L" .OR. MSTATUS="A"
THISFORM.LABEL2.CAPTION = "PEMBAYARAN KOLEKTIF"
MSTATUS = "A"
ELSE
THISFORM.LABEL2.CAPTION = "PEMBAYARAN KOLEKTIF"
ENDIF
THISFORM.STATUS = MSTATUS
IF MMODE="TAMPIL"
THISFORM.CONTAINER1.MFILTER.CAPTION = "bln='"+STR(MONTH(TGLNOW))+"' and tahun='"+STR(YEAR(TGLNOW))+"'"
ENDIF
THISFORM.CONTAINER1.MLIMIT.VALUE = 50
THISFORM.CONTAINER1.MLIMIT.INPUTMASK = '9999'
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
IF MMODE="CARI"
THISFORM.CONTAINER1.CMDCARI1.CLICK
ENDIF
THISFORM.CONTAINER1.ENABLED = .T.
THISFORM.TEXT2.SETFOCUS
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA)
USE
SELECT (THISFORM.OLDSELECT)
RETURN
ENDPROC
**
*
*  col_bayar.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "C002"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("Kode kolektor Tidak Tersedia")
NODEFAULT
RETURN
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT3.VALUE = KETERANGAN
THISFORM.KDCOLECTOR = MSANDI
USE
SELECT (OLDSELECT)
THISFORM.CONTAINER1.CMDINPUT.ENABLED = .T.
THISFORM.CONTAINER1.CMDINPUT1.ENABLED = .T.
ENDFUNC
**
*
*  col_bayar.scx::Cmdhapus
**
PROCEDURE Click
IF THISFORM.STATUS="A"
DO FORM ./form/col_bayar_data WITH "HAPUS", THISFORM.TEXT1.VALUE, THISFORM.TEXT2.VALUE, THISFORM.TEXT4.VALUE
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ELSE
MESSAGEBOX("Data History Tidak dapat dihapus", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  col_bayar.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar.scx::Cmdrefresh
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.CONTAINER1.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_bayar.scx::Cmddatatop
**
PROCEDURE Click
GOTO TOP
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_bayar.scx::Cmdcari
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(a.cif),TRIM(nama),TRIM(alamat),TRIM(desa),TRIM(kecamatan),TRIM(kota),TRIM(ibu),TRIM(agama),norek,b.tanggal,nopk)"+" LIKE "+UPPER(MFILTER)
THISFORM.CONTAINER1.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  col_bayar.scx::Cmdfilter
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.CONTAINER1.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.CONTAINER1.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  col_bayar.scx::Cmddataup
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_bayar.scx::Cmddatabott
**
PROCEDURE Click
GOTO BOTTOM
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_bayar.scx::Cmddatadowm
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_bayar.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE DblClick
DO FORM .\form\Col_bayar_edit WITH "TAMPIL"
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
IF THISFORM.MODE="CARI"
THISFORM.RELEASE
ELSE
DO FORM .\form\col_bayar_edit WITH "TAMPIL"
ENDIF
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
*
*  col_bayar.scx::Command6
**
PROCEDURE Click
DEFINE POPUP POPUPLAP FROM 5, 43 FONT "Cambria", 10
DEFINE BAR 1 OF POPUPLAP PROMPT 'Cetak Laporan .................. '
DEFINE BAR 2 OF POPUPLAP PROMPT 'Cetak Validasi ......................'
ON SELECTION BAR 1 OF POPUPLAP MESSAGEBOX("111111111111111111111111111")
ON SELECTION BAR 2 OF POPUPLAP MESSAGEBOX("2222222222222222222222222222221")
ACTIVATE POPUP POPUPLAP
ENDPROC
**
*
*  col_bayar.scx::Command
**
PROCEDURE Click
OLDSELECT = SELECT()
DO FORM col_set_rekap WITH THISFORM.TEXT2.VALUE, THISFORM.TEXT4.VALUE, THISFORM.KDCOLECTOR
SELECT (OLDSELECT)
THISFORM.CONTAINER1.GRID1.SETFOCUS
ENDPROC
**
*
*  col_bayar.scx::CmdLain
**
PROCEDURE Click
DO FORM col_lainlain
IF LASTKEY()<>27
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDIF
ENDPROC
**
*
*  col_bayar.scx::CmdBrowse
**
PROCEDURE Click
THISFORM.KDCOLECTOR = THISFORM.TEXT1.VALUE
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_bayar.scx::Text2
**
PROCEDURE LostFocus
IF THIS.VALUE<1 .OR. THIS.VALUE>12
MESSAGEBOX("Bulan Tagihan salah!,"+CHR(13)+"Harus di isi antara 1 s/d. 12")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** col_bayar.sct
***
*
***
*** cari_tabel.scx
***
*
*
*  cari_tabel.scx::Form1
**
PROCEDURE bacasql
MCURSOR = THISFORM.DATA
MSANDI = THISFORM.SANDI
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, MCURSOR)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampil
MDATA = THISFORM.DATA
THISFORM.GRID1.RECORDSOURCE = MDATA
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 3
.COLUMN1.WIDTH = 80
.COLUMN1.CONTROLSOURCE = "SANDI"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "SANDI"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "NAMA INSTANSI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
ENDPROC
**
FUNCTION Unload
MASAL = THISFORM.DBFASAL
MCURSOR = THISFORM.DATA
SELECT (MCURSOR)
USE
IF  .NOT. EMPTY(MASAL)
SELECT &MASAL
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MSANDI
MCURSOR = SYS(2015)
MASAL = ALIAS()
THISFORM.DBFASAL = MASAL
THISFORM.DATA = MCURSOR
THISFORM.SANDI = MSANDI
IF MSANDI='0001'
THISFORM.LABEL2.CAPTION = "DATA INSTANSI"
ENDIF
IF MSANDI='C002'
THISFORM.LABEL2.CAPTION = "DATA COLECTOR"
ENDIF
THISFORM.BACASQL()
THISFORM.TOP = 280
THISFORM.LEFT = 400
THISFORM.TEXT1.SETFOCUS
SELECT (MCURSOR)
INDEX ON SANDI TO INDEX1
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.CMDBATAL.CLICK
ENDIF
ENDPROC
**
*
*  cari_tabel.scx::Text1
**
PROCEDURE InteractiveChange
PERKIRAAN = THISFORM.MYDBFPERKIRAAN
SELECT &PERKIRAAN
MCARI = ALLTRIM(THIS.VALUE)
SET FILTER TO AT(MCARI, NOPER+NAMA)>0
THISFORM.GRID1.REFRESH
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDIF
IF NKEYCODE=24
NODEFAULT
KEYBOARD '{DNARROW}'
THISFORM.GRID1.SETFOCUS
ENDIF
ENDPROC
**
*
*  cari_tabel.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDIF
IF NKEYCODE=13
THISFORM.MYPILIH = SANDI
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  cari_tabel.scx::Cmdoke
**
PROCEDURE Click
THISFORM.MYPILIH = SANDI
THISFORM.RELEASE
ENDPROC
**
*
*  cari_tabel.scx::Cmdbatal
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  cari_tabel.scx::Cmdinput
**
PROCEDURE Click
MCURSOR = THISFORM.MYDBFPERKIRAAN
DO FORM ./form/setsandi_data WITH "INPUT", THISFORM.SANDI, THISFORM.LABEL2.CAPTION
IF LASTKEY()<>27
THISFORM.BACASQL()
THISFORM.TAMPIL()
ENDIF
ENDPROC
**
***
*** cari_tabel.sct
***
*
***
*** col_bayar_data.scx
***
*
*
*  col_bayar_data.scx::Form1
**
PROCEDURE Init
PARAMETER MMODE, MKOLEKTOR, MBULAN, MTAHUN
THISFORM.MODE = MMODE
THISFORM.KOLEKTOR = MKOLEKTOR
THISFORM.TEXT41.VALUE = MBULAN
THISFORM.TEXT3.VALUE = MTAHUN
THISFORM.TEXT1.ENABLED = .T.
THISFORM.SHAPE5.WIDTH = 0
IF MMODE="HAPUS"
THISFORM.SHAPE8.BACKCOLOR = RGB(255, 125, 125)
THISFORM.LABEL17.CAPTION = "BATAL TAGIHAN KOLEKTIF"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 0, 0)
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  col_bayar_data.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar_data.scx::Command3
**
PROCEDURE Click
IF THISFORM.MODE="INSERT"
CSQL = "select * from pinjaman where tgllunas='0000-00-00' and kelompok='"+THISFORM.TEXT1.VALUE+"' "
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
JUMREC = RECCOUNT()
DO WHILE  .NOT. EOF()
THISFORM.SHAPE5.WIDTH = (RECNO()/JUMREC)*442
MCIF = CIF
CSQL = "select nama from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MNAMA = NAMA
USE
CSQL = "select produk,norek,pot_simpanan from simpanan where tgltutup='0000-00-00' and cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
JUMREK1 = RECCOUNT()
CSQL = "select jenis,norek,pot_pokok,pot_bunga from pinjaman where tglLunas='0000-00-00' and cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT2")
JUMREK2 = RECCOUNT()
JUM = MAX(JUMREK1, JUMREK2)
FOR A = 1 TO JUM
MKE = ALLTRIM(STR(A))
MSIMSUKA&MKE=0
MREKSUKA&MKE=""
MSIMMAPAN&MKE=0
MREKMAPAN&MKE=""
MANGPK&MKE=0
MANGBG&MKE=0
MREKPINJ&MKE="" 
ENDFOR
SELECT SMT1
MSIMSUKA = 0
MSIMMAPAN = 0
A = 0
B = 0
KE = 1
DO WHILE  .NOT. EOF()
MKE = ALLTRIM(STR(KE))
IF PRODUK='4'
A = A+1
VA = ALLTRIM(STR(A))
MSIMSUKA&VA=POT_SIMPANAN
MREKSUKA&VA=NOREK
ENDIF
IF PRODUK='5'
B = B+1
VB = ALLTRIM(STR(B))
MSIMMAPAN&VB=POT_SIMPANAN
MREKMAPAN&VB=NOREK
ENDIF
KE = MAX(A, B)
SKIP
ENDDO
USE
SELECT SMT2
KE = 1
MMAXPINJ = 0
DO WHILE  .NOT. EOF()
MKE = ALLTRIM(STR(KE))
MANGPK&MKE=POT_POKOK
MANGBG&MKE=POT_BUNGA
MREKPINJ&MKE=NOREK
MMAXPINJ = KE
KE = KE+1
SKIP
ENDDO
USE
SELECT SMT
IF JUM>=1
CSQL = "insert into col_bayar (kantor,kode,instansi,bln,tahun,noangg,nama,"+"simpokok,simwajib,simsuka,mapan,lain,ket,rate,pokok,bulan,"+"jw,angpokok,angbunga,jmlpotongan) value "
FOR A = 1 TO JUM
IF A=1
MWAJIB = DEFANOMIWAJIB
ELSE
MWAJIB = 0
ENDIF
MKE = ALLTRIM(STR(A))
CSQL=CSQL+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+ STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+ CIF+"','"+MNAMA+"','"+STR(0)+"','"+STR(MWAJIB)+"','"+STR(MSIMSUKA&MKE)+"','"+ STR(MSIMMAPAN&MKE)+"','"+STR(0)+"','"+""+"','"+STR(RATE)+"','"+ STR(POKOK)+"','"+"0"+"','"+STR(LAMA)+"','"+STR(MANGPK&MKE)+"','"+ STR(MANGBG&MKE)+"','"+STR(MANGPK&MKE+MANGBG&MKE)+"'), "
ENDFOR
CSQL = LEFT(CSQL, LEN(CSQL)-2)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert data")
XSQL = CSQL
RETURN
ENDIF
ENDIF
SKIP
ENDDO
ENDIF
IF THISFORM.MODE="HAPUS"
CSQL = "DELETE from col_bayar where kantor='"+DEFAKANTOR+"' and bln='"+STR(THISFORM.TEXT41.VALUE)+"'and tahun='"+STR(THISFORM.TEXT3.VALUE)+"' and "+"kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("PEMBATALAN TAGIHAN GAGAL DILAKUKAN", 0, "")
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar_data.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "P003"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("Kode Instansi Tidak Tersedia")
NODEFAULT
RETURN
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_data.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** col_bayar_data.sct
***
*
***
*** col_bayar_edit.scx
***
*
*
*  col_bayar_edit.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MKDKOL, MBULAN, MTAHUN
THISFORM.MODE = MMODE
THISFORM.OLDSELECT = SELECT()
WITH THISFORM
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
.TEXT41.VALUE = BLN
.TEXT11.VALUE = TAHUN
.TEXT42.VALUE = KODE
.TEXT1.VALUE = INSTANSI
.TEXT4.VALUE = NOANGG
.TEXT5.VALUE = NAMA
.TEXT6.VALUE = SIMPOKOK
.TEXT7.VALUE = SIMWAJIB
.TEXT8.VALUE = SIMSUKA
.TEXT9.VALUE = MAPAN
.TEXT16.VALUE = SIMPOKOK+SIMWAJIB+SIMSUKA+MAPAN
.TEXT12.VALUE = POKOK
.TEXT13.VALUE = JW
.TEXT14.VALUE = RATE
.TEXT15.VALUE = 0
.TEXT17.VALUE = ANGPOKOK
.TEXT18.VALUE = ANGBUNGA
.TEXT20.VALUE = 0
.TEXT19.VALUE = ANGPOKOK+ANGBUNGA
.EDIT1.VALUE = KET
.TEXT22.VALUE = LAIN
.TEXT21.VALUE = LAIN
.TEXT10.VALUE = .TEXT16.VALUE+.TEXT19.VALUE+.TEXT21.VALUE
ENDIF
IF MMODE="INSERT"
.TEXT1.ENABLED = .T.
.TEXT4.ENABLED = .T.
.TEXT41.VALUE = MBULAN
.TEXT11.VALUE = MTAHUN
.TEXT42.VALUE = MKDKOL
ENDIF
IF MMODE="INSERT" .OR. MMODE="EDIT"
.TEXT6.ENABLED = .T.
.TEXT7.ENABLED = .T.
.TEXT8.ENABLED = .T.
.TEXT9.ENABLED = .T.
.TEXT17.ENABLED = .T.
.TEXT18.ENABLED = .T.
.TEXT20.ENABLED = .T.
.TEXT22.ENABLED = .T.
ENDIF
ENDWITH
IF MMODE="TAMPIL"
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar_edit.scx::Command3
**
PROCEDURE Click
IF THISFORM.MODE="EDIT"
CSQL = "update col_bayar set simpokok='"+STR(THISFORM.TEXT6.VALUE)+"', "+"simwajib='"+STR(THISFORM.TEXT7.VALUE)+"', "+"simsuka='"+STR(THISFORM.TEXT8.VALUE)+"', "+"mapan='"+STR(THISFORM.TEXT9.VALUE)+"', "+"lain='"+STR(THISFORM.TEXT22.VALUE)+"', "+"ket='"+THISFORM.EDIT1.VALUE+"', "+"angpokok='"+STR(THISFORM.TEXT17.VALUE)+"', "+"angbunga='"+STR(THISFORM.TEXT18.VALUE)+"', "+"jmlpotongan='"+STR(THISFORM.TEXT19.VALUE)+"' where "+"kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT42.VALUE+"' and "+"instansi='"+THISFORM.TEXT1.VALUE+"' and noangg='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into col_bayar (kantor,kode,instansi,tanggal,noangg,nama,simpokok,simwajib,simsuka,mapan,lain,ket,angpokok,"+"angbunga,jmlpotongan) values ("+"'"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT42.VALUE+"', "+"'"+THISFORM.TEXT1.VALUE+"', "+"'"+SQLDATE(THISFORM.TEXT41.VALUE)+"', "+"'"+THISFORM.TEXT4.VALUE+"', "+"'"+THISFORM.TEXT5.VALUE+"', "+"'"+STR(THISFORM.TEXT6.VALUE)+"', "+"'"+STR(THISFORM.TEXT7.VALUE)+"', "+"'"+STR(THISFORM.TEXT8.VALUE)+"', "+"'"+STR(THISFORM.TEXT9.VALUE)+"', "+"'"+STR(THISFORM.TEXT22.VALUE)+"', "+"'"+THISFORM.EDIT1.VALUE+"', "+"'"+STR(THISFORM.TEXT17.VALUE)+"', "+"'"+STR(THISFORM.TEXT18.VALUE)+"', "+"'"+STR(THISFORM.TEXT19.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan penambahan tagihan bayar", 0, "")
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar_edit.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "C002"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT42.VALUE = MSANDI
THISFORM.TEXT3.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_edit.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "P003"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text3
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text4
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF LASTKEY()=27
RETURN .T.
ENDIF
IF LASTKEY()=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
OLDSELECT = SELECT()
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
SELECT (OLDSELECT)
ENDIF
MCIF = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
DEFAKANTORASAL = KANTOR
THISFORM.TEXT5.VALUE = NAMA
USE
CSQL = "select SUM(mtspokok) as simpk from anggota_mutasi where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MSIMPPOKOK = IIF(ISNULL(SIMPK), 0, SIMPK)
USE
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT6.VALUE = MAX(0, VAL(CARIPUBLIC("NOMIPOKOK")), MSIMPPOKOK)
THISFORM.TEXT7.VALUE = VAL(CARIPUBLIC("NOMIWAJIB"))
USE
SELECT (OLDSELECT)
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  col_bayar_edit.scx::Text5
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text7
**
PROCEDURE InteractiveChange
THISFORM.TEXT16.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT7.VALUE+THISFORM.TEXT8.VALUE+THISFORM.TEXT9.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text6
**
PROCEDURE InteractiveChange
THISFORM.TEXT16.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT7.VALUE+THISFORM.TEXT8.VALUE+THISFORM.TEXT9.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text16
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text19
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text9
**
PROCEDURE InteractiveChange
THISFORM.TEXT16.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT7.VALUE+THISFORM.TEXT8.VALUE+THISFORM.TEXT9.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text8
**
PROCEDURE InteractiveChange
THISFORM.TEXT16.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT7.VALUE+THISFORM.TEXT8.VALUE+THISFORM.TEXT9.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text12
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text13
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text14
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text15
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text17
**
PROCEDURE InteractiveChange
THISFORM.TEXT19.VALUE = THISFORM.TEXT17.VALUE+THISFORM.TEXT18.VALUE+THISFORM.TEXT20.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text18
**
PROCEDURE InteractiveChange
THISFORM.TEXT19.VALUE = THISFORM.TEXT17.VALUE+THISFORM.TEXT18.VALUE+THISFORM.TEXT20.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text20
**
PROCEDURE InteractiveChange
THISFORM.TEXT19.VALUE = THISFORM.TEXT17.VALUE+THISFORM.TEXT18.VALUE+THISFORM.TEXT20.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text21
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text22
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THISFORM.TEXT22.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF THIS.VALUE>0
THISFORM.EDIT1.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Text10
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar_edit.scx::Text11
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_edit.scx::Command4
**
PROCEDURE Click
CIF = THISFORM.TEXT4.VALUE
NAMA = THISFORM.TEXT5.VALUE
DO FORM anggota_potong_gaji
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
***
*** col_bayar_edit.sct
***
*
***
*** col_bayar_rekap.scx
***
*
*
*  col_bayar_rekap.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MBULAN, MTAHUN, MKDCOL, MCOLNAME, MINST, MINSTNAME
THISFORM.TEXT41.VALUE = MBULAN
THISFORM.TEXT16.VALUE = MTAHUN
THISFORM.TEXT42.VALUE = MKDCOL
THISFORM.TEXT3.VALUE = MCOLNAME
THISFORM.TEXT1.VALUE = MINST
THISFORM.TEXT2.VALUE = MINSTNAME
THISFORM.TEXT4.VALUE = IIF(ISNULL(JSIMPOKOK), 0, JSIMPOKOK)
THISFORM.TEXT5.VALUE = IIF(ISNULL(JSIMWAJIB), 0, JSIMWAJIB)
THISFORM.TEXT6.VALUE = IIF(ISNULL(JSIMPOKOK), 0, JSIMPOKOK)+IIF(ISNULL(JSIMWAJIB), 0, JSIMWAJIB)
THISFORM.TEXT7.VALUE = IIF(ISNULL(JSIMSUKA), 0, JSIMSUKA)
THISFORM.TEXT8.VALUE = IIF(ISNULL(JMAPAN), 0, JMAPAN)
THISFORM.TEXT9.VALUE = IIF(ISNULL(JSIMSUKA), 0, JSIMSUKA)+IIF(ISNULL(JMAPAN), 0, JMAPAN)
THISFORM.TEXT10.VALUE = IIF(ISNULL(JANGPOKOK), 0, JANGPOKOK)
THISFORM.TEXT11.VALUE = IIF(ISNULL(JANGBUNGA), 0, JANGBUNGA)
THISFORM.TEXT12.VALUE = 0
THISFORM.TEXT13.VALUE = IIF(ISNULL(JANGPOKOK), 0, JANGPOKOK)+IIF(ISNULL(JANGBUNGA), 0, JANGBUNGA)
THISFORM.TEXT14.VALUE = IIF(ISNULL(JLAIN), 0, JLAIN)
THISFORM.TEXT15.VALUE = IIF(ISNULL(JSIMPOKOK), 0, JSIMPOKOK)+IIF(ISNULL(JSIMWAJIB), 0, JSIMWAJIB)+IIF(ISNULL(JSIMSUKA), 0, JSIMSUKA)+IIF(ISNULL(JMAPAN), 0, JMAPAN)+IIF(ISNULL(JANGPOKOK), 0, JANGPOKOK)+IIF(ISNULL(JANGBUNGA), 0, JANGBUNGA)+IIF(ISNULL(JLAIN), 0, JLAIN)
ENDPROC
**
*
*  col_bayar_rekap.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar_rekap.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "C002"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT42.VALUE = MSANDI
THISFORM.TEXT3.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_rekap.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text3
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text4
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_rekap.scx::Text5
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text6
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_rekap.scx::Text7
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_rekap.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text9
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_rekap.scx::Text10
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_rekap.scx::Text11
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text12
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_rekap.scx::Text13
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text14
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_bayar_rekap.scx::Text15
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_rekap.scx::Text16
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** col_bayar_rekap.sct
***
*
***
*** col_set_rekap.scx
***
*
*
*  col_set_rekap.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MBLN, MTHN, MKOLECT
THISFORM.TEXT41.VALUE = MBLN
THISFORM.TEXT4.VALUE = MTHN
THISFORM.TEXT42.VALUE = MKOLECT
THISFORM.TEXT1.VALUE = INSTANSI
OLDSELECT = SELECT()
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002' and sandi='"+THISFORM.TEXT42.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT3.VALUE = KETERANGAN
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT2.VALUE = KETERANGAN
ENDPROC
**
*
*  col_set_rekap.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_set_rekap.scx::Command3
**
PROCEDURE Click
MKODE = THISFORM.TEXT42.VALUE
MBLN = STR(THISFORM.TEXT41.VALUE)
MTHN = STR(THISFORM.TEXT4.VALUE)
MINST = THISFORM.TEXT1.VALUE
CREATE CURSOR rekap (JSIMPOKOK N (12), JSIMWAJIB N (12), JSIMPANAN N (12), JLAIN N (12), JANGPOKOK N (12), JANGBUNGA N (12), JANGDENDA N (12))
APPEND BLANK
CSQL = "select noangg,simpokok, simwajib,lain "+"from col_instansi where instansi=?minst and kode=?mkode and tahun=?mthn and bln=?mbln "
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal rekap")
ENDIF
DO WHILE  .NOT. EOF()
MNOANGG = NOANGG
MSIMPOKOK = SIMPOKOK
MSIMWAJIB = SIMWAJIB
MLAIN = LAIN
SELECT REKAP
MANGPOKOK = JANGPOKOK
MANGBUNGA = JANGBUNGA
MANGDENDA = JANGDENDA
MSIMPANAN = JSIMPANAN
REPLACE JSIMPOKOK WITH JSIMPOKOK+MSIMPOKOK, JSIMWAJIB WITH JSIMWAJIB+MSIMWAJIB, JLAIN WITH JLAIN+MLAIN
CSQL = "select sum(angpokok) as angpokok, sum(angbunga) as angbunga,sum(angdenda) as AngDenda from col_instansi_pinj "+"where instansi=?minst and kode=?mkode and tahun=?mthn and bln=?mbln and noangg=?mnoangg group by noangg"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX("gagal baca")
RETURN
ENDIF
MANGPOKOK = MANGPOKOK+ANGPOKOK
MANGBUNGA = MANGBUNGA+ANGBUNGA
MANGDENDA = MANGDENDA+ANGDENDA
SELECT REKAP
REPLACE JANGPOKOK WITH MANGPOKOK, JANGBUNGA WITH MANGBUNGA, JANGDENDA WITH MANGDENDA
SELECT SMT
CSQL = "select sum(jumlah) as simpanan from col_instansi_simp "+"where instansi=?minst and kode=?mkode and tahun=?mthn and bln=?mbln and noangg=?mnoangg group by noangg"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX("gagal baca")
RETURN
ENDIF
MSIMPANAN = MSIMPANAN+SIMPANAN
SELECT REKAP
REPLACE JSIMPANAN WITH MSIMPANAN
SELECT SMT
SKIP
ENDDO
SELECT REKAP
DO FORM col_instansi_rekap WITH THISFORM.TEXT41.VALUE, THISFORM.TEXT4.VALUE, THISFORM.TEXT42.VALUE, THISFORM.TEXT3.VALUE, THISFORM.TEXT1.VALUE, THISFORM.TEXT2.VALUE
USE
THISFORM.RELEASE
ENDPROC
**
*
*  col_set_rekap.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_set_rekap.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "C002"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("KODE KOLEKTOR TIDAK TERSEDIA", 0, "Peringatan")
NODEFAULT
RETURN
ENDIF
THISFORM.TEXT42.VALUE = MSANDI
THISFORM.TEXT3.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_set_rekap.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "P003"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("Kode Instansi Tidak Tersedia", 0, "Peringatan")
NODEFAULT
RETURN
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_set_rekap.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_set_rekap.scx::Text3
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_set_rekap.scx::Text4
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** col_set_rekap.sct
***
*
***
*** print_setup.scx
***
*
*
*  print_setup.scx::REPORTFORMPROMPT
**
PROCEDURE setprnname
LPARAMETERS TLINIT
WITH THISFORM
.PRNCOUNT = APRINTERS(.PRNARRAY)
= ASORT(.PRNARRAY)
NNEWPRINTCOUNT = .PRNCOUNT
FOR COUNTER = 1 TO .PRNCOUNT
IF EMPTY(.PRNARRAY(COUNTER, 1))
LOOP
ENDIF
IF (UPPER(.PRNARRAY(COUNTER, 1))$UPPER(.PRNEXCLUSIONS))
ADEL(.PRNARRAY, COUNTER)
COUNTER = COUNTER-1
NNEWPRINTCOUNT = NNEWPRINTCOUNT-1
ENDIF
ENDFOR
.PRNCOUNT = NNEWPRINTCOUNT
IF .PRNCOUNT=0
DIMENSION .PRNARRAY[1, 2]
.PRNARRAY = "No Printers Available"
.CBOPRNNAME.ADDITEM(.PRNARRAY(1, 1), 1)
.CBOPRNNAME.LISTINDEX = 1
.CBOPRNNAME.ENABLED = .F.
ELSE
DIMENSION .PRNARRAY[.PRNCOUNT, 2]
.CBOPRNNAME.ENABLED = .T.
.CBOPRNNAME.CLEAR
FOR COUNTER = 1 TO .PRNCOUNT
IF LEFT(.PRNARRAY(COUNTER, 1), 1)="\"
.CBOPRNNAME.ADDITEM("\"+.PRNARRAY(COUNTER, 1), COUNTER)
ELSE
.CBOPRNNAME.ADDITEM(.PRNARRAY(COUNTER, 1), COUNTER)
ENDIF
IF TLINIT
IF UPPER(.PRNARRAY(COUNTER, 1))=UPPER(SET("PRINTER", 2))
.CBOPRNNAME.LISTINDEX = COUNTER
.LBLWHERE.CAPTION = .PRNARRAY(COUNTER, 2)
TLINIT = .F.
ENDIF
ENDIF
ENDFOR
ENDIF
ENDWITH
ENDPROC
**
PROCEDURE setprnsize
LOCAL CPAPERNUMBERS, CPAPERNAMES, NPAPERTYPES, COUNTER
LOCAL CPRNNAME, CPRNPORT
WITH THISFORM
IF .PRNCOUNT=0
.CBOPAPER.ENABLED = .F.
RETURN
ENDIF
.CBOPAPER.ENABLED = .T.
CPRNNAME = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 1)
CPRNPORT = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 2)
NPAPERTYPES = DEVICECAPABILITIES(CPRNNAME, CPRNPORT, 2, 0, 0)
CPAPERNUMBERS = SPACE((NPAPERTYPES*2))
CPAPERNAMES = SPACE((NPAPERTYPES*64))
= DEVICECAPABILITIES(CPRNNAME, CPRNPORT, 2, @CPAPERNUMBERS, 0)
= DEVICECAPABILITIES(CPRNNAME, CPRNPORT, 16, @CPAPERNAMES, 0)
DIMENSION .PRNPAPER[NPAPERTYPES, 2]
.CBOPAPER.CLEAR
FOR COUNTER = 1 TO NPAPERTYPES
.PRNPAPER[COUNTER, 2] = (ASC(SUBSTR(CPAPERNUMBERS, (COUNTER*2), 1))*256)+(ASC(SUBSTR(CPAPERNUMBERS, (COUNTER*2)-1, 1)))
.PRNPAPER[COUNTER, 1] = SUBSTR(CPAPERNAMES, ((COUNTER-1)*64)+1, 64)
IF LEFT(.PRNPAPER(COUNTER, 1), 1)="\"
.CBOPAPER.ADDITEM("\"+.PRNPAPER(COUNTER, 1), COUNTER)
ELSE
.CBOPAPER.ADDITEM(.PRNPAPER(COUNTER, 1), COUNTER)
ENDIF
IF (PRTINFO(2, CPRNNAME)=.PRNPAPER(COUNTER, 2))
.CBOPAPER.LISTINDEX = COUNTER
ENDIF
ENDFOR
ENDWITH
ENDPROC
**
PROCEDURE setprnsource
LOCAL CBINNUMBERS, CBINNAMES, NBINCOUNT, COUNTER
LOCAL CPRNNAME, CPRNPORT
WITH THISFORM
IF .PRNCOUNT=0
.CBOSOURCE.ENABLED = .F.
RETURN
ENDIF
.CBOSOURCE.ENABLED = .T.
CPRNNAME = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 1)
CPRNPORT = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 2)
NBINCOUNT = DEVICECAPABILITIES(CPRNNAME, CPRNPORT, 6, 0, 0)
CBINNUMBERS = SPACE((NBINCOUNT*2))
CBINNAMES = SPACE((NBINCOUNT*24))
= DEVICECAPABILITIES(CPRNNAME, CPRNPORT, 6, @CBINNUMBERS, 0)
= DEVICECAPABILITIES(CPRNNAME, CPRNPORT, 12, @CBINNAMES, 0)
DIMENSION .PRNBINS[NBINCOUNT, 2]
.CBOSOURCE.CLEAR
FOR COUNTER = 1 TO NBINCOUNT
.PRNBINS[COUNTER, 2] = (ASC(SUBSTR(CBINNUMBERS, (COUNTER*2), 1))*256)+(ASC(SUBSTR(CBINNUMBERS, (COUNTER*2)-1, 1)))
.PRNBINS[COUNTER, 1] = SUBSTR(CBINNAMES, ((COUNTER-1)*24)+1, 24)
IF LEFT(.PRNBINS(COUNTER, 1), 1)="\"
.CBOSOURCE.ADDITEM("\"+.PRNBINS(COUNTER, 1), COUNTER)
ELSE
.CBOSOURCE.ADDITEM(.PRNBINS(COUNTER, 1), COUNTER)
ENDIF
IF (PRTINFO(7, CPRNNAME)=.PRNBINS(COUNTER, 2))
.CBOSOURCE.LISTINDEX = COUNTER
ENDIF
ENDFOR
ENDWITH
ENDPROC
**
PROCEDURE setprncopies
LPARAMETERS TLINIT
LOCAL CCOPIES, MAXCOPIES
LOCAL CPRNNAME, CPRNPORT
WITH THISFORM
IF .PRNCOUNT=0
.SPNCOPIES.ENABLED = .F.
RETURN
ENDIF
.SPNCOPIES.ENABLED = .T.
CPRNNAME = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 1)
CPRNPORT = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 2)
CCOPIES = ""
MAXCOPIES = DEVICECAPABILITIES(CPRNNAME, CPRNPORT, 18, @CCOPIES, 0)
IF (MAXCOPIES<1)
MAXCOPIES = 1
ENDIF
.SPNCOPIES.SPINNERHIGHVALUE = MIN(MAXCOPIES, 9999)
.SPNCOPIES.ENABLED = (MAXCOPIES>1)
.SPNCOPIES.VALUE = PRTINFO(6, CPRNNAME)
ENDWITH
ENDPROC
**
PROCEDURE setprnorientation
LPARAMETERS TLINIT
LOCAL CPRNNAME, CPRNPORT
WITH THISFORM
IF .PRNCOUNT=0
.OPGORIENTATION.ENABLED = .F.
RETURN
ENDIF
.OPGORIENTATION.ENABLED = .T.
CPRNNAME = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 1)
CPRNPORT = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 2)
.OPGORIENTATION.VALUE = PRTINFO(1, CPRNNAME)+1
ENDWITH
ENDPROC
**
PROCEDURE setproperties
LOCAL TMPEXPR, LCSHORTNAME
WITH THISFORM
.PRINTERNAME = .CBOPRNNAME.VALUE
.PRINTERPAPERSIZE = .PRNPAPER(.CBOPAPER.LISTINDEX, 2)
.PRINTERPAPERSOURCE = .PRNBINS(.CBOSOURCE.LISTINDEX, 2)
.PRINTERORIENTATION = .OPGORIENTATION.VALUE-1
.PRINTERCOPIES = .SPNCOPIES.VALUE
TMPEXPR = "ORIENTATION="+ALLTRIM(STR(.PRINTERORIENTATION))+CHR(13)+CHR(10)+"PAPERSIZE="+ALLTRIM(STR(.PRINTERPAPERSIZE))+CHR(13)+CHR(10)+"COPIES="+ALLTRIM(STR(.PRINTERCOPIES))+CHR(13)+CHR(10)+"DEFAULTSOURCE="+ALLTRIM(STR(.PRINTERPAPERSOURCE))+CHR(13)+CHR(10)
UPDATE (.RPTTMPFILE+"."+.RPTEXT) SET EXPR = TMPEXPR, TAG = "", TAG2 = "" WHERE OBJTYPE=1 .AND. OBJCODE=53
LCSHORTNAME = JUSTFNAME(.RPTTMPFILE)
USE IN (LCSHORTNAME)
ENDWITH
ENDPROC
**
PROCEDURE printreport
LOCAL LCOLDPRINTER, LNPRINTRANGEFROM, LNPRINTRANGETO, LCWHERE_FOR, LCSCOPE
SELECT (THISFORM.OLDSELE)
WITH THISFORM
LCFORWHILE = .CFORWHILE
LCSCOPE = .CSCOPE
LNPRINTRANGEFROM = IIF(.OPGPRINTRANGE.VALUE=1, 1, .TXTPAGEFROM.VALUE)
LNPRINTRANGETO = IIF(.OPGPRINTRANGE.VALUE=1, 9999, .TXTPAGETO.VALUE)
LCOLDPRINTER = SET('PRINTER', 3)
SET PRINTER TO NAME (.PRINTERNAME)
DO CASE
CASE .RPTEXT="FRX"
REPORT FORM (.RPTTMPFILE) TO PRINTER  &LCFORWHILE  &LCSCOPE  NOCONSOLE  RANGE LNPRINTRANGEFROM,LNPRINTRANGETO
CASE .RPTEXT="LBX"
LABEL FORM (.RPTTMPFILE) TO PRINTER  &LCFORWHILE  &LCSCOPE  NOCONSOLE  RANGE LNPRINTRANGEFROM,LNPRINTRANGETO
OTHERWISE
= MESSAGEBOX("Cannot print report")
ENDCASE
SET PRINTER TO NAME (LCOLDPRINTER)
ENDWITH
ENDPROC
**
PROCEDURE rptext_assign
LPARAMETERS VNEWVAL
IF EMPTY(VNEWVAL)
M.VNEWVAL = 'FRX'
ENDIF
THIS.RPTEXT = M.VNEWVAL
ENDPROC
**
PROCEDURE printpreview
LOCAL LCOLDPRINTER, LNPRINTRANGEFROM, LNPRINTRANGETO, LCWHERE_FOR, LCSCOPE
WITH THISFORM
LCFORWHILE = .CFORWHILE
LCSCOPE = .CSCOPE
LNPRINTRANGEFROM = IIF(.OPGPRINTRANGE.VALUE=1, 1, .TXTPAGEFROM.VALUE)
LNPRINTRANGETO = IIF(.OPGPRINTRANGE.VALUE=1, 9999, .TXTPAGETO.VALUE)
LCOLDPRINTER = SET('PRINTER', 3)
SET PRINTER TO NAME (.PRINTERNAME)
DO CASE
CASE .RPTEXT="FRX"
REPORT FORM (.RPTTMPFILE) PREVIEW &LCFORWHILE  &LCSCOPE  NOCONSOLE  RANGE LNPRINTRANGEFROM,LNPRINTRANGETO IN SCREEN  
CASE .RPTEXT="LBX"
LABEL FORM (.RPTTMPFILE) PREVIEW  &LCFORWHILE  &LCSCOPE  NOCONSOLE  RANGE LNPRINTRANGEFROM,LNPRINTRANGETO
OTHERWISE
= MESSAGEBOX("Cannot print report")
ENDCASE
SET PRINTER TO NAME (LCOLDPRINTER)
ENDWITH
ENDPROC
**
PROCEDURE Destroy
WITH THISFORM
IF USED(JUSTFNAME(.RPTTMPFILE))
USE IN (JUSTFNAME(.RPTTMPFILE))
ENDIF
IF FILE(.RPTTMPFILE+"."+.RPTEXT)
ERASE (.RPTTMPFILE+"."+.RPTEXT)
ENDIF
IF FILE(.RPTTMPFILE+".frt")
ERASE (.RPTTMPFILE+".frt")
ENDIF
ENDWITH
ENDPROC
**
FUNCTION Init
LPARAMETERS TCREPORTNAME, TCFORWHILE, TCSCOPE
LOCAL INPRNNAME, INCOPIES, INORIENTATION, INPAPERSIZE, INPAPERSOURCE
LOCAL NWA, LCSHORTNAME
LOCAL COUNTER, CDEFAULTPRINTER
THISFORM.OLDSELE = SELECT()
IF EMPTY(TCREPORTNAME)
TCREPORTNAME = GETFILE('frx;lbx')
IF EMPTY(TCREPORTNAME)
RETURN .F.
ENDIF
ENDIF
TCREPORTNAME = UPPER(TCREPORTNAME)
WITH THISFORM
IF  .NOT. EMPTY(TCSCOPE)
.CSCOPE = TCSCOPE
ENDIF
IF  .NOT. EMPTY(TCFORWHILE)
.CFORWHILE = TCFORWHILE
ENDIF
.RPTEXT = JUSTEXT(TCREPORTNAME)
.RPTPATH = ADDBS(JUSTPATH(TCREPORTNAME))
TCREPORTNAME = ADDBS(JUSTPATH(TCREPORTNAME))+JUSTSTEM(TCREPORTNAME)
NWA = SELECT()
LCSHORTNAME = JUSTFNAME(TCREPORTNAME)
.RPTTMPFILE = ADDBS(SYS(2023))+LEFT(SYS(2015), 8)
DO WHILE FILE(.RPTTMPFILE+"."+.RPTEXT)
.RPTTMPFILE = ADDBS(SYS(2023))+SYS(3)
ENDDO
SELECT * FROM (TCREPORTNAME+"."+.RPTEXT) INTO TABLE (.RPTTMPFILE+"."+.RPTEXT)
USE IN (LCSHORTNAME)
LOCATE FOR OBJTYPE=1 .AND. OBJCODE=53
INPRNNAME = ""
INCOPIES = -1
INORIENTATION = -1
INPAPERSIZE = -1
INPAPERSOURCE = -1
ARRAYCOUNT = ALINES(AMEMLINE, EXPR, .T.)
FOR COUNTER = 1 TO ARRAYCOUNT
IF ("DEVICE"$UPPER(AMEMLINE(COUNTER)))
INPRNNAME = SUBSTR(AMEMLINE(COUNTER), AT("=", AMEMLINE(COUNTER))+1)
ENDIF
IF ("ORIENTATION"$UPPER(AMEMLINE(COUNTER)))
INORIENTATION = INT(VAL(SUBSTR(AMEMLINE(COUNTER), AT("=", AMEMLINE(COUNTER))+1)))
ENDIF
IF ("PAPERSIZE"$UPPER(AMEMLINE(COUNTER)))
INPAPERSIZE = INT(VAL(SUBSTR(AMEMLINE(COUNTER), AT("=", AMEMLINE(COUNTER))+1)))
ENDIF
IF ("COPIES"$UPPER(AMEMLINE(COUNTER)))
INCOPIES = INT(VAL(SUBSTR(AMEMLINE(COUNTER), AT("=", AMEMLINE(COUNTER))+1)))
ENDIF
IF ("DEFAULTSOURCE"$UPPER(AMEMLINE(COUNTER)))
INPAPERSOURCE = INT(VAL(SUBSTR(AMEMLINE(COUNTER), AT("=", AMEMLINE(COUNTER))+1)))
ENDIF
ENDFOR
USE
SELECT (NWA)
.SETPRNNAME(.T.)
IF .CBOPRNNAME.LISTINDEX=0
.CBOPRNNAME.LISTINDEX = 1
ENDIF
IF (LEN(INPRNNAME)>0)
FOR COUNTER = 1 TO .PRNCOUNT
IF UPPER(.PRNARRAY(COUNTER, 1))=UPPER(INPRNNAME)
.CBOPRNNAME.LISTINDEX = COUNTER
.LBLWHERE.CAPTION = .PRNARRAY(COUNTER, 2)
ENDIF
ENDFOR
ELSE
CDEFAULTPRINTER = SET('PRINTER', 3)
FOR COUNTER = 1 TO .PRNCOUNT
IF UPPER(.PRNARRAY(COUNTER, 1))=UPPER(CDEFAULTPRINTER)
.CBOPRNNAME.LISTINDEX = COUNTER
.LBLWHERE.CAPTION = .PRNARRAY(COUNTER, 2)
ENDIF
ENDFOR
ENDIF
.SETPRNSIZE()
IF (INPAPERSIZE>-1)
FOR COUNTER = 1 TO .CBOPAPER.LISTCOUNT
IF (INPAPERSIZE=.PRNPAPER(COUNTER, 2))
.CBOPAPER.LISTINDEX = COUNTER
ENDIF
ENDFOR
ENDIF
.SETPRNSOURCE()
IF (INPAPERSOURCE>-1)
FOR COUNTER = 1 TO .CBOSOURCE.LISTCOUNT
IF (INPAPERSOURCE=.PRNBINS(COUNTER, 2))
.CBOSOURCE.LISTINDEX = COUNTER
ENDIF
ENDFOR
ENDIF
IF .CBOSOURCE.LISTINDEX=0
.CBOSOURCE.LISTINDEX = 1
ENDIF
.SETPRNCOPIES()
IF ((INCOPIES>-1) .AND. (.SPNCOPIES.ENABLED=.T.))
.SPNCOPIES.VALUE = INCOPIES
ELSE
.SPNCOPIES.VALUE = 1
ENDIF
.SETPRNORIENTATION()
IF (INORIENTATION>-1)
IF (INORIENTATION=0)
.OPGORIENTATION.PORTRAIT.VALUE = 1
.OPGORIENTATION.LANDSCAPE.VALUE = 0
.IMGPORTRAIT.VISIBLE = .T.
.IMGLANDSCAPE.VISIBLE = .F.
ELSE
.OPGORIENTATION.PORTRAIT.VALUE = 0
.OPGORIENTATION.LANDSCAPE.VALUE = 1
.IMGPORTRAIT.VISIBLE = .F.
.IMGLANDSCAPE.VISIBLE = .T.
ENDIF
ENDIF
.OPGPRINTRANGE.ENABLED = (.PRNCOUNT>0)
.TXTPAGEFROM.ENABLED = (.PRNCOUNT>0)
.TXTPAGETO.ENABLED = (.PRNCOUNT>0)
.CMDOK.ENABLED = (.PRNCOUNT>0)
ENDWITH
ENDFUNC
**
PROCEDURE Load
DECLARE LONG DeviceCapabilities IN "winspool.drv" STRING, STRING, LONG, STRING @, INTEGER
ENDPROC
**
*
*  print_setup.scx::cboPrnName
**
PROCEDURE InteractiveChange
LOCAL PREVPAPERSIZE, PREVPAPERBIN, PREVCOPIES, LSET
LSET = .F.
WITH THISFORM
.LOCKSCREEN = .T.
.LBLWHERE.CAPTION = .PRNARRAY(.CBOPRNNAME.LISTINDEX, 2)
PREVPAPERSIZE = IIF(.CBOPAPER.LISTINDEX=0, 0, .PRNPAPER(.CBOPAPER.LISTINDEX, 2))
.SETPRNSIZE()
LSET = .F.
FOR COUNTER = 1 TO .CBOPAPER.LISTCOUNT
IF (.PRNPAPER(COUNTER, 2)=PREVPAPERSIZE)
.CBOPAPER.LISTINDEX = COUNTER
LSET = .T.
EXIT
ENDIF
ENDFOR
IF PREVPAPERSIZE=0 .OR. LSET=.F.
.CBOPAPER.LISTINDEX = 1
ENDIF
PREVPAPERBIN = IIF(.CBOSOURCE.LISTINDEX=0, 0, .PRNBINS(.CBOSOURCE.LISTINDEX, 2))
.SETPRNSOURCE()
LSET = .F.
FOR COUNTER = 1 TO .CBOSOURCE.LISTCOUNT
IF (.PRNBINS(COUNTER, 2)=PREVPAPERBIN)
.CBOSOURCE.LISTINDEX = COUNTER
LSET = .T.
EXIT
ENDIF
ENDFOR
IF PREVPAPERBIN=0 .OR. LSET=.F.
.CBOSOURCE.LISTINDEX = 1
ENDIF
PREVCOPIES = .SPNCOPIES.VALUE
.SETPRNCOPIES()
.SPNCOPIES.VALUE = IIF(PREVCOPIES<=.SPNCOPIES.SPINNERHIGHVALUE, PREVCOPIES, .SPNCOPIES.SPINNERHIGHVALUE)
.LOCKSCREEN = .F.
ENDWITH
ENDPROC
**
*
*  print_setup.scx::lblWhere
**
PROCEDURE Init
THIS.BORDERSTYLE = 0
THIS.CAPTION = ''
ENDPROC
**
*
*  print_setup.scx::opgOrientation
**
PROCEDURE Portrait.Click
WITH THISFORM
.LOCKSCREEN = .T.
.IMGPORTRAIT.VISIBLE = .T.
.IMGLANDSCAPE.VISIBLE = .F.
.LOCKSCREEN = .F.
ENDWITH
ENDPROC
**
PROCEDURE Landscape.Click
WITH THISFORM
.LOCKSCREEN = .T.
.IMGPORTRAIT.VISIBLE = .F.
.IMGLANDSCAPE.VISIBLE = .T.
.LOCKSCREEN = .F.
ENDWITH
ENDPROC
**
*
*  print_setup.scx::opgPrintRange
**
PROCEDURE Option2.Click
THISFORM.TXTPAGEFROM.SETFOCUS()
ENDPROC
**
*
*  print_setup.scx::txtPageFrom
**
PROCEDURE InteractiveChange
THISFORM.OPGPRINTRANGE.VALUE = 2
ENDPROC
**
*
*  print_setup.scx::txtPageTo
**
PROCEDURE InteractiveChange
THISFORM.OPGPRINTRANGE.VALUE = 2
ENDPROC
**
*
*  print_setup.scx::cmdOK
**
PROCEDURE Click
THISFORM.SETPROPERTIES()
THISFORM.PRINTREPORT()
THISFORM.CMDCANCEL.CLICK()
ENDPROC
**
*
*  print_setup.scx::cmdCancel
**
PROCEDURE Click
THISFORM.RELEASE()
ENDPROC
**
*
*  print_setup.scx::Command1
**
PROCEDURE Click
THISFORM.SETPROPERTIES()
THISFORM.PRINTPREVIEW()
ENDPROC
**
***
*** print_setup.sct
***
*
***
*** krd_nominatif.frx
***
*
***
*** krd_nominatif.frt
***
*
***
*** anggota_potong_gaji.scx
***
*
*
*  anggota_potong_gaji.scx::FORM1
**
PROCEDURE bacadata
MDATA1 = THISFORM.DATA1
MCIF = CIF
CSQL = "select a.tanggal,a.norek,a.jenis,a.pot_simpanan,b.keterangan as produk from simpanan as a, setsandi_tab as b where cif='"+THISFORM.TEXT1.VALUE+"' and tgltutup='0000-00-00' and a.jenis=b.jenis and a.produk=b.sandi "
LCEK = SQLEXEC(OODBC, CSQL, MDATA1)
MDATA2 = THISFORM.DATA2
CSQL = "select tanggal,norek,jenis,pot_pokok,pot_bunga from pinjaman where cif='"+THISFORM.TEXT1.VALUE+"' and tglLunas='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, MDATA2)
ENDPROC
**
PROCEDURE tampilkan
DATA1 = THISFORM.DATA1
SELECT &DATA1  
WITH THISFORM.GRID1
.RECORDSOURCE = DATA1
.COLUMNCOUNT = 3
THISFORM.GRID1.FONTNAME = "Cambria"
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NOREK"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "PRODUK"
.COLUMN2.HEADER1.CAPTION = "PRODUK"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "POT_SIMPANAN"
.COLUMN3.INPUTMASK = "999,999,999,999"
.COLUMN3.ALIGNMENT = 1
.COLUMN3.HEADER1.CAPTION = "SIMPANAN"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.SETFOCUS
DATA2 = THISFORM.DATA2
SELECT &DATA2  
THISFORM.GRID2.FONTNAME = "Cambria"
WITH THISFORM.GRID2
.RECORDSOURCE = DATA2
.COLUMNCOUNT = 4
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 100
.COLUMN2.CONTROLSOURCE = "NOREK"
.COLUMN2.HEADER1.CAPTION = "NOREK"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "POT_POKOK"
.COLUMN3.INPUTMASK = "999,999,999,999"
.COLUMN3.HEADER1.CAPTION = "POKOK"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN3.ALIGNMENT = 1
.COLUMN4.WIDTH = 100
.COLUMN4.CONTROLSOURCE = "POT_BUNGA"
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.HEADER1.CAPTION = "BUNGA"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN4.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID2.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID2.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.COMMAND1.VISIBLE = IJINMODUL("ANGG", "EDIT")
THISFORM.COMMAND2.VISIBLE = IJINMODUL("ANGG", "EDIT")
THISFORM.COMMAND4.VISIBLE = IJINMODUL("ANGG", "EDIT")
THISFORM.TEXT1.VALUE = CIF
MCIF = CIF
OLDDBF = SELECT()
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal Baca anggota", 0, "")
ENDIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = IIF(ISNULL(SIMPOKOK), 0, SIMPOKOK)
THISFORM.TEXT5.VALUE = IIF(ISNULL(SIMWAJIB), 0, SIMWAJIB)
THISFORM.TEXT11.VALUE = IIF(ISNULL(LAIN), 0, LAIN)
THISFORM.TEXT12.VALUE = KETLAIN
USE
SELECT (OLDDBF)
THISFORM.OLDSELECT = SELECT()
THISFORM.DATA1 = SYS(2015)
THISFORM.DATA2 = SYS(2015)
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.DATA2)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  anggota_potong_gaji.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_potong_gaji.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_potong_gaji.scx::Command1
**
PROCEDURE Click
DATA1 = THISFORM.DATA1
SELECT (DATA1)
IF RECCOUNT()=0
MESSAGEBOX("TIDAK TERDAPAT REKENING SIMPANAN", 0, "")
RETURN
ENDIF
DO FORM anggota_pg_rek WITH 1
SELECT (THISFORM.OLDSELECT)
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.COMMAND3.ENABLED = .T.
ENDPROC
**
*
*  anggota_potong_gaji.scx::Command2
**
PROCEDURE Click
THISFORM.COMMAND5.VISIBLE = .F.
THISFORM.COMMAND5.LEFT = THIS.LEFT
THISFORM.COMMAND5.VISIBLE = .T.
THISFORM.COMMAND8.LEFT = THIS.LEFT+THISFORM.COMMAND5.WIDTH+2
THISFORM.COMMAND8.VISIBLE = .T.
THISFORM.COMMAND1.ENABLED = .F.
THISFORM.COMMAND4.ENABLED = .F.
THISFORM.COMMAND3.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .T.
THISFORM.TEXT5.ENABLED = .T.
THISFORM.TEXT11.ENABLED = .T.
THISFORM.TEXT12.ENABLED = .T.
THISFORM.TEXT4.SETFOCUS
ENDPROC
**
*
*  anggota_potong_gaji.scx::Command5
**
PROCEDURE Click
THISFORM.COMMAND2.ENABLED = .T.
THISFORM.COMMAND5.VISIBLE = .F.
THISFORM.COMMAND8.VISIBLE = .F.
THISFORM.COMMAND1.ENABLED = .T.
THISFORM.COMMAND4.ENABLED = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT11.ENABLED = .F.
THISFORM.TEXT12.ENABLED = .F.
CSQL = "update anggota set simpokok='"+STR(THISFORM.TEXT4.VALUE)+"',"+"simwajib='"+STR(THISFORM.TEXT5.VALUE)+"',"+"lain='"+STR(THISFORM.TEXT11.VALUE)+"',"+"ketlain='"+THISFORM.TEXT12.VALUE+"' where cif='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan data")
ENDIF
THISFORM.COMMAND3.ENABLED = .T.
ENDPROC
**
*
*  anggota_potong_gaji.scx::Command8
**
PROCEDURE Click
THIS.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND5.VISIBLE = .F.
THISFORM.COMMAND8.VISIBLE = .F.
THISFORM.COMMAND1.ENABLED = .T.
THISFORM.COMMAND4.ENABLED = .T.
THISFORM.COMMAND3.ENABLED = .T.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT11.ENABLED = .F.
THISFORM.TEXT12.ENABLED = .F.
THISFORM.COMMAND3.ENABLED = .T.
ENDPROC
**
*
*  anggota_potong_gaji.scx::Command4
**
PROCEDURE Click
DATA2 = THISFORM.DATA2
SELECT (DATA2)
IF RECCOUNT()=0
MESSAGEBOX("TIDAK TERDAPAT REKENING PINJAMAN", 0, "")
RETURN
ENDIF
DO FORM anggota_pg_rek WITH 2
SELECT (THISFORM.OLDSELECT)
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.COMMAND3.ENABLED = .T.
ENDPROC
**
***
*** anggota_potong_gaji.sct
***
*
***
*** anggota_pg_rek.scx
***
*
*
*  anggota_pg_rek.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MJENIS
THISFORM.MODE = ""
THISFORM.JENIS = MJENIS
THISFORM.OLDSELECT = SELECT()
IF MJENIS=2
THISFORM.LABEL6.VISIBLE = .T.
THISFORM.TEXT7.VISIBLE = .T.
THISFORM.LABEL5.CAPTION = "ANGSURAN POKOK"
THISFORM.TEXT1.VALUE = '-'
THISFORM.TEXT5.VALUE = "PINJAMAN"
THISFORM.TEXT2.VALUE = JENIS
THISFORM.TEXT3.VALUE = NOREK
THISFORM.TEXT4.VALUE = POT_POKOK
THISFORM.TEXT7.VALUE = POT_BUNGA
CSQL = "select keterangan from setsandi_pinj where sandi='"+JENIS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT6.VALUE = KETERANGAN
USE
SELECT (THISFORM.OLDSELECT)
ELSE
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL5.CAPTION = "SETORAN SIMPANAN"
THISFORM.TEXT1.VALUE = JENIS
THISFORM.TEXT2.VALUE = PRODUK
THISFORM.TEXT3.VALUE = NOREK
THISFORM.TEXT4.VALUE = POT_SIMPANAN
IF JENIS='1'
THISFORM.TEXT5.VALUE = "SIMPANAN"
ELSE
THISFORM.TEXT5.VALUE = "SIMPANAN BERJANGKA"
ENDIF
CSQL = "select keterangan from setsandi_tab where jenis='"+JENIS+"' and sandi='"+PRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT6.VALUE = KETERANGAN
ENDIF
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  anggota_pg_rek.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_pg_rek.scx::Command3
**
PROCEDURE Click
IF THISFORM.MODE="INPUT"
CSQL = "insert into anggota (kantor,cif,nama,alamat,desa,kecamatan,kota,ibu,agama) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+THISFORM.TEXT2.VALUE+"',"+"'"+THISFORM.TEXT3.VALUE+"',"+"'"+THISFORM.TEXT4.VALUE+"',"+"'"+THISFORM.TEXT5.VALUE+"',"+"'"+THISFORM.TEXT6.VALUE+"',"+"'"+THISFORM.TEXT7.VALUE+"',"+"'"+THISFORM.TEXT8.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.JENIS=1
CSQL = "update simpanan set pot_simpanan='"+STR(THISFORM.TEXT4.VALUE)+"' where norek='"+THISFORM.TEXT3.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.JENIS=2
CSQL = "update pinjaman set pot_pokok='"+STR(THISFORM.TEXT4.VALUE)+"', pot_bunga='"+STR(THISFORM.TEXT7.VALUE)+"' where norek='"+THISFORM.TEXT3.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_pg_rek.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** anggota_pg_rek.sct
***
*
***
*** tab_rekening_koran.frx
***
*
***
*** tab_rekening_koran.frt
***
*
***
*** csql.scx
***
*
*
*  csql.scx::Form1
**
PROCEDURE Init
THISFORM.EDIT1.VALUE = CSQL
ENDPROC
**
***
*** csql.sct
***
*
***
*** angg_daftaranggota.frx
***
*
***
*** angg_daftaranggota.frt
***
*
***
*** angg_lap.scx
***
*
*
*  angg_lap.scx::FORM1
**
PROCEDURE bacasql
MSYARAT = ""
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT8.VALUE), "", "a.kantor='"+THISFORM.TEXT8.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "a.tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "a.desa='"+THISFORM.TEXT2.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT3.VALUE), "", "a.kecamatan='"+THISFORM.TEXT3.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT4.VALUE), "", "a.kota='"+THISFORM.TEXT4.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT5.VALUE), "", "a.agama='"+THISFORM.TEXT5.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT6.VALUE), "", "a.kelkerja='"+THISFORM.TEXT6.VALUE+"' and ")
IF EMPTY(MSYARAT)
MSYARAT = '1'
ELSE
MSYARAT = LEFT(MSYARAT, LEN(MSYARAT)-5)
ENDIF
IF THISFORM.NOMORLAP=1
CREATE CURSOR anggota (CIF C (20), TANGGAL DATE, NAMA C (40), ALAMAT C (40), SLDPOKOK N (15), SLDWAJIB N (15))
CSQL = "select a.cif,a.tanggal,nama,alamat,simpokok as sldpokok ,simwajib as sldwajib from anggota as a "+" where (tglkeluar='0000-00-00' or tglkeluar>'"+SQLDATE(THISFORM.TEXT1.VALUE)+"')  and "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
RETURN
ENDIF
JUMREC = RECCOUNT()
REKNO = 0
GOTO TOP
DO WHILE  .NOT. EOF()
REKNO = REKNO+1
MCIF = CIF
THISFORM.BAR.WIDTH = (REKNO/400)*JUMREC
CSQL = "select sldpokok from anggota_mutasi where cif='"+MCIF+"' and mtspokok<>'0' and iddata=(select MAX(iddata) from anggota_mutasi where cif='"+MCIF+"' and mtspokok<>'0' and tanggal<=?thisform.text1.value)"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
MSLDPOKOK = IIF(ISNULL(SLDPOKOK), 0, SLDPOKOK)
CSQL = "select sldwajib from anggota_mutasi where cif='"+MCIF+"' and mtswajib<>'0' and iddata=(select MAX(iddata) from anggota_mutasi where cif='"+MCIF+"' and mtswajib<>'0' and tanggal<=?thisform.text1.value)"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
MSLDWAJIB = IIF(ISNULL(SLDWAJIB), 0, SLDWAJIB)
SELECT ANGGOTA
APPEND BLANK
REPLACE CIF WITH SMT.CIF, TANGGAL WITH SMT.TANGGAL, NAMA WITH SMT.NAMA, ALAMAT WITH SMT.ALAMAT
REPLACE SLDPOKOK WITH MSLDPOKOK
REPLACE SLDWAJIB WITH MSLDWAJIB
SELECT SMT
SKIP
ENDDO
SELECT ANGGOTA
ELSE
CSQL = "select * from anggota as a where "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
THISFORM.NOMORLAP = MKE
THISFORM.TEXT8.VALUE = DEFAKANTOR
THISFORM.TEXT9.VALUE = NAMAKANTOR(DEFAKANTOR)
IF MKE=1
THISFORM.JUDUL.CAPTION = "DAFTAR ANGGOTA"
THISFORM.FRXNAME = "angg_daftaranggota.frx"
ELSE
THISFORM.JUDUL.CAPTION = "PERHITUNGAN SHU ANGGOTA"
THISFORM.FRXNAME = "angg_shu_anggota.frx"
ENDIF
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
THISFORM.TEXT1.VALUE = TGLNOW
ENDPROC
**
*
*  angg_lap.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  angg_lap.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  angg_lap.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  angg_lap.scx::Text2
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  angg_lap.scx::Text3
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  angg_lap.scx::Text4
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  angg_lap.scx::Text5
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  angg_lap.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
REPORT FORM (THISFORM.FRXNAME) PREVIEW
ENDPROC
**
*
*  angg_lap.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer", 64, "")
ENDIF
ENDPROC
**
*
*  angg_lap.scx::Text7
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  angg_lap.scx::Text9
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  angg_lap.scx::text6
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT7.VALUE = BB
ENDPROC
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P003'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
KE = 1
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  angg_lap.scx::text8
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+"0000 ,KONSOLIDASI,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE InteractiveChange
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT9.VALUE = BB
ENDPROC
**
*
*  angg_lap.scx::bar
**
PROCEDURE Init
THIS.WIDTH = 0
ENDPROC
**
***
*** angg_lap.sct
***
*
***
*** angg_shu_anggota.frx
***
*
***
*** angg_shu_anggota.frt
***
*
***
*** simp_lap.scx
***
*
*
*  simp_lap.scx::FORM1
**
PROCEDURE bacasql
MSYARAT = ""
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT10.VALUE), "", "a.kantor='"+THISFORM.TEXT10.VALUE+"' and ")
IF THISFORM.NOMORLAP=1
IF THISFORM.TEXT2.VISIBLE=.T.
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "a.tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "a.tanggal<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and ")
ELSE
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "a.tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
ENDIF
ENDIF
IF THISFORM.NOMORLAP=2
IF THISFORM.TEXT2.VISIBLE=.T.
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "c.tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "c.tanggal<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and ")
ELSE
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "c.tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
ENDIF
ENDIF
IF THISFORM.NOMORLAP=3
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "(a.tgltutup='0000-00-00' or a.tgltutup>'"+SQLDATE(THISFORM.TEXT1.VALUE)+"') and a.tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
ENDIF
IF THISFORM.NOMORLAP=4
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "a.tgltutup>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "a.tgltutup<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and ")
ENDIF
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT3.VALUE), "", "a.jenis='"+THISFORM.TEXT3.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT4.VALUE), "", "a.produk='"+THISFORM.TEXT4.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT5.VALUE), "", "a.marketing='"+THISFORM.TEXT5.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT6.VALUE), "", "a.kelompok='"+THISFORM.TEXT6.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT7.VALUE), "", "a.wilayah='"+THISFORM.TEXT7.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.COMBO1.VALUE), "", "b.kelkerja='"+THISFORM.COMBO1.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT8.VALUE), "", "saldo>='"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT9.VALUE), "", "saldo<='"+TRANSFORM(THISFORM.TEXT9.VALUE, '999999999999999')+"' and ")
IF EMPTY(MSYARAT)
MSYARAT = '1'
ELSE
MSYARAT = LEFT(MSYARAT, LEN(MSYARAT)-5)
ENDIF
DO CASE
CASE THISFORM.NOMORLAP=1
THISFORM.TGL_LAPORAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
MSYARAT = ""
IF  .NOT. EMPTY(THISFORM.TEXT10.VALUE)
MSYARAT = " and kantor='"+ALLTRIM(THISFORM.TEXT10.VALUE)+"'"
ENDIF
IF  .NOT. EMPTY(THISFORM.TEXT3.VALUE)
MSYARAT = MSYARAT+" and jenis='"+ALLTRIM(THISFORM.TEXT3.VALUE)+"'"
ENDIF
IF  .NOT. EMPTY(THISFORM.TEXT4.VALUE)
MSYARAT = MSYARAT+" and produk='"+ALLTRIM(THISFORM.TEXT4.VALUE)+"'"
ENDIF
IF  .NOT. EMPTY(THISFORM.TEXT5.VALUE)
MSYARAT = MSYARAT+" and marketing='"+ALLTRIM(THISFORM.TEXT5.VALUE)+"'"
ENDIF
IF  .NOT. EMPTY(THISFORM.TEXT6.VALUE)
MSYARAT = MSYARAT+" and kelompok='"+ALLTRIM(THISFORM.TEXT6.VALUE)+"'"
ENDIF
IF  .NOT. EMPTY(THISFORM.TEXT7.VALUE)
MSYARAT = MSYARAT+" and wilayah='"+ALLTRIM(THISFORM.TEXT7.VALUE)+"'"
ENDIF
CREATE CURSOR bukarek (NOREK C (20), TANGGAL D, CIF C (15), NAMA C (30), ALAMAT C (40), SALDO N (15))
CSQL = "select tanggal,norek,cif from simpanan where tanggal>=?thisform.text1.value and tanggal<=?thisform.text2.value "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
RETURN
ENDIF
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTANGGAL = TANGGAL
MCIF = CIF
CSQL = "select nama,alamat from anggota where cif=?mcif"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
MNAMA = NAMA
MALAMAT = ALAMAT
CSQL = "select kredit from simpanan_mutasi where norek=?mnorek and iddata=(select MIN(iddata) from simpanan_mutasi where norek=?mnorek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt3")
MSALDO = KREDIT
SELECT BUKAREK
APPEND BLANK
REPLACE NOREK WITH MNOREK, TANGGAL WITH MTANGGAL, CIF WITH MCIF
REPLACE NAMA WITH MNAMA, ALAMAT WITH MALAMAT, SALDO WITH MSALDO
SELECT SMT
SKIP
ENDDO
SELECT BUKAREK
CASE THISFORM.NOMORLAP=2
THISFORM.TGL_LAPORAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
IF  .NOT. EMPTY(THISFORM.TEXT17.VALUE)
MSYARAT = MSYARAT+" and c.kode='"+ALLTRIM(THISFORM.TEXT17.VALUE)+"'"
ENDIF
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
CSQL = "select c.*,b.* from simpanan_mutasi as c left join simpanan as a on c.norek=a.norek left join  anggota as b on a.cif=b.cif where "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
RETURN
ENDIF
CASE THISFORM.NOMORLAP=3
THISFORM.TGL_LAPORAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
MSYARAT2 = ''
IF  .NOT. (THISFORM.CHECK1.VALUE+THISFORM.CHECK2.VALUE=0 .OR. THISFORM.CHECK1.VALUE+THISFORM.CHECK2.VALUE=2)
MBLOKIR = IIF(THISFORM.CHECK1.VALUE=1, 'T', 'Y')
MSYARAT2 = MSYARAT2+"blokir='"+MBLOKIR+"' and "
ENDIF
IF  .NOT. (THISFORM.CHECK3.VALUE+THISFORM.CHECK4.VALUE=0 .OR. THISFORM.CHECK3.VALUE+THISFORM.CHECK4.VALUE=2)
MAUTODEBET = IIF(THISFORM.CHECK3.VALUE=1, 'T', 'Y')
MSYARAT2 = MSYARAT2+"autodebet='"+MAUTODEBET+"' and "
ENDIF
IF LEN(MSYARAT2)>5
MSYARAT2 = LEFT(MSYARAT2, LEN(MSYARAT2)-5)
ENDIF
IF .F.
CSQL = "select a.kantor,a.tanggal,a.bukti,a.jenis,a.produk,a.marketing,a.norek,a.norek_lama,a.nobuku,a.cif,a.pokok,"+"c.a_rate as rate,a.carahitung,a.bunga_ke,a.bunga_rek,a.bunga_nama,a.kelompok,a.wilayah,"+"b.*,cekblokir(norek,'"+SQLDATE(THISFORM.TEXT1.VALUE)+"') as blokir, saldotab(norek,'"+SQLDATE(THISFORM.TEXT1.VALUE)+"') as saldo from simpanan as a left join anggota as b on a.cif=b.cif left join setsandi_tab as c on a.produk=sandi and c.jenis='1' where 1"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
ENDIF
CSQL = "select a.kantor,a.tanggal,a.bukti,a.jenis,a.produk,a.marketing,a.rate as rate1,a.norek,a.norek_lama,a.nobuku,a.cif,a.pokok,"+"c.a_rate as rate,a.carahitung,a.bunga_ke,a.bunga_rek,a.bunga_nama,a.kelompok,a.wilayah,b.kelkerja,"+"b.*,'T' as blokir, saldo from simpanan as a left join anggota as b on a.cif=b.cif left join setsandi_tab as c on a.produk=sandi and c.jenis='1' where "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "smt")
JUMREC = RECCOUNT()
REKNO = 0
DO WHILE  .NOT. EOF()
SELECT SMT
REKNO = REKNO+1
THISFORM.BAR.WIDTH = (REKNO/JUMREC)*400
MNOREK = NOREK
MJENIS = JENIS
IF MJENIS='1'
CSQL = "select saldo from simpanan_mutasi as a where norek='"+MNOREK+"' and iddata=(select max(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "tab")
MSALDO = SALDO
SELECT SMT
REPLACE SALDO WITH MSALDO
ELSE
CSQL = "select norek,saldo from simpanan_mutasi where iddata="+"(select MAX(iddata) from simpanan_mutasi where (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') and norek='"+MNOREK+"' and tanggal<'"+SQLDATE(THISFORM.TEXT1.VALUE)+"' group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF NOREK=MNOREK
MSALDO = SALDO
ELSE
MSALDO = 0
ENDIF
SELECT SMT
REPLACE RATE WITH RATE1
REPLACE SALDO WITH MSALDO
ENDIF
SELECT SMT
SKIP
ENDDO
IF LEN(MSYARAT2)>5
SELECT * FROM SMT WHERE &MSYARAT2 INTO CURSOR AA
ENDIF
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
CASE THISFORM.NOMORLAP=4
THISFORM.TGL_LAPORAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
CSQL = "select a.*,b.nama,b.alamat from simpanan as a left join anggota as b on a.cif=b.cif where "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("SALAH")
RETURN
ENDIF
CASE THISFORM.NOMORLAP=5
THISFORM.TGL_LAPORAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
MSYARAT2 = ''
IF  .NOT. (THISFORM.CHECK1.VALUE+THISFORM.CHECK2.VALUE=0 .OR. THISFORM.CHECK1.VALUE+THISFORM.CHECK2.VALUE=2)
MBLOKIR = IIF(THISFORM.CHECK1.VALUE=1, 'T', 'Y')
MSYARAT2 = MSYARAT2+"blokir='"+MBLOKIR+"' and "
ENDIF
IF  .NOT. (THISFORM.CHECK3.VALUE+THISFORM.CHECK4.VALUE=0 .OR. THISFORM.CHECK3.VALUE+THISFORM.CHECK4.VALUE=2)
MAUTODEBET = IIF(THISFORM.CHECK3.VALUE=1, 'T', 'Y')
MSYARAT2 = MSYARAT2+"autodebet='"+MAUTODEBET+"' and "
ENDIF
IF LEN(MSYARAT2)>5
MSYARAT2 = LEFT(MSYARAT2, LEN(MSYARAT2)-5)
ENDIF
MTGL1 = AWALBLN(THISFORM.TEXT1.VALUE)
MTGL2 = AKHIRBLN(THISFORM.TEXT1.VALUE)
IF .F.
CSQL = "select a.kantor,a.tanggal,a.bukti,a.jenis,a.produk,a.marketing,a.norek,a.norek_lama,a.nobuku,a.cif,a.pokok,"+"c.a_rate as rate,a.carahitung,a.bunga_ke,a.bunga_rek,a.bunga_nama,a.kelompok,a.wilayah,"+"b.*,cekblokir(norek,'"+SQLDATE(THISFORM.TEXT1.VALUE)+"') as blokir, saldotab(norek,'"+SQLDATE(THISFORM.TEXT1.VALUE)+"') as saldo from simpanan as a left join anggota as b on a.cif=b.cif left join setsandi_tab as c on a.produk=sandi and c.jenis='1' where 1"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
ENDIF
CSQL = "select a.kantor,a.tanggal,a.bukti,a.jenis,a.produk,a.marketing,a.rate as rate1,a.norek,a.norek_lama,a.nobuku,a.cif,a.pokok,"+"c.a_rate as rate,a.carahitung,a.bunga_ke,a.bunga_rek,a.bunga_nama,a.kelompok,a.wilayah,"+"b.*,'T' as blokir, saldo as saldoawal,saldo as bunga, saldo as pajak, saldo as adm from simpanan as a left join anggota as b on a.cif=b.cif left join setsandi_tab as c on a.produk=sandi and c.jenis='1' where "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "smt")
JUMREC = RECCOUNT()
REKNO = 0
DO WHILE  .NOT. EOF()
REKNO = REKNO+1
THISFORM.BAR.WIDTH = (REKNO/JUMREC)*400
MNOREK = NOREK
MJENIS = JENIS
IF MJENIS='1'
CSQL = "select saldo from simpanan_mutasi as a where norek='"+MNOREK+"' and iddata=(select max(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "tab")
MSALDO = IIF(ISNULL(SALDO), 0, SALDO)
CSQL = "select SUM(kredit)-SUM(debet) as bunga from simpanan_mutasi where tanggal>='"+SQLDATE(MTGL1)+"' and tanggal<='"+SQLDATE(MTGL2)+"' and norek='"+ALLTRIM(MNOREK)+"' and kode='"+ALLTRIM(DEFATABBG)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "tab")
MBUNGA = IIF(ISNULL(BUNGA), 0, BUNGA)
CSQL = "select SUM(kredit)-SUM(debet) as pajak from simpanan_mutasi where tanggal>=?mtgl1 and tanggal<=?mtgl2 and norek=?mnorek and kode=?defatabpjk"
LCEK = SQLEXEC(OODBC, CSQL, "tab")
MPAJAK = IIF(ISNULL(PAJAK), 0, PAJAK)
CSQL = "select SUM(kredit)-SUM(debet) as adm from simpanan_mutasi where tanggal>=?mtgl1 and tanggal<=?mtgl2 and norek=?mnorek and kode=?defatabadm"
LCEK = SQLEXEC(OODBC, CSQL, "tab")
MADM = IIF(ISNULL(ADM), 0, ADM)
SELECT SMT
REPLACE SALDOAWAL WITH MSALDO-MBUNGA+MPAJAK+MADM
REPLACE BUNGA WITH MBUNGA
REPLACE PAJAK WITH MPAJAK
REPLACE ADM WITH MADM
ELSE
CSQL = "select norek,saldo from simpanan_mutasi where iddata="+"(select MAX(iddata) from simpanan_mutasi where (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') and norek='"+MNOREK+"' and tanggal<'"+SQLDATE(THISFORM.TEXT1.VALUE)+"' group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF NOREK=MNOREK
MSALDO = SALDO
ELSE
MSALDO = 0
ENDIF
SELECT SMT
REPLACE RATE WITH RATE1
REPLACE SALDOAWAL WITH MSALDO
REPLACE BUNGA WITH 0
REPLACE PAJAK WITH 0
REPLACE ADM WITH 0
ENDIF
SELECT SMT
SKIP
ENDDO
IF LEN(MSYARAT2)>5
SELECT * FROM SMT WHERE &MSYARAT2 INTO CURSOR AA
ENDIF
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDCASE
DEFAKETERANGAN = UPPER(DEFAKETERANGAN)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
THISFORM.BAR.WIDTH = 0
THISFORM.NOMORLAP = MKE
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT10.VALUE = DEFAKANTOR
THISFORM.TEXT11.VALUE = NAMAKANTOR(DEFAKANTOR)
DO CASE
CASE MKE=1
THISFORM.JUDUL.CAPTION = "PEMBUKAAN REKENING"
THISFORM.FRXNAME = "tab_baru.frx"
THISFORM.TEXT8.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.LABEL9.VISIBLE = .F.
THISFORM.LABEL10.VISIBLE = .F.
THISFORM.SHAPE6.VISIBLE = .F.
THISFORM.CHECK1.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
THISFORM.CHECK3.VISIBLE = .F.
THISFORM.CHECK4.VISIBLE = .F.
THISFORM.HEIGHT = 290
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=2
THISFORM.JUDUL.CAPTION = "MUTASI SIMPANAN"
THISFORM.FRXNAME = "tab_mutasi_harian.frx"
THISFORM.TEXT8.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.LABEL9.VISIBLE = .F.
THISFORM.LABEL10.VISIBLE = .F.
THISFORM.SHAPE6.VISIBLE = .F.
THISFORM.CHECK1.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
THISFORM.CHECK3.VISIBLE = .F.
THISFORM.CHECK4.VISIBLE = .F.
THISFORM.TEXT17.VISIBLE = .T.
THISFORM.LABEL12.VISIBLE = .T.
THISFORM.HEIGHT = 330
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=3
THISFORM.JUDUL.CAPTION = "DAFTAR NOMINATIF"
THISFORM.FRXNAME = "tab_nominatif.frx"
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
THISFORM.TEXT1.VALUE = TGLNOW
CASE MKE=4
THISFORM.JUDUL.CAPTION = "DAFTAR TUTUP REKENING"
THISFORM.FRXNAME = "tab_tutup_rek.frx"
THISFORM.TEXT8.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.LABEL9.VISIBLE = .F.
THISFORM.LABEL10.VISIBLE = .F.
THISFORM.SHAPE6.VISIBLE = .F.
THISFORM.CHECK1.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
THISFORM.CHECK3.VISIBLE = .F.
THISFORM.CHECK4.VISIBLE = .F.
THISFORM.HEIGHT = 290
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=5
THISFORM.JUDUL.CAPTION = "DAFTAR NOMINATIF"
THISFORM.FRXNAME = "tab_nominatif_rinci.frx"
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
THISFORM.TEXT1.VALUE = TGLNOW
ENDCASE
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
ENDPROC
**
*
*  simp_lap.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
MTANGGAL1 = THISFORM.TEXT1.VALUE
MTANGGAL2 = THISFORM.TEXT2.VALUE
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  simp_lap.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simp_lap.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simp_lap.scx::Text2
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  simp_lap.scx::Text8
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  simp_lap.scx::Text9
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simp_lap.scx::Text13
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  simp_lap.scx::Text14
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simp_lap.scx::Text15
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simp_lap.scx::Text16
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  simp_lap.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
TGLLAPORAN = THISFORM.TGL_LAPORAN
REPORT FORM (THISFORM.FRXNAME) PREVIEW
IF WEXIST("Report")
MOVE WINDOW "Report" CENTER
ZOOM WINDOW "Report" MAX
ENDIF
ENDPROC
**
*
*  simp_lap.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer")
ENDIF
ENDPROC
**
*
*  simp_lap.scx::Text11
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simp_lap.scx::text10
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+"0000 ,KONSOLIDASI,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE InteractiveChange
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT11.VALUE = BB
ENDPROC
**
*
*  simp_lap.scx::text3
**
PROCEDURE Init
PILIH = ',,1 ,SIMPANAN,2 ,SIMPANAN BERJANGKA,3 ,PENYERTAAN'
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDPROC
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT13.VALUE = BB
THISFORM.TEXT4.VALUE = ''
THISFORM.TEXT14.VALUE = ''
PILIH = ''
OLDSELE = SELECT()
CSQL = "SELECT * from setsandi_tab where jenis='"+ALLTRIM(THISFORM.TEXT3.VALUE)+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THISFORM.TEXT4.ROWSOURCETYPE = 1
THISFORM.TEXT4.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  simp_lap.scx::text4
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT14.VALUE = BB
ENDPROC
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "SELECT * from setsandi_tab where jenis='"+ALLTRIM(THISFORM.TEXT3.VALUE)+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  simp_lap.scx::text5
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "SELECT * from setsandi where kantor='"+DEFAKANTOR+"' and kode='A003'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT15.VALUE = BB
ENDPROC
**
*
*  simp_lap.scx::text6
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT16.VALUE = BB
ENDPROC
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "SELECT * from setsandi where kantor='"+DEFAKANTOR+"' and kode='A003'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  simp_lap.scx::text7
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "SELECT * from setsandi where kantor='"+DEFAKANTOR+"' and kode='A004'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT12.VALUE = BB
ENDPROC
**
*
*  simp_lap.scx::Text12
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simp_lap.scx::Text18
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  simp_lap.scx::Combo1
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P003'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
DO WHILE  .NOT. EOF()
THIS.ADDLISTITEM(SANDI)
THIS.ADDLISTITEM(KETERANGAN, THIS.NEWITEMID, 2)
SKIP
ENDDO
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE LostFocus
OLDDBF = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P003' and sandi='"+THISFORM.TEXT6.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
THISFORM.TEXT18.VALUE = KETERANGAN
USE
SELECT (OLDDBF)
ENDPROC
**
***
*** simp_lap.sct
***
*
***
*** col_lap.scx
***
*
*
*  col_lap.scx::FORM1
**
PROCEDURE bacasql
MSYARAT = ""
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "a.kantor='"+THISFORM.TEXT1.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "a.bln='"+STR(THISFORM.TEXT2.VALUE)+"' and a.tahun='"+STR(THISFORM.TEXT6.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT3.VALUE), "", "a.kode='"+THISFORM.TEXT3.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT4.VALUE), "", "a.instansi='"+THISFORM.TEXT4.VALUE+"' and ")
IF EMPTY(MSYARAT)
MSYARAT = '1'
ELSE
MSYARAT = LEFT(MSYARAT, LEN(MSYARAT)-5)
ENDIF
DO CASE
CASE THISFORM.NOMORLAP=1
DEFAKETERANGAN = "BULAN : "+NAMABULAN(THISFORM.TEXT2.VALUE)+" "+TRANSFORM(THISFORM.TEXT6.VALUE, "9999")
CREATE CURSOR INSTANSI (NOANGG C (17), NAMA C (20), SIMPOKOK N (12), SIMWAJIB N (12), SIMSUKA N (12), MAPAN N (12), LAINNYA N (12), LAIN N (12), KET C (30), POKOK N (12), RATE N (5, 2), JW N (2), KE N (2), BULAN C (15), ANGPOKOK N (12), ANGBUNGA N (12))
SELECT INSTANSI
INDEX ON NOANGG TO instansi
CSQL = "select a.*,sum(if(b.produk=4,b.jumlah,0)) as simsuka,"+"sum(if(b.produk=5,b.jumlah,0)) as mapan,"+" SUM(if(b.produk=6,b.jumlah,0)) as lainnya  "+"from col_instansi as a left join col_instansi_simp as b "+"on a.bln=b.bln and a.tahun=b.tahun and a.noangg=b.noangg "+"where "+MSYARAT+" group by a.noangg"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Tidak Terbaca")
ENDIF
SELECT SMT
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT INSTANSI
APPEND BLANK
REPLACE NOANGG WITH SMT.NOANGG
REPLACE NAMA WITH SMT.NAMA
REPLACE SIMPOKOK WITH SMT.SIMPOKOK
REPLACE SIMWAJIB WITH SMT.SIMWAJIB
REPLACE SIMSUKA WITH SMT.SIMSUKA
REPLACE MAPAN WITH SMT.MAPAN
REPLACE LAINNYA WITH SMT.LAINNYA
REPLACE LAIN WITH SMT.LAIN
REPLACE KET WITH SMT.KET
CSQL = "select * from col_instansi_pinj where bln='"+STR(SMT.BLN)+"' and tahun='"+STR(SMT.TAHUN)+"' and noangg='"+SMT.NOANGG+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT2")
A = 1
DO WHILE  .NOT. EOF()
SELECT INSTANSI
IF A=1
REPLACE POKOK WITH SMT2.POKOK
REPLACE RATE WITH SMT2.RATE
REPLACE JW WITH SMT2.JW
REPLACE BULAN WITH SMT2.ANGS
REPLACE ANGPOKOK WITH SMT2.ANGPOKOK
REPLACE ANGBUNGA WITH SMT2.ANGBUNGA
ELSE
APPEND BLANK
REPLACE NOANGG WITH SMT.NOANGG
REPLACE NAMA WITH SMT.NAMA
REPLACE POKOK WITH SMT2.POKOK
REPLACE RATE WITH SMT2.RATE
REPLACE JW WITH SMT2.JW
REPLACE BULAN WITH SMT2.ANGS
REPLACE ANGPOKOK WITH SMT2.ANGPOKOK
REPLACE ANGBUNGA WITH SMT2.ANGBUNGA
ENDIF
SELECT SMT2
SKIP
ENDDO
SELECT SMT
SKIP
ENDDO
SELECT INSTANSI
CASE THISFORM.NOMORLAP=2
ENDCASE
ENDPROC
**
PROCEDURE Unload
SELECT KANTOR
USE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
THISFORM.BAR.WIDTH = 0
THISFORM.NOMORLAP = MKE
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "KANTOR")
IF RECCOUNT()>1
APPEND BLANK
REPLACE SANDI WITH '0000', KETERANGAN WITH "KONSOLIDASI"
IF DEFAKANTOR='0001'
THISFORM.TEXT1.ENABLED = .T.
ENDIF
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = DEFAKANTOR
THISFORM.TEXT5.VALUE = NAMAKANTOR(DEFAKANTOR)
THISFORM.TEXT2.VALUE = MONTH(TGLNOW)
THISFORM.TEXT6.VALUE = YEAR(TGLNOW)
DO CASE
CASE MKE=1
THISFORM.JUDUL.CAPTION = "DAFTAR TAGIHAN INSTANSI"
THISFORM.FRXNAME = "col_tagih_instansi2.frx"
CASE MKE=2
THISFORM.JUDUL.CAPTION = "MUTASI SIMPANAN"
THISFORM.FRXNAME = "tab_mutasi_harian.frx"
CASE MKE=3
THISFORM.JUDUL.CAPTION = "CEK DATA TRANSFER INSTANSI"
THISFORM.FRXNAME = "col_cek_transfer.frx"
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT13.ENABLED = .F.
THISFORM.TEXT14.ENABLED = .F.
ENDCASE
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
ENDPROC
**
*
*  col_lap.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  col_lap.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_lap.scx::Text3
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  col_lap.scx::Text4
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  col_lap.scx::Text13
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  col_lap.scx::Text14
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  col_lap.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
REPORT FORM (THISFORM.FRXNAME) PREVIEW
ENDPROC
**
*
*  col_lap.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer")
ENDIF
ENDPROC
**
*
*  col_lap.scx::Text2
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  col_lap.scx::Text5
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  col_lap.scx::Text6
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  col_lap.scx::text1
**
PROCEDURE InteractiveChange
THISFORM.TEXT9.VALUE = KETERANGAN
ENDPROC
**
***
*** col_lap.sct
***
*
***
*** gl_lap1.scx
***
*
*
*  gl_lap1.scx::FORM1
**
PROCEDURE bacasql
DO CASE
CASE THISFORM.NOMORLAP=1
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
TGLCETAK = THISFORM.TEXT1.VALUE
IF DEFANAMA="KPRI ABDI HUSADA"
CSQL = "select * from perkiraan where 1 group by noper"
LCEK = SQLEXEC(OODBC, CSQL, "DAFTPER")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MCURSOR = "create cursor SMT1 ( tglcetak d(8), "
GOTO TOP
DO WHILE  .NOT. EOF()
IF LEFT(KEL, 1)='N'
MNOPER = "M"+ALLTRIM(NOPER)
MCURSOR = MCURSOR+MNOPER+" N(13), "
ENDIF
SKIP
ENDDO
MCURSOR = LEFT(MCURSOR, LEN(MCURSOR)-2)+")"
&MCURSOR
APPEND BLANK
REPLACE TGLCETAK WITH THISFORM.TEXT1.VALUE ALL
GOTO TOP
MSELE = SELECT()
CSQL = "select a.noper,a.nama,b.saldo from perkiraan as a left join neraca as b "+"on a.noper=b.noper and tanggal=(select max(tanggal) from neraca where noper=a.noper and tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "TEST")
SELECT (MSELE)
FOR MKE = 2 TO FCOUNT()
THISFORM.BAR.WIDTH = (MKE/700)*700
MNOPER = SUBSTR(FIELD(MKE), 2)
SELECT TEST
SUM SALDO TO MSALDO FOR LEFT(NOPER, LEN(ALLTRIM(MNOPER)))=ALLTRIM(MNOPER)
AA = "replace M"+ALLTRIM(MNOPER)+" with "+TRANSFORM(MSALDO, '999999999999999')
SELECT (MSELE)
&AA
ENDFOR
SELECT TEST
USE
SELECT (MSELE)
ELSE
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT2.VALUE
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where LEFT(kel,1)='N' order by kel,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO KEL="N" .AND. LEVEL<=MLEVEL .AND. LEN(ALLTRIM(NOPER))>1
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
CREATE CURSOR NERACA (TGLCETAK DATE, ANOPER C (10), ANAMA C (30), AJUMLAH N (15), AFONT C (1), ALEVEL C (1), AKELDATA C (2), PNOPER C (10), PNAMA C (30), PJUMLAH N (15), PFONT C (1), PLEVEL C (1), PKELDATA C (2))
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
IF KELDATA<>'NA'
EXIT
ENDIF
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL
REPLACE ANOPER WITH AA.NOPER, ANAMA WITH MNAMA, AJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO), AFONT WITH AA.FONT, ALEVEL WITH AA.LEVEL, AKELDATA WITH AA.KELDATA
IF AA.FONT='+'
APPEND BLANK
ENDIF
SELECT AA
SKIP
ENDDO
SELECT NERACA
GOTO TOP
SELECT AA
DO WHILE  .NOT. EOF()
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
SELECT NERACA
IF EOF()
APPEND BLANK
ENDIF
REPLACE TGLCETAK WITH MTGL
REPLACE PNOPER WITH AA.NOPER, PNAMA WITH MNAMA, PJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO), PFONT WITH AA.FONT, PLEVEL WITH AA.LEVEL, PKELDATA WITH AA.KELDATA
IF AA.FONT='+'
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
ENDIF
SELECT NERACA
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
SELECT AA
SKIP
ENDDO
SELECT NERACA
ENDIF
CASE THISFORM.NOMORLAP=2
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
TGLCETAK = THISFORM.TEXT1.VALUE
IF .F.
CSQL = "select * from perkiraan where 1 group by keldata,noper"
LCEK = SQLEXEC(OODBC, CSQL, "DAFTPER")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MCURSOR = "create cursor SMT1 ( tglcetak d(8), "
GOTO TOP
DO WHILE  .NOT. EOF()
IF LEFT(KEL, 1)='R'
MNOPER = "M"+ALLTRIM(NOPER)
MCURSOR = MCURSOR+MNOPER+" N(13), "
ENDIF
SKIP
ENDDO
MCURSOR = LEFT(MCURSOR, LEN(MCURSOR)-2)+")"
&MCURSOR
APPEND BLANK
REPLACE TGLCETAK WITH THISFORM.TEXT1.VALUE ALL
GOTO TOP
MSELE = SELECT()
CSQL = "select a.noper,a.nama,b.saldo from perkiraan as a left join neraca as b "+"on a.noper=b.noper and tanggal=(select max(tanggal) from neraca where noper=a.noper and tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "TEST")
SELECT (MSELE)
FOR MKE = 2 TO FCOUNT()
THISFORM.BAR.WIDTH = (MKE/700)*700
MNOPER = SUBSTR(FIELD(MKE), 2)
SELECT TEST
SUM SALDO TO MSALDO FOR LEFT(NOPER, LEN(ALLTRIM(MNOPER)))=ALLTRIM(MNOPER)
AA = "replace M"+ALLTRIM(MNOPER)+" with "+TRANSFORM(IIF(ISNULL(MSALDO), 0, MSALDO), '999999999999999')
SELECT (MSELE)
&AA
ENDFOR
SELECT TEST
SELECT (MSELE)
ELSE
MSALDO = 0
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT2.VALUE
MFILER = "set filter to level<='"+MLEVEL+"'"
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where LEFT(kel,1)='R' order by keldata,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
&MFILER
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
CREATE CURSOR LABA (TGLCETAK DATE, ANOPER C (10), ANAMA C (50), AJUMLAH N (15), AFONT C (1), ALEVEL C (1), AKEL C (2), PNOPER C (10), PNAMA C (50), PJUMLAH N (15), PFONT C (1), PLEVEL C (1), PKEL C (2))
MPERTAMA = .T.
MJUMLAH1 = 0
MJUMLAH2 = 0
MJUMLAH3 = 0
JLEVEL = 0
JDATA = 0
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
IF LEFT(KELDATA, 1)>'1'
EXIT
ENDIF
IF LEVEL>'0' .AND. LEVEL<'9'
MJUMLAH1 = MJUMLAH1+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH2 = MJUMLAH2+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH3 = MJUMLAH3+IIF(ISNULL(SALDO), 0, SALDO)
ENDIF
JLEVEL = JLEVEL+IIF(KEL='RA' .OR. KEL='RP', 1, 0)
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
MFNT = IIF(LEVEL='0', 'B', FONT)
SELECT LABA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL
REPLACE ANOPER WITH AA.NOPER, ANAMA WITH MNAMA, AJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
REPLACE AFONT WITH MFNT, ALEVEL WITH AA.LEVEL, AKEL WITH AA.KEL
IF AA.FONT='+'
APPEND BLANK
ENDIF
SELECT AA
MKELDATA = KELDATA
MNAMA = NAMA
JDATA = JDATA+1
SKIP
IF .T.
IF MKELDATA='11' .AND. AA.KELDATA<>'11'
IF JDATA>3
MPERTAMA = .F.
JLEVEL = 0
SELECT LABA
DO CASE
CASE THISFORM.MODEL=1
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, ANAMA WITH 'PELAYANAN BRUTO ANGGOTA', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
CASE THISFORM.MODEL=2
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, ANAMA WITH 'TOTAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
OTHERWISE
ENDCASE
MJUMLAH1 = 0
ENDIF
JDATA = 0
ENDIF
IF MKELDATA='12' .AND. AA.KELDATA<>'12'
IF JDATA>3
MPERTAMA = .F.
JLEVEL = 0
SELECT LABA
DO CASE
CASE THISFORM.MODEL=1
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, ANAMA WITH 'BEBAN POKOK PELAYANAN', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
CASE THISFORM.MODEL=2
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, ANAMA WITH 'BEBAN BUNGA ', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
OTHERWISE
ENDCASE
MJUMLAH1 = 0
ENDIF
JDATA = 0
ENDIF
IF LEFT(MKELDATA, 1)='1' .AND. LEFT(AA.KELDATA, 1)<>'1'
MPERTAMA = .F.
JLEVEL = 0
SELECT LABA
APPEND BLANK
DO CASE
CASE THISFORM.MODEL=1
REPLACE TGLCETAK WITH MTGL, ANAMA WITH 'PELAYANAN NETTO ANGGOTA', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
CASE THISFORM.MODEL=2
REPLACE TGLCETAK WITH MTGL, ANAMA WITH 'PENDAPATAN DAN BEBAN OPERASIONAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
OTHERWISE
REPLACE TGLCETAK WITH MTGL, ANAMA WITH 'TOTAL PENDAPATAN OPERASIOANAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
ENDCASE
MJUMLAH1 = 0
ENDIF
ENDIF
SELECT AA
ENDDO
SELECT LABA
GOTO TOP
SELECT AA
DO WHILE  .NOT. EOF()
IF LEVEL>'0' .AND. LEVEL<'9'
MJUMLAH1 = MJUMLAH1+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH2 = MJUMLAH2+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH3 = MJUMLAH3+IIF(ISNULL(SALDO), 0, SALDO)
ENDIF
MNAMA = IIF(LEN(ALLTRIM(AA.NOPER))<4, "", SPACE((LEN(ALLTRIM(AA.NOPER))-4)*2))+AA.NAMA
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
MFNT = IIF(LEVEL='0', 'B', FONT)
SELECT LABA
IF EOF()
APPEND BLANK
ENDIF
REPLACE TGLCETAK WITH MTGL, PNOPER WITH AA.NOPER, PNAMA WITH MNAMA, PJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO), PFONT WITH MFNT, PLEVEL WITH AA.LEVEL, PKEL WITH AA.KEL
IF AA.FONT='+'
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
SKIP
ENDIF
SELECT LABA
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
SELECT AA
MKELDATA = KELDATA
SKIP
IF LEFT(MKELDATA, 1)='2' .AND. LEFT(AA.KELDATA, 1)<>'2'
SELECT LABA
IF EOF()
APPEND BLANK
ELSE
ENDIF
DO CASE
CASE THISFORM.MODEL=1
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'TOTAL BEBAN OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RP'
CASE THISFORM.MODEL=2
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'JUMLAH BEBAN OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RP'
OTHERWISE
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'TOTAL PENDAPATAN OPERASIONAL ', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RP'
ENDCASE
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
DO CASE
CASE THISFORM.MODEL=1
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'SHU OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH2), 0, MJUMLAH2), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE THISFORM.MODEL=2
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'LABA (RUGI) OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH2), 0, MJUMLAH2), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'LABA / RUGI OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH2), 0, MJUMLAH2), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
MJUMLAH1 = 0
ENDIF
IF LEFT(MKELDATA, 1)='3' .AND. LEFT(AA.KELDATA, 1)<>'3'
SELECT LABA
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
DO CASE
CASE THISFORM.MODEL=1
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'PENDAPATAN DAN BEBAN NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE THISFORM.MODEL=2
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'JUMLAH PENDAPATAN DAN BEBAN NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'LABA/RUGI NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
DO CASE
CASE THISFORM.MODEL=1
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'SHU SEBELUM PAJAK', PJUMLAH WITH IIF(ISNULL(MJUMLAH2), 0, MJUMLAH2), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE THISFORM.MODEL=2
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'LABA (RUGI) SEBELUM PAJAK PENGHASILAN', PJUMLAH WITH IIF(ISNULL(MJUMLAH2), 0, MJUMLAH2), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'LABA / RUGI SEBELUM PAJAK', PJUMLAH WITH IIF(ISNULL(MJUMLAH2), 0, MJUMLAH2), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
ELSE
SKIP
ENDIF
MJUMLAH1 = 0
ENDIF
SELECT AA
ENDDO
SELECT LABA
IF RECCOUNT()=RECNO() .OR. EOF()
APPEND BLANK
ELSE
ENDIF
DO CASE
CASE THISFORM.MODEL=1
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'SHU SETELAH PAJAK', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE THISFORM.MODEL=2
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'LABA (RUGI) NETTO', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE TGLCETAK WITH MTGL, PNAMA WITH 'LABA / RUGI SETELAH PAJAK', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
SELECT LABA
ENDIF
CASE THISFORM.NOMORLAP=3
CREATE CURSOR NERACA (TGLCETAK DATE, KELDATA C (2), KEL C (2), TGL1 DATE, NOPER C (10), NAMA C (30), JUMLAH1 N (15), TGL2 DATE, JUMLAH2 N (15))
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT3.VALUE
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where 1 order by keldata,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SELECT AA
SET FILTER TO KEL="N" .AND. LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, TGL1 WITH MTGL, KELDATA WITH AA.KELDATA
REPLACE NOPER WITH AA.NOPER, NAMA WITH AA.NAMA, JUMLAH1 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
SELECT AA
USE
MTGL = THISFORM.TEXT2.VALUE
MLEVEL = THISFORM.TEXT3.VALUE
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where 1 order by keldata,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SELECT AA
SET FILTER TO KEL="N" .AND. LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = NOPER
SELECT NERACA
LOCATE FOR NOPER=AA.NOPER .AND. LEN(ALLTRIM(NOPER))=LEN(ALLTRIM(AA.NOPER))
IF  .NOT. FOUND()
APPEND BLANK
ENDIF
REPLACE TGL2 WITH MTGL, KELDATA WITH AA.KELDATA, KEL WITH AA.KEL
REPLACE JUMLAH2 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
SELECT NERACA
CASE THISFORM.NOMORLAP=4
CREATE CURSOR NERACA (TGLCETAK DATE, KEL C (2), KELDATA C (2), TGL1 DATE, NOPER C (10), NAMA C (30), JUMLAH1 N (15), TGL2 DATE, JUMLAH2 N (15), FONT C (1))
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT3.VALUE
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where 1 order by keldata,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO KEL="R" .AND. LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, TGL1 WITH MTGL, KELDATA WITH AA.KELDATA, KEL WITH AA.KEL, FONT WITH AA.FONT
REPLACE NOPER WITH AA.NOPER, NAMA WITH AA.NAMA, JUMLAH1 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
MTGL = THISFORM.TEXT2.VALUE
MLEVEL = THISFORM.TEXT3.VALUE
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where 1 order by keldata,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO KEL="R" .AND. LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
LOCATE FOR NOPER=AA.NOPER .AND. LEN(ALLTRIM(NOPER))=LEN(ALLTRIM(AA.NOPER))
IF  .NOT. FOUND()
APPEND BLANK
ENDIF
REPLACE TGL2 WITH MTGL, KELDATA WITH AA.KELDATA, KEL WITH AA.KEL, FONT WITH AA.FONT
REPLACE JUMLAH2 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
SELECT NERACA
CASE THISFORM.NOMORLAP=5
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
TGLCETAK = THISFORM.TEXT1.VALUE
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT2.VALUE
CSQL = "select tglterakhir as tglcetak,noper,nama,kel,sandi,keldata,detail,level,font,saldo from perkiraan where kel='NA' order by noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
REPLACE TGLCETAK WITH MTGL ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SELECT AA
SET FILTER TO KEL="NA"
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
CASE THISFORM.NOMORLAP=6
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
TGLCETAK = THISFORM.TEXT1.VALUE
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT2.VALUE
CSQL = "select tglterakhir as tglcetak,noper,nama,kel,sandi,keldata,detail,level,font,saldo from perkiraan where kel='NP'  order by noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
REPLACE TGLCETAK WITH MTGL ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO KEL="NP"
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
CASE THISFORM.NOMORLAP=7
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
TGLCETAK = THISFORM.TEXT1.VALUE
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT2.VALUE
CSQL = "select tglterakhir as tglcetak,noper,nama,kel,sandi,keldata,detail,level,font,saldo from perkiraan where  kel='RA' order by noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
REPLACE TGLCETAK WITH MTGL ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO KEL="RA"
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
CASE THISFORM.NOMORLAP=8
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
TGLCETAK = THISFORM.TEXT1.VALUE
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT2.VALUE
CSQL = "select tglterakhir as tglcetak,noper,nama,kel,sandi,keldata,detail,level,font,saldo from perkiraan where kel='RP'  order by noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
REPLACE TGLCETAK WITH MTGL ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO KEL="RP"
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
CASE THISFORM.NOMORLAP=9
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
CREATE CURSOR NERACA (TGLCETAK DATE, KELDATA C (2), NOPER C (10), NAMA C (30), JUMLAH1 N (15), JUMLAH2 N (15), JUMLAH3 N (15), FONT C (1))
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT2.VALUE
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where LEFT(kel,1)='N' order by noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, KELDATA WITH AA.KELDATA, FONT WITH AA.FONT
REPLACE NOPER WITH AA.NOPER, NAMA WITH AA.NAMA, JUMLAH3 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
MTGL = MTGL-1
SELECT AA
SET FILTER TO
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO KEL="N" .AND. LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
LOCATE FOR NOPER=AA.NOPER .AND. LEN(ALLTRIM(NOPER))=LEN(ALLTRIM(AA.NOPER))
IF  .NOT. FOUND()
APPEND BLANK
ENDIF
REPLACE KELDATA WITH AA.KELDATA, FONT WITH AA.FONT
REPLACE JUMLAH2 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
SELECT NERACA
MTGL = AWALBLN(THISFORM.TEXT1.VALUE)-1
SELECT AA
SET FILTER TO
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO KEL="N" .AND. LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
LOCATE FOR NOPER=AA.NOPER .AND. LEN(ALLTRIM(NOPER))=LEN(ALLTRIM(AA.NOPER))
IF  .NOT. FOUND()
APPEND BLANK
ENDIF
REPLACE KELDATA WITH AA.KELDATA, FONT WITH AA.FONT
REPLACE JUMLAH1 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
SELECT NERACA
CASE THISFORM.NOMORLAP=10
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)
CREATE CURSOR NERACA (TGLCETAK DATE, KELDATA C (2), KEL C (2), NOPER C (10), NAMA C (30), JUMLAH1 N (15), JUMLAH2 N (15), JUMLAH3 N (15), FONT C (1))
MTGL = THISFORM.TEXT1.VALUE
MLEVEL = THISFORM.TEXT2.VALUE
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where LEFT(kel,1)='R' order by keldata,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, KELDATA WITH AA.KELDATA, FONT WITH AA.FONT, KEL WITH AA.KEL
REPLACE NOPER WITH AA.NOPER, NAMA WITH AA.NAMA, JUMLAH3 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
MTGL = MTGL-1
SELECT AA
SET FILTER TO
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
LOCATE FOR NOPER=AA.NOPER .AND. LEN(ALLTRIM(NOPER))=LEN(ALLTRIM(AA.NOPER))
IF  .NOT. FOUND()
APPEND BLANK
ENDIF
REPLACE KELDATA WITH AA.KELDATA, FONT WITH AA.FONT
REPLACE JUMLAH2 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
SELECT NERACA
MTGL = AWALBLN(THISFORM.TEXT1.VALUE)-1
SELECT AA
SET FILTER TO
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, MTGL)
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT NERACA
LOCATE FOR NOPER=AA.NOPER .AND. LEN(ALLTRIM(NOPER))=LEN(ALLTRIM(AA.NOPER))
IF  .NOT. FOUND()
APPEND BLANK
ENDIF
REPLACE KELDATA WITH AA.KELDATA, FONT WITH AA.FONT
REPLACE JUMLAH1 WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
SELECT AA
SKIP
ENDDO
SELECT NERACA
ENDCASE
ENDPROC
**
PROCEDURE pilihcetak
DO CASE
CASE THISFORM.NOMORLAP=1
DO CASE
CASE THISFORM.COMBO1.VALUE="FORMAT SAK ETAP - PA BPR"
THISFORM.FRXNAME = "akt_neraca_etap.frx"
CASE THISFORM.COMBO1.VALUE="FORMAT SAK ETAP - PUA KOP"
THISFORM.FRXNAME = "akt_neraca_psak.frx"
CASE THISFORM.COMBO1.VALUE="FORMAT LAMA"
THISFORM.FRXNAME = "akt_neraca_lama.frx"
ENDCASE
CASE THISFORM.NOMORLAP=2
DO CASE
CASE THISFORM.COMBO1.VALUE="FORMAT SAK ETAP - PA BPR"
THISFORM.FRXNAME = "akt_labarugi_pabpr.frx"
CASE THISFORM.COMBO1.VALUE="FORMAT SAK ETAP - PUA KOP"
THISFORM.FRXNAME = "akt_labarugi_puak.frx"
CASE THISFORM.COMBO1.VALUE="FORMAT LAMA"
THISFORM.FRXNAME = "akt_labarugi_lama.frx"
ENDCASE
ENDCASE
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
THISFORM.BAR.WIDTH = 1
THISFORM.NOMORLAP = MKE
THISFORM.TEXT8.VALUE = DEFAKANTOR
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.NAMAKANTOR.VALUE = NAMAKANTOR(DEFAKANTOR)
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and ket2='NRC_MODEL'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.MODEL = VAL(KETERANGAN)
USE
DO CASE
CASE MKE=1
THISFORM.JUDUL.CAPTION = "LAPORAN NERACA"
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
IF DEFANAMA="KPRI ABDI HUSADA"
THISFORM.COMBO1.ADDITEM("FORMAT SAK ETAP - PA BPR")
THISFORM.COMBO1.ADDITEM("FORMAT SAK ETAP - PUA KOP")
THISFORM.COMBO1.ADDITEM("FORMAT LAMA")
THISFORM.COMBO1.VALUE = "FORMAT SAK ETAP - PUA KOP"
THISFORM.COMBO1.VISIBLE = .T.
THISFORM.LABEL3.VISIBLE = .T.
THISFORM.LABEL3.TOP = 93
THISFORM.COMBO1.TOP = 91
THISFORM.HEIGHT = (0169)
ELSE
THISFORM.FRXNAME = "akt_neraca_umum.frx"
THISFORM.HEIGHT = 165
THISFORM.LABEL2.VISIBLE = .T.
THISFORM.TEXT2.VISIBLE = .T.
THISFORM.LABEL2.CAPTION = "LEVEL LAPORAN"
THISFORM.TEXT2.FORMAT = '9'
THISFORM.TEXT2.VALUE = '1'
ENDIF
CASE MKE=2
THISFORM.JUDUL.CAPTION = "LAPORAN LABA / RUGI"
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
IF DEFANAMA="KPRI ABDI HUSADA"
THISFORM.COMBO1.ADDITEM("FORMAT SAK ETAP - PA BPR")
THISFORM.COMBO1.ADDITEM("FORMAT SAK ETAP - PUA KOP")
THISFORM.COMBO1.ADDITEM("FORMAT LAMA")
THISFORM.COMBO1.VALUE = "FORMAT SAK ETAP - PUA KOP"
THISFORM.COMBO1.VISIBLE = .T.
THISFORM.LABEL3.VISIBLE = .T.
THISFORM.LABEL3.TOP = 93
THISFORM.COMBO1.TOP = 91
THISFORM.HEIGHT = (0169)
ELSE
THISFORM.FRXNAME = "akt_labarugi_umum.frx"
THISFORM.LABEL2.VISIBLE = .T.
THISFORM.TEXT2.VISIBLE = .T.
THISFORM.LABEL2.CAPTION = "LEVEL LAPORAN"
THISFORM.TEXT2.FORMAT = '9'
THISFORM.TEXT2.VALUE = '1'
THISFORM.HEIGHT = 165
ENDIF
CASE MKE=3
THISFORM.JUDUL.CAPTION = "NERACA PERBANDINGAN"
THISFORM.FRXNAME = "akt_neraca_perbandingan.frx"
THISFORM.LABEL1.CAPTION = "TGL LAPORAN I"
THISFORM.LABEL2.CAPTION = "TGL LAPORAN II"
THISFORM.LABEL4.CAPTION = "LEVEL"
THISFORM.HEIGHT = 185
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)-1
THISFORM.TEXT2.VALUE = TGLNOW
THISFORM.TEXT3.VALUE = '1'
THISFORM.LABEL4.VISIBLE = .T.
THISFORM.TEXT3.VISIBLE = .T.
CASE MKE=4
THISFORM.JUDUL.CAPTION = "LABA/RUGI PERBANDINGAN"
THISFORM.FRXNAME = "akt_labarugi_perbandingan.frx"
THISFORM.LABEL1.CAPTION = "TGL LAPORAN I"
THISFORM.LABEL2.CAPTION = "TGL LAPORAN II"
THISFORM.LABEL4.CAPTION = "LEVEL"
THISFORM.HEIGHT = 185
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)-1
THISFORM.TEXT2.VALUE = TGLNOW
THISFORM.TEXT3.VALUE = "1"
THISFORM.LABEL4.VISIBLE = .T.
THISFORM.TEXT3.VISIBLE = .T.
CASE MKE=5
THISFORM.JUDUL.CAPTION = "RINCIAN POS AKTIVA"
THISFORM.FRXNAME = "akt_detail_aktiva.frx"
THISFORM.LABEL1.CAPTION = "TANGGAL LAPORAN"
THISFORM.LABEL2.CAPTION = "LEVEL"
THISFORM.HEIGHT = 165
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
CASE MKE=6
THISFORM.JUDUL.CAPTION = "RINCIAN POS PASIVA"
THISFORM.FRXNAME = "akt_detail_pasiva.frx"
THISFORM.LABEL1.CAPTION = "TANGGAL LAPORAN"
THISFORM.LABEL2.CAPTION = "LEVEL"
THISFORM.HEIGHT = 165
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
CASE MKE=7
THISFORM.JUDUL.CAPTION = "RINCIAN POS PENDAPATAN"
THISFORM.FRXNAME = "akt_detail_pend.frx"
THISFORM.LABEL1.CAPTION = "TANGGAL LAPORAN"
THISFORM.LABEL2.CAPTION = "LEVEL"
THISFORM.HEIGHT = 165
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
CASE MKE=8
THISFORM.JUDUL.CAPTION = "RINCIAN POS BIAYA"
THISFORM.FRXNAME = "akt_detail_biaya.frx"
THISFORM.LABEL1.CAPTION = "TANGGAL LAPORAN"
THISFORM.LABEL2.CAPTION = "LEVEL"
THISFORM.HEIGHT = 165
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
CASE MKE=9
THISFORM.JUDUL.CAPTION = "NERACA HARIAN"
THISFORM.FRXNAME = "akt_neraca_harian.frx"
THISFORM.LABEL1.CAPTION = "TANGGAL LAPORAN"
THISFORM.HEIGHT = 140
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT2.VISIBLE = .T.
THISFORM.LABEL2.CAPTION = "LEVEL LAPORAN"
THISFORM.TEXT2.FORMAT = '9'
THISFORM.TEXT2.VALUE = '1'
THISFORM.HEIGHT = 165
CASE MKE=10
THISFORM.JUDUL.CAPTION = "PERHITUNGAN HASIL USAHA HARIAN"
THISFORM.FRXNAME = "akt_labarugi_harian.frx"
THISFORM.LABEL1.CAPTION = "TANGGAL LAPORAN"
THISFORM.HEIGHT = 140
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT2.VISIBLE = .T.
THISFORM.LABEL2.CAPTION = "LEVEL LAPORAN"
THISFORM.TEXT2.FORMAT = '9'
THISFORM.TEXT2.VALUE = '1'
THISFORM.HEIGHT = 165
CASE MKE=11
THISFORM.JUDUL.CAPTION = "TINGKAT KESEHATAN KOPERASI"
THISFORM.FRXNAME = "akt_CAMEL_KOP.frx"
THISFORM.LABEL1.CAPTION = "TANGGAL LAPORAN"
THISFORM.HEIGHT = 140
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT2.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.COMBO1.VISIBLE = .F.
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.HEIGHT = 135
ENDCASE
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
THISFORM.TEXT1.SETFOCUS
THISFORM.PILIHCETAK()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  gl_lap1.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  gl_lap1.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_lap1.scx::Text1
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  gl_lap1.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
REPORT FORM (THISFORM.FRXNAME) PREVIEW
IF WEXIST("Report")
MOVE WINDOW "Report" CENTER
ZOOM WINDOW "Report" MAX
ENDIF
ENDPROC
**
*
*  gl_lap1.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer", 64, "")
ENDIF
ENDPROC
**
*
*  gl_lap1.scx::Combo1
**
PROCEDURE LostFocus
THISFORM.PILIHCETAK()
ENDPROC
**
*
*  gl_lap1.scx::Text2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  gl_lap1.scx::NamaKantor
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  gl_lap1.scx::Text3
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  gl_lap1.scx::text8
**
PROCEDURE Init
IF DEFAKANTOR='0001'
THIS.ENABLED = .T.
ENDIF
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+"0000 ,KONSOLIDASI,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE InteractiveChange
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.NAMAKANTOR.VALUE = BB
ENDPROC
**
***
*** gl_lap1.sct
***
*
***
*** kas_lap.scx
***
*
*
*  kas_lap.scx::FORM1
**
PROCEDURE bacasql
MSYARAT = ""
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "kantor='"+THISFORM.TEXT1.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "csr='"+THISFORM.TEXT2.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT3.VALUE), "", "tanggal='"+SQLDATE(THISFORM.TEXT3.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT4.VALUE), "", "kode='"+THISFORM.TEXT4.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT5.VALUE), "", "keterangan='"+THISFORM.TEXT5.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT6.VALUE), "", "opt='"+THISFORM.TEXT6.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT7.VALUE), "", "(debet='"+STR(THISFORM.TEXT7.VALUE)+"' or "+"kredit= "+STR(THISFORM.TEXT7.VALUE)+"') and '")
IF EMPTY(MSYARAT)
MSYARAT = '1'
ELSE
MSYARAT = LEFT(MSYARAT, LEN(MSYARAT)-5)
ENDIF
MTGL = THISFORM.TEXT3.VALUE
DO CASE
CASE THISFORM.NOMORLAP=1
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT3.VALUE)
CSQL = "select tanggal,saldo from neraca where kantor='"+ALLTRIM(DEFAKANTOR)+"' and noper='"+ALLTRIM(DEFANOPERKAS)+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+ALLTRIM(DEFAKANTOR)+"' and noper='"+ALLTRIM(DEFANOPERKAS)+"' and tanggal<'"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Data neraca tidak terbaca")
ENDIF
MAWAL = IIF(ISNULL(SALDO), 0, SALDO)
CSQL = "select tanggal,debet as awal,bukti,keterangan as ket,debet as terima,kredit as keluar from kasir where "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(LCEK)
ENDIF
REPLACE AWAL WITH MAWAL ALL
GOTO TOP
CASE THISFORM.NOMORLAP=2
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT3.VALUE)
CSQL = "select a.*,b.* from anggota_mutasi as a left join anggota as b on a.norek=b.norek left join  where "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(LCEK)
ENDIF
CASE THISFORM.NOMORLAP=3
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT3.VALUE)
CSQL = "select * from kas_rincian where "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "test")
IF LCEK<1
MESSAGEBOX("Gagal baca")
ENDIF
CASE THISFORM.NOMORLAP=4
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT3.VALUE)
CASE THISFORM.NOMORLAP=5
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT3.VALUE)
CREATE CURSOR laporankas (KEL C (1), NOPER C (10), NAMA C (40), JUMLAH INT (12))
CSQL = "select saldo from neraca where noper='"+DEFANOPERKAS+"' and tanggal="+"(select MAX(tanggal) from neraca where noper='"+DEFANOPERKAS+"' and tanggal<'"+SQLDATE(THISFORM.TEXT3.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = SALDO
SELECT LAPORANKAS
APPEND BLANK
REPLACE KEL WITH '1', NOPER WITH DEFANOPERKAS, NAMA WITH 'SALDO AWAL KAS', JUMLAH WITH MSALDO
CSQL = "select b.noper,SUM(b.jumlah) as jumlah from kasir as a right join jurnal as b "+"on a.tanggal=b.tanggal and a.bukti=b.bukti where a.tanggal='"+SQLDATE(THISFORM.TEXT3.VALUE)+"'"+"and b.jumlah>0 group by noper"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
TJUMLAH = 0
DO WHILE  .NOT. EOF()
MNOPER = NOPER
MJUMLAH = JUMLAH
CSQL = "select nama from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
MNAMA = NAMA
TJUMLAH = TJUMLAH+MJUMLAH
SELECT LAPORANKAS
APPEND BLANK
REPLACE KEL WITH '2', NOPER WITH MNOPER, NAMA WITH MNAMA, JUMLAH WITH MJUMLAH
SELECT SMT
SKIP
ENDDO
SELECT LAPORANKAS
CSQL = "select b.noper,SUM(b.jumlah) as jumlah from kasir as a right join jurnal as b "+"on a.tanggal=b.tanggal and a.bukti=b.bukti where a.tanggal='"+SQLDATE(THISFORM.TEXT3.VALUE)+"'"+"and b.jumlah<0 group by noper"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
TJUMLAH2 = 0
DO WHILE  .NOT. EOF()
MNOPER = NOPER
MJUMLAH = JUMLAH
CSQL = "select nama from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
MNAMA = NAMA
TJUMLAH2 = TJUMLAH+MJUMLAH
SELECT LAPORANKAS
APPEND BLANK
REPLACE KEL WITH '3', NOPER WITH MNOPER, NAMA WITH MNAMA, JUMLAH WITH MJUMLAH
SELECT SMT
SKIP
ENDDO
SELECT LAPORANKAS
ENDCASE
ENDPROC
**
PROCEDURE Unload
SELECT KANTOR
USE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
THISFORM.BAR.WIDTH = 0
THISFORM.NOMORLAP = MKE
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "KANTOR")
IF RECCOUNT()>1
APPEND BLANK
REPLACE SANDI WITH '0000', KETERANGAN WITH "KONSOLIDASI"
IF DEFAKANTOR='0001'
THISFORM.TEXT1.ENABLED = .T.
ENDIF
ENDIF
THISFORM.TEXT1.VALUE = DEFAKANTOR
THISFORM.TEXT8.VALUE = NAMAKANTOR(DEFAKANTOR)
THISFORM.TEXT2.VALUE = '01'
THISFORM.TEXT3.VALUE = DEFATGLKAS
THISFORM.BORDERSTYLE = 2
DO CASE
CASE MKE=1
THISFORM.JUDUL.CAPTION = "LAPORAN KAS HARIAN"
THISFORM.FRXNAME = "kas_kasharian.frx"
THISFORM.HEIGHT = 273
THISFORM.LABEL4.VISIBLE = .T.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.LABEL7.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .T.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .T.
THISFORM.HEIGHT = 185
CASE MKE=2
THISFORM.JUDUL.CAPTION = "LAPORAN NON KAS"
THISFORM.FRXNAME = "kas_nonkasharian.frx"
THISFORM.HEIGHT = 273
CASE MKE=3
THISFORM.JUDUL.CAPTION = "RINCIAN UANG KAS"
THISFORM.FRXNAME = "kas_rincian.frx"
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.LABEL7.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.HEIGHT = 175
CASE MKE=4
THISFORM.JUDUL.CAPTION = "PENGGUNAAN MATERAI"
THISFORM.FRXNAME = "kas_materai.frx"
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.LABEL7.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.HEIGHT = 175
CASE MKE=5
THISFORM.JUDUL.CAPTION = "REKAP TRANSAKSI KAS"
THISFORM.FRXNAME = "kas_rekap_transaksi.frx"
THISFORM.HEIGHT = 273
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.LABEL7.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.HEIGHT = 175
ENDCASE
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
ENDPROC
**
*
*  kas_lap.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  kas_lap.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_lap.scx::Text2
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  kas_lap.scx::Text3
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  kas_lap.scx::Text5
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  kas_lap.scx::Text6
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  kas_lap.scx::Text7
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  kas_lap.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
REPORT FORM (THISFORM.FRXNAME) PREVIEW
IF WEXIST("Report")
MOVE WINDOW "Report" CENTER
ZOOM WINDOW "Report" MAX
ENDIF
ENDPROC
**
*
*  kas_lap.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer")
ENDIF
ENDPROC
**
*
*  kas_lap.scx::Text8
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  kas_lap.scx::Text9
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  kas_lap.scx::text1
**
PROCEDURE InteractiveChange
THISFORM.TEXT9.VALUE = KETERANGAN
ENDPROC
**
*
*  kas_lap.scx::text4
**
PROCEDURE Init
THIS.ADDITEM("  ")
THIS.ADDITEM("01")
THIS.ADDITEM("02")
THIS.ADDITEM("03")
THIS.ADDITEM("04")
THIS.ADDITEM("05")
THIS.ADDITEM("99")
ENDPROC
**
PROCEDURE LostFocus
DO CASE
CASE THIS.VALUE='01'
THISFORM.TEXT9.VALUE = "KEANGGOTAAN"
CASE THIS.VALUE='02'
THISFORM.TEXT9.VALUE = "SIMPANAN"
CASE THIS.VALUE='03'
THISFORM.TEXT9.VALUE = "PINJAMAN"
CASE THIS.VALUE='04'
THISFORM.TEXT9.VALUE = "KOLEKTIF"
CASE THIS.VALUE='05'
THISFORM.TEXT9.VALUE = "INSTANSI"
CASE THIS.VALUE='99'
THISFORM.TEXT9.VALUE = "LAIN-LAIN"
ENDCASE
ENDPROC
**
***
*** kas_lap.sct
***
*
***
*** tab_tutup_rek.frx
***
*
***
*** tab_tutup_rek.frt
***
*
***
*** krd_penerimaan_angsuran.frx
***
*
***
*** krd_penerimaan_angsuran.frt
***
*
***
*** krd_realisasi.frx
***
*
***
*** krd_realisasi.frt
***
*
***
*** krd_pelunasan.frx
***
*
***
*** krd_pelunasan.frt
***
*
***
*** reg_warning.scx
***
*
*
*  reg_warning.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.EDIT1.VALUE = "Komputer ini Belum diregister, "+CHR(13)+"Hubungi Petugas untuk meregister komputer ini"+CHR(13)+CHR(13)+"TRIMA KASIH"
ENDPROC
**
***
*** reg_warning.sct
***
*
***
*** reg_blokir.scx
***
*
*
*  reg_blokir.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.EDIT1.VALUE = "JIKA ANDA TETAP MENCOBA AKSES PROGRAM INI, "+CHR(13)+"KAMI AKAN LUMPUHKAN SYSTEM ANDA SECARA PERLAHAN"+CHR(13)+"TERIMA KASIH"
THISFORM.IMAGE1.TOP = 96
THISFORM.IMAGE1.LEFT = 324
THIS.WINDOWSTATE = 2
ENDPROC
**
***
*** reg_blokir.sct
***
*
***
*** col_tagih_instansi.frx
***
*
***
*** col_tagih_instansi.frt
***
*
***
*** mylib.vcx
***
*
***
*** mylib.vct
***
*
***
*** simpanan_autodebet.scx
***
*
*
*  simpanan_autodebet.scx::FORM1
**
PROCEDURE myenable
WITH THISFORM
.TEXT1.ENABLED = .T.
.TEXT3.ENABLED = .T.
.TEXT4.ENABLED = .T.
.TEXT5.ENABLED = .T.
.TEXT8.ENABLED = .T.
.TEXT9.ENABLED = .T.
.OPTIONGROUP1.ENABLED = .T.
.OPTIONGROUP2.ENABLED = .T.
ENDWITH
ENDPROC
**
PROCEDURE mydisable
WITH THISFORM
.TEXT1.ENABLED = .F.
.TEXT3.ENABLED = .F.
.TEXT4.ENABLED = .F.
.TEXT5.ENABLED = .F.
.TEXT6.ENABLED = .F.
.OPTIONGROUP1.ENABLED = .F.
.OPTIONGROUP2.ENABLED = .F.
ENDWITH
ENDPROC
**
PROCEDURE mytampil
WITH THISFORM
.TEXT1.VALUE = TANGGAL
.TEXT4.VALUE = KET
.OPTIONGROUP1.VALUE = OPT_REK
.TEXT5.VALUE = NOREK_TUJUAN
.TEXT9.VALUE = JUMLAH
.TEXT3.VALUE = TGLAUTO
IF EMPTY(TGLAKHIR) .OR. ISNULL(TGLAKHIR)
THISFORM.OPTIONGROUP2.VALUE = 2
.TEXT8.VALUE = CTOD('  -  -    ')
ELSE
.TEXT8.VALUE = TGLAKHIR
ENDIF
.TEXT6.VALUE = TGLCABUT
ENDWITH
THISFORM.OPTIONGROUP1.OPTION1.FONTBOLD = .F.
THISFORM.OPTIONGROUP1.OPTION2.FONTBOLD = .F.
THISFORM.OPTIONGROUP2.OPTION1.FONTBOLD = .F.
THISFORM.OPTIONGROUP2.OPTION2.FONTBOLD = .F.
THISFORM.LABEL1.FONTBOLD = .F.
THISFORM.LABEL2.FONTBOLD = .F.
THISFORM.LABEL3.FONTBOLD = .F.
THISFORM.LABEL4.FONTBOLD = .F.
THISFORM.LABEL5.FONTBOLD = .F.
THISFORM.LABEL6.FONTBOLD = .F.
THISFORM.LABEL7.FONTBOLD = .F.
THISFORM.LABEL8.FONTBOLD = .F.
THISFORM.LABEL9.FONTBOLD = .F.
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA1
MNOREK = THISFORM.NOREK
CSQL = "select * FROM simpanan_autodebet where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX("Gagal Baca Data")
RETURN
ENDIF
THISFORM.GRID1.RECORDSOURCE = MDATA
WITH THISFORM.GRID1
.COLUMNCOUNT = 3
.FONTSIZE = 10
.FONTNAME = "Cambria"
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 250
.COLUMN2.CONTROLSOURCE = "KET"
.COLUMN2.HEADER1.CAPTION = "KETERANGAN"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "trans(JUMLAH,'999,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "JUMLAH"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN3.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT1.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.NOREK = NOREK
THISFORM.OLDDBF = SELECT()
THISFORM.DATA1 = SYS(2015)
THISFORM.BORDERSTYLE = 2
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDDBF)
RETURN
ENDPROC
**
*
*  simpanan_autodebet.scx::Text4
**
PROCEDURE LostFocus
THISFORM.TEXT5.SETFOCUS
ENDPROC
**
*
*  simpanan_autodebet.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_autodebet.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT1.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS1.CLICK
ENDIF
ENDPROC
**
*
*  simpanan_autodebet.scx::Cmdedit1
**
PROCEDURE Click
THISFORM.MYEDIT = "EDIT"
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDKELUAR1.VISIBLE = .F.
THISFORM.CMDEDIT1.VISIBLE = .F.
THISFORM.CMDINPUT1.VISIBLE = .F.
THISFORM.CMDHAPUS1.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.MYENABLE()
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  simpanan_autodebet.scx::Cmdsimpan1
**
PROCEDURE Click
THIS.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDKELUAR1.VISIBLE = .T.
THISFORM.CMDEDIT1.VISIBLE = .T.
THISFORM.CMDINPUT1.VISIBLE = .T.
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDKELUAR1.VISIBLE = .T.
THISFORM.CMDSELESAI.VISIBLE = .T.
THISFORM.CMDHAPUS1.VISIBLE = .T.
THISFORM.MYDISABLE()
IF THISFORM.MYEDIT<>"INPUT"
MIDAUTODEBET = IDAUTODEBET
ENDIF
MTANGGAL = THISFORM.TEXT1.VALUE
MKET = THISFORM.TEXT4.VALUE
MOPT_REK = THISFORM.OPTIONGROUP1.VALUE
MNOREK = THISFORM.NOREK
MJUMLAH = THISFORM.TEXT9.VALUE
MREKTUJUAN = THISFORM.TEXT5.VALUE
MTGLAUTO = THISFORM.TEXT3.VALUE
MTGLAKHIR = THISFORM.TEXT8.VALUE
IF THISFORM.MYEDIT="INPUT"
CSQL = "insert into simpanan_autodebet (kantor,tanggal, ket, jumlah,norek,"+" opt_rek, norek_tujuan, tglauto, tglakhir,inpopr) "+"values (?defakantor,?sqldate(mtanggal),?mket,?STR(mjumlah),?mnorek,"+"?mopt_rek,?mrektujuan,?str(mtglauto),?sqldate(mtglakhir),?defaIdUser)"
ELSE
CSQL = "update simpanan_autodebet set tanggal=?sqldate(mtanggal),ket=?mket,jumlah=?STR(mjumlah), "+"opt_rek=?mopt_rek, norek_tujuan=?mrektujuan,  "+"tglauto=?str(mtglauto), tglakhir=?sqldate(mtglakhir),"+"edtopr=?defaIdUser "+"where norek=?mnorek and idautodebet=?midautodebet"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("SALAH")
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan_autodebet.scx::Cmdinput1
**
PROCEDURE Click
THISFORM.MYEDIT = "INPUT"
THISFORM.CMDSIMPAN1.VISIBLE = .T.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDKELUAR1.VISIBLE = .F.
THISFORM.CMDEDIT1.VISIBLE = .F.
THISFORM.CMDINPUT1.VISIBLE = .F.
THISFORM.CMDHAPUS1.VISIBLE = .F.
THISFORM.CMDSELESAI.VISIBLE = .F.
THISFORM.MYENABLE()
THISFORM.COMMAND5.ENABLED = .T.
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT4.VALUE = SPACE(40)
THISFORM.OPTIONGROUP1.VALUE = 1
THISFORM.TEXT5.VALUE = ''
THISFORM.TEXT9.VALUE = 0
THISFORM.TEXT3.VALUE = DAY(TGLNOW)
THISFORM.TEXT6.VALUE = CTOD("  -  -    ")
THISFORM.TEXT8.VALUE = CTOD("  -  -    ")
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  simpanan_autodebet.scx::Cmdbatal1
**
PROCEDURE Click
THIS.VISIBLE = .F.
THISFORM.CMDSIMPAN1.VISIBLE = .F.
THISFORM.CMDKELUAR1.VISIBLE = .T.
THISFORM.CMDEDIT1.VISIBLE = .T.
THISFORM.CMDINPUT1.VISIBLE = .T.
THISFORM.CMDSELESAI.VISIBLE = .T.
THISFORM.CMDHAPUS1.VISIBLE = .T.
THISFORM.MYDISABLE()
ENDPROC
**
*
*  simpanan_autodebet.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=13 .OR. LASTKEY()=24
THISFORM.TEXT8.SETFOCUS
ENDIF
ENDPROC
**
*
*  simpanan_autodebet.scx::Optiongroup2
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.TEXT8.ENABLED = .T.
ELSE
THISFORM.TEXT8.ENABLED = .F.
ENDIF
ENDPROC
**
PROCEDURE Option1.Click
THISFORM.TEXT8.ENABLED = .T.
THISFORM.TEXT8.SETFOCUS
ENDPROC
**
PROCEDURE Option2.Click
THISFORM.TEXT8.ENABLED = .F.
ENDPROC
**
*
*  simpanan_autodebet.scx::Cmdhapus1
**
PROCEDURE Click
MIDAUTODEBET = IDAUTODEBET
CSQL = "delete from simpanan_autodebet where idautodebet='"+STR(MIDAUTODEBET)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus Data")
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  simpanan_autodebet.scx::cmdselesai
**
PROCEDURE Click
OLDSELE = ALIAS()
DO FORM simpanan_cabut_auto WITH 1
SELECT &OLDSELE
THISFORM.TEXT6.VALUE = TGLCABUT
ENDPROC
**
*
*  simpanan_autodebet.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_autodebet.scx::Optiongroup1
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.LABEL3.CAPTION = "NOREK SIMPANAN :"
ENDIF
IF THIS.VALUE=2
THISFORM.LABEL3.CAPTION = "NOREK PINJAMAN :"
ENDIF
IF THIS.VALUE=3
THISFORM.LABEL3.CAPTION = "NO. PERKIRAAN :"
ENDIF
THISFORM.TEXT5.SETFOCUS
ENDPROC
**
*
*  simpanan_autodebet.scx::Command5
**
PROCEDURE Click
OLDSELECT = SELECT()
DO CASE
CASE THISFORM.OPTIONGROUP1.VALUE=1
DO FORM simpanan TO MNOREK WITH "CARI"
CASE THISFORM.OPTIONGROUP1.VALUE=2
DO FORM pinjaman TO MNOREK WITH "CARI"
CASE THISFORM.OPTIONGROUP1.VALUE=3
DO FORM setsandi TO MNOREK WITH "GL01"
ENDCASE
THISFORM.TEXT5.VALUE = MNOREK
SELECT (OLDSELECT)
THISFORM.TEXT9.SETFOCUS
ENDPROC
**
***
*** simpanan_autodebet.sct
***
*
***
*** print_export.scx
***
*
*
*  print_export.scx::FORM1
**
FUNCTION Unload
RETURN THISFORM.MRET
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.TOP = THISFORM.TOP+150
THISFORM.LEFT = THISFORM.LEFT+200
THISFORM.COMBO2.ADDITEM("XLS")
THISFORM.COMBO2.ADDITEM("TXT")
THISFORM.COMBO2.ADDITEM("DBF")
THISFORM.COMBO2.ADDITEM("CSV")
THISFORM.COMBO2.VALUE = "XLS"
THISFORM.JUDUL.CAPTION = "EXPORT DATA"
THISFORM.JUDUL2.CAPTION = "EXPORT DATA"
THISFORM.BORDERSTYLE = 2
ENDPROC
**
*
*  print_export.scx::Cmdoke1
**
PROCEDURE Click
MRET = LEFT(ALLTRIM(THISFORM.COMBO2.VALUE)+SPACE(5), 5)+ALLTRIM(THISFORM.TEXT1.VALUE)
THISFORM.MRET = MRET
THISFORM.RELEASE
ENDPROC
**
*
*  print_export.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.MRET = ""
THISFORM.RELEASE
ENDPROC
**
*
*  print_export.scx::Text1
**
PROCEDURE InteractiveChange
IF EMPTY(THIS.VALUE)
THISFORM.CMDOKE1.ENABLED = .F.
ELSE
THISFORM.CMDOKE1.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  print_export.scx::Combo2
**
PROCEDURE LostFocus
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  print_export.scx::Command1
**
PROCEDURE Click
MDRIV = SYS(5)+SYS(2003)
THISFORM.TEXT1.VALUE = GETFILE(THISFORM.COMBO2.VALUE, "File Name :", "Oke", 0, "Save As")
THISFORM.CMDOKE1.ENABLED = .T.
SET DEFAULT TO &MDRIV
ENDPROC
**
***
*** print_export.sct
***
*
***
*** col_lainlain.scx
***
*
*
*  col_lainlain.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.KOLEKTOR = KODE
THISFORM.INSTANSI = INSTANSI
THISFORM.BLN = BLN
THISFORM.THN = TAHUN
THISFORM.TEXT41.VALUE = LAIN
THISFORM.TEXT1.VALUE = KET
ENDPROC
**
*
*  col_lainlain.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_lainlain.scx::Command3
**
PROCEDURE Click
CSQL = "update col_instansi set lain='"+STR(THISFORM.TEXT41.VALUE)+"', ket='"+THISFORM.TEXT1.VALUE+"' where kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.INSTANSI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Potongan Lain-Lain gagal di update", 0, "")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  col_lainlain.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_lainlain.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** col_lainlain.sct
***
*
***
*** kas_instansi.scx
***
*
*
*  kas_instansi.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE11.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE12.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE13.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE14.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT17.VALUE = "KAS MASUK"
THISFORM.LABEL20.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL8.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE11.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE12.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE13.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE14.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT17.VALUE = "KAS KELUAR"
THISFORM.LABEL20.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL8.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
FUNCTION Unload
SELECT CUR_JURNAL
USE
IF THISFORM.MODE="INPUT"
CEKURUTNOTA("KAS", THISFORM.TANGGAL, THISFORM.BUKTI)
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MKAS
THISFORM.MODE = MMODE
THISFORM.KAS = IIF(VARTYPE(MKAS)="X" .OR. VARTYPE(MKAS)="L", "KAS", MKAS)
IF THISFORM.KAS="NONKAS"
THISFORM.LABEL2.CAPTION = "TRANSAKSI KOLEKTIF VIA BANK"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 128, 0)
THISFORM.LABEL21.VISIBLE = .T.
THISFORM.TEXT18.VISIBLE = .T.
THISFORM.TEXT19.VISIBLE = .T.
ENDIF
THISFORM.TANGGAL = TGLNOW
THISFORM.BUKTI = ' '
OLDSELECT = SELECT()
CREATE CURSOR CUR_JURNAL (TANGGAL D, BUKTI C (10), NOPER C (10), KET C (40), JUMLAH N (15))
SELECT (OLDSELECT)
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
MKDKAS = IIF(DEBET-KREDIT>0, "M", "K")
THISFORM.TEXT4.SETFOCUS
THISFORM.TEXT7.VALUE = DEFATGLKAS
THISFORM.UBAHWARNA(MKDKAS)
IF MMODE="TAMPIL" .OR. MMODE="HAPUS"
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT11.ENABLED = .F.
THISFORM.TEXT18.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
IF MMODE="HAPUS"
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .T.
ENDIF
THISFORM.TEXT4.VALUE = NOREK
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002' and sandi='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
THISFORM.TEXT5.VALUE = JUMLAH1
THISFORM.TEXT6.VALUE = JUMLAH2
THISFORM.TEXT22.VALUE = JUMLAH3
THISFORM.TEXT16.VALUE = THISFORM.TEXT5.VALUE+THISFORM.TEXT6.VALUE+THISFORM.TEXT22.VALUE
THISFORM.TEXT12.VALUE = JUMLAH4
THISFORM.TEXT13.VALUE = JUMLAH5
THISFORM.TEXT14.VALUE = JUMLAH6
THISFORM.TEXT15.VALUE = THISFORM.TEXT12.VALUE+THISFORM.TEXT13.VALUE+THISFORM.TEXT14.VALUE
THISFORM.TEXT20.VALUE = JUMLAH7
THISFORM.TEXT21.VALUE = THISFORM.TEXT20.VALUE
THISFORM.TEXT9.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT15.VALUE+THISFORM.TEXT21.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT9.VALUE
THISFORM.TEXT7.VALUE = TANGGAL
THISFORM.TEXT8.VALUE = BUKTI
THISFORM.TEXT11.VALUE = IIF(DEBET>0, "M", "K")
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  kas_instansi.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_instansi.scx::Command3
**
PROCEDURE Click
MKD = '05'
MKOLECTOR = THISFORM.TEXT4.VALUE
MTGLTRANS = THISFORM.TEXT7.VALUE
MBUKTI = THISFORM.TEXT8.VALUE
IF THISFORM.TEXT11.VALUE='K' .AND. THISFORM.TEXT10.VALUE>DEFABATASKAS
DO WHILE .T.
MKETACC = "TRANSAKSI KOLEKTIF INSTANSI"+CHR(13)+"-----------------------------------------------"+CHR(13)+"KODE KOLEKTOR	: "+THISFORM.TEXT1.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT2.VALUE+CHR(13)+"		SIMPANAN	: "+TRANSFORM(THISFORM.TEXT16.VALUE, "999,999,999,999")+CHR(13)+"		PINJAMAN	: "+TRANSFORM(THISFORM.TEXT15.VALUE, "999,999,999,999")+CHR(13)+"		LAIN-LAIN	: "+TRANSFORM(THISFORM.TEXT21.VALUE, "999,999,999,999")+CHR(13)+"-----------------------------------------------"+CHR(13)+"JML PENGAMBILAN	: "+TRANSFORM(THISFORM.TEXT10.VALUE, "999,999,999,999")
DO FORM acc_client TO HASIL WITH THISFORM.TEXT7.VALUE, ALLTRIM(THISFORM.TEXT8.VALUE), MKETACC, THISFORM.TEXT10.VALUE
IF HASIL=1 .OR. HASIL=2
EXIT
ENDIF
ENDDO
IF HASIL=2
RETURN
ENDIF
ENDIF
CSQL = "select * from col_instansi where kantor='"+DEFAKANTOR+"' and kode='"+MKOLECTOR+"' and bln='"+STR(MONTH(DEFATGLKAS))+"' and tahun='"+STR(YEAR(DEFATGLKAS))+"' and (simpokok>'0' or simwajib>'0')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
STORE 0 TO JPOKOK, JWAJIB, JSMK, JLAIN
GOTO TOP
DO WHILE  .NOT. EOF()
MNOANGG = NOANGG
MPOKOK = SIMPOKOK
MSMK = 0
MWAJIB = SIMWAJIB
MLAIN = IIF(ISNULL(LAIN), 0, LAIN)
CSQL = "select sldpokok,saldosmk,sldwajib from anggota_mutasi where cif='"+MNOANGG+"' and iddata="+"(select MAX(iddata) from anggota_mutasi where cif='"+MNOANGG+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT0")
IF LCEK<1
MESSAGEBOX("Gagal baca")
RETURN
ENDIF
MSALDOPK = IIF(ISNULL(SLDPOKOK), 0, SLDPOKOK)
MSALDOWJ = IIF(ISNULL(SLDWAJIB), 0, SLDWAJIB)
MSALDOSMK = IIF(ISNULL(SALDOSMK), 0, SALDOSMK)
CSQL = "INSERT INTO anggota_mutasi (kantor,cif,tanggal,bukti,kd,mtspokok,sldpokok,mtssmk,saldosmk,mtswajib,sldwajib) VALUES "+"('"+DEFAKANTOR+"','"+MNOANGG+"','"+SQLDATE(MTGLTRANS)+"','"+MBUKTI+"','"+"01"+"','"+STR(MPOKOK)+"','"+STR(MSALDOPK+MPOKOK)+"','"+STR(MSMK)+"','"+STR(MSALDOSMK+MSMK)+"','"+STR(MWAJIB)+"','"+STR(MSALDOWJ+MWAJIB)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan")
RETURN
ENDIF
JPOKOK = JPOKOK+MPOKOK
JWAJIB = JWAJIB+MWAJIB
JSMK = JSMK+MSMK
JLAIN = JLAIN+MLAIN
SELECT SMT
SKIP
ENDDO
SELECT CUR_JURNAL
IF JPOKOK<>0
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH DEFANOPERSIMPK, KET WITH "STR. SIMP.POKOK INSTANSI ", JUMLAH WITH 0-JPOKOK
ENDIF
IF JWAJIB<>0
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH DEFANOPERSIMWJB, KET WITH "STR. SIMP.WAJIB INSTANSI ", JUMLAH WITH 0-JWAJIB
ENDIF
IF JSMK<>0
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH DEFANOPERSIMSMK, KET WITH "STR. SMK INSTANSI ", JUMLAH WITH 0-JSMK
ENDIF
IF JLAIN<>0
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH '21019', KET WITH "TITIPAN LAIN-LAIN ", JUMLAH WITH 0-JLAIN
ENDIF
CSQL = "select a.*,b.jurnaltab,b.keterangan from col_instansi_simp as a, setsandi_tab as b  where a.kantor=b.kantor and a.sandi=b.sandi and a.kantor='"+DEFAKANTOR+"' and a.kode='"+ALLTRIM(MKOLECTOR)+"' and bln='"+ALLTRIM(STR(MONTH(DEFATGLKAS)))+"' and tahun='"+ALLTRIM(STR(YEAR(DEFATGLKAS)))+"' and jumlah>'0'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO WHILE  .NOT. EOF()
MNOANGG = NOANGG
CSQL = "select simpokok,simwajib,simpanan from col_instansi where kantor='"+DEFAKANTOR+"' and kode='"+MKOLECTOR+"' and bln='"+STR(MONTH(DEFATGLKAS))+"' and tahun='"+STR(YEAR(DEFATGLKAS))+"' and "+"noangg='"+MNOANGG+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
IF LCEK<1
ENDIF
MSIMPANAN = SIMPOKOK+SIMWAJIB+SIMPANAN
USE
SELECT SMT
IF MSIMPANAN>0
MNOREK = NOREK
MPRODUK = PRODUK
MJUMLAH = JUMLAH
MJURNAL = JURNALTAB
CSQL = "select saldo from simpanan_saldo where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal="+"(select MAX(tanggal) from simpanan_saldo where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLTRANS)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF LCEK<1
MESSAGEBOX("gagal baca 1")
RETURN
ENDIF
MSALDO = IIF(ISNULL(SALDO), 0, SALDO)
CSQL = "insert into simpanan_mutasi (kantor,norek,BUKTI,TANGGAL,kode,KETERANGAN,DEBET, KREDIT,SALDO,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+MBUKTI+"','"+SQLDATE(MTGLTRANS)+"','"+"01"+"','"+"KOLEKTIF INSTANSI"+"','0','"+STR(MJUMLAH)+"','"+TRANSFORM(MSALDO+MJUMLAH, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal baca 2")
RETURN
ENDIF
CSQL = "update simpanan_saldo set saldo='"+TRANSFORM(MSALDO+MJUMLAH, '999999999999999')+"', tglmutasi='"+SQLDATE(MTGLTRANS)+"', opt='"+DEFAUSERID+"' where "+"kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTGLTRANS)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal update saldo")
RETURN
ENDIF
SELECT CUR_JURNAL
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MJUMLAH
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH "STR. TABUNGAN KOLEKTIF ("+MKOLECTOR+")"
REPLACE JUMLAH WITH JUMLAH-MJUMLAH
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
CSQL = "select a.*,b.jurnal_pokok,b.jurnal_jasa,b.jurnal_denda,b.keterangan from col_instansi_pinj as a, setsandi_pinj as b  where a.kantor=b.kantor and a.produk=b.sandi and a.kantor='"+DEFAKANTOR+"' and a.kode='"+ALLTRIM(MKOLECTOR)+"' and bln='"+ALLTRIM(STR(MONTH(DEFATGLKAS)))+"' and tahun='"+ALLTRIM(STR(YEAR(DEFATGLKAS)))+"' and angpokok+angbunga+angdenda>'0'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca jurnal pinjaman")
RETURN
ENDIF
MTOTBUNGA = 0
DO WHILE  .NOT. EOF()
MNOANGG = NOANGG
MNOREK = NOREK
MPRODUK = PRODUK
CSQL = "select angpokok,angbunga,angdenda from col_instansi where kantor='"+DEFAKANTOR+"' and kode='"+MKOLECTOR+"' and bln='"+STR(MONTH(DEFATGLKAS))+"' and tahun='"+STR(YEAR(DEFATGLKAS))+"' and "+"noangg='"+MNOANGG+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
IF LCEK<1
ENDIF
MPINJAMAN = ANGPOKOK+ANGBUNGA+ANGDENDA
USE
SELECT SMT
IF MPINJAMAN>0
MJURPK = JURNAL_POKOK
MJURBG = JURNAL_JASA
MJURDN = JURNAL_DENDA
MBYRPK = ANGPOKOK
MBYRBG = ANGBUNGA
MBYRDN = ANGDENDA
CSQL = "select sisapokok,sisabunga,denda from pinjaman_saldo where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal="+"(select MAX(tanggal) from pinjaman_saldo where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLTRANS)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF LCEK<1
MESSAGEBOX("gagal baca 1")
RETURN
ENDIF
MSISAPOKOK = IIF(ISNULL(SISAPOKOK), 0, SISAPOKOK)-MBYRPK
MSISABUNGA = IIF(ISNULL(SISABUNGA), 0, SISABUNGA)-MBYRBG
MSISADENDA = IIF(ISNULL(DENDA), 0, DENDA)-MBYRDN
CSQL = "insert into pinjaman_mutasi (kantor,norek,bukti,tanggal,tglmutasi,kode,"+"pokok,jasa,denda, `opt`, `sisapokok`, `sisabunga`) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+MBUKTI+"','"+SQLDATE(MTGLTRANS)+"','"+SQLDATE(MTGLTRANS)+"','"+"01"+"','"+TRANSFORM(MBYRPK, "999999999999999")+"','"+TRANSFORM(MBYRBG, "999999999999999")+"','"+TRANSFORM(MBYRDN, "999999999999999")+"','"+DEFAUSERID+"','"+TRANSFORM(MSISAPOKOK, '999999999999999')+"','"+TRANSFORM(MSISABUNGA, '999999999999999')+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal baca 2")
RETURN
ENDIF
CSQL = "update pinjaman_saldo set sisapokok='"+TRANSFORM(MSISAPOKOK, '999999999999999')+"', sisabunga='"+TRANSFORM(MSISABUNGA, '999999999999999')+"', opt='"+DEFAUSERID+"' where "+"kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTGLTRANS)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal update saldo")
RETURN
ENDIF
SELECT CUR_JURNAL
LOCATE FOR NOPER=MJURPK
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MBYRPK
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURPK, KET WITH "ANG. POKOK KOLEKTIF ("+MKOLECTOR+")"
REPLACE JUMLAH WITH JUMLAH-MBYRPK
ENDIF
MTOTBUNGA = MTOTBUNGA+MBYRBG
SELECT CUR_JURNAL
LOCATE FOR NOPER=MJURBG
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MBYRBG
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURBG, KET WITH "ANG. BUNGA KOLEKTIF ("+MKOLECTOR+")"
REPLACE JUMLAH WITH JUMLAH-MBYRBG
ENDIF
SELECT CUR_JURNAL
LOCATE FOR NOPER=MJURDN
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MBYRDN
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURDN, KET WITH "ANG. DENDA KOLEKTIF ("+MKOLECTOR+")"
REPLACE JUMLAH WITH JUMLAH-MBYRDN
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
MALOKASI = MTOTBUNGA*(1.0/10)
JALOKASI = 0
IF MALOKASI>0
SELECT CUR_JURNAL
IF DEFASHU_RAT>0 .AND.  .NOT. EMPTY(DEFAJURSHU_RAT)
MALO = MALOKASI*DEFASHU_RAT
MJURNAL = DEFAJURSHU_RAT
MKET = "ALOKASI RAT"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_THR>0 .AND.  .NOT. EMPTY(DEFAJURSHU_THR)
MALO = MALOKASI*DEFASHU_THR
MJURNAL = DEFAJURSHU_THR
MKET = "ALOKASI THR"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_OPER>0 .AND.  .NOT. EMPTY(DEFAJURSHU_OPER)
MALO = MALOKASI*DEFASHU_OPER
MJURNAL = DEFAJURSHU_OPER
MKET = "ALOKASI OPERASIONAL"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_SRG>0 .AND.  .NOT. EMPTY(DEFAJURSHU_SRG)
MALO = MALOKASI*DEFASHU_SRG
MJURNAL = DEFAJURSHU_SRG
MKET = "ALOKASI SERAGAM"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_BEA>0 .AND.  .NOT. EMPTY(DEFAJURSHU_BEA)
MALO = MALOKASI*DEFASHU_BEA
MJURNAL = DEFAJURSHU_BEA
MKET = "ALOKASI BEASISWA"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_DOOR>0 .AND.  .NOT. EMPTY(DEFAJURSHU_DOOR)
MALO = MALOKASI*DEFASHU_DOOR
MJURNAL = DEFAJURSHU_DOOR
MKET = "ALOKASI DOORPRIZE"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_TRAN>0 .AND.  .NOT. EMPTY(DEFAJURSHU_TRAN)
MALO = MALOKASI*DEFASHU_TRAN
MJURNAL = DEFAJURSHU_TRAN
MKET = "ALOKASI TRANSPORTASI"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_TALI>0 .AND.  .NOT. EMPTY(DEFAJURSHU_TALI)
MALO = MALOKASI*DEFASHU_TALI
MJURNAL = DEFAJURSHU_TALI
MKET = "ALOKASI TALI ASIH"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_TUNJ1>0 .AND.  .NOT. EMPTY(DEFAJURSHU_TUNJ1)
MALO = MALOKASI*DEFASHU_TUNJ1
MJURNAL = DEFAJURSHU_TUNJ1
MKET = "ALOKASI TUNJANGAN 1"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_TUNJ2>0 .AND.  .NOT. EMPTY(DEFAJURSHU_TUNJ2)
MALO = MALOKASI*DEFASHU_TUNJ2
MJURNAL = DEFAJURSHU_TUNJ2
MKET = "ALOKASI TUNJANGAN 2"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_TUNJ3>0 .AND.  .NOT. EMPTY(DEFAJURSHU_TUNJ3)
MALO = MALOKASI*DEFASHU_TUNJ3
MJURNAL = DEFAJURSHU_TUNJ3
MKET = "ALOKASI TUJANGAN 3"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_TUNJ4>0 .AND.  .NOT. EMPTY(DEFAJURSHU_TUNJ4)
MALO = MALOKASI*DEFASHU_TUNJ4
MJURNAL = DEFAJURSHU_TUNJ4
MKET = "ALOKASI TUNJANGAN 4"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_DPLK>0 .AND.  .NOT. EMPTY(DEFAJURSHU_DPLK)
MALO = MALOKASI*DEFASHU_DPLK
MJURNAL = DEFAJURSHU_DPLK
MKET = "ALOKASI DPLK"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_PEMEL>0 .AND.  .NOT. EMPTY(DEFAJURSHU_PEMEL)
MALO = MALOKASI*DEFASHU_PEMEL
MJURNAL = DEFAJURSHU_PEMEL
MKET = "ALOKASI PEMELIHARAAN"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF DEFASHU_LEMB>0 .AND.  .NOT. EMPTY(DEFAJURSHU_LEMB)
MALO = MALOKASI*DEFASHU_LEMB
MJURNAL = DEFAJURSHU_LEMB
MKET = "ALOKASI LEMBUR"
JALOKASI = JALOKASI+MALO
LOCATE FOR NOPER=MJURNAL
IF FOUND()
REPLACE JUMLAH WITH JUMLAH-MALO
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURNAL, KET WITH MKET
REPLACE JUMLAH WITH JUMLAH-MALO
ENDIF
ENDIF
IF JALOKASI>0
LOCATE FOR NOPER=MJURBG
IF FOUND()
REPLACE JUMLAH WITH JALOKASI
ELSE
APPEND BLANK
REPLACE TANGGAL WITH MTGLTRANS, BUKTI WITH MBUKTI
REPLACE NOPER WITH MJURBG, KET WITH "DANA ALOKASI"
REPLACE JUMLAH WITH JUMLAH+JALOKASI
ENDIF
ENDIF
ENDIF
CSQL = "update col_instansi set flag='*' where kantor='"+DEFAKANTOR+"' and kode='"+MKOLECTOR+"' and bln='"+STR(MONTH(DEFATGLKAS))+"' and thn='"+STR(YEAR(DEFATGLKAS))+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update col_instansi_simp set flag='*' where kantor='"+DEFAKANTOR+"' and kode='"+MKOLECTOR+"' and bln='"+STR(MONTH(DEFATGLKAS))+"' and thn='"+STR(YEAR(DEFATGLKAS))+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update col_instansi_pinj set flag='*' where kantor='"+DEFAKANTOR+"' and kode='"+MKOLECTOR+"' and bln='"+STR(MONTH(DEFATGLKAS))+"' and thn='"+STR(YEAR(DEFATGLKAS))+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT CUR_JURNAL
MKAS = 0
GOTO TOP
DO WHILE  .NOT. EOF()
IF JUMLAH<>0
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TANGGAL)+"','"+BUKTI+"','"+NOPER+"','"+KET+"','"+STR(JUMLAH)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
MKAS = MKAS+JUMLAH
ENDIF
SKIP
ENDDO
IF THISFORM.KAS="KAS"
MNOPERKAS = DEFANOPERKAS
ELSE
MNOPERKAS = THISFORM.NOPERBANK
ENDIF
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "+"('"+DEFAKANTOR+"','"+SQLDATE(THISFORM.TEXT7.VALUE)+"','"+THISFORM.TEXT8.VALUE+"','"+MNOPERKAS+"','"+"STR. KOLEKTIF"+THISFORM.TEXT4.VALUE+"','"+STR(0-MKAS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF THISFORM.KAS="KAS"
CSQL = "insert into kasir (kantor,csr,tanggal,bukti,kode,keterangan,debet,kredit,opt,norek,jumlah1,jumlah2,jumlah3,jumlah4,jumlah5,jumlah6,jumlah7) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+"STR. KOLEKTIF"+THISFORM.TEXT4.VALUE+"',"+"'"+STR(IIF(THISFORM.TEXT11.VALUE="M", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+STR(IIF(THISFORM.TEXT11.VALUE="K", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+DEFAUSERID+"',"+"'"+MKOLECTOR+"',"+"'"+STR(JPOKOK)+"',"+"'"+STR(JWAJIB)+"',"+"'"+STR(THISFORM.TEXT22.VALUE)+"',"+"'"+STR(THISFORM.TEXT12.VALUE)+"',"+"'"+STR(THISFORM.TEXT13.VALUE)+"',"+"'"+STR(THISFORM.TEXT14.VALUE)+"',"+"'"+STR(THISFORM.TEXT20.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal insert kasir")
ENDIF
ELSE
CSQL = "insert into nonkas (kantor,csr,tanggal,bukti,kode,kodebank,keterangan,debet,kredit,opt) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+STR(THISFORM.TEXT18.VALUE)+"',"+"'"+"STR. KOLEKTIF"+THISFORM.TEXT4.VALUE+"',"+"'"+STR(IIF(THISFORM.TEXT11.VALUE="M", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+STR(IIF(THISFORM.TEXT11.VALUE="K", THISFORM.TEXT10.VALUE, 0))+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF DEFAVALIDASI='1'
MNAMACETAK = "VLD_INSTANSI"
MKET = IIF(THISFORM.TEXT5.VALUE>0, "SIMP.POKOK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT5.VALUE, '999,999,999,999'))+" ", "")
MKET = MKET+IIF(THISFORM.TEXT6.VALUE>0, "/SIMP.WAJIB:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT6.VALUE, '999,999,999,999'))+" ", "")
MKET = MKET+IIF(THISFORM.TEXT22.VALUE>0, "/SIMPANAN:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT22.VALUE, '999,999,999,999'))+" ", "")
MKET = MKET+IIF(THISFORM.TEXT20.VALUE>0, "/LAIN-LAIN:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT20.VALUE, '999,999,999,999'))+" ", "")
MKET1 = IIF(THISFORM.TEXT12.VALUE>0, "ANG.POKOK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT12.VALUE, '999,999,999,999'))+" ", "")
KET1 = MKET1+IIF(THISFORM.TEXT13.VALUE>0, "/ANGS.JASA:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT13.VALUE, '999,999,999,999'))+" ", "")
MKET1 = MKET1+IIF(THISFORM.TEXT14.VALUE>0, "/ANGS.DENDA:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT14.VALUE, '999,999,999,999'))+" ", "")
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/INST/"+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT10.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT8.VALUE)+'/'+DTOC(THISFORM.TEXT7.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = ALLTRIM(THISFORM.TEXT4.VALUE)+'/'+THISFORM.TEXT2.VALUE
MBARIS3 = MKET
MBARIS4 = MKET1
CETAKVALIDASI(MNAMACETAK, MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_instansi.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_instansi.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MBUKTI = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT1 = BUKTI
USE
CSQL = "select bukti from jurnal where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT2 = BUKTI
USE
SELECT (OLDSELECT)
IF (ISNULL(MBKT1) .OR. EMPTY(MBKT1)) .AND. (ISNULL(MBKT2) .OR. EMPTY(MBKT2))
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
RETURN
ENDIF
MESSAGEBOX("Bukti Sudah Pernah Masuk", 0, "Validasi Bukti")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_instansi.scx::Text4
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5 .OR. THIS.ADA=0
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "C002"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THISFORM.TEXT4.VALUE = ALLTRIM(MSANDI)
ENDIF
ELSE
MSANDI = ALLTRIM(THISFORM.TEXT4.VALUE)
ENDIF
CSQL = "select sandi,keterangan,ket2,ket3 from setsandi where kode='C002' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Marketing tidak terbaca")
ENDIF
IF RECCOUNT()>0
THISFORM.TEXT2.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Marketing tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
CSQL = "select SUM(simpokok) as jsimpokok, SUM(simwajib) as jsimwajib, SUM(simpanan) as Jsimpanan,"+" SUM(lain) as Jlain, SUM(angpokok) as Jangpokok, SUM(angbunga) as "+" Jangbunga from col_instansi where kantor='"+DEFAKANTOR+"' and bln='"+STR(MONTH(DEFATGLKAS))+"' and tahun='"+STR(YEAR(DEFATGLKAS))+"' and kode='"+THISFORM.TEXT4.VALUE+"' group by kode"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT5.VALUE = JSIMPOKOK
THISFORM.TEXT6.VALUE = JSIMWAJIB
THISFORM.TEXT22.VALUE = JSIMPANAN
THISFORM.TEXT16.VALUE = JSIMPOKOK+JSIMWAJIB+JSIMPANAN
THISFORM.TEXT12.VALUE = JANGPOKOK
THISFORM.TEXT13.VALUE = JANGBUNGA
THISFORM.TEXT14.VALUE = 0
THISFORM.TEXT15.VALUE = JANGPOKOK+JANGBUNGA+0
THISFORM.TEXT20.VALUE = JLAIN
THISFORM.TEXT21.VALUE = JLAIN
THISFORM.TEXT9.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT15.VALUE+THISFORM.TEXT21.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT9.VALUE
THISFORM.TEXT11.VALUE = IIF(THISFORM.TEXT9.VALUE>0, "M", "K")
THISFORM.UBAHWARNA(THISFORM.TEXT11.VALUE)
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  kas_instansi.scx::Text11
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="M" .OR. THIS.VALUE="K")
MESSAGEBOX("Gunakan Huruf "+CHR(13)+"M : Untuk Kas Masuk"+CHR(13)+"K  : Untuk Kas Keluar", 64, "TIDAK VALID")
THIS.SETFOCUS
NODEFAULT
ENDIF
THISFORM.UBAHWARNA(THIS.VALUE)
ENDPROC
**
*
*  kas_instansi.scx::Text17
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_instansi.scx::Text18
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT19.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_instansi.scx::Text19
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_instansi.scx::Command1
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_instansi.scx::Command4
**
PROCEDURE Click
MKODE = THISFORM.TEXT4.VALUE
MTANGGAL = THISFORM.TEXT7.VALUE
MBUKTI = THISFORM.TEXT8.VALUE
CSQL = "delete from pinjaman_mutasi where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(MTANGGAL)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus pinjaman")
ENDIF
CSQL = "select * from col_instansi_pinj where kantor='"+DEFAKANTOR+"' and kode='"+MKODE+"' and bln='"+STR(MONTH(TANGGAL))+"' and tahun='"+TRANSFORM(YEAR(TANGGAL), '9999')+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca instansi pinjaman")
ENDIF
DO WHILE  .NOT. EOF()
MNOREK = NOREK
CSQL = "select sisapokok,sisabunga from pinjaman_saldo where norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTANGGAL-1)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF LCEK<1
MESSAGEBOX("Gagal cek saldo kemaren")
ENDIF
MSISAPK = SISAPOKOK
MSISABG = SISABUNGA
CSQL = "select SUM(pokok) as byrpk, SUM(jasa) as byrbg from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTANGGAL)+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF LCEK<1
MESSAGEBOX("Gagal baca pembayaran")
ENDIF
MSISAPOKOK = MSISAPK+BYRPK
MSISABUNGA = MSISABG+BYRBG
CSQL = "update pinjaman_saldo set sisapokok='"+STR(MSISAPOKOK)+"', sisabunga='"+STR(MSISABUNGA)+"' where norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update saldo pinjaman")
ENDIF
SELECT SMT
SKIP
ENDDO
CSQL = "delete from simpanan_mutasi where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(MTANGGAL)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select * from col_instansi_simp where kantor='"+DEFAKANTOR+"' and kode='"+MKODE+"' and bln='"+STR(MONTH(MTANGGAL))+"' and tahun='"+TRANSFORM(YEAR(MTANGGAL), '9999')+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
MNOREK = NOREK
CSQL = "select saldo from simpanan_saldo where norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTANGGAL-1)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
MSALDO = SALDO
CSQL = "select SUM(kredit)-SUM(debet) as mts from simpanan_mutasi where norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTANGGAL)+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
MAKHIR = MSALDO+MTS
CSQL = "update simpanan_saldo set saldo='"+STR(MAKHIR)+"' where norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT SMT
SKIP
ENDDO
CSQL = "delete from jurnal where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(MTANGGAL)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update col_instansi set flag='' where kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT4.VALUE+"' and bln='"+STR(MONTH(MTANGGAL))+"' and tahun='"+TRANSFORM(YEAR(MTANGGAL), '9999')+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from kasir where kantor='"+DEFAKANTOR+"' and csr='01' and tanggal='"+SQLDATE(MTANGGAL)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
***
*** kas_instansi.sct
***
*
***
*** col_instansi_edit.scx
***
*
*
*  col_instansi_edit.scx::FORM1
**
PROCEDURE bacasql
SELECT (THISFORM.OLDSELECT)
MKODE = THISFORM.KOLEKTOR
MBLN = THISFORM.BLN
MTAHUN = THISFORM.TAHUN
MKANTOR = KANTOR
MINSTANSI = INSTANSI
MNOANGG = NOANGG
DATA1 = THISFORM.DATA1
CSQL = "select * from col_instansi_simp where kantor='"+MKANTOR+"' and kode='"+MKODE+"' and instansi='"+MINSTANSI+"' and bln='"+STR(MBLN)+"' and tahun='"+STR(MTAHUN)+"' and noangg='"+MNOANGG+"'"
LCEK = SQLEXEC(OODBC, CSQL, DATA1)
IF LCEK<1
MESSAGEBOX("tdk bisa baca data1")
ENDIF
SUM JUMLAH TO MJML 
THISFORM.TEXT16.VALUE = MJML
DATA2 = THISFORM.DATA2
CSQL = "select * from col_instansi_pinj where kantor='"+MKANTOR+"' and kode='"+MKODE+"' and instansi='"+MINSTANSI+"' and bln='"+STR(MBLN)+"' and tahun='"+STR(MTAHUN)+"' and noangg='"+MNOANGG+"'"
LCEK = SQLEXEC(OODBC, CSQL, DATA2)
IF LCEK<1
MESSAGEBOX("tdk bisa baca data2")
RETURN
ENDIF
SUM ANGPOKOK TO MJML1 
SUM ANGBUNGA TO MJML2 
SUM ANGDENDA TO MJML3 
THISFORM.TEXT19.VALUE = MJML1+MJML2+MJML3
THISFORM.TEXT10.VALUE = THISFORM.TEXT21.VALUE+THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE
ENDPROC
**
PROCEDURE tampil
DATA1 = THISFORM.DATA1
SELECT (DATA1)
WITH THISFORM.GRID1
.RECORDSOURCE = DATA1
.COLUMNCOUNT = 3
.FONTSIZE = 9
.BACKCOLOR = RGB(198, 198, 255)
.COLUMN1.WIDTH = 90
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NOREK"
.COLUMN2.WIDTH = 50
.COLUMN2.CONTROLSOURCE = "PRODUK"
.COLUMN2.HEADER1.CAPTION = "PRODUK"
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "TRANS(JUMLAH,'999,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "JUMLAH"
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(180,180,255) , RGB(198,198,255))", "Column")
DATA2 = THISFORM.DATA2
SELECT (DATA2)
WITH THISFORM.GRID2
.RECORDSOURCE = DATA2
.COLUMNCOUNT = 5
.FONTSIZE = 9
.BACKCOLOR = RGB(198, 198, 255)
.COLUMN1.WIDTH = 80
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NOREK"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 50
.COLUMN2.CONTROLSOURCE = "PRODUK"
.COLUMN2.HEADER1.CAPTION = "PRODUK"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 75
.COLUMN3.CONTROLSOURCE = "trans(ANGPOKOK,'999,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "ANGS. POKOK"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN4.WIDTH = 75
.COLUMN4.CONTROLSOURCE = "trans(ANGBUNGA,'999,999,999,999')"
.COLUMN4.HEADER1.CAPTION = "ANGS. BUNGA"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN5.WIDTH = 75
.COLUMN5.CONTROLSOURCE = "trans(ANGDENDA,'999,999,999,999')"
.COLUMN5.HEADER1.CAPTION = "ANGS. DENDA"
.COLUMN5.HEADER1.FONTBOLD = .T.
.REFRESH
ENDWITH
THISFORM.GRID2.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(180,180,255) , RGB(198,198,255))", "Column")
ENDPROC
**
PROCEDURE tampil2
OLDSELE = SELECT()
DATA1 = THISFORM.DATA1
SELECT (DATA1)
THISFORM.TEXT8.VALUE = NOREK
THISFORM.TEXT9.VALUE = PRODUK
THISFORM.TEXT11.VALUE = JUMLAH
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE tampil3
OLDSELE = SELECT()
DATA2 = THISFORM.DATA2
SELECT (DATA2)
THISFORM.TEXT12.VALUE = POKOK
THISFORM.TEXT13.VALUE = JW
THISFORM.TEXT14.VALUE = RATE
THISFORM.TEXT15.VALUE = ANGS
THISFORM.TEXT3.VALUE = NOREK
THISFORM.TEXT17.VALUE = ANGPOKOK
THISFORM.TEXT18.VALUE = ANGBUNGA
THISFORM.TEXT20.VALUE = ANGDENDA
THISFORM.TEXT24.VALUE = ANGPOKOK+ANGBUNGA+ANGDENDA
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE myenable
THISFORM.TEXT6.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .T.
THISFORM.TEXT22.ENABLED = .T.
THISFORM.EDIT1.ENABLED = .T.
THISFORM.TEXT11.ENABLED = .T.
THISFORM.TEXT17.ENABLED = .T.
THISFORM.TEXT18.ENABLED = .T.
THISFORM.TEXT20.ENABLED = .T.
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MODE = MMODE
THISFORM.KOLEKTOR = KODE
THISFORM.BLN = BLN
THISFORM.TAHUN = TAHUN
THISFORM.TEXT1.VALUE = INSTANSI
THISFORM.TEXT4.VALUE = NOANGG
THISFORM.TEXT5.VALUE = NAMA
THISFORM.TEXT6.VALUE = SIMPOKOK
THISFORM.TEXT7.VALUE = SIMWAJIB
THISFORM.TEXT22.VALUE = LAIN
THISFORM.EDIT1.VALUE = KET
THISFORM.TEXT21.VALUE = SIMPOKOK+SIMWAJIB+LAIN
THISFORM.OLDSELECT = SELECT()
THISFORM.DATA1 = SYS(2015)
THISFORM.DATA2 = SYS(2015)
IF MMODE="INSERT"
THISFORM.TEXT4.ENABLED = .T.
ENDIF
IF MMODE="EDIT"
THISFORM.MYENABLE()
ENDIF
IF MMODE="TAMPIL" .OR. MMODE="EDIT"
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
THISFORM.TAMPIL3()
ENDIF
THISFORM.COMMAND4.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.DATA2)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  col_instansi_edit.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi_edit.scx::Command3
**
PROCEDURE Click
IF THISFORM.MODE="EDIT"
CSQL = "update col_bayar set simpokok='"+STR(THISFORM.TEXT6.VALUE)+"', "+"simwajib='"+STR(THISFORM.TEXT7.VALUE)+"', "+"simsuka='"+STR(THISFORM.TEXT8.VALUE)+"', "+"mapan='"+STR(THISFORM.TEXT9.VALUE)+"', "+"lain='"+STR(THISFORM.TEXT22.VALUE)+"', "+"ket='"+THISFORM.EDIT1.VALUE+"', "+"angpokok='"+STR(THISFORM.TEXT17.VALUE)+"', "+"angbunga='"+STR(THISFORM.TEXT18.VALUE)+"', "+"jmlpotongan='"+STR(THISFORM.TEXT19.VALUE)+"' where "+"kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT42.VALUE+"' and "+"instansi='"+THISFORM.TEXT1.VALUE+"' and noangg='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into col_bayar (kantor,kode,instansi,tanggal,noangg,nama,simpokok,simwajib,simsuka,mapan,lain,ket,angpokok,"+"angbunga,jmlpotongan) values ("+"'"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT42.VALUE+"', "+"'"+THISFORM.TEXT1.VALUE+"', "+"'"+SQLDATE(THISFORM.TEXT41.VALUE)+"', "+"'"+THISFORM.TEXT4.VALUE+"', "+"'"+THISFORM.TEXT5.VALUE+"', "+"'"+STR(THISFORM.TEXT6.VALUE)+"', "+"'"+STR(THISFORM.TEXT7.VALUE)+"', "+"'"+STR(THISFORM.TEXT8.VALUE)+"', "+"'"+STR(THISFORM.TEXT9.VALUE)+"', "+"'"+STR(THISFORM.TEXT22.VALUE)+"', "+"'"+THISFORM.EDIT1.VALUE+"', "+"'"+STR(THISFORM.TEXT17.VALUE)+"', "+"'"+STR(THISFORM.TEXT18.VALUE)+"', "+"'"+STR(THISFORM.TEXT19.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan penambahan tagihan bayar", 0, "")
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi_edit.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "P003"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_instansi_edit.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text4
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF LASTKEY()=27
RETURN .T.
ENDIF
IF LASTKEY()=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
OLDSELECT = SELECT()
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
SELECT (OLDSELECT)
ENDIF
MCIF = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
MCIF = CIF
MNAMA = NAMA
DATA1 = THISFORM.DATA1
CSQL = "select a.norek,b.keterangan as produk,a.pot_simpanan as jumlah from simpanan as a, setsandi_tab as b where "+"a.jenis=b.jenis and a.produk=b.sandi and a.tgltutup='0000-00-00' and a.cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, DATA1)
IF LCEK<1
MESSAGEBOX("tdk bisa baca data1")
ENDIF
DATA2 = THISFORM.DATA2
CSQL = "select a.norek,b.keterangan as produk,a.pokok,a.lama as jw,0 as angs,a.rate,a.pot_pokok as angpokok,a.pot_bunga as angbunga,0 as angdenda from pinjaman as a, setsandi_pinj as b where a.jenis=b.sandi "+" and a.tgllunas='0000-00-00' and cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, DATA2)
IF LCEK<1
MESSAGEBOX("tdk bisa baca data2")
RETURN
ENDIF
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
THISFORM.TAMPIL3()
THISFORM.MYENABLE()
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  col_instansi_edit.scx::Text5
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text10
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi_edit.scx::Command4
**
PROCEDURE Click
CIF = THISFORM.TEXT4.VALUE
NAMA = THISFORM.TEXT5.VALUE
MCIF = CIF
DO FORM anggota_potong_gaji
CSQL = "select a.tanggal,a.cif,a.norek,a.jenis,a.produk as sandi,a.pot_simpanan,b.keterangan as produk from simpanan as a, setsandi_tab as b where "+"a.tgltutup='0000-00-00' and a.cif='"+MCIF+"' and a.jenis=b.jenis and a.produk=b.sandi "
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
IF LCEK<1
MESSAGEBOX("Gagal Baca data simpanan", 0, "")
ENDIF
MSIMPANAN = 0
DO WHILE  .NOT. EOF()
MSIMPANAN = MSIMPANAN+POT_SIMPANAN
MJUMLAH = POT_SIMPANAN
MNOREK = NOREK
CSQL = "select norek from col_instansi_simp where "+"kantor=?DefaKantor and kode=?thisform.kolektor and instansi=?thisform.text1.Value and "+"bln=?thisform.bln and tahun=?thisform.tahun and noangg=?mcif and norek=?norek"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
IF RECCOUNT()=0
SELECT SMT1
CSQL = "insert into col_instansi_simp (`kantor`,`kode`,`instansi`,`bln`,`tahun`,`noangg`,"+"`norek`,`sandi`,`produk`,`jumlah`) value (?DefaKantor,?thisform.kolektor,"+"?thisform.text1.Value,?thisform.bln,?thisform.tahun,?cif,?mnorek,?sandi,?produk,?mjumlah)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
SELECT SMT1
CSQL = "update col_instansi_simp set jumlah=?pot_simpanan where "+"kantor=?DefaKantor and kode=?thisform.kolektor and instansi=?thisform.text1.Value and "+"bln=?thisform.bln and tahun=?thisform.tahun and noangg=?mcif and norek=?norek"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert rincian simpanan")
ENDIF
ENDIF
SELECT SMT1
SKIP
ENDDO
CSQL = "select jenis,norek,cif,jenis,pokok,rate,lama,pot_pokok,pot_bunga from pinjaman where tgllunas='0000-00-00' and cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
IF LCEK<1
MESSAGEBOX("Gagal Baca data simpanan", 0, "")
RETURN
ENDIF
STORE 0 TO MANGPOKOK, MANGBUNGA
GOTO TOP
DO WHILE  .NOT. EOF()
MANGPOKOK = MANGPOKOK+POT_POKOK
MANGBUNGA = MANGBUNGA+POT_BUNGA
MNOREK = NOREK
MCIF = CIF
CSQL = "select norek from col_instansi_pinj where "+"kantor=?DefaKantor and kode=?thisform.kolektor and instansi=?thisform.text1.Value and "+"bln=?thisform.bln and tahun=?thisform.tahun and noangg=?mcif and norek=?norek"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
IF RECCOUNT()=0
SELECT SMT1
CSQL = "insert into col_instansi_pinj (kantor,kode,instansi,bln,tahun,noangg,norek,"+"produk,POKOK,JW,RATE,ANGS,angpokok,angbunga,angdenda) value "+"(?defakantor,?thisform.kolektor,?thisform.text1.Value,?thisform.bln,?thisform.tahun,?mcif,?mnorek,"+"?jenis,?pokok,?lama,?rate,0,?pot_pokok,?pot_bunga,0)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
SELECT SMT1
CSQL = "update col_instansi_pinj set angpokok='"+STR(POT_POKOK)+"',angbunga='"+STR(POT_BUNGA)+"' where "+"kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"' and "+"bln='"+STR(THISFORM.BLN)+"' and tahun='"+STR(THISFORM.TAHUN)+"' and noangg='"+MCIF+"' and norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert rincian simpanan")
RETURN
ENDIF
ENDIF
SELECT SMT1
SKIP
ENDDO
CSQL = "select * from anggota where cif=?mcif"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca anggota")
ENDIF
THISFORM.TEXT6.VALUE = SIMPOKOK
THISFORM.TEXT7.VALUE = SIMWAJIB
THISFORM.TEXT22.VALUE = LAIN
THISFORM.EDIT1.VALUE = KETLAIN
THISFORM.TEXT21.VALUE = SIMPOKOK+SIMWAJIB+LAIN
CSQL = "update col_instansi set simpokok=?simpokok, simwajib=?simwajib,"+"simpanan=?msimpanan,lain=?lain,ket=?ketlain,angpokok=?mAngPokok,angbunga=?mAngBunga where "+"kantor=?DefaKantor and kode=?thisform.kolektor and instansi=?thisform.text1.Value and "+"bln=?thisform.bln and tahun=?thisform.tahun and noangg=?mcif"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update col_instansi")
ENDIF
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
THISFORM.TAMPIL3()
ENDPROC
**
*
*  col_instansi_edit.scx::Text23
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text22
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF THIS.VALUE>0
THISFORM.EDIT1.ENABLED = .T.
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT7.VALUE+THISFORM.TEXT22.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT21.VALUE+THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE
ENDPROC
**
*
*  col_instansi_edit.scx::Text6
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT7.VALUE+THISFORM.TEXT22.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT21.VALUE+THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE
ENDPROC
**
*
*  col_instansi_edit.scx::Text7
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THISFORM.TEXT6.VALUE+THISFORM.TEXT7.VALUE+THISFORM.TEXT22.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT21.VALUE+THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE
ENDPROC
**
*
*  col_instansi_edit.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
*
*  col_instansi_edit.scx::Text16
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Grid2
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL3()
ENDPROC
**
*
*  col_instansi_edit.scx::Text21
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text11
**
PROCEDURE InteractiveChange
THISFORM.TEXT16.VALUE = THIS.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text19
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text12
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text13
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text14
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text15
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text17
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT19.VALUE = THISFORM.TEXT17.VALUE+THISFORM.TEXT18.VALUE+THISFORM.TEXT20.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
*
*  col_instansi_edit.scx::Text18
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT19.VALUE = THISFORM.TEXT17.VALUE+THISFORM.TEXT18.VALUE+THISFORM.TEXT20.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
*
*  col_instansi_edit.scx::Text20
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT19.VALUE = THISFORM.TEXT17.VALUE+THISFORM.TEXT18.VALUE+THISFORM.TEXT20.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
*
*  col_instansi_edit.scx::Text3
**
PROCEDURE InteractiveChange
THISFORM.TEXT19.VALUE = THISFORM.TEXT17.VALUE+THISFORM.TEXT18.VALUE+THISFORM.TEXT20.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_edit.scx::Text24
**
PROCEDURE InteractiveChange
THISFORM.TEXT19.VALUE = THISFORM.TEXT17.VALUE+THISFORM.TEXT18.VALUE+THISFORM.TEXT20.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT16.VALUE+THISFORM.TEXT19.VALUE+THISFORM.TEXT21.VALUE
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** col_instansi_edit.sct
***
*
***
*** col_instansi.scx
***
*
*
*  col_instansi.scx::PINJAMAN
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
IF RECCOUNT()>0
THISFORM.CONTAINER1.CMDHAPUS1.ENABLED = .T.
THISFORM.CONTAINER1.CMDEDIT.ENABLED = .T.
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .T.
THISFORM.CONTAINER1.CMDLAIN.ENABLED = .T.
ELSE
THISFORM.CONTAINER1.CMDHAPUS1.ENABLED = .F.
THISFORM.CONTAINER1.CMDEDIT.ENABLED = .F.
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .F.
THISFORM.CONTAINER1.CMDLAIN.ENABLED = .F.
ENDIF
WITH THISFORM.CONTAINER1.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 10
.BACKCOLOR = RGB(198, 198, 255)
.COLUMN1.WIDTH = 40
.COLUMN1.CONTROLSOURCE = "INSTANSI"
.COLUMN1.HEADER1.CAPTION = "INSTANSI"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 75
.COLUMN2.CONTROLSOURCE = "NOANGG"
.COLUMN2.HEADER1.CAPTION = "NO.ANGG"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 200
.COLUMN3.CONTROLSOURCE = "NAMA"
.COLUMN3.HEADER1.CAPTION = "NAMA ANGGOTA"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "SIMWAJIB"
.COLUMN4.HEADER1.CAPTION = "SIM. WAJIB"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.ALIGNMENT = 1
.COLUMN5.WIDTH = 90
.COLUMN5.CONTROLSOURCE = "SIMPANAN"
.COLUMN5.HEADER1.CAPTION = "JML SIMPANAN"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN6.WIDTH = 90
.COLUMN6.CONTROLSOURCE = "LAIN"
.COLUMN6.HEADER1.CAPTION = "LAIN"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN7.WIDTH = 200
.COLUMN7.CONTROLSOURCE = "KET"
.COLUMN7.HEADER1.CAPTION = "KETERANGAN"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN8.WIDTH = 90
.COLUMN8.CONTROLSOURCE = "ANGPOKOK"
.COLUMN8.HEADER1.CAPTION = "ANGS. POKOK"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN8.INPUTMASK = "999,999,999,999"
.COLUMN8.ALIGNMENT = 1
.COLUMN9.WIDTH = 90
.COLUMN9.CONTROLSOURCE = "ANGBUNGA"
.COLUMN9.HEADER1.CAPTION = "ANGS. BUNGA"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 10
.COLUMN9.INPUTMASK = "999,999,999,999"
.COLUMN9.ALIGNMENT = 1
.COLUMN10.WIDTH = 90
.COLUMN10.CONTROLSOURCE = "ANGDENDA"
.COLUMN10.HEADER1.CAPTION = "ANGS. DENDA"
.COLUMN10.HEADER1.FONTBOLD = .T.
.COLUMN10.HEADER1.FONTSIZE = 10
.COLUMN10.INPUTMASK = "999,999,999,999"
.COLUMN10.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.CONTAINER1.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(180,180,255) , RGB(198,198,255))", "Column")
THISFORM.CONTAINER1.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
CSQL = "select COUNT(noangg) as jml from col_instansi as a where kantor='"+DEFAKANTOR+"' and "
CSQL = CSQL+"kode='"+THISFORM.KDCOLECTOR+"' and "
CSQL = CSQL+IIF(EMPTY(THISFORM.CONTAINER1.MFILTER.CAPTION), "1", THISFORM.CONTAINER1.MFILTER.CAPTION)
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.JUMREC = IIF(ISNULL(JML), 0, IIF(VARTYPE(JML)="C", VAL(JML), JML))
THISFORM.HALAMAN = INT(THISFORM.JUMREC/THISFORM.CONTAINER1.MLIMIT.VALUE)+1
MLIMIT = ALLTRIM(STR((THISFORM.CONTAINER1.HAL.VALUE-1)*THISFORM.CONTAINER1.MLIMIT.VALUE))+", "+ALLTRIM(STR(THISFORM.CONTAINER1.MLIMIT.VALUE))
CSQL = "select a.kantor,a.kode,a.instansi,a.bln,a.tahun,a.noangg,a.nama,a.ket,a.kode,simpokok, simwajib,lain,"+"sum(b.angpokok) as angpokok,sum(b.angbunga) as angbunga,sum(b.angdenda) as AngDenda,"+"(select SUM(jumlah) from col_instansi_simp as c where a.instansi=c.instansi and a.kode=c.kode and a.tahun=c.tahun and a.bln=c.bln and a.noangg=c.noangg) as simpanan "+"from col_instansi as a left join col_instansi_pinj as b on a.instansi=b.instansi and a.kode=b.kode and a.tahun=b.tahun and a.bln=b.bln and a.noangg=b.noangg "+"where a.kantor='"+DEFAKANTOR+"' and a.kode='"+THISFORM.KDCOLECTOR+"' and "
CSQL = CSQL+IIF(EMPTY(THISFORM.CONTAINER1.MFILTER.CAPTION), "1", THISFORM.CONTAINER1.MFILTER.CAPTION)+" group by a.noangg order by a.noangg limit "+MLIMIT
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
JMLDATA = RECCOUNT()
GOTO TOP
IF IJINMODUL("PINJ", "EDIT")
IF JMLDATA>0
THISFORM.CONTAINER1.CMDEDIT.ENABLED = .T.
ELSE
THISFORM.CONTAINER1.CMDEDIT.ENABLED = .F.
ENDIF
ENDIF
IF IJINMODUL("PINJ", "HAPUS")
IF JMLDATA>0
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .T.
ELSE
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .F.
ENDIF
ENDIF
IF IJINMODUL("PINJ", "CETAK")
IF JMLDATA>0
THISFORM.CONTAINER1.COMMAND6.ENABLED = .T.
ELSE
THISFORM.CONTAINER1.COMMAND6.ENABLED = .F.
ENDIF
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MBLN, MTAHUN, MKOL, MNAMA
THISFORM.CONTAINER1.CMDINPUT.ENABLED = IJINMODUL("COL", "INPUT")
THISFORM.CONTAINER1.CMDEDIT.ENABLED = IJINMODUL("COL", "EDIT")
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = IJINMODUL("COL", "HAPUS")
THISFORM.CONTAINER1.COMMAND6.ENABLED = IJINMODUL("COL", "CETAK")
THISFORM.TEXT2.VALUE = MBLN
THISFORM.TEXT4.VALUE = MTAHUN
THISFORM.KDCOLECTOR = MKOL
THISFORM.TEXT1.VALUE = MKOL
THISFORM.TEXT3.VALUE = MNAMA
THISFORM.OLDSELECT = SELECT()
THISFORM.LABEL2.CAPTION = "PEMBAYARAN KOLEKTIF INSTANSI"
THISFORM.CONTAINER1.MFILTER.CAPTION = "a.bln='"+STR(MBLN)+"' and a.tahun='"+STR(MTAHUN)+"'"
THISFORM.CONTAINER1.MLIMIT.VALUE = 50
THISFORM.CONTAINER1.MLIMIT.INPUTMASK = '9999'
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
THISFORM.CONTAINER1.ENABLED = .T.
THISFORM.WINDOWSTATE = 2
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA)
USE
SELECT (THISFORM.OLDSELECT)
RETURN
ENDPROC
**
*
*  col_instansi.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "C002"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("Kode kolektor Tidak Tersedia")
NODEFAULT
RETURN
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT3.VALUE = KETERANGAN
THISFORM.KDCOLECTOR = MSANDI
USE
SELECT (OLDSELECT)
THISFORM.CONTAINER1.CMDINPUT.ENABLED = .T.
THISFORM.CONTAINER1.CMDINPUT1.ENABLED = .T.
ENDFUNC
**
*
*  col_instansi.scx::Cmdhapus
**
PROCEDURE Click
DO FORM ./form/col_instansi_data1 WITH "HAPUS", THISFORM.TEXT1.VALUE, THISFORM.TEXT2.VALUE, THISFORM.TEXT4.VALUE
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::Cmdinput
**
PROCEDURE Click
IF EMPTY(THISFORM.KDCOLECTOR)
MESSAGEBOX("KODE KOLEKTOR TIDAK BOLEH KOSONG", 0, "")
NODEFAULT
RETURN
ENDIF
MYDATA = THISFORM.DATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM ./form/col_instansi_data1 WITH "INSERT", THISFORM.TEXT1.VALUE, THISFORM.TEXT2.VALUE, THISFORM.TEXT4.VALUE
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.CONTAINER1.CMDEDIT.ENABLED = .T.
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .T.
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .T.
ENDPROC
**
*
*  col_instansi.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi.scx::Cmdrefresh
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.CONTAINER1.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::Cmddatatop
**
PROCEDURE Click
IF THISFORM.CONTAINER1.HAL.VALUE=1
MESSAGEBOX("Halaman Pertama", 16, "")
RETURN
ENDIF
THISFORM.CONTAINER1.HAL.VALUE = MAX(1, THISFORM.CONTAINER1.HAL.VALUE-1)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::Cmdcari
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "a.bln='"+STR(MBLN)+"' and a.tahun='"+STR(MTAHUN)+"'"+" concat(TRIM(a.noangg),TRIM(a.nama))"+" LIKE "+UPPER(MFILTER)
THISFORM.CONTAINER1.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.CONTAINER1.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  col_instansi.scx::Cmdfilter
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.CONTAINER1.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.CONTAINER1.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  col_instansi.scx::Cmddataup
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::Cmddatabott
**
PROCEDURE Click
IF THISFORM.CONTAINER1.HAL.VALUE=THISFORM.HALAMAN
MESSAGEBOX("Halaman Terakhir", 16, "")
RETURN
ENDIF
THISFORM.CONTAINER1.HAL.VALUE = MIN(THISFORM.HALAMAN, THISFORM.CONTAINER1.HAL.VALUE+1)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::Cmddatadowm
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::mLimit
**
PROCEDURE LostFocus
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE DblClick
MNOANGG = NOANGG
DO FORM .\form\Col_instansi_edit WITH "TAMPIL"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
LOCATE FOR NOANGG=MNOANGG
THISFORM.CONTAINER1.GRID1.REFRESH
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
MNOANGG = NOANGG
DO FORM .\form\Col_instansi_edit WITH "TAMPIL"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
LOCATE FOR NOANGG=MNOANGG
THISFORM.CONTAINER1.GRID1.REFRESH
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CONTAINER1.CMDCARI.CLICK
ENDIF
ENDPROC
**
*
*  col_instansi.scx::Command6
**
PROCEDURE Click
SELECT (THISFORM.DATA)
DO FORM ins_lap WITH 1
SELECT (THISFORM.DATA)
RETURN
ENDPROC
**
*
*  col_instansi.scx::Command
**
PROCEDURE Click
SELECT (THISFORM.DATA)
DO FORM col_set_rekap WITH THISFORM.TEXT2.VALUE, THISFORM.TEXT4.VALUE, THISFORM.KDCOLECTOR
SELECT (THISFORM.DATA)
THISFORM.CONTAINER1.GRID1.SETFOCUS
ENDPROC
**
*
*  col_instansi.scx::Cmdhapus1
**
PROCEDURE Click
CSQL = "DELETE from col_instansi where "+"kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT1.VALUE+"' and "+"instansi='"+INSTANSI+"' and noangg='"+NOANGG+"' and bln='"+STR(THISFORM.TEXT2.VALUE)+"' and tahun='"+STR(THISFORM.TEXT4.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from col_instansi_pinj where "+"kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT1.VALUE+"' and "+"instansi='"+INSTANSI+"' and noangg='"+NOANGG+"' and bln='"+STR(THISFORM.TEXT2.VALUE)+"' and tahun='"+STR(THISFORM.TEXT4.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus rincian pinjaman")
ENDIF
CSQL = "delete from col_instansi_simp where "+"kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.TEXT1.VALUE+"' and "+"instansi='"+INSTANSI+"' and noangg='"+NOANGG+"' and bln='"+STR(THISFORM.TEXT2.VALUE)+"' and tahun='"+STR(THISFORM.TEXT4.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus rincian simpanan")
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::Cmdedit
**
PROCEDURE Click
MNOANGG = NOANGG
DO FORM .\form\Col_instansi_edit WITH "TAMPIL"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
LOCATE FOR NOANGG=MNOANGG
THISFORM.CONTAINER1.GRID1.REFRESH
ENDPROC
**
*
*  col_instansi.scx::Cmdinput1
**
PROCEDURE Click
IF EMPTY(THISFORM.KDCOLECTOR)
MESSAGEBOX("KODE KOLEKTOR TIDAK BOLEH KOSONG", 0, "")
NODEFAULT
RETURN
ENDIF
IF THISFORM.STATUS="A"
MYDATA = THISFORM.DATA
THISFORM.MYENABLE()
SELECT &MYDATA
DO FORM ./form/col_instansi_edit WITH "INSERT"
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.CONTAINER1.CMDEDIT.ENABLED = .T.
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .T.
THISFORM.CONTAINER1.CMDHAPUS.ENABLED = .T.
ELSE
MESSAGEBOX("Data History Tidak dapat digunakan untuk input data", 16, "PERINGATAN")
ENDIF
ENDPROC
**
*
*  col_instansi.scx::CmdLain
**
PROCEDURE Click
DO FORM col_lainlain
IF LASTKEY()<>27
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDIF
ENDPROC
**
*
*  col_instansi.scx::hal
**
PROCEDURE LostFocus
IF THIS.VALUE>THISFORM.HALAMAN
MESSAGEBOX("Halaman Tidak tersedia")
THIS.VALUE = THISFORM.HALAMAN
ENDIF
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col_instansi.scx::Text2
**
PROCEDURE LostFocus
IF THIS.VALUE<1 .OR. THIS.VALUE>12
MESSAGEBOX("Bulan Tagihan salah!,"+CHR(13)+"Harus di isi antara 1 s/d. 12")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** col_instansi.sct
***
*
***
*** col_instansi_data.scx
***
*
*
*  col_instansi_data.scx::FORM1
**
PROCEDURE Init
PARAMETER MMODE, MKOLEKTOR, MBULAN, MTAHUN
THISFORM.MODE = MMODE
THISFORM.KOLEKTOR = MKOLEKTOR
THISFORM.TEXT41.VALUE = MBULAN
THISFORM.TEXT3.VALUE = MTAHUN
THISFORM.TEXT1.ENABLED = .T.
THISFORM.SHAPE5.WIDTH = 0
IF MMODE="HAPUS"
THISFORM.SHAPE8.BACKCOLOR = RGB(255, 125, 125)
THISFORM.LABEL17.CAPTION = "BATAL TAGIHAN KOLEKTIF"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 0, 0)
THISFORM.CHECK1.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
THISFORM.CHECK3.VISIBLE = .F.
THISFORM.SHAPE6.VISIBLE = .F.
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  col_instansi_data.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi_data.scx::Command3
**
PROCEDURE Click
IF THISFORM.MODE="INSERT"
CSQL = "select * from anggota where kelkerja='"+THISFORM.TEXT1.VALUE+"' and tglkeluar='0000-00-00' group by cif"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca data pinjaman", 0, "")
ENDIF
JUMREC = RECCOUNT()
DO WHILE  .NOT. EOF()
THISFORM.SHAPE5.WIDTH = (RECNO()/JUMREC)*442
MCIF = CIF
MNAMA = NAMA
MLAIN = LAIN
MKET = KETLAIN
MTOTSIMPAN = 0
IF THISFORM.CHECK1.VALUE=1
CSQL = "select a.norek,a.pot_simpanan,produk,jenis from simpanan as a where a.tgltutup='0000-00-00' and a.cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
IF LCEK<1
MESSAGEBOX("Gagal Baca data simpanan 2", 0, "")
ENDIF
DO WHILE  .NOT. EOF()
MTOTSIMPAN = MTOTSIMPAN+POT_SIMPANAN
CSQL = "select sandi,keterangan from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='"+JENIS+"' and sandi='"+PRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt2")
MPRODUK = KETERANGAN
MSANDI = SANDI
SELECT SMT1
CSQL = "insert into col_instansi_simp (kantor,kode,instansi,bln,tahun,noangg,norek,sandi,produk,jumlah) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+MCIF+"','"+NOREK+"','"+MSANDI+"','"+MPRODUK+"','"+STR(POT_SIMPANAN)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert rincian simpanan 3")
RETURN
ENDIF
SELECT SMT1
SKIP
ENDDO
ENDIF
STORE 0 TO MTOTPOKOK, MTOTBUNGA, MTOTDENDA
IF THISFORM.CHECK2.VALUE=1
MTGLMULAI = CTOD('01-'+RIGHT("00"+ALLTRIM(TRANSFORM(THISFORM.TEXT41.VALUE, '99')), 2)+'-'+TRANSFORM(THISFORM.TEXT3.VALUE, '9999'))
CSQL = "select jenis,norek,pokok,rate,lama,pot_pokok,pot_bunga from pinjaman where tgllunas='0000-00-00' and tglvaluta<>'0000-00-00' and tglmulai<='"+SQLDATE(AKHIRBLN(MTGLMULAI))+"' and cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
IF LCEK<1
MESSAGEBOX("Gagal Baca data simpanan 4", 0, "")
RETURN
ENDIF
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT SMT1
CSQL = "insert into col_instansi_pinj (kantor,kode,instansi,bln,tahun,noangg,norek,produk,"+"pokok,jw,rate,angs,angpokok,angbunga) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+MCIF+"','"+NOREK+"','"+JENIS+"','"+STR(POKOK)+"','"+TRANSFORM(LAMA, '9999')+"','"+TRANSFORM(RATE, '99.99')+"','"+"0"+"','"+STR(POT_POKOK)+"','"+STR(POT_BUNGA)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert rincian simpanan 5")
RETURN
ENDIF
MTOTPOKOK = MTOTPOKOK+POT_POKOK
MTOTBUNGA = MTOTBUNGA+POT_BUNGA
SELECT SMT1
SKIP
ENDDO
ENDIF
IF THISFORM.CHECK3.VALUE=0
IF DEFANOMIWAJIB+MTOTSIMPAN+MTOTPOKOK+MTOTBUNGA>0
CSQL = "insert into col_instansi (kantor,kode,instansi,bln,tahun,noangg,nama,"+"simpokok,simwajib,simpanan,lain,ket,angpokok,angbunga,angdenda) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+MCIF+"',"+'"'+MNAMA+'"'+",'"+STR(DEFANOMIPOKOK)+"','"+STR(DEFANOMIWAJIB)+"','"+STR(MTOTSIMPAN)+"','"+STR(MLAIN)+"','"+MKET+"','"+STR(MTOTPOKOK)+"','"+STR(MTOTBUNGA)+"','"+STR(0)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert bayar instansi 6")
RETURN
ENDIF
ENDIF
ELSE
CSQL = "insert into col_instansi (kantor,kode,instansi,bln,tahun,noangg,nama,"+"simpokok,simwajib,simpanan,lain,ket,angpokok,angbunga,angdenda) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+MCIF+"',"+'"'+MNAMA+'"'+",'"+STR(DEFANOMIPOKOK)+"','"+STR(DEFANOMIWAJIB)+"','"+STR(MTOTSIMPAN)+"','"+STR(MLAIN)+"','"+MKET+"','"+STR(MTOTPOKOK)+"','"+STR(MTOTBUNGA)+"','"+STR(0)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert bayar instansi 7")
RETURN
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
ENDIF
IF THISFORM.MODE="HAPUS"
CSQL = "DELETE from col_instansi where kantor='"+DEFAKANTOR+"' and bln='"+STR(THISFORM.TEXT41.VALUE)+"'and tahun='"+STR(THISFORM.TEXT3.VALUE)+"' and "+"kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("PEMBATALAN TAGIHAN GAGAL DILAKUKAN", 0, "")
ENDIF
CSQL = "DELETE from col_instansi_simp where kantor='"+DEFAKANTOR+"' and bln='"+STR(THISFORM.TEXT41.VALUE)+"'and tahun='"+STR(THISFORM.TEXT3.VALUE)+"' and "+"kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("PEMBATALAN TAGIHAN SIMPANAN GAGAL DILAKUKAN 8", 0, "")
ENDIF
CSQL = "DELETE from col_instansi_pinj where kantor='"+DEFAKANTOR+"' and bln='"+STR(THISFORM.TEXT41.VALUE)+"'and tahun='"+STR(THISFORM.TEXT3.VALUE)+"' and "+"kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("PEMBATALAN TAGIHAN PINJAMAN GAGAL DILAKUKAN 9", 0, "")
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi_data.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "P003"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("Kode Instansi Tidak Tersedia")
NODEFAULT
RETURN
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
THISFORM.COMMAND3.SETFOCUS
ENDFUNC
**
*
*  col_instansi_data.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** col_instansi_data.sct
***
*
***
*** anggota_mutasi.scx
***
*
*
*  anggota_mutasi.scx::FORM1
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
MCIF = THISFORM.NOREKASAL
DO CASE
CASE THISFORM.JENIS='1'
CSQL = "select tanggal,bukti,kd,if(mtspokok>0,mtspokok,0) as debet,if(mtspokok<0,0-mtspokok,0) as kredit,"+" sldpokok as saldo from anggota_mutasi where cif='"+MCIF+"' and mtspokok<>0 ORDER BY TANGGAL DESC LIMIT 50"
CASE THISFORM.JENIS='2'
CSQL = "select tanggal,bukti,kd,if(mtswajib>0,mtswajib,0) as debet,if(mtswajib<0,0-mtswajib,0) as kredit,"+" sldwajib as saldo from anggota_mutasi where cif='"+MCIF+"' and mtswajib<>0 ORDER BY TANGGAL DESC LIMIT 50"
CASE THISFORM.JENIS='3'
CSQL = "select tanggal,bukti,kd,if(mtspenyertaan>0,mtspenyertaan,0) as debet,if(mtspenyertaan<0,0-mtspenyertaan,0) as kredit,"+" sldpenyertaan as saldo from anggota_mutasi where cif='"+MCIF+"' and mtspenyertaan<>0 ORDER BY TANGGAL DESC LIMIT 50"
ENDCASE
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampilkan
MYDATA = THISFORM.DATA1
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 6
FONTSIZE = 8
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 80
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KD"
.COLUMN3.HEADER1.CAPTION = "KODE"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "DEBET"
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN4.ALIGNMENT = 1
.COLUMN4.HEADER1.CAPTION = "DEBET"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN5.WIDTH = 90
.COLUMN5.CONTROLSOURCE = "KREDIT"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "KREDIT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN6.WIDTH = 90
.COLUMN6.CONTROLSOURCE = "SALDO"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "SALDO"
.COLUMN6.HEADER1.FONTBOLD = .T.
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MJENIS
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = CIF
THISFORM.JENIS = MJENIS
DO CASE
CASE MJENIS='1'
THISFORM.LABEL17.CAPTION = "MUTASI SIMPANAN POKOK"
CASE MJENIS='2'
THISFORM.LABEL17.CAPTION = "MUTASI SIMPANAN WAJIB"
CASE MJENIS='3'
THISFORM.LABEL17.CAPTION = "MUTASI SIMPANAN PENYERTAAN"
ENDCASE
THISFORM.DATA1 = SYS(2015)
WITH THISFORM
IF MMODE='TAMPIL' .OR. MMODE='EDIT'
SELECT (THISFORM.OLDSELECT)
.TEXT1.VALUE = CIF
.TEXT2.VALUE = NAMA
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.CMDKELUAR1.SETFOCUS
ENDIF
ENDIF
ENDWITH
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  anggota_mutasi.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_mutasi.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into pinjaman (tanggal, bukti, norek, nopk, kdhit, marketing, cif, pokok, rate, lama, tglmulai, tgljtempo, adm, provisi, jenis, kelompok, wilayah, penggunaan, sektor, sumber) value "+"('"+SQLDATE(.TEXT4.VALUE)+"',"+"'"+.TEXT34.VALUE+"',"+"'"+.TEXT32.VALUE+"',"+"'"+.TEXT33.VALUE+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+.TEXT1.VALUE+"',"+"'"+STR(.TEXT38.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT18.VALUE)+"',"+"'"+SQLDATE(.TEXT19.VALUE)+"',"+"'"+SQLDATE(.TEXT14.VALUE)+"',"+"'"+STR(.TEXT39.VALUE)+"',"+"'"+STR(.TEXT40.VALUE)+"',"+"'"+.TEXT21.VALUE+"',"+"'"+.TEXT25.VALUE+"',"+"'"+.TEXT26.VALUE+"',"+"'"+.TEXT22.VALUE+"',"+"'"+.TEXT27.VALUE+"',"+"'"+.TEXT24.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman set "+"tanggal='"+SQLDATE(.TEXT4.VALUE)+"',"+"bukti='"+.TEXT34.VALUE+"',"+"norek='"+.TEXT32.VALUE+"',"+"nopk='"+.TEXT33.VALUE+"',"+"kdhit='"+.TEXT41.VALUE+"',"+"marketing='"+.TEXT42.VALUE+"',"+"cif='"+.TEXT1.VALUE+"',"+"pokok='"+STR(.TEXT38.VALUE)+"',"+"rate='"+STR(.TEXT5.VALUE)+"',"+"lama='"+STR(.TEXT18.VALUE)+"',"+"tglmulai='"+SQLDATE(.TEXT19.VALUE)+"',"+"tgljtempo='"+SQLDATE(.TEXT14.VALUE)+"',"+"adm='"+STR(.TEXT39.VALUE)+"',"+"provisi='"+STR(.TEXT40.VALUE)+"',"+"jenis='"+.TEXT21.VALUE+"',"+"kelompok='"+.TEXT25.VALUE+"',"+"wilayah='"+.TEXT26.VALUE+"',"+"penggunaan='"+.TEXT22.VALUE+"',"+"sektor='"+.TEXT27.VALUE+"',"+"sumber='"+.TEXT24.VALUE+"' where norek='"+THISFORM.NOREKASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="HAPUS"
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_mutasi.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
*
*  anggota_mutasi.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_mutasi.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
***
*** anggota_mutasi.sct
***
*
***
*** col_tagih_instansi2.frx
***
*
***
*** col_tagih_instansi2.frt
***
*
***
*** simpanan_data_byrbunga.scx
***
*
*
*  simpanan_data_byrbunga.scx::FORM1
**
PROCEDURE Init
PARAMETER MNOREK, MBGKE, MBGREK, MBGNAMA, MEDIT
IF MEDIT="EDIT" .OR. MEDIT="INPUT"
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMBO1.ENABLED = .T.
THISFORM.TEXT16.ENABLED = .T.
THISFORM.TEXT16.ENABLED = .T.
ELSE
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
THISFORM.TOP = SYSMETRIC(2)/2
THISFORM.LEFT = SYSMETRIC(1)/2
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.OLDDBF = SELECT()
THISFORM.NOREK = MNOREK
THISFORM.COMBO1.VALUE = MBGKE
THISFORM.TEXT16.VALUE = MBGREK
THISFORM.TEXT17.VALUE = MBGNAMA
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_data_byrbunga.scx::Text16
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THISFORM.TEXT16.VALUE = MNOREK
ENDIF
MNOREK = TRIM(THIS.VALUE)
CSQL = "select norek,cif from simpanan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MCIF = CIF
VNOREK = NOREK
USE
CSQL = "select nama from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF VNOREK=MNOREK
THISFORM.TEXT17.VALUE = NAMA
USE
SELECT (OLDSELECT)
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  simpanan_data_byrbunga.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data_byrbunga.scx::Command3
**
PROCEDURE Click
CSQL = "update simpanan set bunga_ke='"+THISFORM.COMBO1.VALUE+"', bunga_rek='"+THISFORM.TEXT16.VALUE+"', bunga_nama='"+THISFORM.TEXT17.VALUE+"' where norek='"+THISFORM.NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal memasukkan data rekening bunga")
ENDIF
CSQL = "update simpanan set bunga_ke='"+THISFORM.COMBO1.VALUE+"', bunga_rek='"+THISFORM.TEXT16.VALUE+"' ,bunga_nama='"+THISFORM.TEXT17.VALUE+"' where norek='"+THISFORM.NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT (THISFORM.OLDDBF)
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data_byrbunga.scx::Command1
**
PROCEDURE Click
THIS.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.ENABLED = .T.
THISFORM.COMBO1.ENABLED = .T.
ENDPROC
**
*
*  simpanan_data_byrbunga.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data_byrbunga.scx::Combo1
**
PROCEDURE LostFocus
DO CASE
CASE EMPTY(THIS.VALUE)
THISFORM.TEXT16.VALUE = ""
THISFORM.TEXT17.VALUE = ""
THISFORM.TEXT16.ENABLED = .F.
CASE THIS.VALUE="TUNAI"
THISFORM.TEXT16.ENABLED = .F.
THISFORM.TEXT17.ENABLED = .F.
THISFORM.TEXT16.VALUE = ""
THISFORM.TEXT17.VALUE = ""
CASE THIS.VALUE="TABUNGAN"
THISFORM.TEXT16.ENABLED = .T.
THISFORM.COMMAND5.ENABLED = .T.
CASE THIS.VALUE="DEPOSITO"
THISFORM.TEXT16.ENABLED = .T.
THISFORM.COMMAND5.ENABLED = .T.
THISFORM.TEXT16.VALUE = NOREK
THISFORM.TEXT17.VALUE = NAMA
ENDCASE
ENDPROC
**
PROCEDURE Init
THIS.ADDITEM("TUNAI")
THIS.ADDITEM("TABUNGAN")
THIS.ADDITEM("DEPOSITO")
ENDPROC
**
*
*  simpanan_data_byrbunga.scx::Command5
**
PROCEDURE Click
OLDSELECT = SELECT()
DO FORM simpanan TO MNOREK WITH "CARI"
THISFORM.TEXT16.VALUE = MNOREK
SELECT (OLDSELECT)
ENDPROC
**
***
*** simpanan_data_byrbunga.sct
***
*
***
*** a_daftar_sandi.scx
***
*
*
*  a_daftar_sandi.scx::kdinstansi
**
PROCEDURE InteractiveChange
OLDSELECT = SELECT()
CSQL = "select keterangan from setsandi where kode='"+THIS.SANDI+"' and sandi='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CEK")
THISFORM.KET_INSTANSI.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE Init
MSANDI = 'P003'
MNAMA = "Kode Sandi"
THIS.ADDPROPERTY("sandi", MSANDI)
THIS.ADDPROPERTY("nama", MNAMA)
THIS.CLEAR
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT00")
THIS.ROWSOURCE = "SMT00"
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH THIS.SANDI
THIS.VALUE = MSANDI
ENDIF
MSANDI = THIS.VALUE
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+THIS.SANDI+"' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX(THIS.NAMA+" Tidak Tersedia")
NODEFAULT
SELECT (OLDSELECT)
RETURN
ENDIF
THISFORM.KET_INSTANSI.VALUE = KETERANGAN
SELECT (OLDSELECT)
ENDFUNC
**
*
*  a_daftar_sandi.scx::marketing
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH THIS.SANDI
THIS.VALUE = MSANDI
ENDIF
MSANDI = THIS.VALUE
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+THIS.SANDI+"' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX(THIS.NAMA+" Tidak Tersedia")
NODEFAULT
SELECT (OLDSELECT)
RETURN
ENDIF
THISFORM.KET_MARKETING.VALUE = KETERANGAN
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE Init
MSANDI = 'P003'
MNAMA = "Kode Sandi"
THIS.ADDPROPERTY("sandi", MSANDI)
THIS.ADDPROPERTY("nama", MNAMA)
THIS.CLEAR
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT00")
THIS.ROWSOURCE = "SMT00"
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.KET_MARKETING.VALUE = KETERANGAN
ENDPROC
**
***
*** a_daftar_sandi.sct
***
*
***
*** anggota_gabung.scx
***
*
*
*  anggota_gabung.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MJENIS
THISFORM.MODE = ""
THISFORM.JENIS = MJENIS
THISFORM.OLDSELECT = SELECT()
IF MJENIS=2
THISFORM.LABEL6.VISIBLE = .T.
THISFORM.TEXT7.VISIBLE = .T.
THISFORM.LABEL5.CAPTION = "ANGSURAN POKOK"
THISFORM.TEXT1.VALUE = '-'
THISFORM.TEXT5.VALUE = "PINJAMAN"
THISFORM.TEXT2.VALUE = JENIS
THISFORM.TEXT3.VALUE = NOREK
THISFORM.TEXT4.VALUE = POT_POKOK
THISFORM.TEXT7.VALUE = POT_BUNGA
CSQL = "select keterangan from setsandi_pinj where sandi='"+JENIS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT6.VALUE = KETERANGAN
USE
SELECT (THISFORM.OLDSELECT)
ELSE
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL5.CAPTION = "SETORAN SIMPANAN"
THISFORM.TEXT1.VALUE = JENIS
THISFORM.TEXT2.VALUE = PRODUK
THISFORM.TEXT3.VALUE = NOREK
THISFORM.TEXT4.VALUE = POT_SIMPANAN
IF JENIS='1'
THISFORM.TEXT5.VALUE = "SIMPANAN"
ELSE
THISFORM.TEXT5.VALUE = "SIMPANAN BERJANGKA"
ENDIF
CSQL = "select keterangan from setsandi_tab where jenis='"+JENIS+"' and sandi='"+PRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT6.VALUE = KETERANGAN
ENDIF
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  anggota_gabung.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_gabung.scx::Command3
**
PROCEDURE Click
IF THISFORM.MODE="INPUT"
CSQL = "insert into anggota (kantor,cif,nama,alamat,desa,kecamatan,kota,ibu,agama) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+THISFORM.TEXT2.VALUE+"',"+"'"+THISFORM.TEXT3.VALUE+"',"+"'"+THISFORM.TEXT4.VALUE+"',"+"'"+THISFORM.TEXT5.VALUE+"',"+"'"+THISFORM.TEXT6.VALUE+"',"+"'"+THISFORM.TEXT7.VALUE+"',"+"'"+THISFORM.TEXT8.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.JENIS=1
CSQL = "update simpanan set pot_simpanan='"+STR(THISFORM.TEXT4.VALUE)+"' where norek='"+THISFORM.TEXT3.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.JENIS=2
CSQL = "update pinjaman set pot_pokok='"+STR(THISFORM.TEXT4.VALUE)+"', pot_bunga='"+STR(THISFORM.TEXT7.VALUE)+"' where norek='"+THISFORM.TEXT3.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_gabung.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** anggota_gabung.sct
***
*
***
*** simpanan_cabut_auto.scx
***
*
*
*  simpanan_cabut_auto.scx::Form1
**
PROCEDURE Init
PARAMETER MTANDA
THISFORM.TANDA = MTANDA
IF MTANDA=1
THISFORM.LABEL1.CAPTION = "CABUT AUTODEBET"
ELSE
THISFORM.LABEL1.CAPTION = "CABUT BLOKIR"
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.AUTOCENTER = .T.
THISFORM.TEXT1.VALUE = TGLNOW
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_cabut_auto.scx::Cmdsimpan1
**
PROCEDURE Click
REPLACE TGLCABUT WITH THISFORM.TEXT1.VALUE
IF THISFORM.TANDA=1
CSQL = "update simpanan_autodebet set tglcabut='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' where idautodebet='"+STR(IDAUTODEBET)+"'"
ELSE
CSQL = "update simpanan_blokir set tglcabut='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' where idblokir='"+STR(IDBLOKIR)+"'"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_cabut_auto.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_cabut_auto.sct
***
*
***
*** simpanan_bunga.scx
***
*
*
*  simpanan_bunga.scx::Form1
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.AUTOCENTER = .T.
LISTBUNGA(NOREK, TGLNOW, 'Y')
WITH THISFORM.GRID1
.RECORDSOURCE = BUNGA
.COLUMNCOUNT = 10
.FONTSIZE = 8
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "DEBET"
.COLUMN3.HEADER1.CAPTION = "DEBET"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.INPUTMASK = "999,999,999,999"
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "KREDIT"
.COLUMN4.HEADER1.CAPTION = "KREDIT"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.INPUTMASK = "999,999,999,999"
.COLUMN5.WIDTH = 90
.COLUMN5.CONTROLSOURCE = "SALDO"
.COLUMN5.HEADER1.CAPTION = "SALDO"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN6.WIDTH = 90
.COLUMN6.CONTROLSOURCE = "HARI"
.COLUMN6.HEADER1.CAPTION = "HARI"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.INPUTMASK = "999"
.COLUMN7.WIDTH = 50
.COLUMN7.CONTROLSOURCE = "RATE"
.COLUMN7.HEADER1.CAPTION = "  %  "
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.INPUTMASK = "99.99"
.COLUMN8.WIDTH = 90
.COLUMN8.CONTROLSOURCE = "BUNGA"
.COLUMN8.HEADER1.CAPTION = "JASA"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.INPUTMASK = "999,999,999,999"
.COLUMN9.WIDTH = 90
.COLUMN9.CONTROLSOURCE = "PAJAK"
.COLUMN9.HEADER1.CAPTION = "PAJAK"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.INPUTMASK = "999,999,999,999"
.COLUMN10.WIDTH = 90
.COLUMN10.CONTROLSOURCE = "BUNGA-PAJAK"
.COLUMN10.HEADER1.CAPTION = "JASA NET"
.COLUMN10.HEADER1.FONTBOLD = .T.
.COLUMN10.INPUTMASK = "999,999,999,999"
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_bunga.scx::Cmdsimpan1
**
PROCEDURE Click
REPLACE TGLCABUT WITH THISFORM.TEXT1.VALUE
IF THISFORM.TANDA=1
CSQL = "update simpanan_autodebet set tglcabut='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' where idautodebet='"+STR(IDAUTODEBET)+"'"
ELSE
CSQL = "update simpanan_blokir set tglcabut='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' where idblokir='"+STR(IDBLOKIR)+"'"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_bunga.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_bunga.sct
***
*
***
*** simp_lap2.scx
***
*
*
*  simp_lap2.scx::FORM1
**
PROCEDURE bacasql
DO CASE
CASE THISFORM.NOMORLAP=1
THISFORM.TGL_LAPORAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
CSQL = "select b.tanggal,a.norek,a.cif,b.*,c.* from simpanan as a left join simpanan_mutasi as b on a.norek=b.norek left join anggota as c on a.cif=c.cif "+" where a.norek='"+THISFORM.NOREK+"' and b.tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and b.tanggal<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca data")
ENDIF
CASE THISFORM.NOMORLAP=2
DEFAKETERANGAN = "TANGGAL : "+URAITGL(THISFORM.TEXT1.VALUE)+" S/D. "+URAITGL(THISFORM.TEXT2.VALUE)
CASE THISFORM.NOMORLAP=3
CASE THISFORM.NOMORLAP=4
ENDCASE
TGLLAPORAN = THISFORM.TGL_LAPORAN
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
OLDSELECT = SELECT()
THISFORM.BAR.WIDTH = 0
THISFORM.NOMORLAP = MKE
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "KANTOR")
IF RECCOUNT()>1
APPEND BLANK
REPLACE SANDI WITH '0000', KETERANGAN WITH "KONSOLIDASI"
IF DEFAKANTOR='0001'
THISFORM.TEXT10.ENABLED = .T.
ENDIF
ENDIF
SELECT (OLDSELECT)
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT10.VALUE = DEFAKANTOR
THISFORM.TEXT11.VALUE = NAMAKANTOR(DEFAKANTOR)
THISFORM.NOREK = NOREK
DO CASE
CASE MKE=1
THISFORM.JUDUL.CAPTION = "CETAK REKENING KORAN"
THISFORM.FRXNAME = "tab_rekkoran.frx"
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=2
CASE MKE=3
CASE MKE=4
ENDCASE
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simp_lap2.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
MTANGGAL1 = THISFORM.TEXT1.VALUE
MTANGGAL2 = THISFORM.TEXT2.VALUE
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  simp_lap2.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simp_lap2.scx::Text1
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  simp_lap2.scx::Text2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simp_lap2.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
REPORT FORM (THISFORM.FRXNAME) PREVIEW
ENDPROC
**
*
*  simp_lap2.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer")
ENDIF
ENDPROC
**
*
*  simp_lap2.scx::Text11
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  simp_lap2.scx::text10
**
PROCEDURE InteractiveChange
THISFORM.TEXT9.VALUE = KETERANGAN
ENDPROC
**
***
*** simp_lap2.sct
***
*
***
*** krd_jadwal.frx
***
*
***
*** krd_jadwal.frt
***
*
***
*** akt_inventaris2.frx
***
*
***
*** akt_inventaris2.frt
***
*
***
*** simpanan_perpanjangan.scx
***
*
*
*  simpanan_perpanjangan.scx::FORM1
**
PROCEDURE bacasql
MNOREK = THISFORM.NOREK
CSQL = "select * from simpanan_bilyet where norek='"+MNOREK+"' order by tanggal desc"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
ENDPROC
**
PROCEDURE tampil
WITH THISFORM.GRID1
.RECORDSOURCE = "SMT"
.COLUMNCOUNT = 7
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 40
.COLUMN1.CONTROLSOURCE = "KE"
.COLUMN1.HEADER1.CAPTION = "KE"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 100
.COLUMN2.CONTROLSOURCE = "TANGGAL"
.COLUMN2.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "POKOK"
.COLUMN3.HEADER1.CAPTION = "POKOK"
.COLUMN3.INPUTMASK = "999,999,999,999"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 40
.COLUMN4.CONTROLSOURCE = "RATE"
.COLUMN4.HEADER1.CAPTION = "RATE"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 70
.COLUMN5.CONTROLSOURCE = "TGLAWAL"
.COLUMN5.HEADER1.CAPTION = "TGL AWAL"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.COLUMN6.WIDTH = 70
.COLUMN6.CONTROLSOURCE = "TGLJTEMPO"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "TGL JTEMPO"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 9
.COLUMN7.WIDTH = 40
.COLUMN7.CONTROLSOURCE = "ARO"
.COLUMN7.ALIGNMENT = 1
.COLUMN7.HEADER1.CAPTION = "ARO"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 9
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK, MNAMA
THISFORM.NAMA = MNAMA
THISFORM.NOREK = MNOREK
THISFORM.OLDDBF = SELECT()
THISFORM.BACASQL()
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE Unload
SELECT SMT
USE
SELECT (THISFORM.OLDDBF)
ENDPROC
**
*
*  simpanan_perpanjangan.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_perpanjangan.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM simpanan_data_bilyet WITH THISFORM.NOREK, THISFORM.NAMA, "TAMPIL"
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM simpanan_data_bilyet WITH THISFORM.NOREK, THISFORM.NAMA, "TAMPIL"
ENDPROC
**
*
*  simpanan_perpanjangan.scx::Command1
**
PROCEDURE Click
DO FORM simpanan_data_bilyet WITH THISFORM.NOREK, THISFORM.NAMA, "INPUT"
ENDPROC
**
*
*  simpanan_perpanjangan.scx::Command2
**
PROCEDURE Click
DO FORM simpanan_data_bilyet WITH THISFORM.NOREK, THISFORM.NAMA, "EDIT"
ENDPROC
**
*
*  simpanan_perpanjangan.scx::Command3
**
PROCEDURE Click
DO FORM simpanan_data_bilyet WITH THISFORM.NOREK, THISFORM.NAMA, "HAPUS"
THISFORM.BACASQL()
THISFORM.TAMPIL()
ENDPROC
**
*
*  simpanan_perpanjangan.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_perpanjangan.sct
***
*
***
*** angg_daftarnama.frx
***
*
***
*** angg_daftarnama.frt
***
*
***
*** neraca1.frx
***
*
***
*** neraca1.frt
***
*
***
*** akt_neraca_lma.frx
***
*
***
*** akt_neraca_lma.frt
***
*
***
*** akt_neraca_lama.frx
***
*
***
*** akt_neraca_lama.frt
***
*
***
*** akt_neraca_psak.frx
***
*
***
*** akt_neraca_psak.frt
***
*
***
*** akt_neraca_etap.frx
***
*
***
*** akt_neraca_etap.frt
***
*
***
*** a1.scx
***
*
*
*  a1.scx::FORM1
**
PROCEDURE Init
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT2.VALUE = TGLNOW
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  a1.scx::Command1
**
PROCEDURE Click
CSQL = "update perkiraan set level=''"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update perkiraan set level='3' where length(TRIM(noper))='8'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select * from perkiraan where level='3'"
LCEK = SQLEXEC(OODBC, CSQL, 'smt')
GOTO TOP
DO WHILE  .NOT. EOF()
MREC = RECNO()
MNOPER = ALLTRIM(NOPER)
PANJANG = LEN(MNOPER)
MLEVEL = 3
FOR A = 1 TO PANJANG
MNOPER = LEFT(MNOPER, LEN(MNOPER)-1)
CSQL = "select * from perkiraan where noper like '"+MNOPER+"%' and level=''"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
DO WHILE  .NOT. EOF()
IF NOPER=MNOPER .AND. LEN(ALLTRIM(NOPER))=LEN(MNOPER)
MLEVEL = MLEVEL-1
CSQL = "update perkiraan set level='"+ALLTRIM(STR(MLEVEL))+"' where TRIM(noper)='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SKIP
ENDDO
ENDFOR
SELECT SMT
SKIP
ENDDO
CSQL = "select * from perkiraan order by noper "
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNOPER = ALLTRIM(NOPER)
MLEVEL = VAL(LEVEL)
SKIP
DO WHILE  .NOT. EOF()
IF LEFT(NOPER, LEN(MNOPER))=MNOPER .AND. LEN(NOPER)>LEN(MNOPER) .AND. EMPTY(LEVEL)
CSQL = "update perkiraan set level='"+ALLTRIM(STR(MLEVEL+1))+"' where noper='"+NOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MLEVEL = VAL(LEVEL)+1
ELSE
IF LEFT(NOPER, LEN(MNOPER))<>MNOPER
MLEVEL = VAL(LEVEL)
MNOPER = ALLTRIM(NOPER)
ENDIF
ENDIF
SKIP
ENDDO
CSQL = "update perkiraan set level='0' where level<>'1' and level<>'2' and level<>'3'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
*
*  a1.scx::Command2
**
PROCEDURE Click
CSQL = "CREATE TABLE acc_transaksi ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kantor` VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"`tanggal` DATE NOT NULL DEFAULT '0000-00-00',"+"`bukti` VARCHAR(10) NOT NULL DEFAULT '0000000000',"+"`keterangan` VARCHAR(50 ) NOT NULL DEFAULT '',"+"`jumlah` double(15,0) NOT NULL DEFAULT '0',"+"`opt` VARCHAR( 5 ) NOT NULL DEFAULT '',"+"`tglacc` DATE NOT NULL DEFAULT '0000-00-00',"+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
*
*  a1.scx::Command3
**
PROCEDURE Click
CSQL = "update perkiraan set level=''"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select * from perkiraan order by noper "
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNOPER = ALLTRIM(NOPER)
MNOPER0 = MNOPER
MLEVEL = 0
SKIP
DO WHILE  .NOT. EOF()
DO CASE
CASE MLEVEL=1
CASE MLEVEL=2
CASE MLEVEL=3
ENDCASE
IF LEFT(NOPER, LEN(MNOPER))=MNOPER .AND. LEN(NOPER)>LEN(MNOPER) .AND. EMPTY(LEVEL)
MNOPER0 = MNOPER
CSQL = "update perkiraan set level='"+ALLTRIM(STR(MLEVEL+1))+"' where noper='"+NOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MLEVEL = VAL(LEVEL)+1
ELSE
IF LEFT(NOPER, LEN(MNOPER))<>MNOPER
MLEVEL = VAL(LEVEL)
MNOPER = ALLTRIM(NOPER)
ENDIF
ENDIF
SKIP
ENDDO
CSQL = "update perkiraan set level='0' where level<>'1' and level<>'2' and level<>'3'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
*
*  a1.scx::Command4
**
PROCEDURE Click
CSQL = "DROP TABLE IF EXISTS `urutnota`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `urutnota` ("+"kantor      VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"statusnomor VARCHAR( 1 ) NOT NULL DEFAULT '0',"+"kas         VARCHAR( 6 ) NOT NULL DEFAULT 'KAS',"+"nomorbukti  VARCHAR( 10 ) NOT NULL DEFAULT '',"+"INDEX ( `kantor` ))"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
ENDPROC
**
*
*  a1.scx::Command5
**
PROCEDURE Click
CSQL = "select noper,SUM(IF(jumlah>0,jumlah,0)) as debet, SUM(if(jumlah>0,0,jumlah)) as kredit from jurnal where tanggal='2015-06-08' group by noper"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
ENDPROC
**
*
*  a1.scx::Command6
**
PROCEDURE Click
CSQL = "mysqldump -h localhost -u root -p 123 >c:\backupku.sql"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("backup gagal")
ENDIF
ENDPROC
**
*
*  a1.scx::Command7
**
PROCEDURE Click
MTGL = TGLNOW
MLEVEL = '1'
MKONSOL = 'T'
MKANTOR = '0002'
MMODEL = 2
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where 1 order by if(kel='NA','01',if(kel='NP','02',kel))"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
IF MKONSOL='Y'
CSQL = "select saldo from neraca_konsol where noper='"+MNOPER+"' and tanggal=(select MAX(tanggal) from neraca_konsol where noper='"+MNOPER+"' and tanggal<='"+SQLDATE(MTGL)+"')"
ELSE
CSQL = "select saldo from neraca where noper='"+MNOPER+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+MKANTOR+"' and noper='"+MNOPER+"' and tanggal<='"+SQLDATE(MTGL)+"')"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "aa1")
MSALDO = SALDO
USE
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO LEVEL<=MLEVEL
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
CREATE CURSOR NERACA (TGLCETAK DATE, RL C (1), ANOPER C (10), ANAMA C (30), AJUMLAH N (15), AFONT C (1), ALEVEL C (1), AKELDATA C (2), AKEL C (4), PNOPER C (10), PNAMA C (30), PJUMLAH N (15), PFONT C (1), PLEVEL C (1), PKELDATA C (2), PKEL C (4))
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
IF KELDATA<>'NA'
EXIT
ENDIF
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
REPLACE ANOPER WITH AA.NOPER, ANAMA WITH MNAMA, AJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
REPLACE AFONT WITH AA.FONT, ALEVEL WITH AA.LEVEL, AKELDATA WITH AA.KELDATA, AKEL WITH AA.KEL
IF AA.FONT='+'
APPEND BLANK
ENDIF
SELECT AA
SKIP
ENDDO
SELECT NERACA
GOTO TOP
SELECT AA
DO WHILE  .NOT. EOF()
IF KELDATA<>"NP"
EXIT
ENDIF
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
ENDIF
REPLACE PNOPER WITH AA.NOPER, PNAMA WITH MNAMA, PJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO), PFONT WITH AA.FONT
REPLACE PLEVEL WITH AA.LEVEL, PKELDATA WITH AA.KELDATA, PKEL WITH AA.KEL
IF AA.FONT='+'
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
ELSE
SKIP
ENDIF
SKIP
ENDIF
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
ELSE
SKIP
ENDIF
SELECT AA
SKIP
ENDDO
SELECT NERACA
GOTO BOTTOM
MREKRL = RECNO()
MPERTAMA = .T.
MJUMLAH1 = 0
MJUMLAH2 = 0
MJUMLAH3 = 0
JLEVEL = 0
JDATA = 0
SELECT AA
DO WHILE  .NOT. EOF()
IF KELDATA<>'AD'
EXIT
ENDIF
SKIP
ENDDO
DO WHILE  .NOT. EOF()
IF LEFT(KELDATA, 1)>'1'
EXIT
ENDIF
IF LEVEL>'0' .AND. LEVEL<'9'
MJUMLAH1 = MJUMLAH1+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH2 = MJUMLAH2+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH3 = MJUMLAH3+IIF(ISNULL(SALDO), 0, SALDO)
ENDIF
JLEVEL = JLEVEL+IIF(KEL='RA' .OR. KEL='RP', 1, 0)
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
MFNT = IIF(LEVEL='0', 'B', FONT)
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANOPER WITH AA.NOPER, ANAMA WITH MNAMA, AJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
REPLACE AFONT WITH MFNT, ALEVEL WITH AA.LEVEL, AKEL WITH AA.KEL
IF AA.FONT='+'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ENDIF
SELECT AA
MKELDATA = KELDATA
MNAMA = NAMA
JDATA = JDATA+1
SKIP
IF .T.
IF MKELDATA='11' .AND. AA.KELDATA<>'11'
IF JDATA>3
MPERTAMA = .F.
JLEVEL = 0
SELECT NERACA
DO CASE
CASE MMODEL=1
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANAMA WITH 'PELAYANAN BRUTO ANGGOTA', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
CASE MMODEL=2
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANAMA WITH 'TOTAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
OTHERWISE
ENDCASE
MJUMLAH1 = 0
ENDIF
JDATA = 0
ENDIF
IF MKELDATA='12' .AND. AA.KELDATA<>'12'
IF JDATA>3
MPERTAMA = .F.
JLEVEL = 0
SELECT NERACA
DO CASE
CASE MMODEL=1
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANAMA WITH 'BEBAN POKOK PELAYANAN', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
CASE MMODEL=2
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANAMA WITH 'BEBAN BUNGA ', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
OTHERWISE
ENDCASE
MJUMLAH1 = 0
ENDIF
JDATA = 0
ENDIF
IF LEFT(MKELDATA, 1)='1' .AND. LEFT(AA.KELDATA, 1)<>'1'
MPERTAMA = .F.
JLEVEL = 0
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
DO CASE
CASE MMODEL=1
REPLACE ANAMA WITH 'PELAYANAN NETTO ANGGOTA', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
CASE MMODEL=2
REPLACE ANAMA WITH 'PENDAPATAN DAN BEBAN OPERASIONAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
OTHERWISE
REPLACE ANAMA WITH 'TOTAL PENDAPATAN OPERASIOANAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
ENDCASE
MJUMLAH1 = 0
ENDIF
ENDIF
SELECT AA
ENDDO
SELECT NERACA
GOTO MREKRL
SKIP
SELECT AA
DO WHILE  .NOT. EOF()
IF LEVEL>'0' .AND. LEVEL<'9'
MJUMLAH1 = MJUMLAH1+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH2 = MJUMLAH2+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH3 = MJUMLAH3+IIF(ISNULL(SALDO), 0, SALDO)
ENDIF
MNAMA = IIF(LEN(ALLTRIM(AA.NOPER))<4, "", SPACE((LEN(ALLTRIM(AA.NOPER))-4)*2))+AA.NAMA
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
MFNT = IIF(LEVEL='0', 'B', FONT)
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ENDIF
REPLACE PNOPER WITH AA.NOPER, PNAMA WITH MNAMA, PJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO), PFONT WITH MFNT, PLEVEL WITH AA.LEVEL, PKEL WITH AA.KEL
IF AA.FONT='+'
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
SKIP
ENDIF
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
SELECT AA
MKELDATA = KELDATA
SKIP
IF LEFT(MKELDATA, 1)='2' .AND. LEFT(AA.KELDATA, 1)<>'2'
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'TOTAL BEBAN OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'JUMLAH BEBAN OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'TOTAL PENDAPATAN OPERASIONAL ', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'SHU OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'LABA (RUGI) OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'LABA / RUGI OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
ENDIF
IF LEFT(MKELDATA, 1)='3' .AND. LEFT(AA.KELDATA, 1)<>'3'
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'PENDAPATAN DAN BEBAN NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'JUMLAH PENDAPATAN DAN BEBAN NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'LABA/RUGI NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'SHU SEBELUM PAJAK', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'LABA (RUGI) SEBELUM PAJAK PENGHASILAN', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'LABA / RUGI SEBELUM PAJAK', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
ENDIF
SELECT AA
ENDDO
SELECT NERACA
IF RECCOUNT()=RECNO() .OR. EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'SHU SETELAH PAJAK', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'LABA (RUGI) NETTO', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'LABA / RUGI SETELAH PAJAK', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
SELECT NERACA
BROWSE
ENDPROC
**
*
*  a1.scx::Command8
**
PROCEDURE Click
CSQL = "select template1 from set_print where 1 into outfile 'c:\test.doc'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
CTEMPLATE1 = CAST(TEMPLATE1 AS W )
ENDPROC
**
***
*** a1.sct
***
*
***
*** akt_labarugi_puak.frx
***
*
***
*** akt_labarugi_puak.frt
***
*
***
*** akt_labarugi1.frx
***
*
***
*** akt_labarugi1.frt
***
*
***
*** akt_labarugi_lama.frx
***
*
***
*** akt_labarugi_lama.frt
***
*
***
*** anggota_edit.scx
***
*
*
*  anggota_edit.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = CIF_SMT
THISFORM.TEXT4.VALUE = CIF_SMT
ENDPROC
**
*
*  anggota_edit.scx::simpan
**
PROCEDURE Click
MIDDATA = IDDATA
CSQL = "update anggota set cif_smt='"+THISFORM.TEXT4.VALUE+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_edit.scx::batal
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** anggota_edit.sct
***
*
***
*** krd_npl_kel.frx
***
*
***
*** krd_npl_kel.frt
***
*
***
*** krd_rekap_npl.frx
***
*
***
*** krd_rekap_npl.frt
***
*
***
*** kas_nonkasharian.frx
***
*
***
*** kas_nonkasharian.frt
***
*
***
*** delete.bmp
***
*
***
*** contact2.bmp
***
*
***
*** bank 4.png
***
*
***
*** loan.png
***
*
***
*** pictures check.bmp
***
*
***
*** delete.ico
***
*
***
*** print.png
***
*
***
*** documents.bmp
***
*
***
*** coins.png
***
*
***
*** bank 2 account.png
***
*
***
*** ok.bmp
***
*
***
*** undo.bmp
***
*
***
*** user1.bmp
***
*
***
*** user_add.png
***
*
***
*** contact delete.bmp
***
*
***
*** contact edit 2.bmp
***
*
***
*** contact add.bmp
***
*
***
*** reload.png
***
*
***
*** rewind.png
***
*
***
*** cari2.jpg
***
*
***
*** compose1.png
***
*
***
*** search.png
***
*
***
*** back.png
***
*
***
*** forward.png
***
*
***
*** user wizard.png
***
*
***
*** user.png
***
*
***
*** simpan.png
***
*
***
*** document-library.png
***
*
***
*** money.ico
***
*
***
*** order-149.png
***
*
***
*** safe.png
***
*
***
*** paste.png
***
*
***
*** tangan2.cur
***
*
***
*** edit.png
***
*
***
*** chek.bmp
***
*
***
*** loan delete .png
***
*
***
*** loan edit 1.png
***
*
***
*** loan add .png
***
*
***
*** keluar.ico
***
*
***
*** publish.png
***
*
***
*** spreadsheet.png
***
*
***
*** billing.png
***
*
***
*** loan car.png
***
*
***
*** spreadsheet total.png
***
*
***
*** pr_open.bmp
***
*
***
*** profile_edit.png
***
*
***
*** cancel.ico
***
*
***
*** windows automatic.bmp
***
*
***
*** credit.png
***
*
***
*** edit2.png
***
*
***
*** cut.bmp
***
*
***
*** cascade.png
***
*
***
*** cascade1.png
***
*
***
*** new_page.png
***
*
***
*** laporan.ico
***
*
***
*** clipboard delete.bmp
***
*
***
*** clipboard edit 2.bmp
***
*
***
*** clipboard.bmp
***
*
***
*** report delete.bmp
***
*
***
*** report edit 2.bmp
***
*
***
*** report add.bmp
***
*
***
*** new.bmp
***
*
***
*** edit.bmp
***
*
***
*** refresh.bmp
***
*
***
*** exit.bmp
***
*
***
*** delete_16x16.ico
***
*
***
*** spreadsheet total check.png
***
*
***
*** config.png
***
*
***
*** edit1.png
***
*
***
*** panels1.png
***
*
***
*** bank user add.png
***
*
***
*** bank user edit 1.png
***
*
***
*** bank user delete.png
***
*
***
*** group_add.png
***
*
***
*** edit.ico
***
*
***
*** bank teller add.png
***
*
***
*** bank teller edit 2.png
***
*
***
*** bank teller delete.png
***
*
***
*** key.ico
***
*
***
*** bank teller 2.png
***
*
***
*** bank 4 add.png
***
*
***
*** scale.png
***
*
***
*** proses_tahunan.scx
***
*
*
*  proses_tahunan.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  proses_tahunan.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  proses_tahunan.scx::Command3
**
PROCEDURE Click
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  proses_tahunan.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** proses_tahunan.sct
***
*
***
*** bank 4 delete.png
***
*
***
*** cut1.png
***
*
***
*** bank 4 edit 1.png
***
*
***
*** plan.bmp
***
*
***
*** save.png
***
*
***
*** terra.ico
***
*
***
*** previous.bmp
***
*
***
*** next.bmp
***
*
***
*** kop_kb.jpg
***
*
***
*** 2.png
***
*
***
*** copy of drag1pg.ico
***
*
***
*** group_remove.png
***
*
***
*** printer.png
***
*
***
*** calculator.png
***
*
***
*** message_remove.png
***
*
***
*** message_edit.png
***
*
***
*** message_add.png
***
*
***
*** image_add.png
***
*
***
*** addfrx.ico
***
*
***
*** portrait.bmp
***
*
***
*** portrait.msk
***
*
***
*** landscape.bmp
***
*
***
*** landscape.msk
***
*
***
*** pr_print.bmp
***
*
***
*** preview1.bmp
***
*
***
*** pr_excel.bmp
***
*
***
*** undo1.bmp
***
*
***
*** cari3.jpg
***
*
***
*** compose.png
***
*
***
*** contacts.png
***
*
***
*** fast_forward.png
***
*
***
*** fast_forward1.png
***
*
***
*** rewind1.png
***
*
***
*** delete1.bmp
***
*
***
*** reply_all.png
***
*
***
*** reply_all1.png
***
*
***
*** search1.png
***
*
***
*** contacts1.png
***
*
***
*** cut.png
***
*
***
*** new_page1.png
***
*
***
*** panels.png
***
*
***
*** chek1.bmp
***
*
***
*** read.png
***
*
***
*** read1.png
***
*
***
*** print1.png
***
*
***
*** proses1.png
***
*
***
*** reload1.png
***
*
***
*** save1.png
***
*
***
*** mysql0.jpg
***
*
***
*** mysql1.jpg
***
*
***
*** tool.png
***
*
***
*** tool1.png
***
*
***
*** check_send.png
***
*
***
*** page.png
***
*
***
*** cash_register.png
***
*
***
*** pr_search.bmp
***
*
***
*** cari_format_lap.scx
***
*
*
*  cari_format_lap.scx::Form1
**
PROCEDURE tampil
MDATA = THISFORM.MYDATA
THISFORM.GRID1.RECORDSOURCE = MDATA
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 2
.COLUMN1.WIDTH = 250
.COLUMN1.CONTROLSOURCE = "TEMPLATE_ID"
.COLUMN1.HEADER1.CAPTION = "NAMA LAPORAN"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 400
.COLUMN2.CONTROLSOURCE = "PENJELASAN"
.COLUMN2.HEADER1.CAPTION = "DESKRIPSI"
.COLUMN2.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
ENDPROC
**
PROCEDURE Init
PARAMETER MTYPE
MJUDUL = "Cari Format Laporan"
THISFORM.MYDATA = SYS(2015)
MDATA = THISFORM.MYDATA
THISFORM.LABEL2.CAPTION = MJUDUL
THISFORM.SHAPE1.BACKCOLOR = DEFAWARNAKOP1
THISFORM.BACKCOLOR = DEFAWARNABODY1
THISFORM.SHAPE2.BACKCOLOR = DEFAWARNAKOP1
THISFORM.COMBO1.VALUE = "NAMA LAPORAN"
CSQL = "SELECT * from man_atur_print where kdbank=?defakdbank and opt_type=?mtype"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<0
MESSAGEBOX("tidak bisa baca")
ENDIF
THISFORM.TOP = 280
THISFORM.LEFT = 400
THISFORM.TAMPIL
ENDPROC
**
FUNCTION Unload
MDATA = THISFORM.MYDATA
SELECT &MDATA
USE
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
ENDPROC
**
*
*  cari_format_lap.scx::Text1
**
PROCEDURE InteractiveChange
LOCATE FOR LEFT(UPPER(TEMPLATE_ID), LEN(THIS.VALUE))=THIS.VALUE
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDIF
IF NKEYCODE=24
NODEFAULT
KEYBOARD '{DNARROW}'
THISFORM.GRID1.SETFOCUS
ENDIF
ENDPROC
**
*
*  cari_format_lap.scx::Combo1
**
PROCEDURE GotFocus
KEYBOARD '{DNARROW}'
KEYBOARD '{DNARROW}'
ENDPROC
**
*
*  cari_format_lap.scx::Grid1
**
PROCEDURE DblClick
THISFORM.MYPILIH = TEMPLATE_ID
THISFORM.RELEASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDIF
IF NKEYCODE=13
THISFORM.MYPILIH = TEMPLATE_ID
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  cari_format_lap.scx::Cmdoke
**
PROCEDURE Click
THISFORM.MYPILIH = TEMPLATE_ID
THISFORM.RELEASE
ENDPROC
**
*
*  cari_format_lap.scx::Cmdbatal
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
***
*** cari_format_lap.sct
***
*
***
*** application.ico
***
*
***
*** export.ico
***
*
***
*** a_test.frx
***
*
***
*** a_test.frt
***
*
***
*** set_kantor.scx
***
*
*
*  set_kantor.scx::Form1
**
PROCEDURE bacasql
MCURSOR = THISFORM.DATA
CSQL = "SELECT sandi, keterangan FROM setsandi WHERE kantor = 'ID' AND kode = 'KNT'"
LCEK = SQLEXEC(OODBC, CSQL, MCURSOR)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampil
MDATA = THISFORM.DATA
THISFORM.GRID1.RECORDSOURCE = MDATA
WITH THISFORM.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 2
.COLUMN1.WIDTH = 80
.COLUMN1.CONTROLSOURCE = "SANDI"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "KD KANTOR"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 350
.COLUMN2.CONTROLSOURCE = "KETERANGAN"
.COLUMN2.HEADER1.CAPTION = "NAMA KANTOR"
.COLUMN2.HEADER1.FONTBOLD = .T.
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
ENDPROC
**
PROCEDURE tampil2
MDATA = THISFORM.DATA
SELECT (MDATA)
THISFORM.TEXT1.VALUE = SANDI
THISFORM.TEXT2.VALUE = KETERANGAN
ENDPROC
**
FUNCTION Unload
MCURSOR = THISFORM.DATA
SELECT (MCURSOR)
MPILIH = SANDI
USE
RETURN MPILIH
ENDFUNC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDOKE.VISIBLE = .F.
THISFORM.DATA = SYS(2015)
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  set_kantor.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDIF
IF NKEYCODE=13
THISFORM.MYPILIH = SANDI
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  set_kantor.scx::Cmdoke
**
PROCEDURE Click
IF THISFORM.MODE='INSERT'
MREG = BUATREGISTER()
CSQL = "insert into setsandi (kantor,kode,sandi,keterangan,ket2) value ("+"'ID','KNT','"+THISFORM.TEXT1.VALUE+"','"+THISFORM.TEXT2.VALUE+"','"+MREG+"')"
ELSE
CSQL = "update setsandi set sandi='"+THISFORM.TEXT1.VALUE+"' ,keterangan='"+THISFORM.TEXT2.VALUE+"' where kantor='ID' and kode='KNT' and sandi='"+SANDI+"'"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF THISFORM.MODE="INSERT"
CSQL = "insert into batastanggal (kantor,tglawal,tglakhir) value ('"+THISFORM.TEXT1.VALUE+"','"+SQLDATE(TGLNOW)+"','"+SQLDATE(TGLNOW)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDINPUT.VISIBLE = .T.
THISFORM.CMDINPUT1.VISIBLE = .T.
THISFORM.CMDOKE.VISIBLE = .F.
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
THISFORM.GRID1.SETFOCUS
ENDPROC
**
*
*  set_kantor.scx::Cmdbatal
**
PROCEDURE Click
THISFORM.CMDBATAL.VISIBLE = .F.
THISFORM.CMDBATAL1.VISIBLE = .T.
THISFORM.CMDINPUT.VISIBLE = .T.
THISFORM.CMDINPUT1.VISIBLE = .T.
THISFORM.CMDOKE.VISIBLE = .F.
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
ENDPROC
**
*
*  set_kantor.scx::Cmdinput
**
PROCEDURE Click
THISFORM.MODE = 'INSERT'
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDOKE.VISIBLE = .T.
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THIS.VISIBLE = .F.
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.CMDINPUT1.VISIBLE = .F.
THISFORM.TEXT1.VALUE = ''
THISFORM.TEXT2.VALUE = ''
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  set_kantor.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  set_kantor.scx::Cmdinput1
**
PROCEDURE Click
THISFORM.MODE = 'EDIT'
THISFORM.CMDBATAL.VISIBLE = .T.
THISFORM.CMDOKE.VISIBLE = .T.
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THIS.VISIBLE = .F.
THISFORM.CMDINPUT.VISIBLE = .F.
THISFORM.CMDINPUT1.VISIBLE = .T.
THISFORM.CMDBATAL1.VISIBLE = .F.
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
***
*** set_kantor.sct
***
*
***
*** akt_invent_mutasi.frx
***
*
***
*** akt_invent_mutasi.frt
***
*
***
*** gl_inventaris_proses.scx
***
*
*
*  gl_inventaris_proses.scx::FORM1
**
PROCEDURE bacasql
MNOMOR = THISFORM.MODE
IF MNOMOR="ALL"
CSQL = "select *,if(penyusutan>nilaibuku,nilaibuku-1,penyusutan) as susut from gl_inventaris where nilaibuku>1"
ELSE
CSQL = "select *,if(penyusutan>nilaibuku,nilaibuku-1,penyusutan) as susut from gl_inventaris where nilaibuku>1 and nomorid='"+MNOMOR+"'"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
ENDPROC
**
PROCEDURE tampil
MYDATA = THISFORM.DATA1
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 5
.BACKCOLOR = RGB(230, 255, 230)
.FONTSIZE = 9
.COLUMN1.WIDTH = 50
.COLUMN1.CONTROLSOURCE = "NOMORID"
.COLUMN1.HEADER1.CAPTION = "NO.INVENT"
.COLUMN2.WIDTH = 130
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "HARGA"
.COLUMN3.INPUTMASK = "999,999,999,999"
.COLUMN3.HEADER1.CAPTION = "HARGA PEROLEHAN"
.COLUMN4.WIDTH = 50
.COLUMN4.CONTROLSOURCE = "LAMA"
.COLUMN4.INPUTMASK = "99999"
.COLUMN4.HEADER1.CAPTION = "MUTASI KREDIT"
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "SUSUT"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.HEADER1.CAPTION = "PENYUSUTAN"
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOMORID
THISFORM.MODE = MNOMORID
THISFORM.BACASQL()
THISFORM.TAMPIL()
ENDPROC
**
*
*  gl_inventaris_proses.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_proses.scx::Command3
**
PROCEDURE Click
WITH THISFORM
IF THISFORM.MODE="INPUT"
CSQL = "insert into gl_inventaris (kantor,kode,nama,tanggal,harga,gol,lama,penyusutan,akumulasi,nilaibuku,tglmutasi,keterangan) value "+"('"+DEFAKANTOR+"',"+"'"+.TEXT41.VALUE+"',"+"'"+.TEXT42.VALUE+"',"+"'"+SQLDATE(.TEXT1.VALUE)+"',"+"'"+STR(.TEXT2.VALUE)+"',"+"'"+.TEXT3.VALUE+"',"+"'"+STR(.TEXT4.VALUE)+"',"+"'"+STR(.TEXT5.VALUE)+"',"+"'"+STR(.TEXT6.VALUE)+"',"+"'"+STR(.TEXT7.VALUE)+"',"+"'"+SQLDATE(.TEXT8.VALUE)+"',"+"'"+.TEXT9.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "update gl_inventaris set "+"kode='"+.TEXT41.VALUE+"',"+"nama='"+.TEXT42.VALUE+"',"+"tanggal='"+SQLDATE(.TEXT1.VALUE)+"',"+"harga='"+STR(.TEXT2.VALUE)+"',"+"gol='"+.TEXT3.VALUE+"',"+"lama='"+STR(.TEXT4.VALUE)+"',"+"penyusutan='"+STR(.TEXT5.VALUE)+"',"+"akumulasi='"+STR(.TEXT6.VALUE)+"',"+"nilaibuku='"+STR(.TEXT7.VALUE)+"',"+"tglmutasi='"+SQLDATE(.TEXT8.VALUE)+"',"+"keterangan='"+.TEXT9.VALUE+"' where nomor='"+STR(THISFORM.MNOMOR)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDWITH
THISFORM.RELEASE
ENDPROC
**
*
*  gl_inventaris_proses.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_proses.scx::Text42
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_proses.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_proses.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_inventaris_proses.scx::Text3
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** gl_inventaris_proses.sct
***
*
***
*** register.scx
***
*
*
*  register.scx::FORM1
**
PROCEDURE tampil
DO CASE
CASE DEFAREGSTAT="1"
MKET = "Hak Pakai"
CASE DEFAREGSTAT="2"
MKET = "Uji Coba Dengan Waktu Terbatas"
CASE DEFAREGSTAT="3"
MKET = "Sewa Program & Full Maintenance Sampai Dengan : "+DTOC(DEFAREGTGLJT)
ENDCASE
THISFORM.EDIT1.VALUE = "TERIMA KASIH"+CHR(13)+CHR(13)+'Terimakasih, Anda telah menggunakan program dari kami '+CHR(13)+'"TERRA COMPUTER"'+CHR(13)+"Jl. Raya Secang - Temanggung Km 0.5 Secang Magelang"+CHR(13)+"Jika dalam penggunaannya terdapat Bug, atau Kekurangan baik tampilan, data maupun pelaporan "+"bisa disampaikan ke Email : imron_magelang@yahoo.co.id"+CHR(13)+"SALAM & SUKSES"+CHR(13)+CHR(13)+"Program ini terinstall dengan Mode :"+CHR(13)+MKET+CHR(13)+"Dengan Nomor Program :"+DEFAREGKANTOR+CHR(13)+"Untuk melakukan regristrasi ulang harap minta nomor Regristrasi yang baru, dan isikan pada kolom regristrasi dbawah"+CHR(13)+"trimakasih"
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 1
IF VARTYPE(DEFAREGKANTOR)<>"C"
DEFAREGKANTOR = ""
ENDIF
IF VARTYPE(DEFAREGSTAT)<>"C"
DEFAREGSTAT = "2"
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.TAMPIL()
ENDPROC
**
*
*  register.scx::Command1
**
PROCEDURE Click
MKODE = THISFORM.CONTAINER1.TEXT1.VALUE
MDEFAREGKANTOR = DEFAREGKANTOR
MDEFAREGASET = DEFAREGASET
MDEFAREGTGLJT = DEFAREGTGLJT
MDEFAREGSTAT = DEFAREGSTAT
BACAREGISTER(MKODE)
MSALAH = .F.
IF MDEFAREGKANTOR<>DEFAREGKANTOR
MESSAGEBOX(MDEFAREGKANTOR)
MESSAGEBOX(DEFAREGKANTOR)
MESSAGEBOX("Register tidak sesuai")
MSALAH = .T.
ENDIF
IF MSALAH
DEFAREGKANTOR = MDEFAREGKANTOR
DEFAREGASET = MDEFAREGASET
DEFAREGTGLJT = MDEFAREGTGLJT
DEFAREGSTAT = MDEFAREGSTAT
MESSAGEBOX("Register Salah", 16, "")
RETURN
ENDIF
CSQL = "update setsandi set ket2='"+THISFORM.CONTAINER1.TEXT1.VALUE+"' where kantor='ID' and "+"kode='KNT' and sandi='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
THISFORM.TAMPIL()
MESSAGEBOX("Regristrasi Program telah di update", 64)
ENDPROC
**
*
*  register.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** register.sct
***
*
***
*** reg_insert.scx
***
*
*
*  reg_insert.scx::FORM1
**
PROCEDURE Init
SET PROCEDURE TO d:\_myproject\kop1\prg\pros
ENDPROC
**
*
*  reg_insert.scx::Text1
**
PROCEDURE InteractiveChange
THISFORM.TEXT2.VALUE = 500000+(INT(THIS.VALUE/1000000000)*50000)
ENDPROC
**
*
*  reg_insert.scx::Text3
**
PROCEDURE InteractiveChange
THISFORM.TEXT4.VALUE = INT(THIS.VALUE/THISFORM.TEXT2.VALUE)
ENDPROC
**
*
*  reg_insert.scx::Text6
**
PROCEDURE InteractiveChange
IF THIS.VALUE=1
THISFORM.TEXT7.VALUE = "Jual Putus"
ENDIF
IF THIS.VALUE=2
THISFORM.TEXT7.VALUE = "Trial"
ENDIF
IF THIS.VALUE=3
THISFORM.TEXT7.VALUE = "Sewa Program & maintenance"
ENDIF
IF THIS.VALUE=3
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.TEXT3.ENABLED = .T.
THISFORM.TEXT4.ENABLED = .T.
ELSE
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT3.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .F.
ENDIF
ENDPROC
**
*
*  reg_insert.scx::Command1
**
PROCEDURE Click
MTGL = TGLNOW
FOR A = 1 TO THISFORM.TEXT4.VALUE
MTGL = MAJU1BLN(MTGL)
ENDFOR
MREG = BUATREGISTER(THISFORM.TEXT5.VALUE, THISFORM.TEXT6.VALUE, THISFORM.TEXT4.VALUE, MTGL)
THISFORM.TEXT8.VALUE = TRANSFORM(MREG, '@R !!!!-!!!!-!!!!')
BACAREGISTER(MREG)
ENDPROC
**
***
*** reg_insert.sct
***
*
***
*** reg_habis.scx
***
*
*
*  reg_habis.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
DO CASE
CASE MKE=1
MEDIT = "MAAF, PROGRAM AKAN SEGERA KAMI BLOKIR,"+CHR(13)+"KARENA TELAH TERJADI PERUBAHAN REGRISTRASI YANG TIDAK WAJAR"+CHR(13)+"KEMBALIKAN SEPERTI SEMULA ATAU SEGERA HUBUNGI KAMI"+CHR(13)+"TERIMA KASIH"
CASE MKE=2
MEDIT = "MASA UJICOBA PROGRAM SUDAH HABIS PADA ,"+CHR(13)+"TANGGAL : "+DTOC(DEFAREGTGLJT)+CHR(13)+"SEGERA LAKUKAN REGRISTRASI"+CHR(13)+"SEBELUM PROGRAM BERHENTI DENGAN SENDIRINYA"+CHR(13)+"TERIMA KASIH "
OTHERWISE
MEDIT = "PROGRAM INI SUDAH MENDEKATI BATAS AKTIF,"+CHR(13)+"PADA TANGGAL : "+DTOC(DEFAREGTGLJT)+CHR(13)+"SEGERA LAKUKAN REGRISTRASI ULANG"+CHR(13)+"SEBELUM PROGRAM BERHENTI DENGAN SENDIRINYA"+CHR(13)+"TERIMA KASIH "
ENDCASE
THISFORM.EDIT1.VALUE = MEDIT
ENDPROC
**
*
*  reg_habis.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** reg_habis.sct
***
*
***
*** col_bayar_data_angsuran.scx
***
*
*
*  col_bayar_data_angsuran.scx::Form1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MKOLEKTOR, MBULAN, MTAHUN
THISFORM.MODE = MMODE
THISFORM.KOLEKTOR = MKOLEKTOR
THISFORM.TEXT41.VALUE = MBULAN
THISFORM.TEXT3.VALUE = MTAHUN
THISFORM.TEXT1.ENABLED = .T.
THISFORM.SHAPE5.WIDTH = 0
IF MMODE="HAPUS"
THISFORM.SHAPE8.BACKCOLOR = RGB(255, 125, 125)
THISFORM.LABEL17.CAPTION = "BATAL TAGIHAN KOLEKTIF"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 0, 0)
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Command3
**
PROCEDURE Click
IF THISFORM.MODE="INSERT"
CSQL = "select * from pinjaman where tgllunas='0000-00-00' and kelompok='"+THISFORM.TEXT1.VALUE+"' "
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
JUMREC = RECCOUNT()
DO WHILE  .NOT. EOF()
THISFORM.SHAPE5.WIDTH = (RECNO()/JUMREC)*442
MCIF = CIF
CSQL = "select nama from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
MNAMA = NAMA
USE
CSQL = "select produk,norek,pot_simpanan from simpanan where tgltutup='0000-00-00' and cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
JUMREK1 = RECCOUNT()
CSQL = "select jenis,norek,pot_pokok,pot_bunga from pinjaman where tglLunas='0000-00-00' and cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT2")
JUMREK2 = RECCOUNT()
JUM = MAX(JUMREK1, JUMREK2)
FOR A = 1 TO JUM
MKE = ALLTRIM(STR(A))
MSIMSUKA&MKE=0
MREKSUKA&MKE=""
MSIMMAPAN&MKE=0
MREKMAPAN&MKE=""
MANGPK&MKE=0
MANGBG&MKE=0
MREKPINJ&MKE="" 
ENDFOR
SELECT SMT1
MSIMSUKA = 0
MSIMMAPAN = 0
A = 0
B = 0
KE = 1
DO WHILE  .NOT. EOF()
MKE = ALLTRIM(STR(KE))
IF PRODUK='4'
A = A+1
VA = ALLTRIM(STR(A))
MSIMSUKA&VA=POT_SIMPANAN
MREKSUKA&VA=NOREK
ENDIF
IF PRODUK='5'
B = B+1
VB = ALLTRIM(STR(B))
MSIMMAPAN&VB=POT_SIMPANAN
MREKMAPAN&VB=NOREK
ENDIF
KE = MAX(A, B)
SKIP
ENDDO
USE
SELECT SMT2
KE = 1
MMAXPINJ = 0
DO WHILE  .NOT. EOF()
MKE = ALLTRIM(STR(KE))
MANGPK&MKE=POT_POKOK
MANGBG&MKE=POT_BUNGA
MREKPINJ&MKE=NOREK
MMAXPINJ = KE
KE = KE+1
SKIP
ENDDO
USE
SELECT SMT
IF JUM>=1
CSQL = "insert into col_bayar (kantor,kode,instansi,bln,tahun,noangg,nama,"+"simpokok,simwajib,simsuka,mapan,lain,ket,rate,pokok,bulan,"+"jw,angpokok,angbunga,jmlpotongan) value "
FOR A = 1 TO JUM
IF A=1
MWAJIB = DEFANOMIWAJIB
ELSE
MWAJIB = 0
ENDIF
MKE = ALLTRIM(STR(A))
CSQL=CSQL+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+ STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+ CIF+"','"+MNAMA+"','"+STR(0)+"','"+STR(MWAJIB)+"','"+STR(MSIMSUKA&MKE)+"','"+ STR(MSIMMAPAN&MKE)+"','"+STR(0)+"','"+""+"','"+STR(RATE)+"','"+ STR(POKOK)+"','"+"0"+"','"+STR(LAMA)+"','"+STR(MANGPK&MKE)+"','"+ STR(MANGBG&MKE)+"','"+STR(MANGPK&MKE+MANGBG&MKE)+"'), "
ENDFOR
CSQL = LEFT(CSQL, LEN(CSQL)-2)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert data")
XSQL = CSQL
RETURN
ENDIF
ENDIF
SKIP
ENDDO
ENDIF
IF THISFORM.MODE="HAPUS"
CSQL = "DELETE from col_bayar where kantor='"+DEFAKANTOR+"' and bln='"+STR(THISFORM.TEXT41.VALUE)+"'and tahun='"+STR(THISFORM.TEXT3.VALUE)+"' and "+"kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("PEMBATALAN TAGIHAN GAGAL DILAKUKAN", 0, "")
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text1
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text2
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text4
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text5
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text6
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text7
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text8
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text9
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text10
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text11
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text12
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text13
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text14
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text15
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text16
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text17
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text18
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_bayar_data_angsuran.scx::Text19
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** col_bayar_data_angsuran.sct
***
*
***
*** add1.ico
***
*
***
*** proses_bulanan.scx
***
*
*
*  proses_bulanan.scx::Form1
**
PROCEDURE Init
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
*
*  proses_bulanan.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  proses_bulanan.scx::Command3
**
PROCEDURE Click
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  proses_bulanan.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** proses_bulanan.sct
***
*
***
*** pr_gear.bmp
***
*
***
*** pr_new.bmp
***
*
***
*** pr_clean.bmp
***
*
***
*** ts.scx
***
*
*
*  ts.scx::frmTS
**
PROCEDURE editentry
LOCAL LCCMD, LCTYPE, LCFILE, LCMETHOD, LCCLASS, LNPOS, LCPROP, LNPOS, LNLEN, LCOBJ
LCCMD = ""
SELECT CRSFOUND
IF EOF()
RETURN
ENDIF
LCTYPE = ALLTRIM(UPPER(CRSFOUND.CTYPE))
LCFILE = ALLTRIM(CRSFOUND.MFILE)
LCMETHOD = ALLTRIM(CRSFOUND.MPROC)
LCPROP = ALLTRIM(CRSFOUND.CPROP)
LCCLASS = ALLTRIM(MCLASS)
LCOBJ = ""
LNPOS = AT(".", LCCLASS)
IF LNPOS>0
LCOBJ = SUBSTR(LCCLASS, LNPOS+1)
LCCLASS = SUBSTR(LCCLASS, 1, LNPOS-1)
ELSE
LCOBJ = ""
ENDIF
DO CASE
CASE LCTYPE=="SCX"
LCCMD = 'MODIFY FORM "'+LCFILE+'" NOWAIT'
IF  .NOT. EMPTY(LCMETHOD) .AND.  .NOT. (LCMETHOD=ALLTRIM(THIS.CPROPERTYTEXT))
IF  .NOT. EMPTY(LCOBJ)
LCMETHOD = LCOBJ+"."+LCMETHOD
ENDIF
LCCMD = LCCMD+' METHOD '+LCMETHOD
ENDIF
CASE LCTYPE=="VCX"
LCCMD = 'MODIFY CLASS '+LCCLASS+' OF '+LCFILE+' NOWAIT'
IF  .NOT. EMPTY(LCMETHOD) .AND.  .NOT. (LCMETHOD=ALLTRIM(THIS.CPROPERTYTEXT))
IF  .NOT. EMPTY(LCOBJ)
LCMETHOD = LCOBJ+"."+LCMETHOD
ENDIF
LCCMD = LCCMD+' METHOD '+LCMETHOD
ENDIF
CASE LCTYPE=="FRX"
LCCMD = 'MODIFY REPORT "'+LCFILE+'" NOWAIT'
CASE LCTYPE=="MNX"
LCCMD = 'MODIFY MENU "'+LCFILE+'" NOWAIT'
CASE LCTYPE=="PRG"
LNPOS = VAL(LCPROP)
LNLEN = LEN(ALLTRIM(THIS.CSEARCHTEXT))
LCCMD = 'MODIFY COMMAND "'+LCFILE+'" RANGE '+TRANSFORM(LNPOS)+', '+TRANSFORM(LNPOS+LNLEN)+' NOWAIT '
OTHERWISE
LNPOS = VAL(LCPROP)
LNLEN = LEN(ALLTRIM(THIS.CSEARCHTEXT))
LCCMD = 'MODIFY FILE"'+LCFILE+'" RANGE '+TRANSFORM(LNPOS)+', '+TRANSFORM(LNPOS+LNLEN)+' NOWAIT '
ENDCASE
&LCCMD
THIS.SHOW()
RETURN
ENDPROC
**
PROCEDURE readconfig
LOCAL LNSELECT, LADIR[1]
LNSELECT = SELECT(0)
USE IN SELECT("crsPathConfig")
IF ADIR(LADIR, THIS.CCONFIGFILE)=0
CREATE CURSOR crsPathConfig (CTYPE C (8), CPATH C (120))
ELSE
XMLTOCURSOR(THIS.CCONFIGFILE, "crsPathConfig", 0516)
ENDIF
SELECT (LNSELECT)
RETURN
ENDPROC
**
PROCEDURE writeconfig
LOCAL LNSELECT, LCSAFETY
LNSELECT = SELECT(0)
SELECT CRSPATHCONFIG
LCSAFETY = SET("SAFETY")
SET SAFETY OFF
CURSORTOXML("crsPathConfig", THIS.CCONFIGFILE, 1, 0516)
IF LCSAFETY=="ON"
SET SAFETY ON
ENDIF
SELECT (LNSELECT)
RETURN
ENDPROC
**
PROCEDURE enablesearch
LOCAL LLTEXT, LLPATH
LLTEXT =  .NOT. EMPTY(THIS.CSEARCHTEXT) .OR.  .NOT. EMPTY(THIS.PGFSEARCH.PGSEARCH.CNTSEARCH.TXTSEARCH.VALUE)
LLPATH = (RECCOUNT("crsPathConfig")>0)
THIS.PGFSEARCH.PGSEARCH.CNTSEARCH.CMDRUNSEARCH.ENABLED = LLTEXT .AND. LLPATH
RETURN
ENDPROC
**
PROCEDURE csearchtext_assign
LPARAMETERS TCSTR
THIS.CSEARCHTEXT = TCSTR
THIS.ENABLESEARCH()
RETURN
ENDPROC
**
PROCEDURE runsearch
LOCAL LNRECS, LCSAFETY
LCSAFETY = SET("SAFETY")
SET SAFETY OFF
SELECT CRSFOUND
ZAP
IF LCSAFETY=="ON"
SET SAFETY ON
ENDIF
SELECT CRSPATHCONFIG
SCAN
THIS.SCANDIR(ALLTRIM(CTYPE), ALLTRIM(CPATH))
ENDSCAN
SELECT CRSFOUND
LOCATE
LNRECS = RECCOUNT()
DO CASE
CASE LNRECS=0
THIS.CRESULTTEXT = "No Results Found"
CASE LNRECS=1
THIS.CRESULTTEXT = "There was 1 match found"
OTHERWISE
THIS.CRESULTTEXT = "There were "+TRANSFORM(LNRECS)+" matches found"
ENDCASE
WITH THIS.PGFSEARCH
.ACTIVEPAGE = .PGRESULTS.PAGEORDER
.REFRESH()
ENDWITH
RETURN
ENDPROC
**
PROCEDURE addtopath
LOCAL LCPATH, LCTYPE
WITH THIS.PGFSEARCH.PGSEARCH.CNTSEARCH
LCTYPE = ALLTRIM(.CBOTYPE.VALUE)
LCPATH = ALLTRIM(.TXTPATH.VALUE)
IF  .NOT. EMPTY(LCTYPE) .AND.  .NOT. EMPTY(LCPATH)
SELECT CRSPATHCONFIG
LOCATE FOR (ALLTRIM(CTYPE)==LCTYPE) .AND. (ALLTRIM(CPATH)==LCPATH)
IF FOUND()
MESSAGEBOX("That Path/Type combination is already in your search path", 0, "Duplicate Entry")
RETURN
ENDIF
INSERT INTO crsPathConfig (CTYPE, CPATH) VALUES (LCTYPE, LCPATH)
.LSTPATHS.REQUERY()
THIS.WRITECONFIG()
THIS.ENABLESEARCH()
ENDIF
ENDWITH
RETURN
ENDPROC
**
PROCEDURE selectdir
LOCAL LCDIR
LCDIR = GETDIR(CURDIR(), "Select the new directory", "New Search Directory")
IF  .NOT. EMPTY(LCDIR)
THIS.PGFSEARCH.PGSEARCH.CNTSEARCH.TXTPATH.VALUE = LCDIR
ENDIF
RETURN
ENDPROC
**
PROCEDURE removepath
SELECT CRSPATHCONFIG
WITH THIS
IF  .NOT. EOF() .AND.  .NOT. BOF()
DELETE
.PGFSEARCH.PGSEARCH.CNTSEARCH.LSTPATHS.REQUERY()
ENDIF
.WRITECONFIG()
.ENABLESEARCH()
ENDWITH
RETURN
ENDPROC
**
PROCEDURE scandir
LPARAMETERS TCTYPE, TCPATH
LOCAL LNSELECT, LCPATH, LCSTR, LNMEMO, LNDIR, LADIR[1], LNCNT
LNSELECT = SELECT(0)
LNMEMO = SET("MEMOWIDTH")
SET MEMOWIDTH TO 1024
LCSTR = ALLTRIM(THIS.CSEARCHTEXT)
LCPATH = ADDBS(TCPATH)
WAIT WINDOW NOWAIT "Processing "+JUSTPATH(LCPATH)
DO CASE
CASE TCTYPE="*"
THIS.SCANVCX(LCPATH, LCSTR)
THIS.SCANSCX(LCPATH, LCSTR)
THIS.SCANFRX(LCPATH, LCSTR)
THIS.SCANMNX(LCPATH, LCSTR)
THIS.SCANPRG(LCPATH, LCSTR)
THIS.SCANTEXT(LCPATH, LCSTR, .T.)
CASE TCTYPE="VCX"
THIS.SCANVCX(LCPATH, LCSTR)
CASE TCTYPE="SCX"
THIS.SCANSCX(LCPATH, LCSTR)
CASE TCTYPE="FRX"
THIS.SCANFRX(LCPATH, LCSTR)
CASE TCTYPE="MNX"
THIS.SCANMNX(LCPATH, LCSTR)
CASE TCTYPE="PRG"
THIS.SCANPRG(LCPATH, LCSTR)
CASE INLIST(TCTYPE, "TXT", "H", "LOG")
THIS.SCANTEXT(LCPATH, LCSTR, .F., TCTYPE)
OTHERWISE
THIS.SCANTEXT(LCPATH, LCSTR)
ENDCASE
IF THISFORM.LRECURSE
LNDIR = ADIR(LADIR, LCPATH+"*.", "D")
FOR LNCNT = 1 TO LNDIR
IF (LADIR(LNCNT, 1)==".") .OR. (LADIR(LNCNT, 1)=="..") .OR. (LADIR(LNCNT, 1)=="CVS")
LOOP
ENDIF
THIS.SCANDIR(TCTYPE, LCPATH+LADIR(LNCNT, 1))
ENDFOR
ENDIF
SELECT (LNSELECT)
RETURN
ENDPROC
**
FUNCTION fulltrim
LPARAMETERS TCSTR
LOCAL LCRETVAL
LCRETVAL = ALLTRIM(TCSTR)
DO WHILE LEFT(LCRETVAL, 1)$" "+CHR(9)
LCRETVAL = SUBSTR(LCRETVAL, 2)
ENDDO
DO WHILE RIGHT(LCRETVAL, 1)$" "+CHR(9)
LCRETVAL = SUBSTR(LCRETVAL, 1, LEN(LCRETVAL)-1)
ENDDO
RETURN LCRETVAL
ENDFUNC
**
PROCEDURE insertfoundrecord
LPARAMETERS TCPATH, TCFILE, TCTYPE, TCPROC, TCCLASS, TCPARENT, TNLINE, TCLINE, TCPROPERTY
LOCAL LCCLASS
IF  .NOT. EMPTY(TCPARENT)
LCCLASS = TCPARENT+"."+TCCLASS
ELSE
LCCLASS = TCCLASS
ENDIF
INSERT INTO crsFound (MFILE, CTYPE, MPROC, ILINE, MCLASS, CLINE, CPROP, CFILENAME, CDIRECTORY, CWHERE, CPROC) VALUES (TCPATH+TCFILE, TCTYPE, TCPROC, TNLINE, LCCLASS, LEFT(TCLINE, 100), TCPROPERTY, TCFILE, TCPATH, LEFT(LCCLASS, 100), TCPROC)
RETURN
ENDPROC
**
PROCEDURE newsearch
WITH THIS.PGFSEARCH
.ACTIVEPAGE = .PGSEARCH.PAGEORDER
.REFRESH()
ENDWITH
RETURN
ENDPROC
**
PROCEDURE scanscx
LPARAMETERS TCPATH, TCSTR
LOCAL LCPROP, LCLINE, LNLINE, LCPARENT, LCOBJNAME, LCFILE, LNEQPOS, LCMETHOD, LNPROCLINE, LNCNT, LNDIR, LCTYPE, LADIR[1]
LCTYPE = "SCX"
LNDIR = ADIR(LADIR, TCPATH+"*."+LCTYPE)
FOR LNCNT = 1 TO LNDIR
LCFILE = LADIR(LNCNT, 1)
SELECT 0
USE NOUPDATE (TCPATH+LCFILE) AGAIN ALIAS LIB
SCAN FOR  .NOT. DELETED()
LNLINE = ATCLINE(TCSTR, LIB.METHODS)
IF LNLINE>0
LCLINE = MLINE(LIB.METHODS, LNLINE)
IF  .NOT. THIS.LEXCLUDECOMMENTS .OR.  .NOT. THIS.ISCOMMENT(LCLINE)
LNPROCLINE = LNLINE
LCMETHOD = THIS.GETPRIORLINE(LIB.METHODS, "PROCEDURE ", LNLINE)
LCOBJNAME = ALLTRIM(OBJNAME)
LCPARENT = ALLTRIM(PARENT)
IF EMPTY(LCMETHOD)
LCMETHOD = "unknown"
ENDIF
LCLINE = THIS.FULLTRIM(LCLINE)
THIS.INSERTFOUNDRECORD(TCPATH, LCFILE, LCTYPE, LCMETHOD, LCOBJNAME, LCPARENT, LNLINE, LCLINE, "")
ENDIF
ENDIF
LNLINE = ATCLINE(TCSTR, LIB.PROPERTIES)
IF LNLINE>0
LCLINE = MLINE(LIB.PROPERTIES, LNLINE)
LNEQPOS = AT("=", LCLINE)
LCOBJNAME = ALLTRIM(OBJNAME)
LCPARENT = ALLTRIM(PARENT)
LCPROP = IIF(LNEQPOS>1, THIS.FULLTRIM(LEFT(LCLINE, LNEQPOS-1)), "unknown")
LCLINE = THIS.FULLTRIM(LCLINE)
THIS.INSERTFOUNDRECORD(TCPATH, LCFILE, LCTYPE, THIS.CPROPERTYTEXT, LCOBJNAME, LCPARENT, LNLINE, LCLINE, LCPROP)
ENDIF
ENDSCAN
USE
ENDFOR
RETURN
ENDPROC
**
PROCEDURE scanvcx
LPARAMETERS TCPATH, TCSTR
LOCAL LCPROP, LCLINE, LNLINE, LCPARENT, LCOBJNAME, LCFILE, LNEQPOS, LCMETHOD, LNPROCLINE, LNCNT, LNDIR, LCTYPE, LADIR[1]
LCTYPE = "VCX"
LNDIR = ADIR(LADIR, TCPATH+"*."+LCTYPE)
FOR LNCNT = 1 TO LNDIR
LCFILE = LADIR(LNCNT, 1)
SELECT 0
USE NOUPDATE (TCPATH+LCFILE) AGAIN ALIAS LIB
SCAN FOR  .NOT. DELETED()
LNLINE = ATCLINE(TCSTR, LIB.METHODS)
IF LNLINE>0
LCLINE = MLINE(LIB.METHODS, LNLINE)
IF  .NOT. THIS.LEXCLUDECOMMENTS .OR.  .NOT. THIS.ISCOMMENT(LCLINE)
LNPROCLINE = LNLINE
LCMETHOD = THIS.GETPRIORLINE(LIB.METHODS, "PROCEDURE ", LNLINE)
IF EMPTY(LCMETHOD)
LCMETHOD = "unknown"
ENDIF
LCOBJNAME = ALLTRIM(OBJNAME)
LCPARENT = ALLTRIM(PARENT)
LCLINE = THIS.FULLTRIM(LCLINE)
THIS.INSERTFOUNDRECORD(TCPATH, LCFILE, LCTYPE, LCMETHOD, LCOBJNAME, LCPARENT, LNLINE, LCLINE, "")
ENDIF
ENDIF
LNLINE = ATCLINE(TCSTR, LIB.PROPERTIES)
IF LNLINE>0
LCLINE = MLINE(LIB.PROPERTIES, LNLINE)
LNEQPOS = AT("=", LCLINE)
LCOBJNAME = ALLTRIM(OBJNAME)
LCPARENT = ALLTRIM(PARENT)
LCPROP = IIF(LNEQPOS>1, THIS.FULLTRIM(LEFT(LCLINE, LNEQPOS-1)), "unknown")
LCLINE = THIS.FULLTRIM(LCLINE)
THIS.INSERTFOUNDRECORD(TCPATH, LCFILE, LCTYPE, THIS.CPROPERTYTEXT, LCOBJNAME, LCPARENT, LNLINE, LCLINE, LCPROP)
ENDIF
ENDSCAN
USE
ENDFOR
RETURN
ENDPROC
**
PROCEDURE scanfrx
LPARAMETERS TCPATH, TCSTR
LOCAL LCTYPE, LNDIR, LCSTR, LCFILE, LCOBJNAME, LCLINE, LNCNT, LADIR[1]
LCTYPE = "FRX"
LNDIR = ADIR(LADIR, TCPATH+"*."+LCTYPE)
LCSTR = UPPER(TCSTR)
FOR LNCNT = 1 TO LNDIR
LCFILE = LADIR(LNCNT, 1)
SELECT 0
USE NOUPDATE (TCPATH+LCFILE) AGAIN ALIAS REP
SCAN FOR  .NOT. DELETED() .AND. ((LCSTR$UPPER(REP.EXPR)) .OR. (LCSTR$UPPER(REP.SUPEXPR)) .OR. (LCSTR$UPPER(REP.NAME)))
IF OBJTYPE=18
LCOBJNAME = ALLTRIM(NAME)
LCLINE = "Report Variable;  Value = "+THIS.FULLTRIM(EXPR)
ELSE
LCOBJNAME = IIF(REP.OBJTYPE=5, "Label", IIF(REP.OBJTYPE=8, "Field", "??"))+";  position: V = "+ALLTRIM(TRANSFORM(VPOS, "999999.999"))+", H = "+ALLTRIM(TRANSFORM(HPOS, "999999.999"))
DO CASE
CASE (LCSTR$UPPER(REP.EXPR))
LCLINE = ['expression' = ]+ALLTRIM(EXPR)
CASE (LCSTR$UPPER(REP.SUPEXPR))
LCLINE = ['print when' = ]+ALLTRIM(SUPEXPR)
OTHERWISE
LCLINE = ""
ENDCASE
ENDIF
THIS.INSERTFOUNDRECORD(TCPATH, LCFILE, LCTYPE, "", LCOBJNAME, "", 0, LCLINE, "")
ENDSCAN
USE
ENDFOR
RETURN
ENDPROC
**
PROCEDURE scanprg
LPARAMETERS TCPATH, TCSTR
LOCAL LCTYPE, LNDIR, LCUPSTR, LNCNT, LCTEXT, LCUPTEXT, LNCURRLINE, LCPATH, LNLINE, LCLINE, LAPROCINFO[1], LNPROCS, LNPROC, LNPOS, LNCURRPOS, LCMETHOD, LCCLASS, LNTEXTLEN, LCFILE, LADIR[1]
LCTYPE = "PRG"
LNDIR = ADIR(LADIR, TCPATH+"*."+LCTYPE)
LCUPSTR = UPPER(TCSTR)
LCPATH = ADDBS(TCPATH)
LCCLASS = ""
FOR LNCNT = 1 TO LNDIR
LCFILE = LADIR(LNCNT, 1)
LCTEXT = FILETOSTR(LCPATH+LCFILE)
LCUPTEXT = UPPER(LCTEXT)
LNCURRLINE = 0
LNCURRPOS = 0
LNPROCS = APROCINFO(LAPROCINFO, LCPATH+LCFILE, 2)
LNLINE = ATLINE(LCUPSTR, LCUPTEXT)
DO WHILE LNLINE>0
LNPOS = AT(LCUPSTR, LCUPTEXT)
LNCURRPOS = LNCURRPOS+LNPOS
LNCURRLINE = LNCURRLINE+LNLINE
LCLINE = MLINE(LCTEXT, LNLINE)
IF  .NOT. THIS.LEXCLUDECOMMENTS .OR.  .NOT. THIS.ISCOMMENT(LCLINE)
LCMETHOD = ""
FOR LNPROC = 1 TO LNPROCS
IF LNCURRLINE>LAPROCINFO(LNPROC, 2)
LCMETHOD = LAPROCINFO(LNPROC, 1)
ELSE
EXIT
ENDIF
ENDFOR
THIS.INSERTFOUNDRECORD(TCPATH, LCFILE, LCTYPE, LCMETHOD, LCCLASS, "", LNCURRLINE, LCLINE, TRANSFORM(LNCURRPOS))
ENDIF
LCTEXT = SUBSTR(LCTEXT, LNPOS+1)
LNCURRPOS = LNCURRPOS+1
LNPOS = 1
LNTEXTLEN = LEN(LCTEXT)
DO WHILE (SUBSTR(LCTEXT, LNPOS, 1)<>CHR(13)) .AND. (LNPOS<=LNTEXTLEN)
LNPOS = LNPOS+1
LNCURRPOS = LNCURRPOS+1
ENDDO
IF SUBSTR(LCTEXT, LNPOS+1, 1)==CHR(10)
LNPOS = LNPOS+1
LNCURRPOS = LNCURRPOS+1
ENDIF
LCTEXT = SUBSTR(LCTEXT, LNPOS+1)
LCUPTEXT = UPPER(LCTEXT)
LNLINE = ATLINE(LCUPSTR, LCUPTEXT)
ENDDO
ENDFOR
RETURN
ENDPROC
**
PROCEDURE scanmnx
LPARAMETERS TCPATH, TCSTR
LOCAL LCTYPE, LNDIR, LCSTR, LCFILE, LCOBJNAME, LCLINE, LNCNT, LADIR[1]
LCTYPE = "MNX"
LNDIR = ADIR(LADIR, TCPATH+"*."+LCTYPE)
LCSTR = UPPER(TCSTR)
FOR LNCNT = 1 TO LNDIR
LCFILE = LADIR(LNCNT, 1)
SELECT 0
USE NOUPDATE (TCPATH+LCFILE) AGAIN ALIAS MNU
SCAN FOR  .NOT. DELETED() .AND. ((LCSTR$UPPER(MNU.PROCEDURE)) .OR. (LCSTR$UPPER(MNU.COMMENT)) .OR. (LCSTR$UPPER(MNU.SKIPFOR)) .OR. (LCSTR$UPPER(MNU.CLEANUP)) .OR. (LCSTR$UPPER(MNU.SETUP)) .OR. (LCSTR$UPPER(MNU.MESSAGE)) .OR. (LCSTR$UPPER(MNU.COMMAND)) .OR. (LCSTR$UPPER(MNU.PROMPT)) .OR. (LCSTR$UPPER(MNU.NAME)))
IF VAL(MNU.ITEMNUM)=0
LCOBJNAME = MNU.NAME
ELSE
LCOBJNAME = 'Item #'+ALLTRIM(ITEMNUM)+' of '+MNU.LEVELNAME+';  Prompt = "'+PROMPT+'"'
ENDIF
DO CASE
CASE (LCSTR$UPPER(MNU.PROCEDURE))
LCLINE = THIS.FULLTRIM(MLINE(MNU.PROCEDURE, ATCLINE(LCSTR, UPPER(MNU.PROCEDURE))))
CASE (LCSTR$UPPER(MNU.COMMENT))
LCLINE = ['Comment' = ]+ALLTRIM(MNU.COMMENT)
CASE (LCSTR$UPPER(MNU.SKIPFOR))
LCLINE = ['Skip For' = ]+ALLTRIM(MNU.SKIPFOR)
CASE (LCSTR$UPPER(MNU.CLEANUP))
LCLINE = ['Cleanup code' = ]+THIS.FULLTRIM(MLINE(MNU.CLEANUP, ATCLINE(LCSTR, UPPER(MNU.CLEANUP))))
CASE (LCSTR$UPPER(MNU.SETUP))
LCLINE = ['Setup code' = ]+THIS.FULLTRIM(MLINE(MNU.SETUP, ATCLINE(LCSTR, UPPER(MNU.SETUP))))
CASE (LCSTR$UPPER(MNU.MESSAGE))
LCLINE = ['Message' = ]+ALLTRIM(MNU.MESSAGE)
CASE (LCSTR$UPPER(MNU.COMMAND))
LCLINE = ['Command' = ]+ALLTRIM(MNU.COMMAND)
CASE (LCSTR$UPPER(MNU.PROMPT))
LCLINE = ['Prompt' = ]+ALLTRIM(MNU.PROMPT)
CASE (LCSTR$UPPER(MNU.NAME))
LCLINE = ['Name' = ]+ALLTRIM(MNU.NAME)
OTHERWISE
LCLINE = ""
ENDCASE
IF  .NOT. THIS.LEXCLUDECOMMENTS .OR.  .NOT. THIS.ISCOMMENT(LCLINE)
THIS.INSERTFOUNDRECORD(TCPATH, LCFILE, LCTYPE, "", LCOBJNAME, "", 0, LCLINE, "")
ENDIF
ENDSCAN
USE
ENDFOR
RETURN
ENDPROC
**
FUNCTION getpriorline
LPARAMETERS TCTEXT, TCSTR, TNSTARTLINE, TLANYWHERE
LOCAL LNLINE, LCRETVAL, LCORIGLINE, LNPOS, LNSTRLEN, LCSTR, LLFOUND, LCLINE, LCTEXT
LCRETVAL = ""
LNLINE = TNSTARTLINE
LCTEXT = UPPER(TCTEXT)
LCSTR = UPPER(TCSTR)
LNSTRLEN = LEN(LCSTR)
DO WHILE (LNLINE>0)
LCLINE = THIS.FULLTRIM(MLINE(LCTEXT, LNLINE))
IF TLANYWHERE
LLFOUND = (LCSTR$LCLINE)
ELSE
LLFOUND = (LEFT(LCLINE, LNSTRLEN)==LCSTR)
ENDIF
IF LLFOUND
LCORIGLINE = THIS.FULLTRIM(MLINE(TCTEXT, LNLINE))
LNPOS = AT(LCSTR, LCLINE)
LCRETVAL = SUBSTR(LCORIGLINE, LNPOS+LNSTRLEN)
EXIT
ENDIF
LNLINE = LNLINE-1
ENDDO
RETURN LCRETVAL
ENDFUNC
**
FUNCTION iscomment
LPARAMETERS TCSTR
LOCAL LCSTR, LLRETVAL
LLRETVAL = .F.
LCSTR = TCSTR
DO WHILE LEFT(LCSTR, 1)$" "+CHR(9)
LCSTR = SUBSTR(LCSTR, 2)
ENDDO
IF (LEFT(LCSTR, 1)=="*") .OR. (UPPER(LEFT(LCSTR, 4))=="NOTE")
LLRETVAL = .T.
ENDIF
RETURN LLRETVAL
ENDFUNC
**
PROCEDURE scantext
LPARAMETERS TCPATH, TCSTR, TLALL, TCTYPE
LOCAL LCTYPE, LNDIR, LCUPSTR, LNCNT, LCTEXT, LCUPTEXT, LNCURRLINE, LCPATH, LNLINE, LCLINE, LNPOS, LNCURRPOS, LNTEXTLEN, LCFILE, LADIR[1]
IF  .NOT. TLALL
LCTYPE = TCTYPE
ELSE
LCTYPE = "*"
ENDIF
LNDIR = ADIR(LADIR, TCPATH+"*."+LCTYPE)
LCUPSTR = UPPER(TCSTR)
LCPATH = ADDBS(TCPATH)
FOR LNCNT = 1 TO LNDIR
LCFILE = LADIR(LNCNT, 1)
IF TLALL
IF INLIST(JUSTEXT(LCFILE), "SCX", "VCX", "PRG", "FRX", "MNX", "SCT", "VCT", "FXP", "FRT", "MNT")
LOOP
ENDIF
ENDIF
IF LADIR(LNCNT, 2)>5000000
LOOP
ENDIF
LCTEXT = FILETOSTR(LCPATH+LCFILE)
LCUPTEXT = UPPER(LCTEXT)
LNCURRLINE = 0
LNCURRPOS = 0
LNLINE = ATLINE(LCUPSTR, LCUPTEXT)
DO WHILE LNLINE>0
LNPOS = AT(LCUPSTR, LCUPTEXT)
LNCURRPOS = LNCURRPOS+LNPOS
LNCURRLINE = LNCURRLINE+LNLINE
LCLINE = MLINE(LCTEXT, LNLINE)
IF  .NOT. THIS.LEXCLUDECOMMENTS .OR.  .NOT. THIS.ISCOMMENT(LCLINE)
THIS.INSERTFOUNDRECORD(TCPATH, LCFILE, LCTYPE, "", "", "", LNCURRLINE, LCLINE, TRANSFORM(LNCURRPOS))
ENDIF
LCTEXT = SUBSTR(LCTEXT, LNPOS+1)
LNCURRPOS = LNCURRPOS+1
LNPOS = 1
LNTEXTLEN = LEN(LCTEXT)
DO WHILE (SUBSTR(LCTEXT, LNPOS, 1)<>CHR(13)) .AND. (LNPOS<=LNTEXTLEN)
LNPOS = LNPOS+1
LNCURRPOS = LNCURRPOS+1
ENDDO
IF SUBSTR(LCTEXT, LNPOS+1, 1)==CHR(10)
LNPOS = LNPOS+1
LNCURRPOS = LNCURRPOS+1
ENDIF
LCTEXT = SUBSTR(LCTEXT, LNPOS+1)
LCUPTEXT = UPPER(LCTEXT)
LNLINE = ATLINE(LCUPSTR, LCUPTEXT)
ENDDO
ENDFOR
RETURN
ENDPROC
**
PROCEDURE loadconfig
LOCAL LCFILE
LCFILE = GETFILE("tsg", "File to Load", "Load", 0, "Select the TS configuration file to load")
IF  .NOT. EMPTY(LCFILE)
XMLTOCURSOR(LCFILE, "crsPathConfig", 512)
THIS.PGFSEARCH.PGSEARCH.CNTSEARCH.LSTPATHS.REQUERY()
ENDIF
RETURN
ENDPROC
**
PROCEDURE saveconfig
LOCAL LCFILE
LCFILE = PUTFILE("Enter the name for the saved file", "Default.tsg", "tsg")
IF  .NOT. EMPTY(LCFILE)
SELECT CRSPATHCONFIG
CURSORTOXML("crsPathConfig", LCFILE, 1, 512)
ENDIF
RETURN
ENDPROC
**
PROCEDURE Resize
WITH THIS.PGFSEARCH
.HEIGHT = THIS.HEIGHT
.WIDTH = THIS.WIDTH
ENDWITH
WITH THIS.CMDEXIT
.TOP = THIS.HEIGHT-33
.LEFT = THIS.WIDTH-90
ENDWITH
THIS.PGFSEARCH.RESIZE()
RETURN
ENDPROC
**
PROCEDURE Load
THIS.NORIGAREA = SELECT(0)
CREATE CURSOR crsPathConfig (CTYPE C (8), CPATH C (120))
CREATE CURSOR crsFound (MFILE M, CTYPE C (3), MPROC M, ILINE I, MCLASS M, CLINE C (100), CMETHOD C (24), CPROP C (24), CFILENAME C (24), CDIRECTORY C (24), CWHERE C (100), CPROC C (24))
RETURN
ENDPROC
**
PROCEDURE Init
THIS.CSETDELETED = SET("Deleted")
SET DELETED ON
THIS.READCONFIG()
RETURN
ENDPROC
**
PROCEDURE Destroy
THIS.WRITECONFIG()
USE IN SELECT("crsPathConfig")
USE IN SELECT("crsFound")
IF THIS.CSETDELETED=="OFF"
SET DELETED OFF
ENDIF
SELECT (THIS.NORIGAREA)
RETURN
ENDPROC
**
*
*  ts.scx::pgfSearch
**
PROCEDURE Resize
THIS.PGSEARCH.CNTSEARCH.RESIZE()
THIS.PGRESULTS.CNTRESULTS.RESIZE()
RETURN
ENDPROC
**
PROCEDURE Init
WITH THIS
.TABS = .F.
STORE 0 TO .TOP, .LEFT
.WIDTH = THISFORM.WIDTH
.HEIGHT = THISFORM.HEIGHT-THISFORM.NBOTTOMBORDER
ENDWITH
RETURN
ENDPROC
**
*
*  ts.scx::cntSearch
**
PROCEDURE Resize
LOCAL LOPF
LOPF = THIS.PARENT.PARENT
THIS.TOP = (LOPF.HEIGHT-THIS.HEIGHT)/2
THIS.LEFT = (LOPF.WIDTH-THIS.WIDTH)/2
RETURN
ENDPROC
**
*
*  ts.scx::txtSearch
**
PROCEDURE InteractiveChange
THISFORM.ENABLESEARCH()
RETURN
ENDPROC
**
PROCEDURE UIEnable
LPARAMETERS LENABLE
IF LENABLE
WITH THIS
.SETFOCUS()
.SELSTART = 0
.SELLENGTH = 999
ENDWITH
ENDIF
RETURN
ENDPROC
**
*
*  ts.scx::cmdRunSearch
**
PROCEDURE Click
THISFORM.RUNSEARCH()
RETURN
ENDPROC
**
*
*  ts.scx::cmdRemovePath
**
PROCEDURE Click
THISFORM.REMOVEPATH()
RETURN
ENDPROC
**
*
*  ts.scx::cmdAddPath
**
PROCEDURE Click
THISFORM.ADDTOPATH()
RETURN
ENDPROC
**
*
*  ts.scx::cmdGetDir
**
PROCEDURE Click
THISFORM.SELECTDIR()
RETURN
ENDPROC
**
*
*  ts.scx::cmdLoadConfig
**
PROCEDURE Click
THISFORM.LOADCONFIG()
RETURN
ENDPROC
**
*
*  ts.scx::cmdSaveConfig
**
PROCEDURE Click
THISFORM.SAVECONFIG()
RETURN
ENDPROC
**
*
*  ts.scx::cntResults
**
PROCEDURE Resize
LOCAL LOPF, LNWD, LNHT
LOPF = THIS.PARENT.PARENT
THIS.TOP = 0
THIS.LEFT = 0
THIS.HEIGHT = LOPF.HEIGHT
THIS.WIDTH = LOPF.WIDTH
LNHT = THIS.HEIGHT
LNWD = THIS.WIDTH
WITH THIS.GRDCRSFOUND
.LEFT = 0
.TOP = 0
.WIDTH = LNWD
.HEIGHT = LNHT-75
ENDWITH
WITH THIS.LBLLINE
.TOP = LNHT-64
ENDWITH
WITH THIS.TXTLINE
.TOP = LNHT-66
.WIDTH = LNWD-160
ENDWITH
WITH THIS.TXTRESULTS
.TOP = LNHT-45
.WIDTH = LNWD-127
ENDWITH
WITH THIS.CMDNEWSEARCH
.TOP = LNHT-60
.LEFT = LNWD-91
ENDWITH
RETURN
ENDPROC
**
*
*  ts.scx::grdCrsfound
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THIS.PARENT.REFRESH()
RETURN
ENDPROC
**
*
*  ts.scx::cmdEdit
**
PROCEDURE Click
THISFORM.EDITENTRY()
RETURN
ENDPROC
**
*
*  ts.scx::txtLine
**
FUNCTION When
RETURN .F.
ENDFUNC
**
*
*  ts.scx::cmdNewSearch
**
PROCEDURE Click
THISFORM.NEWSEARCH()
RETURN
ENDPROC
**
*
*  ts.scx::txtResults
**
FUNCTION When
RETURN .F.
ENDFUNC
**
*
*  ts.scx::cmdExit
**
PROCEDURE Click
THISFORM.RELEASE()
RETURN
ENDPROC
**
***
*** ts.sct
***
*
***
*** myclassbutton.vcx
***
*
*
*  myclassbutton.vcx::cmddetail
**
PROCEDURE Init
THIS.VISIBLE = .T.
ENDPROC
**
*
*  myclassbutton.vcx::cmdedit
**
PROCEDURE Init
THIS.VISIBLE = .T.
ENDPROC
**
*
*  myclassbutton.vcx::cmdexit
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  myclassbutton.vcx::cmdexport
**
PROCEDURE Click
CFILENAME = PUTFILE("Nama File", "sqlresult", "txt;dbf;csv;xls;wk1")
IF AT("DBF", ALLTRIM(CFILENAME))<>0
COPY TO (CFILENAME)
ENDIF
IF AT("TXT", ALLTRIM(CFILENAME))<>0
COPY TO (CFILENAME) SDF
ENDIF
IF AT("CSV", ALLTRIM(CFILENAME))<>0
COPY TO (CFILENAME) CSV
ENDIF
IF AT("XLS", ALLTRIM(CFILENAME))<>0
COPY TO (CFILENAME) XLS
ENDIF
IF AT("WK1", ALLTRIM(CFILENAME))<>0
COPY TO (CFILENAME) WK1
ENDIF
ENDPROC
**
*
*  myclassbutton.vcx::cmdhapus
**
PROCEDURE Init
THIS.VISIBLE = .T.
ENDPROC
**
*
*  myclassbutton.vcx::cmdinput
**
PROCEDURE Init
THIS.VISIBLE = .T.
ENDPROC
**
*
*  myclassbutton.vcx::cmdmutasi
**
PROCEDURE Init
THIS.VISIBLE = .T.
ENDPROC
**
*
*  myclassbutton.vcx::cmdprint
**
PROCEDURE Init
THIS.VISIBLE = .T.
ENDPROC
**
*
*  myclassbutton.vcx::cmdproses
**
PROCEDURE Init
THIS.VISIBLE = .T.
ENDPROC
**
*
*  myclassbutton.vcx::cmdrefresh
**
PROCEDURE RightClick
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
***
*** myclassbutton.vct
***
*
***
*** calc.bmp
***
*
***
*** col_instansi_rekap.scx
***
*
*
*  col_instansi_rekap.scx::Form1
**
PROCEDURE Init
PARAMETER MBULAN, MTAHUN, MKDCOL, MCOLNAME, MINST, MINSTNAME
THISFORM.TEXT41.VALUE = MBULAN
THISFORM.TEXT16.VALUE = MTAHUN
THISFORM.TEXT42.VALUE = MKDCOL
THISFORM.TEXT3.VALUE = MCOLNAME
THISFORM.TEXT1.VALUE = MINST
THISFORM.TEXT2.VALUE = MINSTNAME
THISFORM.TEXT4.VALUE = IIF(ISNULL(JSIMPOKOK), 0, JSIMPOKOK)
THISFORM.TEXT5.VALUE = IIF(ISNULL(JSIMWAJIB), 0, JSIMWAJIB)
THISFORM.TEXT6.VALUE = IIF(ISNULL(JSIMPOKOK), 0, JSIMPOKOK)+IIF(ISNULL(JSIMWAJIB), 0, JSIMWAJIB)
THISFORM.TEXT7.VALUE = IIF(ISNULL(JSIMPANAN), 0, JSIMPANAN)
THISFORM.TEXT9.VALUE = IIF(ISNULL(JSIMPANAN), 0, JSIMPANAN)
THISFORM.TEXT10.VALUE = IIF(ISNULL(JANGPOKOK), 0, JANGPOKOK)
THISFORM.TEXT11.VALUE = IIF(ISNULL(JANGBUNGA), 0, JANGBUNGA)
THISFORM.TEXT12.VALUE = 0
THISFORM.TEXT13.VALUE = IIF(ISNULL(JANGPOKOK), 0, JANGPOKOK)+IIF(ISNULL(JANGBUNGA), 0, JANGBUNGA)
THISFORM.TEXT14.VALUE = IIF(ISNULL(JLAIN), 0, JLAIN)
THISFORM.TEXT15.VALUE = IIF(ISNULL(JSIMPOKOK), 0, JSIMPOKOK)+IIF(ISNULL(JSIMWAJIB), 0, JSIMWAJIB)+IIF(ISNULL(JSIMPANAN), 0, JSIMPANAN)+IIF(ISNULL(JANGPOKOK), 0, JANGPOKOK)+IIF(ISNULL(JANGBUNGA), 0, JANGBUNGA)+IIF(ISNULL(JLAIN), 0, JLAIN)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi_rekap.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text42
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "C002"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT42.VALUE = MSANDI
THISFORM.TEXT3.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text1
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_instansi_rekap.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text3
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text4
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text5
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_instansi_rekap.scx::Text6
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text7
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text9
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text10
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text11
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_instansi_rekap.scx::Text12
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text13
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_instansi_rekap.scx::Text14
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_rekap.scx::Text15
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "0001"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='0001' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
*
*  col_instansi_rekap.scx::Text16
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** col_instansi_rekap.sct
***
*
***
*** ins_lap.scx
***
*
*
*  ins_lap.scx::FORM1
**
PROCEDURE bacasql
SELECT (THISFORM.OLDSELE)
MKODE = THISFORM.KODE
MBLN = THISFORM.BULAN
MTHN = THISFORM.TAHUN
MTGLLAP = "01-"+RIGHT("00"+ALLTRIM(STR(MBLN)), 2)+"-"+TRANSFORM(MTHN, '9999')
MTGLLAP = AKHIRBLN(CTOD(MTGLLAP))
MKDINST = THISFORM.TEXT4.VALUE
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MKDINST+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKETINS = MKDINST+"- "+KETERANGAN
CSQL = "select * from col_instansi where kantor='"+DEFAKANTOR+"' and kode='"+MKODE+"' and instansi='"+THISFORM.TEXT4.VALUE+"' and bln='"+STR(MBLN)+"' and tahun='"+STR(MTHN)+"' and simpokok+simwajib+simpanan+lain+angpokok+angbunga>'0'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
GOTO TOP
DO WHILE  .NOT. EOF()
MCIF = NOANGG
MNAMA = NAMA
MSIMPOKOK = SIMPOKOK
MSIMWAJIB = SIMWAJIB
MLAIN = LAIN
MKET = KET
MJUMLAH1 = SIMPOKOK+SIMWAJIB+LAIN
MNOMOR = 1
SELECT LAPTGH
APPEND BLANK
REPLACE TANGGAL WITH MTGLLAP, KELKERJA WITH MKETINS
REPLACE CIF WITH MCIF, NOANGG WITH MCIF, NOMOR WITH MNOMOR, NAMA WITH MNAMA, SIMPOKOK WITH MSIMPOKOK, SIMWAJIB WITH MSIMWAJIB
REPLACE LAIN WITH MLAIN, KETLAIN WITH MKET
SELECT 3
CSQL = "select * from col_instansi_simp where kantor='"+DEFAKANTOR+"' and noangg='"+MCIF+"' and kode='"+MKODE+"' and bln='"+STR(MBLN)+"' and tahun='"+STR(MTHN)+"' order by produk"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
MJMLTAB = 0
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MPRODUK = PRODUK
MJUMLAH = JUMLAH
MJMLTAB = MJMLTAB+JUMLAH
IF JUMLAH>0
SELECT LAPTGH
LOCATE FOR NOMOR=MNOMOR .AND. CIF=MCIF
IF FOUND()
REPLACE NOREK WITH MNOREK, PRODUK WITH MPRODUK, TABUNGAN WITH MJUMLAH
ELSE
APPEND BLANK
REPLACE CIF WITH MCIF, NOMOR WITH MNOMOR
REPLACE NOREK WITH MNOREK, PRODUK WITH MPRODUK, TABUNGAN WITH MJUMLAH
ENDIF
MNOMOR = MNOMOR+1
ENDIF
SELECT SMT0
SKIP
ENDDO
MNOMOR = 1
CSQL = "select * from col_instansi_pinj where kantor='"+DEFAKANTOR+"' and noangg='"+MCIF+"' and kode='"+MKODE+"' and bln='"+STR(MBLN)+"' and tahun='"+STR(MTHN)+"'  order by produk"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
MJMLPINJ = 0
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MPRODUK = PRODUK
MPINJ = IIF(ISNULL(POKOK), 0, POKOK)
MRATE = IIF(ISNULL(RATE), 0, RATE)
MJW = IIF(ISNULL(JW), 0, JW)
MKE = 1
MANGPK = ANGPOKOK
MANGBG = ANGBUNGA
MJMLPINJ = MJMLPINJ+(ANGPOKOK+ANGBUNGA)
IF MANGPK+MANGBG>0
SELECT LAPTGH
LOCATE FOR NOMOR=MNOMOR .AND. CIF=MCIF
IF FOUND()
REPLACE PINJ WITH MPINJ
REPLACE RATE WITH MRATE
REPLACE JW WITH MJW
REPLACE KE WITH MKE
REPLACE SISA WITH MJW-MKE
REPLACE ANGPK WITH MANGPK, ANGBG WITH MANGBG
ELSE
APPEND BLANK
REPLACE CIF WITH MCIF, NOMOR WITH MNOMOR
REPLACE PINJ WITH MPINJ, RATE WITH MRATE, JW WITH MJW, KE WITH MKE, SISA WITH JW-MKE
REPLACE ANGPK WITH MANGPK, ANGBG WITH MANGBG
ENDIF
MNOMOR = MNOMOR+1
ENDIF
SELECT SMT0
SKIP
ENDDO
SELECT LAPTGH
LOCATE FOR NOMOR=1 .AND. CIF=MCIF
REPLACE JMLSIMP WITH (MJUMLAH1+MJMLTAB)
REPLACE JUMLAH WITH (MJUMLAH1+MJMLTAB+MJMLPINJ)
SELECT SMT
SKIP
ENDDO
SELECT LAPTGH
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.OLDSELE)
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
THISFORM.BAR.WIDTH = 0
THISFORM.NOMORLAP = MKE
THISFORM.OLDSELE = ALIAS()
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "KANTOR")
IF RECCOUNT()>1
APPEND BLANK
REPLACE SANDI WITH '0000', KETERANGAN WITH "KONSOLIDASI"
IF DEFAKANTOR='0001'
THISFORM.TEXT1.ENABLED = .T.
ENDIF
ENDIF
SELECT (THISFORM.OLDSELE)
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = DEFAKANTOR
THISFORM.REC = RECNO()
THISFORM.KODE = KODE
THISFORM.BULAN = BLN
THISFORM.TAHUN = TAHUN
THISFORM.JUDUL.CAPTION = "DAFTAR TAGIHAN INSTANSI"
THISFORM.FRXNAME = "col_tagih_instansi2.frx"
CREATE CURSOR laptgh (TANGGAL D (8), KELKERJA C (30), CIF C (17), NOMOR N (2), NOANGG C (17), NAMA C (30), SIMPOKOK N (12), SIMWAJIB N (12), NOREK C (25), PRODUK C (40), TABUNGAN N (12), LAIN N (15), KETLAIN C (30), JMLSIMP N (12), PINJ N (12), RATE N (5, 2), JW N (3), KE N (3), BULAN N (2), SISA N (3), ANGPK N (12), ANGBG N (12), JUMLAH N (12))
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  ins_lap.scx::Cmdoke1
**
PROCEDURE Click
LOCAL OLDSELE
OLDSELE = SELECT()
THISFORM.BACASQL()
SELECT LAPTGH
DO FORM print_setup WITH THISFORM.FRXNAME
SELECT (OLDSELE)
THISFORM.RELEASE
ENDPROC
**
*
*  ins_lap.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  ins_lap.scx::Text4
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF EMPTY(THIS.VALUE)
IF .T.
DO FORM ./form/setsandi TO MSANDI WITH "P003"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select sandi,keterangan from setsandi where kode='P003' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Kelompok tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT14.VALUE = KETERANGAN
SELECT SMT
USE
ELSE
MESSAGEBOX("Kode Kelompok tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
RETURN
ENDIF
ENDPROC
**
*
*  ins_lap.scx::Text14
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  ins_lap.scx::Cmdoke2
**
PROCEDURE Click
OLDSELE = SELECT()
THISFORM.BACASQL()
REPORT FORM (THISFORM.FRXNAME) PREVIEW
SELECT (OLDSELE)
ENDPROC
**
*
*  ins_lap.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer")
ENDIF
ENDPROC
**
*
*  ins_lap.scx::Text5
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  ins_lap.scx::text1
**
PROCEDURE InteractiveChange
THISFORM.TEXT9.VALUE = KETERANGAN
ENDPROC
**
***
*** ins_lap.sct
***
*
***
*** atur_tanggal.scx
***
*
*
*  atur_tanggal.scx::Form1
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.JUDUL.CAPTION = "PEMBATASAN TANGGAL"
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT2.VALUE = TGLNOW
CSQL = "select * from batastanggal where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT3.VALUE = TGLAWAL
THISFORM.TEXT4.VALUE = TGLAKHIR
USE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  atur_tanggal.scx::Cmdoke1
**
PROCEDURE Click
TGLNOW = THISFORM.TEXT2.VALUE
MTGL1 = THISFORM.TEXT3.VALUE
MTGL2 = THISFORM.TEXT4.VALUE
CSQL = "update batastanggal set tglawal='"+SQLDATE(MTGL1)+"', tglakhir='"+SQLDATE(MAX(MTGL1, MTGL2))+"', tglupdate='"+SQLDATE(DATE())+"' where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal input")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  atur_tanggal.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  atur_tanggal.scx::Text1
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  atur_tanggal.scx::Text2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  atur_tanggal.scx::Text3
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  atur_tanggal.scx::Text4
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  atur_tanggal.scx::Command1
**
PROCEDURE Click
MTOP = THIS.TOP+THISFORM.TOP+50
MLEFT = THIS.LEFT+THISFORM.LEFT
DO FORM frm_calender TO MTANGGAL WITH MTOP, MLEFT
THISFORM.TEXT3.VALUE = MTANGGAL
THISFORM.TEXT3.SETFOCUS
ENDPROC
**
*
*  atur_tanggal.scx::Command2
**
PROCEDURE Click
MTOP = THIS.TOP+THISFORM.TOP+50
MLEFT = THIS.LEFT+THISFORM.LEFT
DO FORM frm_calender TO MTANGGAL WITH MTOP, MLEFT
THISFORM.TEXT4.VALUE = MTANGGAL
THISFORM.TEXT4.SETFOCUS
ENDPROC
**
*
*  atur_tanggal.scx::Command3
**
PROCEDURE Click
MTOP = THIS.TOP+THISFORM.TOP+50
MLEFT = THIS.LEFT+THISFORM.LEFT
DO FORM frm_calender TO MTANGGAL WITH MTOP, MLEFT
THISFORM.TEXT2.VALUE = MTANGGAL
THISFORM.TEXT2.SETFOCUS
ENDPROC
**
***
*** atur_tanggal.sct
***
*
***
*** calculator delete.png
***
*
***
*** calculator edit 1.png
***
*
***
*** calculator add.png
***
*
***
*** basket delete.png
***
*
***
*** basket edit 1.png
***
*
***
*** basket add.png
***
*
***
*** kas_setting.scx
***
*
*
*  kas_setting.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT2.VALUE = DEFATGLKAS
ENDPROC
**
*
*  kas_setting.scx::Cmdoke1
**
PROCEDURE Click
DEFATGLKAS = THISFORM.TEXT2.VALUE
THISFORM.RELEASE
ENDPROC
**
*
*  kas_setting.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_setting.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  kas_setting.scx::Text2
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  kas_setting.scx::Command3
**
PROCEDURE Click
MTOP = THIS.TOP+THISFORM.TOP+50
MLEFT = THIS.LEFT+THISFORM.LEFT
DO FORM frm_calender TO MTANGGAL WITH MTOP, MLEFT
THISFORM.TEXT2.VALUE = MTANGGAL
THISFORM.TEXT2.SETFOCUS
ENDPROC
**
*
*  kas_setting.scx::Text3
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
***
*** kas_setting.sct
***
*
***
*** report1.frx
***
*
***
*** report1.frt
***
*
***
*** akt_perkiraan.frx
***
*
***
*** akt_perkiraan.frt
***
*
***
*** akt_detail_aktiva.frx
***
*
***
*** akt_detail_aktiva.frt
***
*
***
*** akt_detail_biaya.frx
***
*
***
*** akt_detail_biaya.frt
***
*
***
*** akt_detail_pasiva.frx
***
*
***
*** akt_detail_pasiva.frt
***
*
***
*** akt_detail_pend.frx
***
*
***
*** akt_detail_pend.frt
***
*
***
*** akt_neraca_level.frx
***
*
***
*** akt_neraca_level.frt
***
*
***
*** akt_labarugi_level.frx
***
*
***
*** akt_labarugi_level.frt
***
*
***
*** proses_rubah.scx
***
*
*
*  proses_rubah.scx::FORM1
**
PROCEDURE bacasql
CSQL = "select * from setsandi_tab"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM.GRID1
.RECORDSOURCE = "SMT"
.COLUMNCOUNT = 4
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 90
.COLUMN1.CONTROLSOURCE = "iif(jenis='1','TABUNGAN',IIF(jenis='2','DEPOSITO','PENYERTAAN'))"
.COLUMN1.HEADER1.CAPTION = "JENIS"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 40
.COLUMN2.CONTROLSOURCE = "SANDI"
.COLUMN2.HEADER1.CAPTION = "KODE"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 300
.COLUMN3.CONTROLSOURCE = "KETERANGAN"
.COLUMN3.HEADER1.CAPTION = "PRODUK"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 100
.COLUMN4.CONTROLSOURCE = "trans(TABWAJIB,'999,999,999')"
.COLUMN4.HEADER1.CAPTION = "TAB. WAJIB"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN4.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.TEXT4.VALUE = KETERANGAN
THISFORM.TEXT2.VALUE = TABWAJIB
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.BAR.WIDTH = 0
THISFORM.BORDERSTYLE = 2
THISFORM.JUDUL.CAPTION = "PROSES PERUBAHAN KETENTUAN"
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
THISFORM.BACASQL()
ENDPROC
**
*
*  proses_rubah.scx::Command4
**
PROCEDURE Click
IF THISFORM.TEXT2.VALUE<>THISFORM.TEXT3.VALUE
CSQL = "update setsandi_tab set tabwajib='"+STR(THISFORM.TEXT3.VALUE)+"' where kantor='"+DEFAKANTOR+"' and jenis='"+JENIS+"' and sandi='"+SANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
CSQL = "update simpanan set pot_simpanan='"+STR(THISFORM.TEXT3.VALUE)+"' where kantor='"+DEFAKANTOR+"' and jenis='"+JENIS+"' and produk='"+SANDI+"' and pot_khusus<>'Y'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.BACASQL()
ENDIF
THISFORM.IMAGE8.VISIBLE = .T.
ENDPROC
**
*
*  proses_rubah.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TEXT4.VALUE = KETERANGAN
THISFORM.TEXT2.VALUE = TABWAJIB
THISFORM.IMAGE8.VISIBLE = .F.
ENDPROC
**
*
*  proses_rubah.scx::Command6
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** proses_rubah.sct
***
*
***
*** simpanan_data_khusus.scx
***
*
*
*  simpanan_data_khusus.scx::FORM1
**
PROCEDURE Init
THISFORM.TOP = SYSMETRIC(2)/2
THISFORM.LEFT = SYSMETRIC(1)/2
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.OLDDBF = SELECT()
THISFORM.NOREK = NOREK
THISFORM.TEXT1.VALUE = IIF(RATE_KHUSUS="Y", RATE, 0)
THISFORM.TEXT2.VALUE = IIF(ADM_KHUSUS="Y", ADM, 0)
THISFORM.TEXT3.VALUE = IIF(POT_KHUSUS="Y", POT_SIMPANAN, 0)
THISFORM.CHECK1.VALUE = IIF(RATE_KHUSUS="Y", 1, 0)
THISFORM.CHECK2.VALUE = IIF(ADM_KHUSUS="Y", 1, 0)
THISFORM.CHECK3.VALUE = IIF(POT_KHUSUS="Y", 1, 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_data_khusus.scx::Text2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
*
*  simpanan_data_khusus.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data_khusus.scx::Command3
**
PROCEDURE Click
MRATE_KHUSUS = IIF(THISFORM.CHECK1.VALUE=1, "Y", "T")
MADM_KHUSUS = IIF(THISFORM.CHECK2.VALUE=1, "Y", "T")
MPOT_KHUSUS = IIF(THISFORM.CHECK3.VALUE=1, "Y", "T")
CSQL = "update simpanan set rate='"+STR(THISFORM.TEXT1.VALUE)+"', rate_khusus='"+MRATE_KHUSUS+"', adm='"+STR(THISFORM.TEXT2.VALUE)+"', adm_khusus='"+MADM_KHUSUS+"', pot_simpanan='"+STR(THISFORM.TEXT3.VALUE)+"', pot_khusus='"+MPOT_KHUSUS+"' where norek='"+THISFORM.NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal memasukkan data rekening bunga")
ENDIF
SELECT (THISFORM.OLDDBF)
REPLACE RATE WITH THISFORM.TEXT1.VALUE
REPLACE ADM WITH THISFORM.TEXT2.VALUE
REPLACE POT_SIMPANAN WITH THISFORM.TEXT3.VALUE
REPLACE RATE_KHUSUS WITH MRATE_KHUSUS
REPLACE ADM_KHUSUS WITH MADM_KHUSUS
REPLACE POT_KHUSUS WITH MPOT_KHUSUS
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data_khusus.scx::Command1
**
PROCEDURE Click
THIS.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.TEXT3.ENABLED = .T.
THISFORM.CHECK1.READONLY = .F.
THISFORM.CHECK2.READONLY = .F.
THISFORM.CHECK3.READONLY = .F.
ENDPROC
**
*
*  simpanan_data_khusus.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data_khusus.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
***
*** simpanan_data_khusus.sct
***
*
***
*** acc.scx
***
*
*
*  acc.scx::FORM1
**
PROCEDURE bacasql
CSQL = "select * from acc_transaksi where tglacc='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
ENDPROC
**
PROCEDURE tampil
SELECT SMT
WITH THISFORM.GRID1
.RECORDSOURCE = "SMT"
.COLUMNCOUNT = 4
.FONTSIZE = 10
.FONTNAME = "Cambria"
.COLUMN1.WIDTH = 90
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 100
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 120
.COLUMN3.CONTROLSOURCE = "trans(JUMLAH,'999,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "JUMLAH"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN4.WIDTH = 70
.COLUMN4.CONTROLSOURCE = "OPT"
.COLUMN4.HEADER1.CAPTION = "OPT"
.COLUMN4.HEADER1.FONTBOLD = .T.
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(245,250,252) , RGB(223,223,255))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE tampil2
THISFORM.TEXT4.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = BUKTI
THISFORM.TEXT1.VALUE = JUMLAH
THISFORM.TEXT3.VALUE = OPT
THISFORM.EDIT1.VALUE = CAST(KETERANGAN AS W )
ENDPROC
**
PROCEDURE Init
THISFORM.BAR.WIDTH = 0
THISFORM.BORDERSTYLE = 2
THISFORM.JUDUL.CAPTION = "VALIDASI TRANSAKSI"
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
THISFORM.TIMER1.INTERVAL = 5000
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
*
*  acc.scx::Command6
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc.scx::Command1
**
PROCEDURE Click
DO FORM acc_admin
THISFORM.BACASQL()
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
*
*  acc.scx::Timer1
**
PROCEDURE Timer
MREC = RECNO()
THISFORM.BACASQL()
IF RECCOUNT()=0
GOTO TOP
ELSE
GOTO MIN(MREC, RECCOUNT())
ENDIF
THISFORM.TAMPIL()
THISFORM.TAMPIL2()
ENDPROC
**
***
*** acc.sct
***
*
***
*** acc_client.scx
***
*
*
*  acc_client.scx::FORM1
**
PROCEDURE mintaacc
PARAMETER MTANGGAL, MBUKTI, MKET, MJUMLAH
CSQL = "insert ignore into acc_transaksi (kantor,tanggal,bukti,keterangan,jumlah,opt) values ('"+DEFAKANTOR+"','"+SQLDATE(MTANGGAL)+"','"+MBUKTI+"',?mket,'"+TRANSFORM(MJUMLAH, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select * from acc_transaksi where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(MTANGGAL)+"' and bukti='"+MBUKTI+"' and keterangan=?mket and jumlah='"+TRANSFORM(MJUMLAH, '999999999999999')+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smtACC")
THISFORM.IDDATA = IDDATA
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.HASIL = 2
CSQL = "delete from acc_transaksi where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MTANGGAL, MBUKTI, MKET, MJUMLAH
THISFORM.TOP = SYSMETRIC(2)/2
THISFORM.LEFT = SYSMETRIC(1)/2
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.OLDDBF = SELECT()
THISFORM.JUMLAH = MJUMLAH
THISFORM.MINTAACC(MTANGGAL, MBUKTI, MKET, MJUMLAH)
THISFORM.LABEL2.CAPTION = LEFT(MKET, AT(CHR(13), MKET))+" Rp."+ALLTRIM(TRANSFORM(MJUMLAH, "999,999,999,999"))
THISFORM.TIMER1.INTERVAL = 2000
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.OLDDBF)
RETURN THISFORM.HASIL
ENDFUNC
**
*
*  acc_client.scx::Text2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
*
*  acc_client.scx::Command2
**
PROCEDURE Click
CSQL = "delete from acc_transaksi where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.HASIL = 2
THISFORM.RELEASE
ENDPROC
**
*
*  acc_client.scx::Command3
**
PROCEDURE Click
IF .T.
THISFORM.HASIL = 1
CSQL = "update acc_transaksi  set tglacc='"+SQLDATE(TGLNOW)+"', optacc='"+THISFORM.TEXT1.VALUE+"' where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
USE
SELECT (THISFORM.OLDDBF)
MESSAGEBOX("VALIDASI TRANSAKSI GAGAL DILAKUKAN", 0, "")
THISFORM.TEXT1.SETFOCUS
RETURN
ENDIF
USE
SELECT (THISFORM.OLDDBF)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_client.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
*
*  acc_client.scx::Timer1
**
PROCEDURE Timer
CSQL = "select * from acc_transaksi where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF TGLACC=TGLNOW
THISFORM.HASIL = 1
THISFORM.RELEASE
ENDIF
ENDPROC
**
***
*** acc_client.sct
***
*
***
*** smsgateway.scx
***
*
*
*  smsgateway.scx::FORM1
**
PROCEDURE koneksi
PARAMETER MKONEKSI
IF MKONEKSI=.T.
THISFORM.LABEL5.CAPTION = "CONNECT"
THISFORM.LABEL6.CAPTION = "CONNECT"
ELSE
THISFORM.LABEL5.CAPTION = "DISCONNECT"
THISFORM.LABEL6.CAPTION = "DISCONNECT"
ENDIF
ENDPROC
**
PROCEDURE viewinbox
MDATA = THISFORM.DATA1
SELECT (MDATA)
THISFORM.PAGEFRAME1.PAGE2.GRID1.RECORDSOURCE = MDATA
THISFORM.PAGEFRAME1.PAGE2.GRID1.FONTBOLD = .F.
WITH THISFORM.PAGEFRAME1.PAGE2.GRID1
.ALLOWCELLSELECTION = .F.
.COLUMNCOUNT = 4
.COLUMN1.WIDTH = 50
.COLUMN1.CONTROLSOURCE = "ID"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "No.ID"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "ReceivingDateTime"
.COLUMN2.HEADER1.CAPTION = "TGL. TERIMA"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 150
.COLUMN3.CONTROLSOURCE = "SenderNumber"
.COLUMN3.HEADER1.CAPTION = "NO. TELEPHONE"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 500
.COLUMN4.CONTROLSOURCE = "text"
.COLUMN4.HEADER1.CAPTION = "ISI PESAN"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
ENDWITH
ENDPROC
**
PROCEDURE viewsend
MDATA = THISFORM.DATA2
SELECT (MDATA)
WITH THISFORM.PAGEFRAME1.PAGE3.GRID1
.ALLOWCELLSELECTION = .F.
.FONTBOLD = .F.
.RECORDSOURCE = MDATA
.COLUMNCOUNT = 6
.COLUMN1.WIDTH = 50
.COLUMN1.CONTROLSOURCE = "ID"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "No.ID"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "InsertIntoDB"
.COLUMN2.HEADER1.CAPTION = "TGL. KIRIM"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 150
.COLUMN3.CONTROLSOURCE = "SendingDateTime"
.COLUMN3.HEADER1.CAPTION = "TGL.TERKIRIM"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 125
.COLUMN4.CONTROLSOURCE = "DestinationNumber"
.COLUMN4.HEADER1.CAPTION = "NO. TELEPHONE"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 500
.COLUMN5.CONTROLSOURCE = "text"
.COLUMN5.HEADER1.CAPTION = "ISI PESAN"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 100
.COLUMN6.CONTROLSOURCE = "STATUS"
.COLUMN6.HEADER1.CAPTION = "STATUS"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
ENDWITH
ENDPROC
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
CSQL = "select id,ReceivingDateTime, SenderNumber,LEFT(TextDecoded,160) as text from smsku.inbox"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MDATA = THISFORM.DATA2
CSQL = "select id,InsertIntoDB,SendingDateTime, DestinationNumber,LEFT(TextDecoded,160) as text,status from smsku.sentitems"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE viewkirim
SELECT (THISFORM.DATA4)
MDATA = THISFORM.DATA3
SELECT (MDATA)
WITH THISFORM.PAGEFRAME1.PAGE1.GRID1
.FONTBOLD = .F.
.ALLOWCELLSELECTION = .F.
.RECORDSOURCE = MDATA
.COLUMNCOUNT = 11
.COLUMN1.WIDTH = 150
.COLUMN1.CONTROLSOURCE = "PHONE"
.COLUMN1.FONTSIZE = 10
.COLUMN1.HEADER1.CAPTION = "PHONE"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "VAR1"
.COLUMN2.HEADER1.CAPTION = "VAR1"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 150
.COLUMN3.CONTROLSOURCE = "VAR2"
.COLUMN3.HEADER1.CAPTION = "VAR2"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 150
.COLUMN4.CONTROLSOURCE = "VAR3"
.COLUMN4.HEADER1.CAPTION = "VAR3"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 150
.COLUMN5.CONTROLSOURCE = "VAR4"
.COLUMN5.HEADER1.CAPTION = "VAR4"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 150
.COLUMN6.CONTROLSOURCE = "VAR5"
.COLUMN6.HEADER1.CAPTION = "VAR5"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN7.WIDTH = 150
.COLUMN7.CONTROLSOURCE = "VAR6"
.COLUMN7.HEADER1.CAPTION = "VAR6"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN8.WIDTH = 150
.COLUMN8.CONTROLSOURCE = "VAR7"
.COLUMN8.HEADER1.CAPTION = "VAR7"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN9.WIDTH = 150
.COLUMN9.CONTROLSOURCE = "VAR8"
.COLUMN9.HEADER1.CAPTION = "VAR8"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 10
.COLUMN10.WIDTH = 150
.COLUMN10.CONTROLSOURCE = "VAR9"
.COLUMN10.HEADER1.CAPTION = "VAR9"
.COLUMN10.HEADER1.FONTBOLD = .T.
.COLUMN10.HEADER1.FONTSIZE = 10
.COLUMN11.WIDTH = 150
.COLUMN11.CONTROLSOURCE = "VAR10"
.COLUMN11.HEADER1.CAPTION = "VAR10"
.COLUMN11.HEADER1.FONTBOLD = .T.
.COLUMN11.HEADER1.FONTSIZE = 10
ENDWITH
ENDPROC
**
FUNCTION cekservice
PARAMETER LCSERVICENAME
OSHELLAPP = CREATEOBJECT("Shell.Application")
IF  .NOT. OSHELLAPP.ISSERVICERUNNING(LCSERVICENAME)
IF OSHELLAPP.SERVICESTART(LCSERVICENAME, .F.)
RETURN .T.
ELSE
RETURN .F.
ENDIF
ELSE
RETURN .T.
ENDIF
ENDFUNC
**
PROCEDURE bacasetting
OLDSELECT = SELECT()
SELECT (THISFORM.DATA4)
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.DATA1 = "INBOX"
THISFORM.DATA2 = "SENDITEM"
THISFORM.DATA3 = "DRAFT"
THISFORM.DATA4 = "SETSMS"
THISFORM.BACADATA()
THISFORM.BACASETTING()
KONEK = THISFORM.CEKSERVICE("MYSQL")
KONEK = IIF(KONEK=.T., THISFORM.CEKSERVICE("GAMMUSMSD"), KONEK)
THISFORM.KONEKSI(KONEK)
THISFORM.VIEWINBOX()
THISFORM.VIEWSEND()
THISFORM.VIEWKIRIM()
THIS.TIMER1.INTERVAL = 5000
ENDPROC
**
*
*  smsgateway.scx::Command1
**
PROCEDURE Click
MASAL = THISFORM.PAGEFRAME1.PAGE1.EDIT1.VALUE
SELECT (THISFORM.DATA3)
MJADI = MASAL
MPHONE = IIF(EMPTY(PHONE), "", PHONE)
MVAR1 = IIF(EMPTY(VAR1), "", VAR1)
MVAR2 = IIF(EMPTY(VAR2), "", VAR2)
MVAR3 = IIF(EMPTY(VAR3), "", VAR3)
MVAR4 = IIF(EMPTY(VAR4), "", VAR4)
MVAR5 = IIF(EMPTY(VAR5), "", VAR5)
MVAR6 = IIF(EMPTY(VAR6), "", VAR6)
MVAR7 = IIF(EMPTY(VAR7), "", VAR7)
MVAR8 = IIF(EMPTY(VAR8), "", VAR8)
MVAR9 = IIF(EMPTY(VAR9), "", VAR9)
MVAR10 = IIF(EMPTY(VAR10), "", VAR10)
MJADI=STRTRAN(MJADI,"&phone&",ALLTRIM(MPHONE))
MJADI=STRTRAN(MJADI,"&var1&",ALLTRIM(MVAR1))
MJADI=STRTRAN(MJADI,"&var2&",ALLTRIM(MVAR2))
MJADI=STRTRAN(MJADI,"&var3&",ALLTRIM(MVAR3))
MJADI=STRTRAN(MJADI,"&var4&",ALLTRIM(MVAR4))
MJADI=STRTRAN(MJADI,"&var5&",ALLTRIM(MVAR5))
MJADI=STRTRAN(MJADI,"&var6&",ALLTRIM(MVAR6))
MJADI=STRTRAN(MJADI,"&var7&",ALLTRIM(MVAR7))
MJADI=STRTRAN(MJADI,"&var8&",ALLTRIM(MVAR8))
MJADI=STRTRAN(MJADI,"&var9&",ALLTRIM(MVAR9))
MJADI=STRTRAN(MJADI,"&var10&",ALLTRIM(MVAR10))
THISFORM.PAGEFRAME1.PAGE1.EDIT2.VALUE = MJADI
ENDPROC
**
*
*  smsgateway.scx::Command3
**
PROCEDURE Click
CSQL = "delete from draft_group where 1"
LCEK = SQLEXEC(OODBC, CSQL)
MNAMAFILE = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT1.VALUE
IF EMPTY(MNAMAFILE)
RETURN
ELSE
OLEAPP = CREATEOBJECT("Excel.Application")
OLEAPP.WORKBOOKS.OPEN(MNAMAFILE)
A = 2
OLEI = OLEAPP.WORKBOOKS.ITEM(1)
DO WHILE .T.
IF EMPTY(OLEI.SHEETS.ITEM(1).CELLS(A,1).VALUE) .OR. OLEI.SHEETS.ITEM(1).CELLS(A,1).VALUE=.NULL. .OR. A=10
EXIT
ENDIF
MNOHP = OLEI.SHEETS.ITEM(1).CELLS(A,1).VALUE
MVAR1 = OLEI.SHEETS.ITEM(1).CELLS(A,2).VALUE
MVAR2 = OLEI.SHEETS.ITEM(1).CELLS(A,3).VALUE
MVAR3 = OLEI.SHEETS.ITEM(1).CELLS(A,4).VALUE
MVAR4 = OLEI.SHEETS.ITEM(1).CELLS(A,5).VALUE
MVAR5 = OLEI.SHEETS.ITEM(1).CELLS(A,6).VALUE
MVAR6 = OLEI.SHEETS.ITEM(1).CELLS(A,7).VALUE
MVAR7 = OLEI.SHEETS.ITEM(1).CELLS(A,8).VALUE
MVAR8 = OLEI.SHEETS.ITEM(1).CELLS(A,9).VALUE
MVAR9 = OLEI.SHEETS.ITEM(1).CELLS(A,10).VALUE
MVAR10 = OLEI.SHEETS.ITEM(1).CELLS(A,11).VALUE
MVAR1 = IIF(VARTYPE(MVAR1)="N", ALLTRIM(STR(MVAR1)), IIF(VARTYPE(MVAR1)="D", CTOD(MVAR1), IIF(VARTYPE(MVAR1)="X", "", MVAR1)))
MVAR2 = IIF(VARTYPE(MVAR2)="N", ALLTRIM(STR(MVAR2)), IIF(VARTYPE(MVAR2)="D", CTOD(MVAR2), IIF(VARTYPE(MVAR2)="X", "", MVAR2)))
MVAR3 = IIF(VARTYPE(MVAR3)="N", ALLTRIM(STR(MVAR3)), IIF(VARTYPE(MVAR3)="D", CTOD(MVAR3), IIF(VARTYPE(MVAR3)="X", "", MVAR3)))
MVAR4 = IIF(VARTYPE(MVAR4)="N", ALLTRIM(STR(MVAR4)), IIF(VARTYPE(MVAR4)="D", CTOD(MVAR4), IIF(VARTYPE(MVAR4)="X", "", MVAR4)))
MVAR5 = IIF(VARTYPE(MVAR5)="N", ALLTRIM(STR(MVAR5)), IIF(VARTYPE(MVAR5)="D", CTOD(MVAR5), IIF(VARTYPE(MVAR5)="X", "", MVAR5)))
MVAR6 = IIF(VARTYPE(MVAR6)="N", ALLTRIM(STR(MVAR6)), IIF(VARTYPE(MVAR6)="D", CTOD(MVAR6), IIF(VARTYPE(MVAR6)="X", "", MVAR6)))
MVAR7 = IIF(VARTYPE(MVAR7)="N", ALLTRIM(STR(MVAR7)), IIF(VARTYPE(MVAR7)="D", CTOD(MVAR7), IIF(VARTYPE(MVAR7)="X", "", MVAR7)))
MVAR8 = IIF(VARTYPE(MVAR8)="N", ALLTRIM(STR(MVAR8)), IIF(VARTYPE(MVAR8)="D", CTOD(MVAR8), IIF(VARTYPE(MVAR8)="X", "", MVAR8)))
MVAR9 = IIF(VARTYPE(MVAR9)="N", ALLTRIM(STR(MVAR9)), IIF(VARTYPE(MVAR9)="D", CTOD(MVAR9), IIF(VARTYPE(MVAR9)="X", "", MVAR9)))
MVAR10 = IIF(VARTYPE(MVAR10)="N", ALLTRIM(STR(MVAR10)), IIF(VARTYPE(MVAR10)="D", CTOD(MVAR10), IIF(VARTYPE(MVAR10)="X", "", MVAR10)))
IF VARTYPE(MNOHP)="X"
EXIT
ENDIF
CSQL = "insert into draft_group (phone,var1,var2,var3,var4,var5,var6,var7,var8,var9,var10) value"+" ('"+MNOHP+"','"+MVAR1+"','"+MVAR2+"','"+MVAR3+"','"+MVAR4+"','"+MVAR5+"','"+MVAR6+"','"+MVAR7+"','"+MVAR8+"','"+MVAR9+"','"+MVAR10+"')"
LCEK = SQLEXEC(OODBC, CSQL)
A = A+1
ENDDO
OLEAPP.QUIT
THISFORM.BACADATA()
THISFORM.VIEWKIRIM()
THISFORM.VIEWINBOX()
THISFORM.VIEWKIRIM()
ENDIF
ENDPROC
**
*
*  smsgateway.scx::Command5
**
PROCEDURE Click
MFILE = GETFILE("XLS,XLSX")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT1.VALUE = MFILE
ENDPROC
**
*
*  smsgateway.scx::Command4
**
PROCEDURE Click
MNOHP = THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE
MPESAN = THISFORM.PAGEFRAME1.PAGE1.EDIT1.VALUE
MUHD = "050003A7"
STORE '' TO MTEXT1, MTEXT2, MTEXT3, MTEXT4, MTEXT5, MTEXT6
MPESAN = IIF(LEN(MPESAN)>00918, LEFT(MPESAN, 00918), MPESAN)
IF EMPTY(MNOHP)
MESSAGEBOX("Nomor Telphone tidak boleh kosong", 0, "MySMS")
RETURN
ENDIF
IF LEN(MPESAN)<160
CSQL = "INSERT INTO outbox(DestinationNumber, TextDecoded, CreatorID) VALUES "+"('"+MNOHP+"', '"+MPESAN+"', 'Niji')"
LCEK = SQLEXEC(OODBC, CSQL)
MESSAGEBOX("Pesan Terkirim", 0, "MySms")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT1.VALUE = ''
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.EDIT1.VALUE = ''
ELSE
N = INT(LEN(MPESAN)/153)
N = IIF(LEN(MPESAN)-(N*153)>0, N+1, N)
MKDUHD = MUHD+RIGHT("00"+ALLTRIM(STR(N)), 2)
FOR A = 1 TO N
IF A=1
MKDUHD = MKDUHD+RIGHT("00"+ALLTRIM(STR(A)), 2)
MTEXT1 = LEFT(MPESAN, 153)
CSQL = "INSERT INTO outbox (DestinationNumber, UDH, TextDecoded, MultiPart, CreatorID) "+"VALUES ('"+MNOHP+"', '"+MKDUHD+"', '"+MTEXT1+"', 'true', 'Niji')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select id from outbox where DestinationNumber='"+MNOHP+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MID = ID
ELSE
MKDUHD = MKDUHD+RIGHT("00"+ALLTRIM(STR(A)), 2)
MTEXT1 = SUBSTR(MPESAN, (153*(A-1))+1, 153)
CSQL = "INSERT INTO outbox_multipart(UDH, TextDecoded, ID, SequencePosition)"+" VALUES ('"+MKDUHD+"', '"+MTEXT1+"', '"+MID+"', '"+STR(A)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDFOR
MESSAGEBOX("Pesan Sudah Terkirim", 0, "MySms")
ENDIF
ENDPROC
**
*
*  smsgateway.scx::Command2
**
PROCEDURE Click
MUHD = "050003A7"
MASAL = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.EDIT1.VALUE
MJADI = MASAL
JML = 0
SELECT (THISFORM.DATA3)
GOTO TOP
DO WHILE  .NOT. EOF()
JML = JML+1
MPHONE = IIF(EMPTY(PHONE), "", PHONE)
MVAR1 = IIF(EMPTY(VAR1), "", VAR1)
MVAR2 = IIF(EMPTY(VAR2), "", VAR2)
MVAR3 = IIF(EMPTY(VAR3), "", VAR3)
MVAR4 = IIF(EMPTY(VAR4), "", VAR4)
MVAR5 = IIF(EMPTY(VAR5), "", VAR5)
MVAR6 = IIF(EMPTY(VAR6), "", VAR6)
MVAR7 = IIF(EMPTY(VAR7), "", VAR7)
MVAR8 = IIF(EMPTY(VAR8), "", VAR8)
MVAR9 = IIF(EMPTY(VAR9), "", VAR9)
MVAR10 = IIF(EMPTY(VAR10), "", VAR10)
MJADI=STRTRAN(MJADI,"&phone&",ALLTRIM(MPHONE))
MJADI=STRTRAN(MJADI,"&var1&",ALLTRIM(MVAR1))
MJADI=STRTRAN(MJADI,"&var2&",ALLTRIM(MVAR2))
MJADI=STRTRAN(MJADI,"&var3&",ALLTRIM(MVAR3))
MJADI=STRTRAN(MJADI,"&var4&",ALLTRIM(MVAR4))
MJADI=STRTRAN(MJADI,"&var5&",ALLTRIM(MVAR5))
MJADI=STRTRAN(MJADI,"&var6&",ALLTRIM(MVAR6))
MJADI=STRTRAN(MJADI,"&var7&",ALLTRIM(MVAR7))
MJADI=STRTRAN(MJADI,"&var8&",ALLTRIM(MVAR8))
MJADI=STRTRAN(MJADI,"&var9&",ALLTRIM(MVAR9))
MJADI=STRTRAN(MJADI,"&var10&",ALLTRIM(MVAR10))
IF LEN(MJADI)<160
CSQL = "INSERT INTO outbox(DestinationNumber, TextDecoded, CreatorID) VALUES "+"('"+MPHONE+"', '"+MJADI+"', 'System')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
N = INT(LEN(MJADI)/153)
N = IIF(LEN(MJADI)-(N*153)>0, N+1, N)
MKDUHD1 = MUHD+RIGHT("00"+ALLTRIM(STR(N)), 2)
FOR A = 1 TO N
IF A=1
MKDUHD = MKDUHD1+RIGHT("00"+ALLTRIM(STR(A)), 2)
MTEXT1 = LEFT(MJADI, 153)
CSQL = "INSERT INTO outbox (DestinationNumber, UDH, TextDecoded, MultiPart, CreatorID) "+"VALUES ('"+MPHONE+"', '"+MKDUHD+"', '"+MTEXT1+"', 'true', 'System')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select id from outbox where DestinationNumber='"+MPHONE+"' and UDH='"+MKDUHD+"' and textdecoded='"+MTEXT1+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MID = ID
USE
ELSE
MKDUHD = MKDUHD1+RIGHT("00"+ALLTRIM(STR(A)), 2)
MTEXT1 = SUBSTR(MJADI, (153*(A-1))+1, 153)
CSQL = "INSERT INTO outbox_multipart(UDH, TextDecoded, ID, SequencePosition)"+" VALUES ('"+MKDUHD+"', '"+MTEXT1+"', '"+STR(MID)+"', '"+STR(A)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDFOR
ENDIF
SELECT (THISFORM.DATA3)
SKIP
ENDDO
MESSAGEBOX(STR(JML)+" SMS Terkirim", 0, "MySms")
ENDPROC
**
*
*  smsgateway.scx::Command7
**
PROCEDURE Click
MUHD = "050003A7"
MASAL = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.EDIT1.VALUE
MJADI = MASAL
JML = 0
SELECT (THISFORM.DATA3)
GOTO TOP
DO WHILE  .NOT. EOF()
JML = JML+1
MPHONE = IIF(EMPTY(PHONE), "", PHONE)
MVAR1 = IIF(EMPTY(VAR1), "", VAR1)
MVAR2 = IIF(EMPTY(VAR2), "", VAR2)
MVAR3 = IIF(EMPTY(VAR3), "", VAR3)
MVAR4 = IIF(EMPTY(VAR4), "", VAR4)
MVAR5 = IIF(EMPTY(VAR5), "", VAR5)
MVAR6 = IIF(EMPTY(VAR6), "", VAR6)
MVAR7 = IIF(EMPTY(VAR7), "", VAR7)
MVAR8 = IIF(EMPTY(VAR8), "", VAR8)
MVAR9 = IIF(EMPTY(VAR9), "", VAR9)
MVAR10 = IIF(EMPTY(VAR10), "", VAR10)
MJADI=STRTRAN(MJADI,"&phone&",ALLTRIM(MPHONE))
MJADI=STRTRAN(MJADI,"&var1&",ALLTRIM(MVAR1))
MJADI=STRTRAN(MJADI,"&var2&",ALLTRIM(MVAR2))
MJADI=STRTRAN(MJADI,"&var3&",ALLTRIM(MVAR3))
MJADI=STRTRAN(MJADI,"&var4&",ALLTRIM(MVAR4))
MJADI=STRTRAN(MJADI,"&var5&",ALLTRIM(MVAR5))
MJADI=STRTRAN(MJADI,"&var6&",ALLTRIM(MVAR6))
MJADI=STRTRAN(MJADI,"&var7&",ALLTRIM(MVAR7))
MJADI=STRTRAN(MJADI,"&var8&",ALLTRIM(MVAR8))
MJADI=STRTRAN(MJADI,"&var9&",ALLTRIM(MVAR9))
MJADI=STRTRAN(MJADI,"&var10&",ALLTRIM(MVAR10))
IF LEN(MJADI)<160
CSQL = "INSERT INTO outbox(DestinationNumber, TextDecoded, CreatorID) VALUES "+"('"+MPHONE+"', '"+MJADI+"', 'System')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
N = INT(LEN(MJADI)/153)
N = IIF(LEN(MJADI)-(N*153)>0, N+1, N)
MKDUHD1 = MUHD+RIGHT("00"+ALLTRIM(STR(N)), 2)
FOR A = 1 TO N
IF A=1
MKDUHD = MKDUHD1+RIGHT("00"+ALLTRIM(STR(A)), 2)
MTEXT1 = LEFT(MJADI, 153)
CSQL = "INSERT INTO outbox (DestinationNumber, UDH, TextDecoded, MultiPart, CreatorID) "+"VALUES ('"+MPHONE+"', '"+MKDUHD+"', '"+MTEXT1+"', 'true', 'System')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select id from outbox where DestinationNumber='"+MPHONE+"' and UDH='"+MKDUHD+"' and textdecoded='"+MTEXT1+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MID = ID
USE
ELSE
MKDUHD = MKDUHD1+RIGHT("00"+ALLTRIM(STR(A)), 2)
MTEXT1 = SUBSTR(MJADI, (153*(A-1))+1, 153)
CSQL = "INSERT INTO outbox_multipart(UDH, TextDecoded, ID, SequencePosition)"+" VALUES ('"+MKDUHD+"', '"+MTEXT1+"', '"+STR(MID)+"', '"+STR(A)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDFOR
ENDIF
SELECT (THISFORM.DATA3)
SKIP
ENDDO
MESSAGEBOX(STR(JML)+" SMS Terkirim", 0, "MySms")
ENDPROC
**
*
*  smsgateway.scx::cmdexport
**
PROCEDURE Click
IF RECCOUNT()>0
MNAMAFILE = GETFILE("XLS;XLXS")
OLEAPP = CREATEOBJECT("Excel.Application")
OLEAPP.VISIBLE = .F.
OLEAPP.WORKBOOKS.ADD
A = 2
OLEI = OLEAPP.WORKBOOKS.ITEM(1)
OLEI.SHEETS.ITEM(1).CELLS(1, 1).VALUE = "NO.ID"
OLEI.SHEETS.ITEM(1).CELLS(1, 2).VALUE = "TGL SMS"
OLEI.SHEETS.ITEM(1).CELLS(1, 3).VALUE = "NO.TELEPHONE"
OLEI.SHEETS.ITEM(1).CELLS(1, 4).VALUE = "SMS"
SELECT INBOX
GOTO TOP
DO WHILE  .NOT. EOF()
OLEI.SHEETS.ITEM(1).CELLS(A, 1).VALUE = ID
OLEI.SHEETS.ITEM(1).CELLS(A, 2).VALUE = RECEIVINGDATETIME
OLEI.SHEETS.ITEM(1).CELLS(A, 3).VALUE = SENDERNUMBER
OLEI.SHEETS.ITEM(1).CELLS(A, 4).VALUE = TEXT
SKIP
A = A+1
ENDDO
OLEAPP.ACTIVEWORKBOOK.SAVEAS(MNAMAFILE)
OLEAPP.QUIT
MESSAGEBOX("Data Sudah Di Export", 0, "MySms")
ELSE
MESSAGEBOX("Tidak ada data yang diexport", 0, "MySms")
ENDIF
ENDPROC
**
*
*  smsgateway.scx::cmdexport
**
PROCEDURE Click
MNAMAFILE = GETFILE("XLS;XLXS")
IF RECCOUNT()>0
OLEAPP = CREATEOBJECT("Excel.Application")
OLEAPP.VISIBLE = .F.
OLEAPP.WORKBOOKS.ADD
A = 2
OLEI = OLEAPP.WORKBOOKS.ITEM(1)
OLEI.SHEETS.ITEM(1).CELLS(1, 1).VALUE = "NO.ID"
OLEI.SHEETS.ITEM(1).CELLS(1, 2).VALUE = "TGL KIRIM"
OLEI.SHEETS.ITEM(1).CELLS(1, 3).VALUE = "TGL TERKIRIM"
OLEI.SHEETS.ITEM(1).CELLS(1, 4).VALUE = "NO.TUJUAN"
OLEI.SHEETS.ITEM(1).CELLS(1, 5).VALUE = "ISI PESAN"
OLEI.SHEETS.ITEM(1).CELLS(1, 6).VALUE = "STATUS"
SELECT SENDITEM
GOTO TOP
DO WHILE  .NOT. EOF()
OLEI.SHEETS.ITEM(1).CELLS(A, 1).VALUE = ID
OLEI.SHEETS.ITEM(1).CELLS(A, 2).VALUE = INSERTINTODB
OLEI.SHEETS.ITEM(1).CELLS(A, 3).VALUE = SENDINGDATETIME
OLEI.SHEETS.ITEM(1).CELLS(A, 4).VALUE = "'"+DESTINATIONNUMBER
OLEI.SHEETS.ITEM(1).CELLS(A, 5).VALUE = TEXT
OLEI.SHEETS.ITEM(1).CELLS(A, 6).VALUE = STATUS
SKIP
A = A+1
ENDDO
OLEAPP.ACTIVEWORKBOOK.SAVEAS(MNAMAFILE)
OLEAPP.QUIT
MESSAGEBOX("Data Sudah selesai Di Export", 0, "MySms")
ELSE
MESSAGEBOX("Tidak ada data yang di export", 0, "Mysms")
ENDIF
ENDPROC
**
*
*  smsgateway.scx::Command1
**
PROCEDURE Click
IF RECCOUNT()>0
MNAMAFILE = GETFILE("XLS;XLXS")
OLEAPP = CREATEOBJECT("Excel.Application")
OLEAPP.VISIBLE = .F.
OLEAPP.WORKBOOKS.ADD
A = 2
OLEI = OLEAPP.WORKBOOKS.ITEM(1)
OLEI.SHEETS.ITEM(1).CELLS(1, 1).VALUE = "NO.ID"
OLEI.SHEETS.ITEM(1).CELLS(1, 2).VALUE = "TGL SMS"
OLEI.SHEETS.ITEM(1).CELLS(1, 3).VALUE = "NO.TELEPHONE"
OLEI.SHEETS.ITEM(1).CELLS(1, 4).VALUE = "SMS"
SELECT INBOX
GOTO TOP
DO WHILE  .NOT. EOF()
OLEI.SHEETS.ITEM(1).CELLS(A, 1).VALUE = ID
OLEI.SHEETS.ITEM(1).CELLS(A, 2).VALUE = RECEIVINGDATETIME
OLEI.SHEETS.ITEM(1).CELLS(A, 3).VALUE = SENDERNUMBER
OLEI.SHEETS.ITEM(1).CELLS(A, 4).VALUE = TEXT
SKIP
A = A+1
ENDDO
OLEAPP.ACTIVEWORKBOOK.SAVEAS(MNAMAFILE)
OLEAPP.QUIT
MESSAGEBOX("Data Sudah Di Export", 0, "MySms")
ELSE
MESSAGEBOX("Tidak ada data yang diexport", 0, "MySms")
ENDIF
ENDPROC
**
*
*  smsgateway.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  smsgateway.scx::Command3
**
PROCEDURE Click
DO FORM sms_ucapan WITH 'A01'
ENDPROC
**
*
*  smsgateway.scx::Command4
**
PROCEDURE Click
DO FORM sms_ucapan WITH 'A02'
ENDPROC
**
*
*  smsgateway.scx::Command5
**
PROCEDURE Click
DO FORM sms_ucapan WITH 'A03'
ENDPROC
**
*
*  smsgateway.scx::Command6
**
PROCEDURE Click
DO FORM sms_ucapan WITH 'S01'
ENDPROC
**
*
*  smsgateway.scx::Command7
**
PROCEDURE Click
DO FORM sms_ucapan WITH 'S02'
ENDPROC
**
*
*  smsgateway.scx::Command9
**
PROCEDURE Click
DO FORM sms_ucapan WITH 'P01'
ENDPROC
**
*
*  smsgateway.scx::Command10
**
PROCEDURE Click
DO FORM sms_ucapan WITH 'P02'
ENDPROC
**
*
*  smsgateway.scx::Command2
**
PROCEDURE Click
DO FORM sms_reg WITH "INPUT"
ENDPROC
**
*
*  smsgateway.scx::Command8
**
PROCEDURE Click
DO FORM sms_reg WITH "EDIT"
ENDPROC
**
*
*  smsgateway.scx::Command11
**
PROCEDURE Click
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  smsgateway.scx::Timer1
**
PROCEDURE Timer
IF THISFORM.PAGEFRAME1.ACTIVEPAGE=2
SELECT (THISFORM.DATA1)
MREC1 = RECNO()
JMLDATA1 = RECCOUNT()
MDATA = THISFORM.DATA1
CSQL = "select id,ReceivingDateTime, SenderNumber,LEFT(TextDecoded,160) as text from inbox"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()<>JMLDATA1
CSQL = "select id,ReceivingDateTime, SenderNumber,LEFT(TextDecoded,160) as text from inbox"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
THISFORM.VIEWINBOX()
SELECT (THISFORM.DATA1)
GOTO MREC1
THISFORM.PAGEFRAME1.PAGE2.GRID1.REFRESH
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETFOCUS
ENDIF
SELECT (THISFORM.DATA1)
ENDIF
IF THISFORM.PAGEFRAME1.ACTIVEPAGE=3
SELECT (THISFORM.DATA2)
MREC1 = RECNO()
JMLDATA1 = RECCOUNT()
MDATA = THISFORM.DATA2
CSQL = "select id,InsertIntoDB,SendingDateTime, DestinationNumber,LEFT(TextDecoded,160) as text,status from sentitems"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()<>JMLDATA1
CSQL = "select id,InsertIntoDB,SendingDateTime, DestinationNumber,LEFT(TextDecoded,160) as text,status from sentitems"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
THISFORM.VIEWSEND()
SELECT (THISFORM.DATA1)
GOTO MREC1
THISFORM.PAGEFRAME1.PAGE3.GRID1.REFRESH
THISFORM.PAGEFRAME1.PAGE3.GRID1.SETFOCUS
ENDIF
SELECT (THISFORM.DATA1)
ENDIF
KONEK = THISFORM.CEKSERVICE("MYSQL")
KONEK = IIF(KONEK=.T., THISFORM.CEKSERVICE("GAMMUSMSD"), KONEK)
THISFORM.KONEKSI(KONEK)
ENDPROC
**
***
*** smsgateway.sct
***
*
***
*** 5.png
***
*
***
*** 10.png
***
*
***
*** key.png
***
*
***
*** arwr.ico
***
*
***
*** aa.scx
***
*
*
*  aa.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  aa.scx::Label1
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.BACKCOLOR = RGB(223, 223, 223)
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.BACKCOLOR = RGB(240, 240, 240)
ENDPROC
**
*
*  aa.scx::Label2
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.BACKCOLOR = RGB(223, 223, 223)
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.BACKCOLOR = RGB(240, 240, 240)
ENDPROC
**
***
*** aa.sct
***
*
***
*** get_image.scx
***
*
*
*  get_image.scx::FORM1
**
PROCEDURE Init
PARAMETER MFILE
HIDE POPUP MYMENU
THISFORM.TEXT2.VALUE = MFILE
THISFORM.IMGDISPLAY.PICTURE = MFILE
THISFORM.HOMEDIR = SET('DEFAULT')+SYS(2003)
THISFORM.BORDERSTYLE = 1
THIS.LSTFILES.REQUERY
ENDPROC
**
FUNCTION Unload
SHOW POPUP MYMENU
RETURN THISFORM.MPILIH
ENDFUNC
**
*
*  get_image.scx::lstFiles
**
PROCEDURE InteractiveChange
CSELECTED = UPPER(THIS.LIST(THIS.LISTINDEX))
CD THIS.LIST(2)
IF ".BMP"$CSELECTED .OR. ".JPG"$CSELECTED .OR. ".PNG"$CSELECTED
THISFORM.IMGDISPLAY.PICTURE = THIS.LIST(2)+CSELECTED
THISFORM.TEXT2.VALUE = THIS.LIST(2)+CSELECTED
ENDIF
ENDPROC
**
*
*  get_image.scx::Combo1
**
PROCEDURE Init
THIS.LISTINDEX = 1
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.LSTFILES.ROWSOURCE = THIS.VALUE
THISFORM.LSTFILES.REQUERY
ENDPROC
**
*
*  get_image.scx::IMAGE
**
PROCEDURE Click
SET DEFAULT TO (THISFORM.HOMEDIR)
THISFORM.READINI1._WRITE('IMAGE', 'BACKGROUND', ALLTRIM(THISFORM.TEXT2.VALUE))
THISFORM.MPILIH = THISFORM.TEXT2.VALUE
THISFORM.RELEASE
ENDPROC
**
***
*** get_image.sct
***
*
***
*** laporan kas harian.frx
***
*
***
*** laporan kas harian.frt
***
*
***
*** catatan.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
TEXT
*------------- sebagai dasar baca register ----------------
* ambil tanggal pembuatan tabel user
SELECT create_time FROM INFORMATION_SCHEMA.TABLES where table_schema='suryaartha' and table_name='user'
 
*------------------- form transparant
* Penulisanya
* 1. Ketik Di Form procedure - init
* : transparent(thisform.HWnd, thisform.BackColor)
* 2. buat background formnya : RGB(255,0,255)
* 3. ShowWindow=2
* 4. Ketik di Form procedure - unload
* CLEAR DLLS GetWindowLong,SetWindowLong,SetLayeredWindowAttributes
*------------------------------------------------------------------------
PROCEDURE transparenci
LPARAMETERS nHWND, nColor
DECLARE INTEGER GetWindowLong IN user32.DLL INTEGER hWnd, ;
INTEGER nIndex
DECLARE INTEGER SetWindowLong IN user32.DLL INTEGER hWnd, ;
INTEGER nIndex, ;
INTEGER dwNewLong
DECLARE INTEGER SetLayeredWindowAttributes IN WIN32API INTEGER HWND, ;
INTEGER crKey, ;
INTEGER bAlpha,;
INTEGER dwFlags
*********************************************************************************************
#DEFINE LWA_TRANSPARENT 1
#DEFINE GWL_EXSTYLE -20
#DEFINE WS_EX_LAYERED 0x00080000

LOCAL lnFlags
*********************************************************************************************
lnFlags = GetWindowLong(nHWND, GWL_EXSTYLE) && Gets the existing flags from the window
lnFlags = BITOR(lnFlags, WS_EX_LAYERED) && Appends the Layered flag to the existing ones
SetWindowLong(nHWND, GWL_EXSTYLE, lnFlags) && Sets the new flags to the window
SetLayeredWindowAttributes(nHWND, nColor, 0, LWA_TRANSPARENT)
ENDPROC
* HexToStr
*******************************************
Function HexToStr(cBytes)
Local cReturn,n
cReturn=""
For n=Len(cBytes)/2 to 1 step -1
nChr=eval("0x"+SubStr(cBytes,(n-1)*2+1,2))
cReturn=cReturn+chr(nChr)
endfor
Return cReturn
EndFunc 
*-------------- default printer
* Penulisannya
* =GetdefaPrn()
*----------------------------------------------------------------------------
PROCEDURE getdefaprn
DECLARE INTEGER GetDefaultPrinter IN winspool.drv;
STRING @ pszBuffer,;
INTEGER @ pcchBuffer

* returns default printer name (WinNT)
nBufsize = 250
cPrinter = REPLICATE(Chr(0), nBufsize)

= GetDefaultPrinter(@cPrinter, @nBufsize)
cPrinter = SUBSTR(cPrinter, 1, AT(Chr(0),cPrinter)-1)
RETURN cPrinter
ENDPROC 

*------------------- cek mac address
cMacAddress=""
objWMIService = GetObject("winmgmts:"+;
 "{impersonationLevel=impersonate}!\\.\root\cimv2")
colItems = objWMIService.ExecQuery(;
 "Select * From Win32_NetworkAdapterConfiguration")
For Each objItem in colItems
 IF varTYPE(objItem.MACAddress)="C"
  cMacAddress=cMacAddress+objItem.MACAddress+","
  endif
endfor
?cMacAddress

*__________________ untuk baca processor
objWMIService = GetObject("winmgmts:" ;
 + "{impersonationLevel=impersonate}!\\" + "."+ "\root\cimv2")
colItems  =  objWMIService.ExecQuery( ;
 "Select  *  from  Win32_Processor")
For  Each  objItem  in  colItems
  cName = objItem.Name
ENDFOR
*----------- atau dengan ini (baca prosesor
GETENV("PROCESSOR_ARCHITECTURE")
GETENV("PROCESSOR_IDENTIFIER")
GETENV("PROCESSOR_LEVEL")
GETENV("NUMBER_OF_PROCESSORS")
GETENV("PROCESSOR_REVISION")

*------------------- mengatur uac windows-------------
*/ Meng-Enable UAC /*
WSHShell = CreateObject("WScript.Shell")
cKey = "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\"+;
 "Policies\System\EnableLUA"
WshShell.RegWrite(cKey, 1, "REG_DWORD")

*/ Men-Disable UAC /*
WSHShell = CreateObject("WScript.Shell")
cKey = "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\"+;
 "Policies\System\EnableLUA"
WshShell.RegWrite(cKey, 0, "REG_DWORD")

*--------------backup mysql---------------
1. backup
EXECSCRIPT("! mysqldump -u root -padmin dbpos > " + ;
 "c:\File_hasil_Export.sql")
2. restore
EXECSCRIPT("! mysql -u root -padmin dbpos < " +;
 "c:\File_Hasil_Export.sql") 

*--------------- mengetahui kapasitas harddisk
cDrive="D"
objWMIService = GetObject("winmgmts:" +;
 "{impersonationLevel=impersonate}!\\" +;
 GETENV("COMPUTERNAME") + "\root\cimv2")
colDisks = objWMIService.ExecQuery;
("Select * from Win32_LogicalDisk Where DriveType = 3")
iCek=0
For Each objDisk in colDisks
 IF objDisk.DeviceID=UPPER(cDrive)+":"
  IFreeSpace = objDisk.FreeSpace
  ITotalSpace = objDisk.Size
  ITotalUsage = objDisk.Size - objDisk.FreeSpace
  iCek=1
 ENDIF
ENDFOR
IF iCek=0
 MESSAGEBOX("Drive yang anda masukkan tidak ada")
 IFreeSpace = 0
 ITotalSpace = 0
 ITotalUsage = 0
ENDIF 
*---------------------------------- merubah atrribut file

*Menambahkan Attribut R (Read Only)
cNmFile="c:\FoxproMania.doc"
EXECSCRIPT("! /n attrib " + cNmFile + " +R")

*Menambahkan Attribut H (Hidden)
cNmFile="c:\FoxproMania.doc"
EXECSCRIPT("! /n attrib " + cNmFile + " +H")

*Menambahkan Attribut S (System)
cNmFile="c:\FoxproMania.doc"
EXECSCRIPT("! /n attrib " + cNmFile + " +S")

*Menambahkan Attribut A, H dan S sekaligus
cNmFile="c:\FoxproMania.doc"
EXECSCRIPT("! /n attrib " + cNmFile + " +A +H +S")

*Menghilangkan Attribut R (Read Only)
cNmFile="c:\FoxproMania.doc"
EXECSCRIPT("! /n attrib " + cNmFile + " -R")

*Menghilangkan Attribut H (Hidden)
cNmFile="c:\FoxproMania.doc"
EXECSCRIPT("! /n attrib " + cNmFile + " -H")

*Menghilangkan Attribut S (System)
cNmFile="c:\FoxproMania.doc"
EXECSCRIPT("! /n attrib " + cNmFile + " -S")

*Menghilangkan Attribut A, H dan S sekaligus
cNmFile="c:\FoxproMania.doc"
EXECSCRIPT("! /n attrib " + cNmFile + " -S -H -A")

*------------------------------------------------- mengganti nama komputer
ewName = "FoxproMania"
strComputer = "." 
objWMIService = GetObject("winmgmts:" ;
 + "{impersonationLevel=impersonate}!\\" + ;
 strComputer + "\root\cimv2")
colComputers = objWMIService.ExecQuery;
 ("Select * from Win32_ComputerSystem")
For Each objComputer in colComputers
 err = ObjComputer.Rename(sNewName)
 If err <> 0
  MESSAGEBOX("Penggantian Nama Komputer Gagal..!!, ;
   error # " + Err)
 Else
  MESSAGEBOX("Penggantian Nama Komputer Berhasil, ;
   Silahkan Restart PC")
 EndIf
EndFor 

*---------------------------------------------------mengetahui komputer yg terhubung

! net view > c:\tmp.txt
cTmp=filetoSTR("c:\tmp.txt")
DELETE FILE c:\tmp.txt
cListpc=SUBSTR(cTmp,AT("\\", cTmp),;
 AT("The command", cTmp)-AT("\\", cTmp))

 *------------------------------------------------- compress & extract file
 && Source untuk Mengkompress Folder
strFolderName="d:\test\hasil" && Folder yang mau di kompress
strZipFileName="c:\hasil.zip" && Nama File ZIP hasil kompres
IF DIRECTORY(JUSTPATH(strZipFileName))=.f.
 MESSAGEBOX("Folder '"+strZipFileName+"' Tidak ada") 
 RETURN .f.
ENDIF  
IF LOWER(JUSTEXT(strZipFileName))<>"zip"
 strZipFileName=strZipFileName+".zip"
ENDIF
fso = CreateObject("Scripting.FileSystemObject")
ts = fso.OpenTextFile(strZipFileName, 8, .t.)
BlankZip = "PK" + Chr(5) + Chr(6)
For x = 1 to 18
 BlankZip = BlankZip + Chr(0)
ENDFOR
ts.Write(BlankZip)
objShell = CreateObject("Shell.Application")
WshShell = CreateObject("WScript.Shell")
DestFldr=objShell.NameSpace(strZipFileName)
SrcFldr=objShell.NameSpace(strFolderName)
DestFldr.CopyHere(strFolderName)
*--------------------- 
&& Source untuk Mengekstrak File ZIP
strFolderName="c:\hasil" && Folder untuk menempatkan file yg di ekstrak
strFileName="c:\hasil.zip" && File ZIP yang ingin di ekstrak
objshell = CreateObject("Shell.Application")
objfso = CreateObject("Scripting.FileSystemObject")
If !DIRECTORY(strFolderName) 
 objfso.CreateFolder(strFolderName)
ENDIF 
objshell.NameSpace(strFolderName).CopyHere;
(objshell.NameSpace(strFileName).Items)

*----------------------------------------------------- drive
WSHShell = CreateObject("WScript.Shell")

*Menyembunyikan Drive
WSHShell.RegWrite("HKEY_CURRENT_USER\Software\Microsoft\+;
 "Windows\CurrentVersion\Policies\Explorer\NoDrives", 256,;
 "REG_DWORD")

*Menampilkan kembali drive yang disembunyikan
WSHShell.RegDelete("HKEY_CURRENT_USER\Software\Microsoft\+;
 "Windows\CurrentVersion\Policies\Explorer\NoDrives")

*Memproteksi Drive
WSHShell.RegWrite("HKEY_CURRENT_USER\Software\Microsoft\+;
 "Windows\CurrentVersion\Policies\Explorer\NoViewOnDrive", 256,;
 "REG_DWORD")

*Menghilangkan proteksi pada drive yang terproteksi
WSHShell.RegDelete("HKEY_CURRENT_USER\Software\Microsoft\+;
 "Windows\CurrentVersion\Policies\Explorer\NoViewOnDrive")

* catatan a=1,b=2,c=4,d=8 dst

*-----------------------------------------------------------------register
WSHShell = CreateObject("WScript.Shell")

*Membuat key dengan nama "Kunciku" di HKCU dengan nilai default "Kunci Tertinggi"
WSHShell.RegWrite("HKCU\Kunciku\", "Kunci Tertinggi")

*Membuat subkey dengan nama "FoxMania" di bawah key "Kunciku" dengan nilai default "Subkey"
WSHShell.RegWrite("HKCU\Kunciku\FoxMania\", "Subkey")

*Membuat sebuah nilai dengan nama "setting" di dalam Key "Kunciku" dengan tipe text yang berisi "1" (REG_SZ)
WSHShell.RegWrite("HKCU\Kunciku\setting", 1)

*Membuat sebuah nilai dengan nama "kode" di dalam Key "Kunciku" dengan tipe decimal yang berisi 3 (REG_DWORD)
WSHShell.RegWrite("HKCU\Kunciku\kode", 3, "REG_DWORD")

*Membuat sebuah nilai dengan nama "setting2" di dalam SubKey "FoxMania" dengan tipe binary yang berisi 3 (REG_BINARY)
WSHShell.RegWrite("HKCU\Kunciku\FoxMania\setting2", 4,;
 "REG_BINARY")

*Membaca nilai default dari Key Kunciku dan disimpan dalam variable cnil
cnil = WSHShell.RegRead("HKCU\Kunciku\")

*Membaca nilai default dari SubKey FoxMania dan disimpan dalam variable cnil 
cnil = WSHShell.RegRead("HKCU\Kunciku\FoxMania\")

*Membaca nilai setting yang ada di Key Kunciku dan disimpan dalam variable cnil 
cnil = WSHShell.RegRead("HKCU\Kunciku\setting")

*Membaca nilai kode yang ada di Key Kunciku dan disimpan dalam variable cnil 
cnil = WSHShell.RegRead("HKCU\Kunciku\kode")

*Menghapus nilai setting2 yang berada di dalam subkey FoxMania
WSHShell.RegDelete("HKCU\Kunciku\FoxMania\setting2")

*Menghapus SubKey FoxMania
WSHShell.RegDelete("HKCU\Kunciku\FoxMania\") 

*Menghapus key Kunciku
WSHShell.RegDelete("HKCU\Kunciku\") 

*----------------------------------------------------- mengatur tanggal dan jam komputer
*Pengaturan tanggal dengan format (dd/mm/yyyy)
ctgl="21/03/2011"
EXECSCRIPT("! date "+ctgl)  

*Pengaturan waktu dengan format (hh:mm:ss)
cwkt="09:06:20"
EXECSCRIPT("! time "+cwkt)

*----------------------------------------------------- mengganti nomor IP

cip="192.168.1.189"
csubnet="255.255.255.0"
cgateway="192.168.1.1"
cscr= '! netsh interface ip set address "Local Area connection";
static '+cip+" "+csubnet+" "+cgateway+" 1"
EXECSCRIPT(cscr)

*----------------------------------------------------- mendeteksi koneksi internet

DECLARE Long InternetCheckConnection IN Wininet.dll String Url,;
Long dwFlags, Long Reserved
lcUrl = "http://www.google.com"
IF InternetCheckConnection(lcUrl, 1, 0) <> 0
cStatus="Terkoneksi"
ELSE
cStatus="Tidak Terkoneksi"
ENDIF

*------------------------------------------------- mengetahui nama workgroup
RUN net config workstation | FINDSTR.EXE ;
 /R /B /I /C:"Workstation domain  " >> c:\tmp.txt
cwg=ALLTRIM(SUBSTR(FILETOSTR("c:\tmp.txt"),;
 19,LEN(FILETOSTR("c:\tmp.txt"))))
DELETE FILE c:\tmp.txt

*------------------------------------------------- mengetahui ip public
Cara 1 -->

oHTML = CreateObject("MSXML2.XMLhttp")
oHTML.open("GET", "http://www.your-ip-address.com", .F.)
ohtml.send()
P3=oHTML.ResponseText
P1="Your IP address is"
P2="</nobr></td></tr></table>"
CIP=SUBSTR(P3,AT(P1,P3,1)+39,AT(P2,P3,1)-AT(P1,P3,1)-39)


Cara 2 -->

LOCAL oIe AS InternetExplorer.Application
LOCAL tDt
oIe = CREATEOBJECT([InternetExplorer.Application])
oIe.Navigate2([whatismyip.com])
tDt = DATETIME()
DO WHILE oIe.ReadyState <> 4 AND DATETIME() - tDt < 30
   INKEY(0.01)
ENDDO

ALINES(laLines,oIe.Document.Body.InnerText)
CIP=SUBSTR(ALLTRIM(laLines[3]),21,LEN(ALLTRIM(laLines[3]))-21)
oIe = NULL

*---------- cek koneksi sebelum transaksi
IF SQLEXEC(lnSQH,[SELECT @@IDENTITY],[crsTest]) < 0
   MessageBox([Connection is not valid anymore])
   RETURN
ENDIF
USE IN SELECT([crsTest]

*---- notifikasi tabungan
Dari : BANK MANDIRI
Trx Rek : xxx123
Transaksi KREDIT : Rp. 50000
tanggal :xx-xx-xxxx jam :xx:xx:xx
*------ perintah di word

buat tabel
Set myRange = ActiveDocument.Range(Start:=0, End:=0)
ActiveDocument.Tables.Add Range:=myRange, NumRows:=3, NumColumns:=4
cari dan ganti di dokumen lain

 ActiveDocument.Range(Start:=0, End:=ActiveDocument.Content.End).Copy
    Documents(1).Activate
    Set myRange = ActiveDocument.Content
    myRange.Find.Execute FindText:="<<jaminan>>"
    myRange.Paste
*!*	 
*!*	*--------------- hanya ntuk catatan pengingat saja
*!*	csql="select coba1 from aa"
*!*	lcek=SQLEXEC(oODBC,csql,"smt")
*!*	csql=coba1
*!*	USE 
*!*	csql=STRTRAN(csql,"&tanggal&","2015-03-19")
*!*	csql=STRTRAN(csql,"&noper&","1101")
*!*	MESSAGEBOX(csql)
*!*	lcek=SQLEXEC(oODBC,csql,"smt")

*!*	 
*!*	  1. mengganti kata tertentu STRTRAN(kalimat,'KATA')
*!*	  ?EXECSCRIPT("oForm=CREATEOBJECT('Form')"+CHR(13)+"?oForm.AutoCenter")
*!*	   
*!*	

*!*	*----- untuk cetak struk
*!*	*-----------------------------------------------------------------------------------------*
*!*	FUNCTION DGEN_RPT  &&  DOS REPORTS
*!*	*-----------------------------------------------------------------------------------------*
*!*	LPARAMETERS lcPrn_Target,lcRpt_Prg,lcPF_Name,lnFontSize,llShowMsg

*!*	IF PARAMETERS() < 4
*!*	   lnFontSize = gnFontNorm
*!*	ENDIF

*!*	IF PARAMETERS() < 5
*!*	   llShowMsg = .F.
*!*	ENDIF

*!*	IF PARAMETERS() < 3
*!*	   lcPF_Name = SET("PRINTER",3)
*!*	ENDIF

*!*	*---  PRINTER
*!*	IF lcPrn_Target = "PRINTER"

*!*	   lcSavePrn = SET("PRINTER",3)
*!*	   IF SET("PRINTER",3) <> lcPF_Name
*!*	      SET PRINTER TO NAME (lcPF_Name)
*!*	   ENDIF
*!*	   SET CONSOLE OFF
*!*	   SET DEVICE TO PRINT
*!*	   SET PRINTER FONT "Courier New",lnFontSize
*!*	   IF llShowMsg
*!*	      WAIT WINDOW " PRINTING REPORT ... PLEASE WAIT " NOWAIT
*!*	   ENDIF

*!*	   DO (lcRpt_Prg)

*!*	   SET CONSOLE ON
*!*	   SET DEVICE TO SCREEN
*!*	   SET PRINTER TO
*!*	   IF SET("PRINTER",3) <> lcSavePrn
*!*	      SET PRINTER TO NAME (lcSavePrn)
*!*	   ENDIF

*!*	   IF llShowMsg
*!*	      WAIT CLEAR
*!*	   ENDIF
*!*	ELSE

*!*	   lcSavePrn = SET("PRINTER",3)
*!*	   SET PRINTER TO (lcPF_Name)
*!*	   SET CONSOLE OFF
*!*	   SET DEVICE TO PRINT
*!*	   SET PRINTER FONT "Courier New",lnFontSize
*!*	   IF llShowMsg
*!*	      WAIT WINDOW " PRINTING REPORT ... PLEASE WAIT " NOWAIT
*!*	   ENDIF

*!*	   DO (lcRpt_Prg)

*!*	   SET CONSOLE ON
*!*	   SET DEVICE TO SCREEN
*!*	   SET PRINTER TO
*!*	   IF SET("PRINTER",3) <> lcSavePrn
*!*	      SET PRINTER TO NAME (lcSavePrn)
*!*	   ENDIF

*!*	   IF llShowMsg
*!*	      WAIT CLEAR
*!*	   ENDIF
*!*	ENDIF
*!*	RETURN ""
*!*	*-----------------------------------------------------------------------------------------* 
*!*	*------------------- ini juga cetak struk
*!*	CLEAR
*!*	CLEA ALL
*!*	LOCAL JmlFile
*!*	JmlFile = 0
*!*	WAIT WIND Tunggu sebentar  NOWA
*!*	JmlFile = ADIR(aFile,data\*.DBF)
*!*	WAIT CLEAR
*!*	LIST DATABASE TO FILE PROGRAM\Inf_Data.txt
*!*	IF JmlFile > 0
*!*	* persiapan pencetakkan 
*!*	LOCAL JmlField, JenisTag
*!*	JenisTag = 
*!*	IF FILE(PROGRAM\+DTOS(DATE())+.TXT)
*!*	aa=DELE FILE PROGRAM\+DTOS(DATE())+.TXT
*!*	&aa
*!*	ENDIF
*!*	aa = SET PRINTER TO PROGRAM\+DTOS(DATE())+.TXT ADDI
*!*	&aa
*!*	SET PRINT ON
*!*	ASORT(aFile)
*!*	FOR j=1 TO JmlFile
*!*	WAIT WIND [+ALLTRIM(STR(j))+/+ALLTRIM(STR(JmlFile))+] FileName : +ALLTRIM(aFile[j,1]) NOWAIT
*!*	nmafile = ALLTRIM(aFile[j,1])
*!*	USE DATA\+ALLTRIM(aFile[j,1]) IN 1 SHARED
*!*	JenisTag = 
*!*	IF j=1
*!*	?  STRUKTUR DATABASE : PASIEN
*!*	? 
*!*	ENDIF
*!*	? [+ALLTRIM(STR(j))+/+ALLTRIM(STR(JmlFile))+] File Name : +nmafile
*!*	? CHR(218)+REPLICATE(CHR(196),16)+CHR(194)+REPLICATE(CHR(196),4)+   CHR(194)+REPLICATE(CHR(196),5)+CHR(194)+REPLICATE(CHR(196),3)+CHR(191)
*!*	? CHR(179)+ Name           +CHR(179)+Type+CHR(179)+Width+CHR(179)+Dec+CHR(179)
*!*	? CHR(195)+REPLICATE(CHR(196),16)+CHR(197)+REPLICATE(CHR(196),4)+CHR(197) +REPLICATE(CHR(196),5)+CHR(197)+REPLICATE(CHR(196),3)+CHR(180)
*!*	JmlField = AFIELDS(AObjField)
*!*	FOR i=1 TO JmlField
*!*	? CHR(179)+ +PADR(AObjField(i,1),15, )+CHR(179)+ +PADR(AObjField(i,2),1, )+  +CHR(179)+TRANSFORM(AObjField(i,3),@Z ###)+;
*!*	  +CHR(179)+TRANSFORM(AObjField(i,4),@Z ##)+ +CHR(179)
*!*	ENDFOR

*!*	? CHR(195)+REPLICATE(CHR(196),12)+Chr(194)+REPLICATE(CHR(196),3)+ CHR(193)+Chr(194)+REPLICATE(CHR(196),3)+CHR(193)+ REPLICATE(CHR(196),5)+CHR(193)+REPLICATE(CHR(196),3)+CHR(193)+REPLICATE(CHR(196),8)
*!*	? CHR(179)+ TAG        +CHR(179)+Type+CHR(179)+  Expresion & Filter
*!*	? CHR(195)+REPLICATE(CHR(196),12)+Chr(197)+     REPLICATE(CHR(196),4)+Chr(197)+REPLICATE(CHR(196),10)+ REPLICATE(CHR(196),3)+REPLICATE(CHR(196),9)
*!*	FOR nCount = 1 TO 254
*!*	IF !EMPTY(TAG(nCount))  && Checks for tags in the index
*!*	DO CASE
*!*	CASE PRIMARY(nCount)
*!*	JenisTag = P
*!*	CASE CANDIDATE(nCount)
*!*	JenisTag = C
*!*	OTHERWISE
*!*	JenisTag = R
*!*	ENDCASE
*!*	? CHR(179)+ +PADR(TAG(nCount),11, )+CHR(179)+  +JenisTag+ +CHR(179)+Key(nCount)
*!*	? CHR(179)+SPACE(12)+CHR(179)+SPACE(4)+CHR(179)+FOR(nCount)      && Display .CDX names
*!*	ELSE
*!*	EXIT  && Exit the loop when no more tags are found
*!*	ENDIF
*!*	ENDFOR
*!*	? CHR(192)+REPLICATE(CHR(196),12)+Chr(193)+REPLICATE(CHR(196),4)+Chr(193)+ REPLICATE(CHR(196),10)+REPLICATE(CHR(196),3)+REPLICATE(CHR(196),9)
*!*	? 
*!*	USE
*!*	ENDFO
*!*	WAIT CLEAR
*!*	SET PRINT OFF
*!*	SET PRINTER TO
*!*	MESSAGEBOX(Proses telah dilakukan ,0+64,)
*!*	*-
*!*	ELSE
*!*	MessageBox(Tidak ada DATABASE !!!!,0+16,)
*!*	RETU .T.
*!*	ENDIF
*!*	CLOS ALL
*!*	CLEA ALL
*!*	CLEAR
*!*	*-----------------------------
*!*	*-------------- ini juga
*!*	* ---- start
*!*	LOCAL nRow
*!*	nRow = 0
*!*	nCounter = 0
*!*	SET DEVICE TO FILE test.txt
*!*	@ 0,0 say CHR(27)+"@"+CHR(27)+"M"
*!*	FOR nRow = 1 TO 5
*!*	   nCounter = nCounter + 1
*!*	   @ nRow,10 say "???? : "+STR(nCounter)
*!*	NEXT
*!*	@ nRow, 0 say ""
*!*	SET DEVICE TO SCREEN
*!*	!type test.txt > prn
*!*	* ---- end

*!*	it works, but cannot print chinese, pls try and let me know

*!*	*----------------- ini langsung ke printer tidak lewat windows
*!*	CLEAR ALL
*!*	USE m:\global\accounts\globalnew IN 0 SHARED
*!*	SELECT globalnew

*!*	SET PRINTER on
*!*	SET PRINTER TO \\printscanserver\ZebraGen
*!*	GO 136580
*!*	DO WHILE RECNO()<136590



*!*	??? '^xa'
*!*	??? '^lh30,80'
*!*	??? '^FO20,10^AS,90,90^FDHAWB: '
*!*	? docket_no
*!*	??? '^FS'
*!*	??? '^FO20,110^AS,35^FD'
*!*	? space(5)+ Upper(trim(company))
*!*	??? '^FS'
*!*	??? '^FO20,160^AS,35^FD'
*!*	?  space(5)+upper(trim(address1))
*!*	??? '^FS'
*!*	??? '^FO20,210^AS,35^FD'
*!*	?   space(5)+upper(trim(address2))
*!*	??? '^FS'
*!*	??? '^FO20,260^AS,35^FD'
*!*	?   space(5)+upper(trim(address3))
*!*	??? '^FS'
*!*	??? '^FO20,310^AS,35^FD'
*!*	?  space(5)+upper(trim(address4))
*!*	??? '^FS'
*!*	??? '^FO20,400^AS,35^FDCONTACT: '
*!*	?  space(5)+upper(trim(CONTACT))
*!*	???'^FS'
*!*	??? '^FO20,480^AS,90,90^FD'
*!*	?   space(5)+str(GLOBALNEW.PIECES,4)+" of "+str(globalnew.pieces,4)
*!*	??? '^FS'
*!*	??? '^FO120,650^BC,60^FD'
*!*	if upper(trim(globalnew.country))="ITALY" OR upper(trim(globalnew.country))="SWITZERLAND";
*!*	OR upper(trim(globalnew.country))="BELGIUM" OR upper(LEFT(globalnew.country,3))="LUX"
*!*	?? space(5)+"*"+alltrim(str(globalnew.docket_no))+"*"
*!*	endif 
*!*	? DOCKET_NO
*!*	??? '^FS'
*!*	??? '^XZ'
*!*	SKIP
*!*	enddo

*!*	SET PRINTER off
*!*	SET PRINTER TO default
*--------------------------- skenario cetak 1 ------------------
install printer dengan sharing
anggap printer aktif di lpt1 (saat awal masuk program)
  net use lpt1: \\user-PC\PLQ20 /persistent:yes
  
hapus setelah selesai (saat keluar program)
  net use */del
*------------------------- melihat tabel dalam 1 databased
select table_name from information_schema.tables where table_schema='<your_database_name>';  

*------- cetak perjanjian
 
*!*	lcIsiPerjanjian = ''
*!*	TEXT TO lcSQLGetLapTagihan TEXTMERGE NOSHOW PRETEXT 2
*!*	PERJANJIAN KITA BERSAMA
*!*	NO. 15-17.123.2322.

*!*	Dengan ini kami nyatakan telah berjanji...


*!*	<<bla...bla...>>

*!*	terima kasih
*!*	endtext




ENDTEXT
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** sql_laporan.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
MKANTOR = 1
DO CASE
CASE MKANTOR=1
MSQL = ""
CSQL = "insert into set_laporan (dept,nama,perintah,penjelasan) value "+"('AKT','LAPORAN NERACA','"+MSQL+"','KHUSUS KPRI ABDI HUSADA, perkiraan akuntansi yg tidak setandar')"
LCEK = SQLEXEC(OODBC, CSQL)
OTHERWISE
ENDCASE
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** akt_neraca_umum.frx
***
*
***
*** akt_neraca_umum.frt
***
*
***
*** akt_labarugi_umum.frx
***
*
***
*** akt_labarugi_umum.frt
***
*
***
*** gl_perkiraan_data.scx
***
*
*
*  gl_perkiraan_data.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.MREC = RECNO()
THISFORM.TEXT1.INPUTMASK = ALLTRIM(DEFAFMTAKT)
THISFORM.BORDERSTYLE = 2
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.KODEASAL = NOPER
THISFORM.TEXT1.SETFOCUS
IF MMODE="EDIT"
THISFORM.HEIGHT = 275
ELSE
THISFORM.HEIGHT = 180
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.LABEL9.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT8.VISIBLE = .F.
ENDIF
IF MMODE="EDIT" .OR. MMODE="TAMPIL"
THISFORM.TEXT1.VALUE = NOPER
THISFORM.TEXT2.VALUE = NAMA
THISFORM.KEL = KEL
THISFORM.KELDATA = KELDATA
THISFORM.TEXT5.VALUE = VAL(LEVEL)
THISFORM.TEXT7.VALUE = BUKUBANTU
THISFORM.TEXT3.VALUE = KEL
THISFORM.TEXT4.VALUE = KELDATA
THISFORM.TEXT8.VALUE = DETAIL
IF MMODE="TAMPIL"
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT2.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
ENDIF
ENDIF
IF MMODE="INPUT"
THISFORM.TEXT1.VALUE = ""
THISFORM.TEXT2.VALUE = ""
THISFORM.TEXT5.VALUE = 1
THISFORM.TEXT7.VALUE = ""
ENDIF
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.OLDSELECT)
MREC = MIN(RECNO(), THISFORM.MREC)
IF MREC=0
GOTO TOP
ELSE
GOTO MREC
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  gl_perkiraan_data.scx::Text1
**
PROCEDURE LostFocus
MDEPAN = LEFT(THIS.VALUE, 1)
MKEL = 'NA'
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MMODEL = VAL(CARIPUBLIC("NRC_MODEL"))
MKEL = ''
MKELDATA = ''
MNRC_AKT = ALLTRIM(CARIPUBLIC("NRC_AKT"))
MNRC_PSV = ALLTRIM(CARIPUBLIC("NRC_PSV"))
MNRC_ADM = ALLTRIM(CARIPUBLIC("NRC_ADM"))
MNRC_PO = ALLTRIM(CARIPUBLIC("NRC_PO"))
MNRC_PL = ALLTRIM(CARIPUBLIC("NRC_PL"))
MNRC_BB = ALLTRIM(CARIPUBLIC("NRC_BB"))
MNRC_BO = ALLTRIM(CARIPUBLIC("NRC_BO"))
MNRC_PNO = ALLTRIM(CARIPUBLIC("NRC_PNO"))
MNRC_BNO = ALLTRIM(CARIPUBLIC("NRC_BNO"))
DO CASE
CASE MNRC_AKT=LEFT(MDEPAN, LEN(MNRC_AKT))
MKEL = 'NA'
MKELDATA = 'NA'
CASE MNRC_PSV=LEFT(MDEPAN, LEN(MNRC_PSV))
MKEL = 'NP'
MKELDATA = 'NP'
CASE MNRC_ADM=LEFT(MDEPAN, LEN(MNRC_ADM))
MKEL = 'AD'
MKELDATA = 'AD'
CASE MNRC_PO=LEFT(MDEPAN, LEN(MNRC_PO))
MKEL = 'RA'
MKELDATA = '11'
CASE MNRC_BO=LEFT(MDEPAN, LEN(MNRC_BO))
MKEL = 'RP'
MKELDATA = '21'
CASE MNRC_PNO=LEFT(MDEPAN, LEN(MNRC_PNO))
MKEL = 'RA'
MKELDATA = '31'
CASE MNRC_BNO=LEFT(MDEPAN, LEN(MNRC_BNO))
MKEL = 'RP'
MKELDATA = '31'
OTHERWISE
MKEL = "RP"
MKELDATA = '40'
ENDCASE
IF MNRC_PL=LEFT(MDEPAN, LEN(MNRC_PL))
MKELDATA = IIF(MMODEL=2, '13', '11')
ENDIF
IF MNRC_BB=LEFT(MDEPAN, LEN(MNRC_BB))
MKELDATA = IIF(MMODEL=3, "21", "12")
ENDIF
THISFORM.KEL = MKEL
THISFORM.KELDATA = MKELDATA
ENDPROC
**
*
*  gl_perkiraan_data.scx::Cmdsimpan1
**
PROCEDURE Click
IF THISFORM.MODE="INPUT"
CSQL = "INSERT into perkiraan (noper, nama,kel,keldata,level,bukubantu) "+"VALUE ('"+THISFORM.TEXT1.VALUE+"' , '"+THISFORM.TEXT2.VALUE+"', '"+THISFORM.KEL+"','"+THISFORM.KELDATA+"','"+STR(THISFORM.TEXT5.VALUE)+"','"+THISFORM.TEXT7.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
CSQL = "UPDATE perkiraan SET noper ='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"', nama='"+THISFORM.TEXT2.VALUE+"', "+"kel='"+THISFORM.TEXT3.VALUE+"', keldata='"+THISFORM.TEXT4.VALUE+"',"+"level='"+ALLTRIM(STR(THISFORM.TEXT5.VALUE))+"', "+"bukubantu='"+THISFORM.TEXT7.VALUE+"', "+"kel='"+THISFORM.TEXT3.VALUE+"', "+"keldata='"+THISFORM.TEXT4.VALUE+"', "+"detail='"+THISFORM.TEXT8.VALUE+"' "+" where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal proses sql")
ENDIF
IF THISFORM.KODEASAL<>THISFORM.TEXT1.VALUE
CSQL = "update jurnal set noper='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update neraca set noper='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update neraca_konsol set noper='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update gl_inventaris set jur_biaya='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jur_biaya='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update gl_inventaris set jur_akum='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jur_akum='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update gl_ksd set noper='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where noper='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi set keterangan='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where keterangan='"+THISFORM.KODEASAL+"' and LEFT(ket2,5)='NOPER'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_pinj set jurnal_pokok='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnal_pokok='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_pinj set jurnal_jasa='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnal_jasa='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_pinj set jurnal_denda='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnal_denda='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_pinj set jurnal_adm='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnal_adm='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_pinj set jurnal_prov='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnal_prov='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_pinj set jurnal_yadit='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnal_yadit='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_pinj set jurnal_ppap='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnal_ppap='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_tab set jurnaltab='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnaltab='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_tab set jurnalutangbg='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnalutangbg='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_tab set jurnaladm='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnaladm='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_tab set jurnaladmtutup='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnaladmtutup='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_tab set jurnalpajak='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnalpajak='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_tab set jurnalksd='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where jurnalksd='"+THISFORM.KODEASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  gl_perkiraan_data.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  gl_perkiraan_data.scx::Text3
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="NA" .OR. THIS.VALUE="NP" .OR. THIS.VALUE="AD" .OR. THIS.VALUE="RA" .OR. THIS.VALUE="RP")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  gl_perkiraan_data.scx::Text4
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="NA" .OR. THIS.VALUE="NP" .OR. THIS.VALUE="AD" .OR. THIS.VALUE="RA" .OR. THIS.VALUE="RP" .OR. THIS.VALUE="31")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  gl_perkiraan_data.scx::Text8
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE="Y" .OR. THIS.VALUE="T")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** gl_perkiraan_data.sct
***
*
***
*** a.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
CLOSE DATABASES
CLEAR
CREATE CURSOR tempcursor (F1 I)
INSERT INTO tempcursor VALUES (1)
LCTMPFRX = "Test.frx"
CREATE REPORT (LCTMPFRX) FROM (DBF())
SELECT 0
USE EXCLUSIVE (LCTMPFRX)
LOCATE FOR OBJTYPE=5 .AND. EXPR='"F1"'
SCATTER MEMO NAME LOTEXTOBJ
LOCATE FOR OBJTYPE=8 .AND. EXPR='f1'
SCATTER MEMO NAME LOFIELDOBJ
SCATTER MEMO NAME LOLINEOBJ
DELETE FOR INLIST(EXPR, '"F1"', 'f1', 'DATE()', '"Page "', '_PAGENO')
REPLACE HEIGHT WITH 0 FOR OBJTYPE=9 .AND. INLIST(OBJCODE, 1, 7)
REPLACE HEIGHT WITH (105000*1.0) FOR OBJTYPE=9 .AND. OBJCODE=4
PACK
USE
WITH LOTEXTOBJ
.FONTSTYLE = 0
.MODE = 0
.MODE = 1
ENDWITH
WITH LOLINEOBJ
.OBJTYPE = 6
.OBJCODE = 0
.PENSIZE = 0
.PENPAT = 8
ENDWITH
SELECT * FROM (LCTMPFRX) INTO TABLE temp.frx
FOR LNCOL = 1 TO 7
WITH LOLINEOBJ
.VPOS = (12083333.0/1000)
.HPOS = LNCOL*10000
.HEIGHT = 90000
.WIDTH = 104.167 
.PENSIZE = 0
.PENPAT = 8
ENDWITH
APPEND BLANK
GATHER MEMO NAME LOLINEOBJ
IF LNCOL<>1
WITH LOTEXTOBJ
.VPOS = 012083
.HPOS = LNCOL*10000-1000
.EXPR = [']+TRANSFORM(LNCOL-1)+[']
ENDWITH
APPEND BLANK
GATHER MEMO NAME LOTEXTOBJ
ENDIF
WITH LOLINEOBJ
.VPOS = 2000+LNCOL*100
.HPOS = LNCOL*10000
.HEIGHT = 104.167 
.WIDTH = 10000
.PENSIZE = 1
.PENPAT = 1
ENDWITH
APPEND BLANK
GATHER MEMO NAME LOLINEOBJ
WITH LOLINEOBJ
.VPOS = (107083*1.0)-(LNCOL*100)
.HPOS = LNCOL*10000
.HEIGHT = 104.167 
.WIDTH = 10000
.PENSIZE = 1
.PENPAT = 1
ENDWITH
APPEND BLANK
GATHER MEMO NAME LOLINEOBJ
ENDFOR
FOR LNROW = 1 TO 10
WITH LOLINEOBJ
.VPOS = 2083.333 +LNROW*10000
.HPOS = 10000
.HEIGHT = 104.167 
.WIDTH = 60000
.PENSIZE = 0
.PENPAT = 8
ENDWITH
APPEND BLANK
GATHER MEMO NAME LOLINEOBJ
IF LNROW<>1
WITH LOTEXTOBJ
.VPOS = 2083.333 +LNROW*10000-1700
.HPOS = 010300
.HEIGHT = 104.167 
.WIDTH = 60000
.EXPR = [']+TRANSFORM(LNROW-1)+[']
ENDWITH
APPEND BLANK
GATHER MEMO NAME LOTEXTOBJ
ENDIF
WITH LOLINEOBJ
.VPOS = 2083.333 +LNROW*10000
.HPOS = LNROW*100
.HEIGHT = 9000
.WIDTH = 104.167 
.PENSIZE = 1
.PENPAT = 1
ENDWITH
APPEND BLANK
GATHER MEMO NAME LOLINEOBJ
WITH LOLINEOBJ
.VPOS = 2083.333 +LNROW*10000
.HPOS = 80000-(LNROW*100)
.HEIGHT = 9000
.WIDTH = 104.167 
.PENSIZE = 1
.PENPAT = 1
ENDWITH
APPEND BLANK
GATHER MEMO NAME LOLINEOBJ
ENDFOR
USE
SELECT TEMPCURSOR
REPORT FORM temp
RETURN
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** akt_neraca_perbandingan.frx
***
*
***
*** akt_neraca_perbandingan.frt
***
*
***
*** akt_labarugi_perbandingan.frx
***
*
***
*** akt_labarugi_perbandingan.frt
***
*
***
*** akt_neraca_harian.frx
***
*
***
*** akt_neraca_harian.frt
***
*
***
*** akt_labarugi_harian.frx
***
*
***
*** akt_labarugi_harian.frt
***
*
***
*** col1.scx
***
*
*
*  col1.scx::COL1
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 9
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 10
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "NO.BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 10
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "NOREK"
.COLUMN3.HEADER1.CAPTION = "NO. REKENING"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 10
.COLUMN4.WIDTH = 300
.COLUMN4.CONTROLSOURCE = "NAMA"
.COLUMN4.HEADER1.CAPTION = "NAMA"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 10
.COLUMN5.WIDTH = 50
.COLUMN5.CONTROLSOURCE = "KDTRANS"
.COLUMN5.HEADER1.CAPTION = "KD"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 10
.COLUMN6.WIDTH = 100
.COLUMN6.CONTROLSOURCE = "TABUNGAN"
.COLUMN6.HEADER1.CAPTION = "TABUNGAN"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 10
.COLUMN6.ALIGNMENT = 1
.COLUMN7.WIDTH = 100
.COLUMN7.CONTROLSOURCE = "trans(POKOK,'999,999,999,999')"
.COLUMN7.HEADER1.CAPTION = "ANGS. POKOK"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 10
.COLUMN7.ALIGNMENT = 1
.COLUMN8.WIDTH = 100
.COLUMN8.CONTROLSOURCE = "trans(JASA,'999,999,999,999')"
.COLUMN8.HEADER1.CAPTION = "ANGS. JASA"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 10
.COLUMN8.ALIGNMENT = 1
.COLUMN9.WIDTH = 100
.COLUMN9.CONTROLSOURCE = "trans(DENDA,'999,999,999,999')"
.COLUMN9.HEADER1.CAPTION = "ANGS. DENDA"
.COLUMN9.HEADER1.FONTBOLD = .T.
.COLUMN9.HEADER1.FONTSIZE = 10
.COLUMN9.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
CSQL = "select SUM(norek) as jml from col_bayar where flag=' ' and "
CSQL = CSQL+IIF(EMPTY(THISFORM.MFILTER.CAPTION), "1", THISFORM.MFILTER.CAPTION)
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX("Gagal baca kolektif")
RETURN
ENDIF
THISFORM.JUMREC = IIF(ISNULL(JML), 0, JML)
THISFORM.HALAMAN = INT(THISFORM.JUMREC/THISFORM.MLIMIT.VALUE)
THISFORM.HAL.VALUE = 1
MLIMIT = ALLTRIM(STR((THISFORM.HAL.VALUE-1)*THISFORM.MLIMIT.VALUE))+", "+ALLTRIM(STR(THISFORM.MLIMIT.VALUE))
CSQL = "select * from col_bayar where flag=' ' and "
CSQL = CSQL+IIF(EMPTY(THISFORM.MFILTER.CAPTION), "1", THISFORM.MFILTER.CAPTION)
CSQL = CSQL+" limit "+MLIMIT
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
RETURN
ENDIF
JMLDATA = RECCOUNT()
GOTO TOP
ENDPROC
**
PROCEDURE Init
PARAMETER MKOL, MTANGGAL, MNAMAKOL
THISFORM.CMDINPUT.VISIBLE = IJINMODUL("COL", "INPUT")
THISFORM.CMDEDIT.VISIBLE = IJINMODUL("COL", "EDIT")
THISFORM.CMDHAPUS.VISIBLE = IJINMODUL("COL", "HAPUS")
THISFORM.CMDCETAK.VISIBLE = IJINMODUL("COL", "CETAK")
THISFORM.OLDSELECT = ALIAS()
THISFORM.KOL = MKOL
THISFORM.TANGGAL = MTANGGAL
THISFORM.NAMAKOL = MNAMAKOL
THISFORM.MFILTER.CAPTION = "kantor='"+DEFAKANTOR+"' and kode='"+THISFORM.KOL+"' and tanggal='"+SQLDATE(THISFORM.TANGGAL)+"'"
THISFORM.MLIMIT.VALUE = 50
THISFORM.JUMREC = 0
THISFORM.HALAMAN = 0
THISFORM.HAL.VALUE = 1
THISFORM.DATA = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
THISFORM.WINDOWSTATE = 2
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.CMDINPUT.CLICK
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  col1.scx::Cmdhapus
**
PROCEDURE Click
MYDATA = THISFORM.DATA
SELECT &MYDATA
MREC = RECNO()
CSQL = "delete from col_bayar where tanggal='"+SQLDATE(TANGGAL)+"' and bukti='"+BUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.MYBACASQL()
IF RECCOUNT()<>0
GOTO MIN(MREC, RECCOUNT())
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Cmdedit
**
PROCEDURE Click
MYDATA = THISFORM.DATA
SELECT &MYDATA
MREC = RECNO()
DO FORM ./form/col1_simp_stor WITH "EDIT", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Cmdinput
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
MYDATA = THISFORM.DATA
SELECT &MYDATA
DO FORM ./form/col1_simp_ambil WITH 'INSERT', THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Cmdkeluar
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col1.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Cmddatatop1
**
PROCEDURE Click
THISFORM.HAL.VALUE = MIN(THISFORM.HALAMAN, THISFORM.HAL.VALUE+1)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  col1.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  col1.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Cmddatabott1
**
PROCEDURE Click
IF THISFORM.HAL.VALUE=THISFORM.HALAMAN
MESSAGEBOX("Halaman Terakhir", 16, "")
ENDIF
THISFORM.HAL.VALUE = MIN(THISFORM.HALAMAN, THISFORM.HAL.VALUE+1)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE DblClick
DO CASE
CASE KDTRANS="SIMP" .AND. TABUNGAN>0
DO FORM .\form\col1_simp_stor WITH "TAMPIL", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
CASE KDTRANS="SIMP" .AND. TABUNGAN<0
DO FORM .\form\col1_simp_ambil WITH "TAMPIL", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
CASE KDTRANS="PINJ"
DO FORM .\form\col1_angsur WITH "TAMPIL", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO CASE
CASE KDTRANS="SIMP" .AND. TABUNGAN>0
DO FORM .\form\col1_simp_stor WITH "TAMPIL", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
CASE KDTRANS="SIMP" .AND. TABUNGAN<0
DO FORM .\form\col1_simp_ambil WITH "TAMPIL", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
CASE KDTRANS="PINJ"
DO FORM .\form\col1_angsur WITH "TAMPIL", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
ENDCASE
KEYBOARD '{LEFTARROW}'
ENDIF
IF NKEYCODE=103 .OR. NKEYCODE=71
THISFORM.CMDCARI1.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=22
THISFORM.CMDINPUT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=274
THISFORM.CMDEDIT.CLICK
NODEFAULT
ENDIF
IF NKEYCODE=7
THISFORM.CMDHAPUS.CLICK
NODEFAULT
ENDIF
ENDPROC
**
*
*  col1.scx::cmdcetak
**
PROCEDURE Click
MKOL = THISFORM.KOL
MTANGGAL = THISFORM.TANGGAL
DEFINE POPUP MYMENU FROM (THISFORM.CMDCETAK.TOP/5)-1, THISFORM.CMDCETAK.LEFT/10 FONT "Cambria", 10 TITLE "CETAK LAPORAN" SHADOW MARGIN
DEFINE BAR 1 OF MYMENU PROMPT "1. REKAP MUTASI PER KOLEKTOR"
DEFINE BAR 2 OF MYMENU PROMPT "2. CETAK SETORAN SIMPANAN   "
DEFINE BAR 3 OF MYMENU PROMPT "3. CETAK PENGAMBILAN SIMPANAN  "
DEFINE BAR 4 OF MYMENU PROMPT "4. CETAK ANGSURAN PINJAMAN   "
ON SELECTION BAR 1 OF MYMENU DO FORM COL1_REKAP WITH "MENU"
ON SELECTION BAR 2 OF MYMENU DO FORM COL1_LAP WITH 1 
ON SELECTION BAR 3 OF MYMENU DO FORM COL1_LAP WITH 2
ON SELECTION BAR 4 OF MYMENU DO FORM COL1_LAP WITH 3
ACTIVATE POPUP MYMENU
ENDPROC
**
*
*  col1.scx::Cmdinput1
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
MYDATA = THISFORM.DATA
SELECT &MYDATA
DO FORM ./form/col1_angsur WITH "INSERT", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  col1.scx::Cmdinput2
**
PROCEDURE Click
MVALID = CEKTANGGAL(TGLNOW)
IF  .NOT. MVALID
MESSAGEBOX("                    Maaf,"+CHR(13)+"Anda tidak dapat melakukan input Data"+CHR(13)+"        Diluar pembatasan tanggal", 16, "")
RETURN
ENDIF
MYDATA = THISFORM.DATA
SELECT &MYDATA
DO FORM ./form/col1_simp_stor WITH "INSERT", THISFORM.KOL, THISFORM.TANGGAL, THISFORM.NAMAKOL
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
***
*** col1.sct
***
*
***
*** col1_simp_stor.scx
***
*
*
*  col1_simp_stor.scx::FORM1
**
FUNCTION nomorbukti
CSQL = "select MAX(bukti) as bukti from col_bayar where tanggal='"+SQLDATE(THISFORM.TGL)+"' and kode='"+THISFORM.KOL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0 .OR. ISNULL(BUKTI)
MBUKTI = ALLTRIM(THISFORM.KOL)+".000001"
ELSE
MANGKA = SUBSTR(BUKTI, 5, 5)
MANGKA = VAL(MANGKA)+1
MHRF = RIGHT('00000'+ALLTRIM(STR(MANGKA)), 5)
MBUKTI = ALLTRIM(THISFORM.KOL)+"."+MHRF
ENDIF
RETURN MBUKTI
ENDFUNC
**
FUNCTION tampil
PARAMETER MNOREK
CSQL = "select norek,b.nama,b.alamat from simpanan as a left join anggota as b on a.cif=b.cif where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Smt")
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
IF ISNULL(NOREK) .OR. EMPTY(NOREK)
RETURN .F.
ENDIF
RETURN .T.
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MKOL, MTGL, MNAMAKOL
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.TEXT1.INPUTMASK = DEFAFMTSIMP
THISFORM.TEXT8.INPUTMASK = DEFAFMTSIMP
THISFORM.KOL = MKOL
THISFORM.TGL = MTGL
THISFORM.MODE = MMODE
THISFORM.LABEL12.CAPTION = MKOL
THISFORM.LABEL13.CAPTION = MNAMAKOL
THISFORM.TOP = THISFORM.TOP+100
DO CASE
CASE MMODE="TAMPIL" .OR. MMODE="EDIT"
THISFORM.TEXT6.VALUE = TANGGAL
THISFORM.TEXT7.VALUE = BUKTI
THISFORM.TEXT8.VALUE = NOREK
THISFORM.TEXT9.VALUE = TABUNGAN
THISFORM.TAMPIL(NOREK)
IF MMODE="TAMPIL"
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
ELSE
THISFORM.TEXT8.SETFOCUS
ENDIF
CASE MMODE="INSERT"
THISFORM.TEXT6.VALUE = MTGL
THISFORM.TEXT7.VALUE = THISFORM.NOMORBUKTI()
THISFORM.TEXT8.SETFOCUS
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  col1_simp_stor.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE) .OR. EMPTY(ALLTRIM(CHRTRAN(THIS.VALUE, '.', '')))
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
IF  .NOT. THISFORM.TAMPIL(THIS.VALUE)
MESSAGEBOX("Nomor rekening tidak ditemukan", 16, "")
NODEFAULT
RETURN
ENDIF
ENDFUNC
**
*
*  col1_simp_stor.scx::Command1
**
PROCEDURE Click
CSQL = "insert into col_bayar (kantor,kode,tanggal,bukti,kdtrans,norek,nama,tabungan,opt) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOL+"','"+SQLDATE(THISFORM.TEXT6.VALUE)+"','"+THISFORM.TEXT7.VALUE+"','"+"SIMP"+"','"+THISFORM.TEXT8.VALUE+"','"+THISFORM.TEXT2.VALUE+"','"+TRANSFORM(THISFORM.TEXT9.VALUE, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
THISFORM.RELEASE
RETURN
ENDIF
FOR A = 1 TO _SCREEN.FORMCOUNT
IF _SCREEN.FORMS(A).BASECLASS="Form" .AND. UPPER(_SCREEN.FORMS(A).NAME)="COL1"
_SCREEN.FORMS[A].CMDREFRESH1.CLICK
ENDIF
ENDFOR
THISFORM.TEXT6.VALUE = TGLNOW
THISFORM.TEXT7.VALUE = THISFORM.NOMORBUKTI()
THISFORM.TEXT8.VALUE = ''
THISFORM.TEXT9.VALUE = 0
THISFORM.TEXT8.SETFOCUS
ENDPROC
**
*
*  col1_simp_stor.scx::Text9
**
PROCEDURE LostFocus
IF THIS.VALUE=0
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** col1_simp_stor.sct
***
*
***
*** col1_simp_ambil.scx
***
*
*
*  col1_simp_ambil.scx::FORM1
**
FUNCTION nomorbukti
CSQL = "select MAX(bukti) as bukti from col_bayar where tanggal='"+SQLDATE(THISFORM.TGL)+"' and kode='"+THISFORM.KOL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0 .OR. ISNULL(BUKTI)
MBUKTI = ALLTRIM(THISFORM.KOL)+".000001"
ELSE
MANGKA = SUBSTR(BUKTI, 5, 5)
MANGKA = VAL(MANGKA)+1
MHRF = RIGHT('00000'+ALLTRIM(STR(MANGKA)), 5)
MBUKTI = ALLTRIM(THISFORM.KOL)+"."+MHRF
ENDIF
RETURN MBUKTI
ENDFUNC
**
FUNCTION tampil
PARAMETER MNOREK
CSQL = "select norek,b.nama,b.alamat from simpanan as a left join anggota as b on a.cif=b.cif where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Smt")
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
IF ISNULL(NOREK) .OR. EMPTY(NOREK)
RETURN .F.
ENDIF
RETURN .T.
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MKOL, MTGL, MNAMAKOL
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.KOL = MKOL
THISFORM.TGL = MTGL
THISFORM.LABEL12.CAPTION = MKOL
THISFORM.LABEL13.CAPTION = MNAMAKOL
THISFORM.TOP = THISFORM.TOP+100
THISFORM.TEXT1.INPUTMASK = DEFAFMTSIMP
THISFORM.TEXT8.INPUTMASK = DEFAFMTSIMP
THISFORM.MODE = MMODE
DO CASE
CASE MMODE="TAMPIL" .OR. MMODE="EDIT"
THISFORM.TEXT6.VALUE = TANGGAL
THISFORM.TEXT7.VALUE = BUKTI
THISFORM.TEXT8.VALUE = NOREK
THISFORM.TEXT9.VALUE = TABUNGAN
THISFORM.TAMPIL(NOREK)
IF MMODE="TAMPIL"
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
ELSE
THISFORM.TEXT8.SETFOCUS
ENDIF
CASE MMODE="INSERT"
THISFORM.TEXT6.VALUE = MTGL
THISFORM.TEXT7.VALUE = THISFORM.NOMORBUKTI()
THISFORM.TEXT8.SETFOCUS
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  col1_simp_ambil.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE) .OR. EMPTY(ALLTRIM(CHRTRAN(THIS.VALUE, '.', '')))
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
IF  .NOT. THISFORM.TAMPIL(THIS.VALUE)
MESSAGEBOX("Nomor rekening tidak ditemukan", 16, "")
NODEFAULT
RETURN
ENDIF
ENDFUNC
**
*
*  col1_simp_ambil.scx::Command1
**
PROCEDURE Click
CSQL = "insert into col_bayar (kantor,kode,tanggal,bukti,kdtrans,norek,nama,tabungan,opt) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOL+"','"+SQLDATE(THISFORM.TEXT6.VALUE)+"','"+THISFORM.TEXT7.VALUE+"','"+"SIMP"+"','"+THISFORM.TEXT8.VALUE+"','"+THISFORM.TEXT2.VALUE+"','"+TRANSFORM(0-THISFORM.TEXT9.VALUE, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
THISFORM.RELEASE
RETURN
ENDIF
FOR A = 1 TO _SCREEN.FORMCOUNT
IF _SCREEN.FORMS(A).BASECLASS="Form" .AND. UPPER(_SCREEN.FORMS(A).NAME)="COL1"
_SCREEN.FORMS[A].CMDREFRESH1.CLICK
ENDIF
ENDFOR
THISFORM.TEXT6.VALUE = TGLNOW
THISFORM.TEXT7.VALUE = THISFORM.NOMORBUKTI()
THISFORM.TEXT8.VALUE = ''
THISFORM.TEXT9.VALUE = 0
THISFORM.TEXT8.SETFOCUS
ENDPROC
**
*
*  col1_simp_ambil.scx::Text9
**
PROCEDURE LostFocus
IF THIS.VALUE=0
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** col1_simp_ambil.sct
***
*
***
*** col1_angsur.scx
***
*
*
*  col1_angsur.scx::FORM1
**
FUNCTION nomorbukti
CSQL = "select MAX(bukti) as bukti from col_bayar where tanggal='"+SQLDATE(THISFORM.TGL)+"' and kode='"+THISFORM.KOL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0 .OR. ISNULL(BUKTI)
MBUKTI = ALLTRIM(THISFORM.KOL)+".000001"
ELSE
MANGKA = SUBSTR(BUKTI, 5, 5)
MANGKA = VAL(MANGKA)+1
MHRF = RIGHT('00000'+ALLTRIM(STR(MANGKA)), 5)
MBUKTI = ALLTRIM(THISFORM.KOL)+".0"+MHRF
ENDIF
RETURN MBUKTI
ENDFUNC
**
FUNCTION tampil
PARAMETER MNOREK
OLDSELECT = SELECT()
CSQL = "select b.kantor,a.cif,a.nama,a.alamat,b.* from anggota as a, pinjaman as b where b.norek='"+MNOREK+"' and a.cif=b.cif"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MTGLREAL = TANGGAL
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
IF TGLLUNAS>CTOD('00-00-0000')
THISFORM.LUNAS.VISIBLE = .T.
ELSE
THISFORM.LUNAS.VISIBLE = .F.
ENDIF
IF ISNULL(NOREK) .OR. EMPTY(NOREK)
MESSAGEBOX("Data tidak ditemukan")
USE
SELECT (OLDSELECT)
RETURN .F.
ENDIF
USE
CSQL = "select * from pinjaman_saldo where norek='"+MNOREK+"' and tanggal=(select MAX(tanggal) from pinjaman_saldo where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT4.VALUE = SISAPOKOK+SISABUNGA
THISFORM.ODPOKOK = TUNGGPK
THISFORM.ODBUNGA = TUNGGBG
THISFORM.SISAPOKOK = SISAPOKOK
THISFORM.SISABUNGA = SISABUNGA
USE
CSQL = "select * from pinjaman_jadwal where norek='"+MNOREK+"' and tanggal=(select MAX(tanggal) from pinjaman_jadwal where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF ISNULL(NOREK) .OR. EMPTY(NOREK)
CSQL = "select * from pinjaman_jadwal where norek='"+MNOREK+"' limit 1"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
ENDIF
THISFORM.JDWPK = POKOK
THISFORM.JDWBG = JASA
THISFORM.TEXT5.VALUE = POKOK+JASA
USE
SELECT (OLDSELECT)
RETURN .T.
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MKOL, MTGL, MNAMAKOL
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.KOL = MKOL
THISFORM.TGL = MTGL
THISFORM.LABEL14.CAPTION = MKOL
THISFORM.LABEL15.CAPTION = MNAMAKOL
THISFORM.TOP = THISFORM.TOP+100
THISFORM.TEXT1.INPUTMASK = DEFAFMTSIMP
THISFORM.TEXT6.VALUE = MTGL
THISFORM.TEXT7.VALUE = THISFORM.NOMORBUKTI()
THISFORM.TEXT8.SETFOCUS
ENDPROC
**
*
*  col1_angsur.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE) .OR. EMPTY(ALLTRIM(CHRTRAN(THIS.VALUE, '.', '')))
DO FORM pinjaman TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
IF  .NOT. THISFORM.TAMPIL(THIS.VALUE)
MESSAGEBOX("Nomor rekening tidak ditemukan", 16, "")
NODEFAULT
RETURN
ENDIF
ENDFUNC
**
*
*  col1_angsur.scx::Command1
**
PROCEDURE Click
CSQL = "insert into col_bayar (kantor,kode,tanggal,bukti,kdtrans,norek,nama,pokok,jasa,opt) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOL+"','"+SQLDATE(THISFORM.TEXT6.VALUE)+"','"+THISFORM.TEXT7.VALUE+"','"+"PINJ"+"','"+THISFORM.TEXT8.VALUE+"','"+THISFORM.TEXT2.VALUE+"','"+TRANSFORM(THISFORM.TEXT10.VALUE, '999999999999999')+"','"+TRANSFORM(THISFORM.TEXT11.VALUE, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
THISFORM.RELEASE
RETURN
ENDIF
FOR A = 1 TO _SCREEN.FORMCOUNT
IF _SCREEN.FORMS(A).BASECLASS="Form" .AND. UPPER(_SCREEN.FORMS(A).NAME)="COL1"
_SCREEN.FORMS[A].CMDREFRESH1.CLICK
ENDIF
ENDFOR
THISFORM.TEXT6.VALUE = TGLNOW
THISFORM.TEXT7.VALUE = THISFORM.NOMORBUKTI()
THISFORM.TEXT8.VALUE = ''
THISFORM.TEXT9.VALUE = 0
THISFORM.TEXT10.VALUE = 0
THISFORM.TEXT11.VALUE = 0
THISFORM.TEXT8.SETFOCUS
ENDPROC
**
*
*  col1_angsur.scx::Text9
**
PROCEDURE LostFocus
IF THIS.VALUE=0
NODEFAULT
RETURN
ENDIF
MJMLBAYAR = THIS.VALUE
OLDSELECT = SELECT()
CSQL = "select SUM(pokok) as pk, SUM(jasa) as js from pinjaman_mutasi where norek=?thisform.text1.value group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "HIT")
MPK = PK
MJS = JS
TJS = JS
MBYRBG = 0
MBYRPK = 0
J1 = 0
P1 = 0
CSQL = "select tanggal,pokok, jasa from pinjaman_jadwal where norek=?thisform.text1.value "
LCEK = SQLEXEC(OODBC, CSQL, "HIT")
GOTO TOP
DO WHILE  .NOT. EOF()
IF MJS<JASA .AND. MJMLBAYAR>0
MJS = MJS
IF J1=0
J1 = 1
MBYRBG = MBYRBG+MIN(MJMLBAYAR, JASA-MJS)
MJMLBAYAR = MJMLBAYAR-MIN(MJMLBAYAR, JASA-MJS)
ELSE
MBYRBG = MBYRBG+MIN(MJMLBAYAR, JASA)
MJMLBAYAR = MJMLBAYAR-MIN(MJMLBAYAR, JASA)
ENDIF
ELSE
MJS = MJS-JASA
ENDIF
IF MPK<POKOK .AND. MJMLBAYAR>0
IF P1=0
P1 = 1
MBYRPK = MBYRPK+MIN(MJMLBAYAR, POKOK-MPK)
MJMLBAYAR = MJMLBAYAR-MIN(MJMLBAYAR, POKOK-MPK)
ELSE
MBYRPK = MBYRPK+MIN(MJMLBAYAR, POKOK)
MJMLBAYAR = MJMLBAYAR-MIN(MJMLBAYAR, POKOK)
ENDIF
ELSE
MPK = MPK-POKOK
ENDIF
SKIP
ENDDO
USE
SELECT (OLDSELECT)
THISFORM.TEXT10.VALUE = MBYRPK
THISFORM.TEXT11.VALUE = MBYRBG
THISFORM.COMMAND1.SETFOCUS
ENDPROC
**
***
*** col1_angsur.sct
***
*
***
*** gl_jurnal_cari.scx
***
*
*
*  gl_jurnal_cari.scx::CARI_JURNAL
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.TEXT4.VALUE = TGLNOW
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF LASTKEY()=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  gl_jurnal_cari.scx::Text1
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_jurnal_cari.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  gl_jurnal_cari.scx::Command1
**
PROCEDURE Click
IF THISFORM.TEXT1.VALUE=CTOD('  -  -    ') .OR. THISFORM.TEXT4.VALUE=CTOD('  -  -    ')
MFILTER = '1'
ELSE
MFILTER = "tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and tanggal<='"+SQLDATE(THISFORM.TEXT4.VALUE)+"'"
ENDIF
MCARI = ""
IF  .NOT. EMPTY(THISFORM.TEXT2.VALUE)
MCARI = MCARI+" bukti='"+THISFORM.TEXT2.VALUE+"' and "
ENDIF
IF  .NOT. EMPTY(THISFORM.TEXT3.VALUE)
MCARI = MCARI+" AT('"+ALLTRIM(THISFORM.TEXT3.VALUE)+"',keterangan)>0 and "
ENDIF
MCARI = LEFT(MCARI, LEN(MCARI)-4)
FOR A = 1 TO _SCREEN.FORMCOUNT
IF _SCREEN.FORMS(A).BASECLASS="Form" .AND. UPPER(_SCREEN.FORMS(A).NAME)="JURNAL"
_SCREEN.FORMS[A].MCARI = MCARI
_SCREEN.FORMS[A].MFILTER.CAPTION = MFILTER
ENDIF
ENDFOR
THISFORM.RELEASE
ENDPROC
**
*
*  gl_jurnal_cari.scx::Text4
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
***
*** gl_jurnal_cari.sct
***
*
***
*** col1_rekap.scx
***
*
*
*  col1_rekap.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
IF THISFORM.MMODE="MENU"
SHOW POPUP MYMENU
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
IF MMODE="MENU"
HIDE POPUP MYMENU
ENDIF
THISFORM.MMODE = MMODE
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.AUTOCENTER = .T.
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = KODE
SUM TABUNGAN TO THISFORM.TEXT4.VALUE FOR KDTRANS="SIMP" .AND. TABUNGAN<0
SUM TABUNGAN TO THISFORM.TEXT3.VALUE FOR KDTRANS="SIMP" .AND. TABUNGAN>0
SUM POKOK TO MPOKOK FOR KDTRANS="PINJ"
SUM JASA TO MJASA FOR KDTRANS="PINJ"
THISFORM.TEXT6.VALUE = MPOKOK+MJASA
THISFORM.TEXT5.VALUE = THISFORM.TEXT3.VALUE+THISFORM.TEXT4.VALUE
THISFORM.TEXT7.VALUE = THISFORM.TEXT5.VALUE+THISFORM.TEXT6.VALUE
ENDPROC
**
*
*  col1_rekap.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** col1_rekap.sct
***
*
***
*** col1_setoran.frx
***
*
***
*** col1_setoran.frt
***
*
***
*** col1_masuk.scx
***
*
*
*  col1_masuk.scx::FORM1
**
PROCEDURE Destroy
IF THISFORM.OKE
DO FORM col1 WITH THISFORM.COMBO1.VALUE, THISFORM.TEXT1.VALUE, THISFORM.TEXT2.VALUE
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.AUTOCENTER = .T.
THISFORM.TEXT1.VALUE = TGLNOW
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002'"
LCEK = SQLEXEC(OODBC, CSQL, "DATAKOL")
THISFORM.COMBO1.ROWSOURCE = "DATAKOL"
ENDPROC
**
PROCEDURE Unload
SELECT DATAKOL
USE
ENDPROC
**
*
*  col1_masuk.scx::Command1
**
PROCEDURE Click
THISFORM.OKE = .T.
THISFORM.RELEASE
ENDPROC
**
*
*  col1_masuk.scx::Combo1
**
PROCEDURE InteractiveChange
THISFORM.TEXT2.VALUE = DATAKOL.KETERANGAN
ENDPROC
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** col1_masuk.sct
***
*
***
*** instansi_masuk.scx
***
*
*
*  instansi_masuk.scx::FORM1
**
PROCEDURE Destroy
IF THISFORM.OKE
DO FORM col_instansi WITH THISFORM.TEXT1.VALUE, THISFORM.TEXT3.VALUE, THISFORM.COMBO1.VALUE, THISFORM.TEXT2.VALUE
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT DATAKOL
USE
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.AUTOCENTER = .T.
THISFORM.TEXT1.VALUE = MONTH(TGLNOW)
THISFORM.TEXT3.VALUE = YEAR(TGLNOW)
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='C002'"
LCEK = SQLEXEC(OODBC, CSQL, "DATAKOL")
THISFORM.COMBO1.ROWSOURCE = "DATAKOL"
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  instansi_masuk.scx::Command1
**
PROCEDURE Click
THISFORM.OKE = .T.
THISFORM.RELEASE
ENDPROC
**
*
*  instansi_masuk.scx::Combo1
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
NODEFAULT
RETURN
ENDIF
ENDPROC
**
PROCEDURE InteractiveChange
THISFORM.TEXT2.VALUE = DATAKOL.KETERANGAN
ENDPROC
**
***
*** instansi_masuk.sct
***
*
***
*** basket 2 check.png
***
*
***
*** payment.ico
***
*
***
*** basket check.png
***
*
***
*** col1_lap.scx
***
*
*
*  col1_lap.scx::FORM1
**
PROCEDURE bacasql
MSYARAT = ""
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "kantor='"+THISFORM.TEXT1.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "tanggal='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT3.VALUE), "", "kode='"+THISFORM.TEXT3.VALUE+"' and ")
IF EMPTY(MSYARAT)
MSYARAT = '1'
ELSE
MSYARAT = LEFT(MSYARAT, LEN(MSYARAT)-5)
ENDIF
DO CASE
CASE THISFORM.NOMORLAP=1
CSQL = "select * from col_bayar "+"where kdtrans='SIMP' and tabungan>'0' and "+MSYARAT+" group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Tidak Terbaca")
ENDIF
CASE THISFORM.NOMORLAP=2
CSQL = "select * from col_bayar "+"where kdtrans='SIMP' and tabungan<'0' and "+MSYARAT+" group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Tidak Terbaca")
ENDIF
CASE THISFORM.NOMORLAP=3
CSQL = "select * from col_bayar "+"where kdtrans='PINJ' and "+MSYARAT+" group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Tidak Terbaca")
ENDIF
ENDCASE
ENDPROC
**
PROCEDURE Unload
SHOW POPUP MYMENU
SELECT SMT
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
HIDE POPUP MYMENU
THISFORM.BAR.WIDTH = 0
THISFORM.NOMORLAP = MKE
THISFORM.OLDSELECT = SELECT()
CREATE CURSOR SMT (COBA C (10))
SELECT (THISFORM.OLDSELECT)
THISFORM.BORDERSTYLE = 2
THISFORM.HEIGHT = 165
THISFORM.TEXT1.VALUE = DEFAKANTOR
THISFORM.TEXT5.VALUE = NAMAKANTOR(DEFAKANTOR)
THISFORM.TEXT2.VALUE = TGLNOW
THISFORM.TEXT3.VALUE = KODE
DO CASE
CASE MKE=1
THISFORM.JUDUL.CAPTION = "SETORAN SIMPANAN KOLEKTIF"
THISFORM.FRXNAME = "col1_setoran.frx"
CASE MKE=2
THISFORM.JUDUL.CAPTION = "PENGAMBILAN SIMPANAN KOLEKTIF"
THISFORM.FRXNAME = "col1_pengambilan.frx"
CASE MKE=3
THISFORM.JUDUL.CAPTION = "ANGSURAN KOLEKTIF"
THISFORM.FRXNAME = "col1_angsuran.frx"
ENDCASE
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
ENDPROC
**
*
*  col1_lap.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  col1_lap.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col1_lap.scx::Text13
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  col1_lap.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
REPORT FORM (THISFORM.FRXNAME) PREVIEW
ENDPROC
**
*
*  col1_lap.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer")
ENDIF
ENDPROC
**
*
*  col1_lap.scx::Text2
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  col1_lap.scx::Text5
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  col1_lap.scx::text1
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+"0000 ,KONSOLIDASI,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE InteractiveChange
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT5.VALUE = BB
ENDPROC
**
*
*  col1_lap.scx::text3
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT16.VALUE = BB
ENDPROC
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P002'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
***
*** col1_lap.sct
***
*
***
*** col1_pengambilan.frx
***
*
***
*** col1_pengambilan.frt
***
*
***
*** col1_angsuran.frx
***
*
***
*** col1_angsuran.frt
***
*
***
*** a2.scx
***
*
*
*  a2.scx::Command1
**
PROCEDURE Click
MTGL = TGLNOW
MLEVEL = '3'
AA = "set filter to level<='"+MLEVEL+"'"
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where LEFT(kel,1)='R' order by keldata,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
IF DETAIL='Y'
CSQL = "select saldo from neraca where noper='"+MNOPER+"' and tanggal=(select MAX(tanggal) from neraca where noper='"+MNOPER+"' and tanggal<'2015-04-05')"
LCEK = SQLEXEC(OODBC, CSQL, "aa1")
MSALDO = SALDO
USE
SELECT AA
REPLACE SALDO WITH MSALDO
ENDIF
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
IF DETAIL='T'
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
ENDIF
SKIP
ENDDO
BROWSE
&AA
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
BROWSE
ENDPROC
**
*
*  a2.scx::Command2
**
PROCEDURE Click
THISFORM.SHAPE1.WIDTH = 0
THISFORM.TEXT1.VALUE = TIME()
CREATE CURSOR KREDIT (KANTOR C (4), TANGGAL DATE, BUKTI C (10), NOREK C (25), NOPK C (25), KDHIT C (1), MARKETING C (5), CIF C (10), NAMA C (30), ALAMAT C (50), DESA C (50), KECAMATAN C (50), KOTA C (50), AGAMA C (50), PHONE C (30), POKOK N (15), RATE N (5, 2), JASA N (15), LAMA N (3), TGLMULAI DATE, TGLJTEMPO DATE, ADM N (10), PROVISI N (10), MATERAI N (10), NOTARIS N (10), LAINLAIN N (10), BIAYA N (10), JENIS C (4), KELOMPOK C (4), WILAYAH C (4), PENGGUNAAN C (4), SEKTOR C (4), SUMBER C (4), TGLLUNAS DATE, KOL C (1), PLAFON INT (10), PKAWAL N (15), BGAWAL N (15), SISAPK INT (15), SISABG INT (15), HRSPK N (15), HRSBG N (15), SISAJDWPK N (15), SISAJDWBG N (15), KALIPK N (5, 1), KALIBG N (5, 1), JUMJDWPK N (3), JUMJDWBG N (3), ODPK INT (15), ODBG INT (15), TGLODPK DATE, TGLODBG DATE, WJBPK INT (15), WJBBG INT (15), JDWKE INT (3), ANGSKE INT (3), HARUSKE INT (3), NJDWPK INT (15), NJDWBG INT (15), MTGLKHBYR DATE, BYRPK INT (15), BYRBG INT (15), DENDA INT (10), KALIBYRPK N (3), KALIBYRBG N (3), JAMINAN C (100), TAKSASI N (15), PPAP N (15), PPAP1 N (15), BGAKRUAL N (15), KONTIJENSI N (15), SLDADM N (15), SLDPROVISI N (15), SLDBIAYA N (15))
CSQL = "select b.nama,b.alamat,b.desa,b.kecamatan,b.kota,b.agama,b.phone,a.* from pinjaman as a left join anggota as b on a.cif=b.cif where tgllunas='0000-00-00' or tgllunas>'"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
REKNO = 1
JUMREC = RECCOUNT()
DO WHILE  .NOT. EOF()
SELECT KREDIT
APPEND BLANK
FOR A = 1 TO 034
MFIELD = FIELD(A)
MDATA = "SMT."+MFIELD
MISI=&MDATA
MISI = IIF(VARTYPE(MISI)='C', "'"+MISI+"'", MISI)
MISI = IIF(VARTYPE(MISI)='N', "val('"+ALLTRIM(STR(MISI))+"')", MISI)
MISI = IIF(VARTYPE(MISI)='D', "ctod('"+DTOC(MISI)+"')", MISI)
SELECT KREDIT
AA = "REPLACE "+MFIELD+" with "+MISI
&AA
ENDFOR
THISFORM.SHAPE1.WIDTH = (REKNO/JUMREC)*370
SALDOKRD(NOREK, TGLNOW)
SELECT SALDOKRD
FOR A = 2 TO 40
MFIELD = FIELD(A)
MDATA = "saldokrd."+MFIELD
MISI=&MDATA
MISI = IIF(VARTYPE(MISI)='C', "'"+MISI+"'", MISI)
MISI = IIF(VARTYPE(MISI)='N', "val('"+ALLTRIM(STR(MISI))+"')", MISI)
MISI = IIF(VARTYPE(MISI)='D', "ctod('"+DTOC(MISI)+"')", MISI)
SELECT KREDIT
AA = "REPLACE "+MFIELD+" with "+MISI
&AA
SELECT SALDOKRD
ENDFOR
SELECT KREDIT
REPLACE SLDADM WITH SALDOKRD.ADM
REPLACE SLDPROVISI WITH SALDOKRD.PROVISI
REPLACE SLDBIAYA WITH SALDOKRD.BIAYA
SELECT SMT
THISFORM.TEXT5.VALUE = REKNO
REKNO = REKNO+1
SKIP
ENDDO
THISFORM.TEXT2.VALUE = TIME()
THISFORM.TEXT4.VALUE = RECCOUNT()
SELECT KREDIT
BROWSE
ENDPROC
**
***
*** a2.sct
***
*
***
*** a2.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
CSQL = "DROP TRIGGER cif_update"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
  CREATE TRIGGER `cif_update` AFTER UPDATE ON `anggota` FOR EACH ROW BEGIN
	   if old.cif<>new.cif then 
	      update anggota_mutasi set cif=new.cif where cif=old.cif;
	      update pinjaman set cif=new.cif where cif=old.cif ;
	      update simpanan set cif=new.cif where cif=old.cif;
	      update catatan set norek=new.cif where dept='ANGG' and norek=old.cif;
	   end if;
  
  END 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - cif_udate gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER pinj_insert"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
    CREATE TRIGGER `pinj_insert` AFTER INSERT ON `pinjaman` FOR EACH ROW BEGIN    
    SET @mppap=NEW.pokok*(0.5/100);
    INSERT INTO pinjaman_saldo (kantor,norek,tanggal,sisapokok,sisabunga,kol_awal,kol,ppap,adm,provisi,biaya) VALUES 
    (NEW.kantor,NEW.norek,NEW.tanggal,NEW.pokok,NEW.jasa,'1','1',@mppap,NEW.adm,NEW.provisi,NEW.biaya);
    END 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - pinj_insert gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER pinj_update"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
create trigger `pinj_update` AFTER UPDATE ON `pinjaman` 
    FOR EACH ROW BEGIN    
    IF old.norek<>new.norek THEN 
       set @mNorek=old.norek;
       set @Newnorek=new.norek;
       UPDATE pinjaman_saldo SET norek=@Newnorek WHERE norek=@mnorek;
       update pinjaman_akrual SET norek=@Newnorek WHERE norek=@mnorek;
       update pinjaman_jadwal SET norek=@Newnorek WHERE norek=@mnorek;
       update pinjaman_jaminan SET norek=@Newnorek WHERE norek=@mnorek;
       update pinjaman_mutasi SET norek=@Newnorek WHERE norek=@mnorek;
       update catatan set norek=@Newnorek where dept='PINJ' and norek=@mNorek;
    end if;
end; 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - pinj_insert gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER simp_insert"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
    CREATE TRIGGER `simp_insert` AFTER INSERT ON `simpanan` FOR EACH ROW BEGIN    
        INSERT INTO simpanan_saldo (kantor,norek, tanggal, saldo) VALUES 
       (NEW.kantor,NEW.norek,NEW.tanggal,'0');
    END 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - simp_insert gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER `simp_update`"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
CREATE TRIGGER `simp_update` AFTER UPDATE on `simpanan` FOR EACH ROW BEGIN    
    IF old.norek<>new.norek THEN 
       set @mNorek=old.norek;
       set @Newnorek=new.norek;
       UPDATE simpanan_saldo SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_akrual SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_autodebet SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_blokir SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_bilyet SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_bunga SET norek=@Newnorek WHERE norek=@mnorek;  
       update simpanan_mutasi SET norek=@Newnorek WHERE norek=@mnorek;
       update catatan SET norek=@Newnorek WHERE dept='SIMP' and norek=@mnorek;
    end if;
END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - simp_update gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER inv_ins"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
   CREATE TRIGGER `inv_ins` AFTER INSERT ON `gl_inventaris_mutasi` FOR EACH ROW BEGIN
   set @mAkum=(select sum(kredit)-sum(debet) from gl_inventaris_mutasi where nomorid=NEW.nomorid);
   set @mnilai=(select harga from gl_inventaris where nomorid=new.nomorid);
   update gl_inventaris set akumulasi=@mAkum, nilaibuku=(@mNilai-@mAkum) where nomorid=new.nomorid;
   END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - inv_insert dibuat")
ENDIF
CSQL = "DROP FUNCTION IF EXISTS cekblokir"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
   CREATE FUNCTION `cekblokir` (mnorek varchar(17), mtgl date)	RETURNS varchar(1) BEGIN
   SET @ada=(select count(norek) from simpanan_blokir where norek=mnorek and tglcabut='0000-00-00' or tglcabut>mtgl);
   if @ada>0 then 
      return 'Y' ;
   else 
      return 'T';
   end if;     
   END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("FUNCTION CEK BLOKIR")
ENDIF
CSQL = "DROP FUNCTION IF EXISTS cekautodebet"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
   CREATE FUNCTION `cekautodebet`(mnorek varchar(17), mtgl date)	RETURNS varchar(1) BEGIN
   SET @ada=(select count(norek) from simpanan_autodebet where norek=mnorek and tglcabut='0000-00-00' or tglcabut>mtgl);
   if @ada>0 then 
      return 'Y' ;
   else 
      return 'T';
   end if;     
   END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("FUNCTION CEK AUTODEBET")
ENDIF
CSQL = "DROP FUNCTION IF EXISTS saldotab"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
     CREATE FUNCTION saldotab(mnorek varchar(25), mtgl date)	RETURNS double(15,0)    BEGIN
       set @iddata=(select max(iddata) from simpanan_mutasi where norek=mnorek and tanggal<=mtgl);       
       set @sld=(select saldo from simpanan_mutasi where norek=mnorek and iddata=@iddata);
       return @sld;    
       END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("GAGAL MEMBUAT PROCEDURE SALDOTAB")
ENDIF
CSQL = "DROP TRIGGER perkiraan_au"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
	create trigger `perkiraan_au` AFTER UPDATE on `perkiraan` 
	for each row BEGIN
	   if old.noper<>new.noper then 
	      update neraca set noper=new.noper where noper=old.noper;
	      update neraca_konsol set noper=new.noper where noper=old.noper;
	      update jurnal set noper=new.noper where noper=old.noper;
	      update setsandi set keterangan=new.noper where keterangan=old.noper and left(ket2,5)='NOPER';
	      update setsandi_pinj set jurnal_pokok=new.noper where jurnal_pokok=old.noper;
	      update setsandi_pinj set jurnal_jasa=new.noper where jurnal_jasa=old.noper;
	      update setsandi_pinj set jurnal_denda=new.noper where jurnal_denda=old.noper;
	      update setsandi_pinj set jurnal_adm=new.noper where jurnal_adm=old.noper;
	      update setsandi_pinj set jurnal_prov=new.noper where jurnal_prov=old.noper;
	      update setsandi_pinj set jurnal_yadit=new.noper where jurnal_yadit=old.noper;
	      update setsandi_pinj set jurnal_ppap=new.noper where jurnal_ppap=old.noper;
	      update setsandi_tab set jurnaltab=new.noper where jurnaltab=old.noper;
	      update setsandi_tab set jurnalutangbg=new.noper where jurnalutangbg=old.noper;
	      update setsandi_tab set jurnalbunga=new.noper where jurnalbunga=old.noper;
	      update setsandi_tab set jurnaladm=new.noper where jurnaladm=old.noper;
	      update setsandi_tab set jurnaladmtutup=new.noper where jurnaladmtutup=old.noper;
	      update setsandi_tab set jurnalpajak=new.noper where jurnalpajak=old.noper;
	      update setsandi_tab set jurnalksd=new.noper where jurnalksd=old.noper;
	   end if;
	  
	END;
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER UFTER UPDATE PERKIRAAN")
ENDIF
CSQL = "DROP TRIGGER neraca_au"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
     CREATE TRIGGER `neraca_au` AFTER UPDATE on `neraca`FOR EACH ROW BEGIN        
     set @msaldoawal=(select sum(saldoawal) from neraca where noper=new.noper and tanggal=new.tanggal);
     set @mdebet=(select sum(debet) from neraca where noper=new.noper and tanggal=new.tanggal);
     set @mkredit=(select sum(kredit) from neraca where noper=new.noper and tanggal=new.tanggal);
     set @msaldo=(select sum(saldo) from neraca where noper=new.noper and tanggal=new.tanggal);
     update neraca_konsol set saldoawal=@msaldoawal,debet=@mdebet,kredit=@mkredit,saldo=@msaldo where noper=new.noper and tanggal=new.tanggal;
    END;
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER NERACA AFTER UPDATE")
ENDIF
CSQL = "DROP TRIGGER neraca_ai"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
    CREATE TRIGGER `neraca_ai` AFTER INSERT on `neraca` FOR EACH ROW BEGIN    
    set @mnoper=(select noper from neraca_konsol where noper=new.noper and tanggal=new.tanggal);
    if @mnoper<>'' then
        set @msaldoawal=(select sum(saldoawal) from neraca where noper=new.noper and tanggal=new.tanggal);
        set @mdebet=(select sum(debet) from neraca where noper=new.noper and tanggal=new.tanggal);
        set @mkredit=(select sum(kredit) from neraca where noper=new.noper and tanggal=new.tanggal);
        set @msaldo=(select sum(saldo) from neraca where noper=new.noper and tanggal=new.tanggal);
        insert into neraca_konsol (noper,tanggal,saldoawal,debet,kredit,saldo) value (new.noper,new.tanggal,@msaldoawal,@mdebet,@mkredit,@msaldo);
    end if;
    END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER NERACA AFTER INSERT")
ENDIF
CSQL = "DROP FUNCTION hitneraca"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
    CREATE FUNCTION hitneraca(mkantor varchar(4), mnoper varchar(10), mtgl date) RETURNS double(15,0)
    BEGIN
        SET @tgl=(select max(tanggal) from neraca where kantor=mkantor and noper=mnoper and tanggal<=mtgl group by noper );
        set @sld=(select sum(saldo) from neraca where kantor=mkantor and noper=mnoper and tanggal=@tgl );     
        return @sld;
    END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("FUNCTION HITNERACA")
ENDIF
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** pinjaman_lunas.scx
***
*
*
*  pinjaman_lunas.scx::FORM1
**
PROCEDURE Init
THISFORM.DATA1 = SELECT()
OLDSELECT = SELECT()
MDENDA = HITDENDA(NOREK, TGLNOW)
MCUR = SALDOKRD(NOREK, TGLNOW)
SELECT (MCUR)
MSISAPK = SISAPK
MSISABG = SISABG
USE
SELECT (OLDSELECT)
THISFORM.TEXT2.VALUE = NOREK
THISFORM.TEXT3.VALUE = NAMA
THISFORM.TEXT4.VALUE = POKOK
THISFORM.TEXT5.VALUE = MSISAPK
THISFORM.TEXT6.VALUE = MSISABG
THISFORM.TEXT7.VALUE = MDENDA
IF .T.
THISFORM.TEXT1.VALUE = TGLNOW
ELSE
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.COMMAND2.ENABLED = .F.
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  pinjaman_lunas.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_lunas.scx::Command2
**
PROCEDURE Click
CSQL = "select * from user where userid='"+ALLTRIM(THISFORM.TEXT8.VALUE)+"' and password=md5('"+ALLTRIM(THISFORM.TEXT9.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF USERID<>THISFORM.TEXT8.VALUE
MESSAGEBOX("VALIDASI PELUNASAN GAGAL DILAKUKAN", 0, "")
NODEFAULT
RETURN
ENDIF
MDISCJASA = MAX(THISFORM.TEXT6.VALUE, 0)
IF MDISCJASA>0
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,pokok,jasa,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT2.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT1.VALUE)+"',"+"'"+SQLDATE(THISFORM.TEXT1.VALUE)+"',"+"'"+"-"+"',"+"'"+DEFAPINPOT+"',"+"'"+STR(0)+"',"+"'"+STR(MDISCJASA)+"',"+"'"+THISFORM.TEXT8.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SELECT (THISFORM.DATA1)
REPLACE TGLLUNAS WITH THISFORM.TEXT1.VALUE
CSQL = "update pinjaman set tgllunas='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' where norek='"+ALLTRIM(THISFORM.TEXT2.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT (THISFORM.DATA1)
THISFORM.RELEASE
ENDPROC
**
***
*** pinjaman_lunas.sct
***
*
***
*** handshak.ico
***
*
***
*** simpanan_simulasi.scx
***
*
*
*  simpanan_simulasi.scx::FORM1
**
PROCEDURE Unload
SELECT COBA
USE
SELECT (THISFORM.OLDSELECT)
SHOW POPUP MYMENU
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
HIDE POPUP MYMENU
MNOREK = NOREK
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = TGLNOW
THISFORM.OLDSELECT = SELECT()
HASIL = LISTBUNGA(MNOREK, TGLNOW, "Y", "coba")
HSL1 = VAL(LEFT(HASIL, AT('|', HASIL)-1))
HSL2 = VAL(SUBSTR(HASIL, AT('|', HASIL)+1))
SELECT COBA
SUM BUNGA TO HSL1 
SUM PAJAK TO HSL2 
THISFORM.TEXT4.VALUE = HSL1
THISFORM.TEXT5.VALUE = HSL2
GOTO TOP
WITH THISFORM.GRID1
.RECORDSOURCE = "coba"
.COLUMNCOUNT = 9
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "DEBET"
.COLUMN3.HEADER1.CAPTION = "DEBET"
.COLUMN4.WIDTH = 100
.COLUMN4.CONTROLSOURCE = "KREDIT"
.COLUMN4.HEADER1.CAPTION = "KREDIT"
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "SALDO"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "SALDO"
.COLUMN6.WIDTH = 40
.COLUMN6.CONTROLSOURCE = "HARI"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "HARI"
.COLUMN7.WIDTH = 40
.COLUMN7.CONTROLSOURCE = "RATE"
.COLUMN7.INPUTMASK = "999,999,999,999"
.COLUMN7.ALIGNMENT = 1
.COLUMN7.HEADER1.CAPTION = "RATE"
.COLUMN8.WIDTH = 50
.COLUMN8.CONTROLSOURCE = "BUNGA"
.COLUMN8.HEADER1.CAPTION = "BUNGA"
.COLUMN9.WIDTH = 50
.COLUMN9.CONTROLSOURCE = "PAJAK"
.COLUMN9.HEADER1.CAPTION = "PAJAK"
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
*
*  simpanan_simulasi.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_simulasi.scx::Command2
**
PROCEDURE Click
REPORT FORM simp_simulasi_jasa PREVIEW
ENDPROC
**
***
*** simpanan_simulasi.sct
***
*
***
*** simp_simulasi_jasa.frx
***
*
***
*** simp_simulasi_jasa.frt
***
*
***
*** lap.frx
***
*
***
*** lap.frt
***
*
***
*** a3.scx
***
*
*
*  a3.scx::Command1
**
PROCEDURE Click
LOCAL MFILE
MFILE = PUTFILE("", "", "TXT")
IF  .NOT. EMPTY(MFILE)
LNFILEHANDLE = FCREATE(MFILE)
MTEXT = THISFORM.EDIT1.VALUE
FWRITE(LNFILEHANDLE, MTEXT)
FCLOSE(LNFILEHANDLE)
ENDIF
ENDPROC
**
*
*  a3.scx::Command2
**
PROCEDURE Click
MFILE = GETFILE("TXT", "", "Buka")
IF ( .NOT. EMPTY(MFILE))
LNFILEHANDLE = FOPEN(MFILE)
IF LNFILEHANDLE=-1
RETURN
ENDIF
THISFORM.EDIT1.VALUE = ''
MDATA = ''
DO WHILE  .NOT. FEOF(LNFILEHANDLE)
MDATA = FGETS(LNFILEHANDLE)
THISFORM.EDIT1.VALUE = THISFORM.EDIT1.VALUE+MDATA+CHR(13)
ENDDO
FCLOSE(LNFILEHANDLE)
ENDIF
ENDPROC
**
***
*** a3.sct
***
*
***
*** form_buatdatabased.scx
***
*
*
*  form_buatdatabased.scx::FORM1
**
PROCEDURE buattrigger
CSQL = "DROP TRIGGER cif_update"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
  CREATE TRIGGER `cif_update` AFTER UPDATE ON `anggota` FOR EACH ROW BEGIN
	   if old.cif<>new.cif then 
	      update anggota_mutasi set cif=new.cif where cif=old.cif;
	      update pinjaman set cif=new.cif where cif=old.cif ;
	      update simpanan set cif=new.cif where cif=old.cif;
	      update catatan set norek=new.cif where dept='ANGG' and norek=old.cif;
	   end if;
  
  END 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - cif_udate gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER pinj_insert"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
    CREATE TRIGGER `pinj_insert` AFTER INSERT ON `pinjaman` FOR EACH ROW BEGIN    
    SET @mppap=NEW.pokok*(0.5/100);
    INSERT INTO pinjaman_saldo (kantor,norek,tanggal,sisapokok,sisabunga,kol_awal,kol,ppap,adm,provisi,biaya) VALUES 
    (NEW.kantor,NEW.norek,NEW.tanggal,NEW.pokok,NEW.jasa,'1','1',@mppap,NEW.adm,NEW.provisi,NEW.biaya);
    END 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - pinj_insert gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER pinj_update"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
create trigger `pinj_update` AFTER UPDATE ON `pinjaman` 
    FOR EACH ROW BEGIN    
    IF old.norek<>new.norek THEN 
       set @mNorek=old.norek;
       set @Newnorek=new.norek;
       UPDATE pinjaman_saldo SET norek=@Newnorek WHERE norek=@mnorek;
       update pinjaman_akrual SET norek=@Newnorek WHERE norek=@mnorek;
       update pinjaman_jadwal SET norek=@Newnorek WHERE norek=@mnorek;
       update pinjaman_jaminan SET norek=@Newnorek WHERE norek=@mnorek;
       update pinjaman_mutasi SET norek=@Newnorek WHERE norek=@mnorek;
       update catatan set norek=@Newnorek where dept='PINJ' and norek=@mNorek;
    end if;
end; 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - pinj_insert gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER simp_insert"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
    CREATE TRIGGER `simp_insert` AFTER INSERT ON `simpanan` FOR EACH ROW BEGIN    
        INSERT INTO simpanan_saldo (kantor,norek, tanggal, saldo) VALUES 
       (NEW.kantor,NEW.norek,NEW.tanggal,'0');
    END 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - simp_insert gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER `simp_update`"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
CREATE TRIGGER `simp_update` AFTER UPDATE on `simpanan` FOR EACH ROW BEGIN    
    IF old.norek<>new.norek THEN 
       set @mNorek=old.norek;
       set @Newnorek=new.norek;
       UPDATE simpanan_saldo SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_akrual SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_autodebet SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_blokir SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_bilyet SET norek=@Newnorek WHERE norek=@mnorek;
       update simpanan_bunga SET norek=@Newnorek WHERE norek=@mnorek;  
       update simpanan_mutasi SET norek=@Newnorek WHERE norek=@mnorek;
       update catatan SET norek=@Newnorek WHERE dept='SIMP' and norek=@mnorek;
    end if;
END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - simp_update gagal dibuat")
ENDIF
CSQL = "DROP TRIGGER inv_ins"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
   CREATE TRIGGER `inv_ins` AFTER INSERT ON `gl_inventaris_mutasi` FOR EACH ROW BEGIN
   set @mAkum=(select sum(kredit)-sum(debet) from gl_inventaris_mutasi where nomorid=NEW.nomorid);
   set @mnilai=(select harga from gl_inventaris where nomorid=new.nomorid);
   update gl_inventaris set akumulasi=@mAkum, nilaibuku=(@mNilai-@mAkum) where nomorid=new.nomorid;
   END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER - inv_insert dibuat")
ENDIF
CSQL = "DROP FUNCTION IF EXISTS cekblokir"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
   CREATE FUNCTION `cekblokir` (mnorek varchar(17), mtgl date)	RETURNS varchar(1) BEGIN
   SET @ada=(select count(norek) from simpanan_blokir where norek=mnorek and tglcabut='0000-00-00' or tglcabut>mtgl);
   if @ada>0 then 
      return 'Y' ;
   else 
      return 'T';
   end if;     
   END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("FUNCTION CEK BLOKIR")
ENDIF
CSQL = "DROP FUNCTION IF EXISTS cekautodebet"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
   CREATE FUNCTION `cekautodebet`(mnorek varchar(17), mtgl date)	RETURNS varchar(1) BEGIN
   SET @ada=(select count(norek) from simpanan_autodebet where norek=mnorek and tglcabut='0000-00-00' or tglcabut>mtgl);
   if @ada>0 then 
      return 'Y' ;
   else 
      return 'T';
   end if;     
   END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("FUNCTION CEK AUTODEBET")
ENDIF
CSQL = "DROP FUNCTION IF EXISTS saldotab"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
     CREATE FUNCTION saldotab(mnorek varchar(25), mtgl date)	RETURNS double(15,0)    BEGIN
       set @iddata=(select max(iddata) from simpanan_mutasi where norek=mnorek and tanggal<=mtgl);       
       set @sld=(select saldo from simpanan_mutasi where norek=mnorek and iddata=@iddata);
       return @sld;    
       END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("GAGAL MEMBUAT PROCEDURE SALDOTAB")
ENDIF
CSQL = "DROP TRIGGER perkiraan_au"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
	create trigger `perkiraan_au` AFTER UPDATE on `perkiraan` 
	for each row BEGIN
	   if old.noper<>new.noper then 
	      update neraca set noper=new.noper where noper=old.noper;
	      update neraca_konsol set noper=new.noper where noper=old.noper;
	      update jurnal set noper=new.noper where noper=old.noper;
	      update setsandi set keterangan=new.noper where keterangan=old.noper and left(ket2,5)='NOPER';
	      update setsandi_pinj set jurnal_pokok=new.noper where jurnal_pokok=old.noper;
	      update setsandi_pinj set jurnal_jasa=new.noper where jurnal_jasa=old.noper;
	      update setsandi_pinj set jurnal_denda=new.noper where jurnal_denda=old.noper;
	      update setsandi_pinj set jurnal_adm=new.noper where jurnal_adm=old.noper;
	      update setsandi_pinj set jurnal_prov=new.noper where jurnal_prov=old.noper;
	      update setsandi_pinj set jurnal_yadit=new.noper where jurnal_yadit=old.noper;
	      update setsandi_pinj set jurnal_ppap=new.noper where jurnal_ppap=old.noper;
	      update setsandi_tab set jurnaltab=new.noper where jurnaltab=old.noper;
	      update setsandi_tab set jurnalutangbg=new.noper where jurnalutangbg=old.noper;
	      update setsandi_tab set jurnalbunga=new.noper where jurnalbunga=old.noper;
	      update setsandi_tab set jurnaladm=new.noper where jurnaladm=old.noper;
	      update setsandi_tab set jurnaladmtutup=new.noper where jurnaladmtutup=old.noper;
	      update setsandi_tab set jurnalpajak=new.noper where jurnalpajak=old.noper;
	      update setsandi_tab set jurnalksd=new.noper where jurnalksd=old.noper;
	   end if;
	  
	END;
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER UFTER UPDATE PERKIRAAN")
ENDIF
CSQL = "DROP TRIGGER neraca_au"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
     CREATE TRIGGER `neraca_au` AFTER UPDATE on `neraca`FOR EACH ROW BEGIN        
     set @msaldoawal=(select sum(saldoawal) from neraca where noper=new.noper and tanggal=new.tanggal);
     set @mdebet=(select sum(debet) from neraca where noper=new.noper and tanggal=new.tanggal);
     set @mkredit=(select sum(kredit) from neraca where noper=new.noper and tanggal=new.tanggal);
     set @msaldo=(select sum(saldo) from neraca where noper=new.noper and tanggal=new.tanggal);
     update neraca_konsol set saldoawal=@msaldoawal,debet=@mdebet,kredit=@mkredit,saldo=@msaldo where noper=new.noper and tanggal=new.tanggal;
    END;
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER NERACA AFTER UPDATE")
ENDIF
CSQL = "DROP TRIGGER neraca_ai"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
    CREATE TRIGGER `neraca_ai` AFTER INSERT on `neraca` FOR EACH ROW BEGIN    
    set @mnoper=(select noper from neraca_konsol where noper=new.noper and tanggal=new.tanggal);
    if @mnoper<>'' then
        set @msaldoawal=(select sum(saldoawal) from neraca where noper=new.noper and tanggal=new.tanggal);
        set @mdebet=(select sum(debet) from neraca where noper=new.noper and tanggal=new.tanggal);
        set @mkredit=(select sum(kredit) from neraca where noper=new.noper and tanggal=new.tanggal);
        set @msaldo=(select sum(saldo) from neraca where noper=new.noper and tanggal=new.tanggal);
        insert into neraca_konsol (noper,tanggal,saldoawal,debet,kredit,saldo) value (new.noper,new.tanggal,@msaldoawal,@mdebet,@mkredit,@msaldo);
    end if;
    END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("TRIGGER NERACA AFTER INSERT")
ENDIF
CSQL = "DROP FUNCTION hitneraca"
LCEK = SQLEXEC(OODBC, CSQL)
TEXT TO STR1 NOSHOW
    CREATE FUNCTION hitneraca(mkantor varchar(4), mnoper varchar(10), mtgl date) RETURNS double(15,0)
    BEGIN
        SET @tgl=(select max(tanggal) from neraca where kantor=mkantor and noper=mnoper and tanggal<=mtgl group by noper );
        set @sld=(select sum(saldo) from neraca where kantor=mkantor and noper=mnoper and tanggal=@tgl );     
        return @sld;
    END
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1)
IF LCEK<1
MESSAGEBOX("FUNCTION HITNERACA")
ENDIF
ENDPROC
**
PROCEDURE isiperkiraan
MKANTOR = THISFORM.TEXT1.VALUE
LCEK = 1
CSQL="insert into perkiraan (kantor,noper,noper_lama,nama,sandi,kel,keldata,bukubantu,detail,level) values "+ "('"+MKANTOR+"', '1      ', '', 'ASET'  ,                                	'', 'N ', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '11     ', '', 'ASET LANCAR',							'', 'N ', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1101   ', '', 'KAS',   									'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1102   ', '', 'BANK', 	   								'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1103   ', '', 'SURAT BERHARGA',							'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1104   ', '', 'PIUTANG USAHA', 	   						'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1105   ', '', 'PIUTANG PINJAMAN ANGGOTA', 	   			'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1106   ', '', 'PIUTANG PINJAMAN NON ANGGOTA', 	   		'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1107   ', '', 'PENYISIHAN PIUTANG TAK TERTAGIH', 		'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1108   ', '', 'PERSEDIAAN', 	   						'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1109   ', '', 'BEBAN DIBAYAR DIMUKA', 	   				'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1110   ', '', 'PENDAPATAN YG MASIH HARUS DITERIMA', 	'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1111   ', '', 'ASET LANCAR LAINNYA', 	   				'', 'N', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '11111  ', '', 'PERSEDIAAN MATERAI', 	   				'', 'NA','NA', '', '', '1'), "+ "('"+MKANTOR+"', '1112   ', '', 'ANTAR KANTOR AKTIVA', 	   				'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '12     ', '', 'ASET TIDAK LANCAR', 	   					'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1201   ', '', 'INVESTASI JANGKA PANJANG', 	   			'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1202   ', '', 'PROPERTI INVESTASI', 	   				'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1203   ', '', 'AKM PENYUSUTAN PROPERTI INVESTASI', 		'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1204   ', '', 'ASET TETAP', 	   						'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '12041  ', '', 'TANAH', 	   								'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '12042  ', '', 'BANGUNAN', 	   							'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '12043  ', '', 'MESIN DAN KENDARAAN', 	   				'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '12044  ', '', 'INVENTARIS & PERALATAN KANTOR', 			'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '12045  ', '', 'AKUM PENYUSUTAN ASET TETAP', 	   		'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '120451 ', '', 'AKUM PENYUSUTAN BANGUNAN', 	   			'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '120452 ', '', 'AKUM PENYUSUTAN MESIN DAN KENDARAAN',	'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '120453 ', '', 'AKUM PENYUSUTAN INVENTARIS&ALAT KANTOR' ,'','NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1205   ', '', 'ASET TIDAK BERWUJUD', 	   				'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '12051  ', '', 'ASET TIDAK BERWUJUD', 	   				'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '12052  ', '', 'AKUM PENYUSUTAN ASET TDK BERWUJUD', 		'', 'NA', 'NA', '', '', '1'), "+ "('"+MKANTOR+"', '1206   ', '', 'ASET TIDAK LANCAR LAINNYA', 				'', 'NA', 'NA', '', '', '1') "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal 1")
ENDIF
CSQL = "insert into perkiraan (kantor,noper,noper_lama,nama,sandi,kel,keldata,bukubantu,detail,level,debet,kredit,saldo,sld_awal_tahun,sld_awal_bulan,sld_awal_hari,sld,tglterakhir) values "+"('"+MKANTOR+"', '2      ', '', 'KEWAJIBAN DAN EKUITAS', 			'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '21     ', '', 'KEWAJIBAN JANGKA PENDEK', 		'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2101   ', '', 'SIMPANAN ANGGOTA', 				'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '21011  ', '', '- SIMPANAN SUKARELA   ', 		'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '21012  ', '', '- SIMPANAN BERJANGKA',  			'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2102   ', '', 'SHU BAGIAN ANGGOTA', 	       	'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2103   ', '', 'UTANG USAHA ',  	        		'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2104   ', '', 'UTANG BANK/LEMBAGA KEU LAINNYA', '', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2105   ', '', 'UTANG JANGKA PENDEK LAINNYA', 	'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2106   ', '', 'BEBAN YANG MASIH HARUS DIBAYAR LAINNYA','', 'N', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '21061  ', '', 'TITIPAN BIAYA NOTARIS','', 'N', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '21062  ', '', 'TITIPAN PREMI ASURANSI KREDIT','', 'N', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2107   ', '', 'PENDAPATAN DITERIMA DIMUKA', 	    '', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '22     ', '', 'KEWAJIBAN JANGKA PANJANG', 	        '', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2201   ', '', 'UTANG BANK / LEMBAGA KEU. LAINNYA', 	'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2202   ', '', 'KEWAJIBAN IMBALAN KERJA', 	        '', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2203   ', '', 'KEWAJIBAN IMBALAN PASCA KERJA', 	'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '2204   ', '', 'KEWAJIBAN JANGKA PANJANG LAINNYA','', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '3      ', '', 'EKUITAS', 	        			'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '3101   ', '', 'SIMPANAN POKOK', 	        	'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '3102   ', '', 'SIMPANAN WAJIB', 	        	'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '3200   ', '', 'HIBAH/MODAL SUMBANGAN', 	        '', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '3300   ', '', 'MODAL PENYERTAAN', 	        '', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '340    ', '', 'CADANGAN', 	        			'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '3401   ', '', 'CADANGAN UMUM', 	        		'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '3402   ', '', 'CADANGAN TUJUAN', 	        	'', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '3500   ', '', 'SHU TAHUN BERJALAN', 	        '', 'NP', 'NP', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00') "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal 2")
ENDIF
CSQL = "insert into perkiraan (kantor,noper,noper_lama,nama,sandi,kel,keldata,bukubantu,detail,level,debet,kredit,saldo,sld_awal_tahun,sld_awal_bulan,sld_awal_hari,sld,tglterakhir) values "+"('"+MKANTOR+"', '4      ', '', 'HASIL USAHA', 	        	        '', 'R', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41     ', '', 'PELAYANAN ANGGOTA', 	        	    '', 'R', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '411    ', '', 'PELAYANAN BRUTO ANGGOTA', 	        '', 'R', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4111   ', '', 'PENDAPATAN DARI BANK/KOP', 	        '', 'R', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41111  ', '', 'PENDAPATAN BUNGA BANK', 	            '', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41112 ', '', 'PENDAPATAN BUNGA KOPERASI LAIN',     '', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41113 ', '', 'PENDAPATAN BUNGA INVESTASI LAIN',    '', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4112  ', '', 'PENDAPATAN DARI ANGGOTA', 	        '', 'R', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41121 ', '', 'PENDAPATAN JASA PINJAMAN', 	        '', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41122 ', '', 'PENDAPATAN ADM & PROVISI', 	        '', 'R', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '411221','', 'PENDAPATAN ADM & PROVISI PINJAMAN', 	'', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '411222','', 'PENDAPATAN PINALTY' , 	        	'', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '411223','', 'PENDAPATAN ADM SIMPANAN', 	        '', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '412   ', '', 'BEBAN POKOK PELAYANAN', 	        '', 'R', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4121  ', '', 'BEBAN KEPADA BANK' , 	        	'', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41211 ', '', 'BEBAN BUNGA PINJAMAN YG DITERIMA', 	'', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41212 ', '', 'BEBAN ADM & PROVISI PINJAMAN YG DITERIMA','', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41213 ', '', 'BEBAN DENDA PINJAMAN YG DITERIMA', 	        '', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4122  ', '', 'BEBAN  KEPADA ANGGOTA', 	        '', 'R', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41221 ', '', 'BEBAN JASA SIMPANAN SUKARELA', 	        '', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '41222 ', '', 'BEBAN JASA SIMPANAN BERJANGKA', 	'', 'RA', '01', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '42     ', '', 'PENDAPATAN DARI NON ANGGOTA', 	        '', 'RA', '02', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '421    ', '', 'PENJUALAN KPD NON ANGGOTA', 		'', 'RA', '02', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '422    ', '', 'BEBAN POKOK PENJUALAN KPD NON ANGGOTA', '', 'RP', '02', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '43     ', '', 'BEBAN OPERASIONAL', 	        	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4301   ', '', 'BEBAN USAHA', 	         	        '', 'R ', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430101 ', '', 'BEBAN GAJI KARYAWAN',         	        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430102 ', '', 'BEBAN ALAT TUKIS KANTOR',               '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430103 ', '', 'BEBAN PERJALANAN DINAS',       	        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430104 ', '', 'BEBAN UPAH',         	        	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430105 ', '', 'BEBAN PENYUSUTAN DAN AMORTISASI',       '', 'R', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4301051', '', '- BEBAN PENGHAPUSAN PIUTANG TAK TERTAGIH','', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4301052', '', '- PENYUSUTAN GEDUNG',       		'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4301053', '', '- PENYUSUTAN MESIN DAN KENDARAAN',      '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4301054', '', '- PENYUSUTAN INVENTARIS',       	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4301055', '', '- PENYUSUTAN GEDUNG',       		'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430106 ', '', 'BEBAN LISTRIK',         	        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430107 ', '', 'BEBAN TELEPHONE',         	        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430108 ', '', 'BEBAN PROMOSI',         	        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4302   ', '', 'BEBAN PERKOPERASIAN', 	        	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430201 ', '', 'BEBAN PENDIDIKAN DAN PELATIHAN',        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430202 ', '', 'BEBAN RAPAT ORGANISASI',         	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430203 ', '', 'BEBAN PENGEMBANGAN WILAYAH',         	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430204 ', '', 'BEBAN HONOR PENGURUS',         	        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430205 ', '', 'BEBAN HONOR PENGAWAS',         	        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430206 ', '', 'BEBAN RAT',         	        	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '430207 ', '', 'BEBAN PERKOPERASIAN LAINNYA',         	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4303   ', '', 'BEBAN SEWA',          			'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4304   ', '', 'BEBAN PEMELIHARAAN DAN PERBAIKAN',      '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '43041  ', '', '- GEDUNG',         			'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '43042  ', '', '- MESIN DAN KENDARAAN',         	'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '43043  ', '', '- INVENTARIS ',         		'', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4309   ', '', 'BEBAN OPERASIONAL LAINNYA', 	        '', 'RP', '03', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '44     ', '', 'PENDAPATAN DAN BEBAN NON OPERASIONAL', 	'', 'RA', '04', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4401   ', '', 'PENDAPATAN NON OPERASIONAL', 	       	'', 'RA', '04', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4402   ', '', 'BEBAN NON OPERASIONAL', 	       	'', 'RP', '04', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00'), "+"('"+MKANTOR+"', '4501   ', '', 'BEBAN PAJAK', 	        		'', 'RP', '05', '', '', '1', 0, 0, 0, 0, 0, 0, 0, '0000-00-00')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal 3")
RETURN
ENDIF
MESSAGEBOX("Perkiraan standar PUA Koperasi (SKA-ETAP) selesai dibentuk")
ENDPROC
**
FUNCTION Unload
MESSAGEBOX(THISFORM.NILAI)
RETURN THISFORM.NILAI
ENDFUNC
**
PROCEDURE Init
PARAMETER LCCON, MNAMEDB
MPOSAWAL = AT("SERVER=", LCCON)+8
MPOSAKHIR = AT(";UID", LCCON)-1
LOSERVER = SUBSTR(LCCON, MPOSAWAL, MPOSAKHIR-MPOSAWAL)
THISFORM.TEXT1.VALUE = DEFAKANTOR
THISFORM.TEXT2.VALUE = MNAMEDB
THISFORM.TEXT5.VALUE = LOSERVER
MPOSAWAL = AT("UID=", LCCON)+4
MPOSAKHIR = AT(";PASS", LCCON)-1
MUSER = SUBSTR(LCCON, MPOSAWAL, MPOSAKHIR-MPOSAWAL)
THISFORM.TEXT7.VALUE = MUSER
MPOSAWAL = AT("PASSWORD=", LCCON)+9
MPOSAKHIR = AT(";PORT", LCCON)-1
MPASS = SUBSTR(LCCON, MPOSAWAL, MPOSAKHIR-MPOSAWAL)
THISFORM.TEXT8.VALUE = MPASS
THISFORM.HEIGHT = 80
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  form_buatdatabased.scx::Command1
**
PROCEDURE Click
IF THISFORM.MODE=0
THISFORM.RELEASE
NODEFAULT
RETURN
ENDIF
LONMDB = ALLTRIM(THISFORM.TEXT2.VALUE)
LOSERVER = ALLTRIM(THISFORM.TEXT5.VALUE)
LODBUNAME = ALLTRIM(THISFORM.TEXT7.VALUE)
LODBPWD = ALLTRIM(THISFORM.TEXT8.VALUE)
LCCON = "DRIVER={MySQL ODBC 5.1 Driver};DESC=;DATABASE="+LONMDB+";SERVER="+LOSERVER+";UID="+LODBUNAME+";PASSWORD="+LODBPWD+";PORT=3306;OPTION=;STMT=;"
DEFACONNECT = LCCON
OODBC = SQLSTRINGCONNECT(DEFACONNECT)
THISFORM.NILAI = OODBC
IF OODBC>0
THISFORM.LABEL1.CAPTION = "TERHUBUNG"
ENDIF
IF THISFORM.TEXT9.VALUE<>"NEW"
IF OODBC>0
THISFORM.RELEASE
ENDIF
NODEFAULT
RETURN
ENDIF
DEFAKANTOR = ALLTRIM(THISFORM.TEXT1.VALUE)
CSQL = "create database if not exists "+ALLTRIM(THISFORM.TEXT2.VALUE)
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "USE "+ALLTRIM(THISFORM.TEXT2.VALUE)
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS anggota"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `anggota` ("+"`iddata` int(10) NOT NULL AUTO_INCREMENT, "+"`kantor` varchar(4) NOT NULL,"+"`cif` varchar(17) NOT NULL,"+"`cif_lama` varchar(17) NOT NULL,"+"`cif_smt` varchar(17) NOT NULL,"+"`tanggal` date NOT NULL,"+"`noktp` varchar(30) NOT NULL,"+"`nama` varchar(30) NOT NULL,"+"`tempatlhr` varchar(30) NOT NULL,"+"`tanggallhr` date NOT NULL,"+"`jeniskl` varchar(15) NOT NULL,"+"`alamat` varchar(50) NOT NULL,"+"`rt` varchar(30) NOT NULL,"+"`desa` varchar(50) NOT NULL,"+"`kecamatan` varchar(50) NOT NULL,"+"`kota` varchar(50) NOT NULL,"+"`agama` varchar(20) NOT NULL,"+"`pekerjaan` varchar(30) NOT NULL,"+"`statuskawin` varchar(15) NOT NULL,"+"`ibu` varchar(50) NOT NULL,"+"`phone` varchar(30) NOT NULL,"+"`kelkerja` varchar(4) NOT NULL,"+"`tglkeluar` date NOT NULL,"+"`opr` varchar(10) NOT NULL,"+"`simpokok` int(12) NOT NULL,"+"`simwajib` int(12) NOT NULL,"+"`simsuka` int(12) NOT NULL,"+"`lain` int(12) NOT NULL,"+"`ketlain` varchar(50) NOT NULL,"+"`tglmutasi` date NOT NULL,"+"`wilayah` varchar(4) NOT NULL,"+"`lokasi` varchar(4) NOT NULL,"+"`npwp` varchar(25) NOT NULL,"+"`kodepos` varchar(5) NOT NULL,"+"PRIMARY KEY (`iddata`),"+"UNIQUE KEY `cif` (`cif`,`nama`)"+") ENGINE=MyISAM AUTO_INCREMENT=2284 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `anggota_mutasi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `anggota_mutasi` ("+"`iddata` int(11) NOT NULL AUTO_INCREMENT,"+"`kantor` varchar(4) NOT NULL,"+"`cif` varchar(10) NOT NULL,"+"`tanggal` date NOT NULL,"+"`bukti` varchar(10) NOT NULL,"+"`kd` varchar(2) NOT NULL,"+"`mtspokok` double(15,0) DEFAULT '0',"+"`sldpokok` double(15,0) DEFAULT '0',"+"`mtssmk` double(15,0) DEFAULT '0',"+"`saldosmk` double(15,0) DEFAULT '0',"+"`mtswajib` double(15,0) NOT NULL,"+"`sldwajib` double(15,0) NOT NULL,"+"`mtspenyertaan` double(15,0) NOT NULL,"+"`sldpenyertaan` double(15,0) NOT NULL,"+"PRIMARY KEY (`iddata`),"+"KEY `cif` (`cif`,`tanggal`,`bukti`)"+") ENGINE=MyISAM AUTO_INCREMENT=79525 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `catatan`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `catatan` ( "+"`kantor` varchar(4) NOT NULL,"+"`DEPT` char(3) DEFAULT '',"+"`norek` char(25) DEFAULT '',"+"`idcatatan` int(10) NOT NULL AUTO_INCREMENT,"+"`tanggal` date DEFAULT '0000-00-00',"+"`catatan` text,"+"`JUMLAH` double(15,0) DEFAULT '0',"+"`VLD` char(1) DEFAULT '',"+"`VLD2` char(1) DEFAULT '',"+"`TGLVALID` date DEFAULT '0000-00-00',"+"`INPOPR` char(5) DEFAULT '',"+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,"+"`EDTOPR` char(5) DEFAULT '',"+"`TGLEDT` datetime DEFAULT NULL,"+"`tglselesai` date NOT NULL,"+"`cttselesai` varchar(50) NOT NULL,"+"PRIMARY KEY (`idcatatan`),"+"KEY `norek` (`norek`)"+") ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `col_bayar`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `col_bayar` ("+"`kantor` varchar(4) NOT NULL,"+"`kode` varchar(4) NOT NULL,"+"`tanggal` date NOT NULL,"+"`bukti` varchar(10) NOT NULL,"+"`kdtrans` varchar(4) NOT NULL,"+"`norek` varchar(17) NOT NULL,"+"`nama` varchar(30) NOT NULL,"+"`tabungan` int(12) NOT NULL,"+"`pokok` int(12) NOT NULL,"+"`jasa` int(12) NOT NULL,"+"`denda` INT(12) NOT NULL,"+"`lainnya` int(12) NOT NULL,"+"`opt` varchar(5) NOT NULL,"+"`flag` varchar(1) NOT NULL"+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `col_instansi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `col_instansi` ("+"`kantor` varchar(4) NOT NULL,"+"`kode` varchar(4) NOT NULL,"+"`instansi` varchar(4) NOT NULL,"+"`bln` int(2) NOT NULL,"+"`tahun` int(4) NOT NULL,"+"`noangg` varchar(10) NOT NULL,"+"`nama` varchar(30) NOT NULL,"+"`simpokok` int(10) NOT NULL,"+"`simwajib` int(10) NOT NULL,"+"`simpanan` int(10) NOT NULL,"+"`lain` int(10) NOT NULL,"+"`ket` varchar(30) NOT NULL,"+"`angpokok` int(10) NOT NULL,"+"`angbunga` int(10) NOT NULL,"+"`angdenda` int(10) NOT NULL,"+"`flag` varchar(1) NOT NULL,"+"KEY `kantor` (`kantor`),"+"KEY `bln` (`bln`,`tahun`),"+" KEY `instansi` (`instansi`)"+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `col_instansi_pinj`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `col_instansi_pinj` ( "+"`kantor` varchar(4) NOT NULL,"+"`kode` varchar(4) NOT NULL,"+"`instansi` varchar(4) NOT NULL,"+"`bln` int(2) NOT NULL,"+"`tahun` int(4) NOT NULL,"+"`noangg` varchar(10) NOT NULL,"+"`norek` varchar(17) NOT NULL,"+"`produk` varchar(40) NOT NULL,"+"`POKOK` int(12) NOT NULL,"+"`JW` int(3) NOT NULL,"+"`RATE` decimal(5,2) NOT NULL,"+"`ANGS` varchar(15) NOT NULL,"+"`angpokok` int(12) NOT NULL,"+"`angbunga` int(12) NOT NULL,"+"`angdenda` int(12) NOT NULL,"+"`flag` varchar(1) NOT NULL,"+"KEY `kantor` (`kantor`),"+"KEY `bln` (`bln`,`tahun`),"+"KEY `instansi` (`instansi`)"+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `col_instansi_simp`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `col_instansi_simp` ( "+"`kantor` varchar(4) NOT NULL, "+"`kode` varchar(4) NOT NULL, "+"`instansi` varchar(4) NOT NULL, "+"`bln` int(2) NOT NULL, "+"`tahun` int(4) NOT NULL, "+"`noangg` varchar(10) NOT NULL, "+"`norek` varchar(17) NOT NULL, "+"`produk` varchar(40) NOT NULL, "+"`jumlah` int(10) NOT NULL, "+"`flag` varchar(1) NOT NULL, "+"KEY `kantor` (`kantor`), "+"KEY `bln` (`bln`,`tahun`), "+"KEY `instansi` (`instansi`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1 "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_antarbank`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQK = "CREATE TABLE `gl_antarbank` ("+"`kantor` varchar(4) NOT NULL, "+"`nomorid` int(5) NOT NULL AUTO_INCREMENT, "+"`noper` varchar(10) NOT NULL, "+"`tanggal` date NOT NULL, "+"`noaccount` varchar(25) NOT NULL, "+"`nama` varchar(30) NOT NULL, "+"`keterangan` varchar(30) NOT NULL, "+"`jenis` varchar(15) NOT NULL, "+"`rate` decimal(5,2) NOT NULL, "+"`jw` int(3) NOT NULL, "+"`tgljtempo` date NOT NULL, "+"`prosen_ppap` date NOT NULL, "+"`awal` bigint(15) NOT NULL, "+"`mutasi` bigint(15) NOT NULL,"+"`saldo` bigint(15) NOT NULL, "+"`bunga_yadit` int(10) NOT NULL, "+"`ppap` int(10) NOT NULL, "+"PRIMARY KEY (`nomorid`) "+") ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_antarbank_akrual`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `gl_antarbank_akrual` ( "+"`kantor` varchar(4) NOT NULL, "+"`nomorid` int(5) NOT NULL, "+"`mutasiid` int(6) NOT NULL AUTO_INCREMENT, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`keterangan` varchar(30) NOT NULL, "+"`debet` bigint(15) NOT NULL, "+"`kredit` bigint(15) NOT NULL, "+"`saldo` bigint(15) NOT NULL, "+"`bunga` int(9) NOT NULL, "+"`pajak` int(9) NOT NULL, "+"`ppap` int(9) NOT NULL, "+"`opt` varchar(4) NOT NULL, "+"PRIMARY KEY (`mutasiid`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1 "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_antarkantor`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `gl_antarkantor` ( "+"`kantor` varchar(4) NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`debet` bigint(15) NOT NULL, "+"`kredit` bigint(15) NOT NULL, "+"`saldo` bigint(15) NOT NULL, "+"`opr` varchar(4) NOT NULL, "+"PRIMARY KEY (`kantor`,`tanggal`,`bukti`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1 "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_biayadimuka`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `gl_biayadimuka` ( "+"`kantor` varchar(4) NOT NULL, "+"`nomorid` int(5) NOT NULL AUTO_INCREMENT, "+"`bukubantu` varchar(5) NOT NULL, "+"`kode` varchar(25) NOT NULL, "+"`nama` varchar(30) NOT NULL, "+"`keterangan` varchar(40) NOT NULL, "+"`tanggal` date NOT NULL, "+"`biaya` bigint(15) NOT NULL, "+"`lama` int(3) NOT NULL, "+"`tglakhir` date NOT NULL, "+"`lamahari` int(9) NOT NULL, "+"`amortisasi` int(10) NOT NULL, "+"`akumulasi` bigint(15) NOT NULL, "+"`sisa` bigint(15) NOT NULL, "+"`tglmutasi` date NOT NULL, "+"PRIMARY KEY (`nomorid`) "+") ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1 "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_biayadimuka_mutasi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `gl_biayadimuka_mutasi` ( "+"`kantor` varchar(4) NOT NULL, "+"`nomorid` int(5) NOT NULL, "+"`mutasiid` int(6) NOT NULL AUTO_INCREMENT, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`keterangan` varchar(30) NOT NULL, "+"`debet` bigint(15) DEFAULT '0', "+"`kredit` bigint(15) DEFAULT '0', "+"`saldo` bigint(15) NOT NULL, "+"`opt` varchar(4) NOT NULL, "+"PRIMARY KEY (`mutasiid`) "+") ENGINE=MyISAM AUTO_INCREMENT=10 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_inventaris`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `gl_inventaris` ( "+"`kantor` varchar(4) NOT NULL, "+"`nomorid` int(5) NOT NULL AUTO_INCREMENT, "+"`bukubantu` varchar(5) NOT NULL, "+"`kode` varchar(25) NOT NULL, "+"`nama` varchar(30) NOT NULL, "+"`keterangan` varchar(40) NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`harga` double(15,0) NOT NULL, "+"`gol` varchar(3) NOT NULL, "+"`lama` int(3) NOT NULL, "+"`penyusutan` int(10) NOT NULL, "+"`akumulasi` double(15,0) NOT NULL, "+"`nilaibuku` double(15,0) NOT NULL, "+"`tglmutasi` date NOT NULL, "+"PRIMARY KEY (`nomorid`) "+") ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_inventaris_mutasi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `gl_inventaris_mutasi` ( "+"`kantor` varchar(4) NOT NULL, "+"`nomorid` int(5) NOT NULL, "+"`mutasiid` int(6) NOT NULL AUTO_INCREMENT, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`keterangan` varchar(30) NOT NULL, "+"`debet` double(15,0) NOT NULL, "+"`kredit` double(15,0) DEFAULT '0', "+"`saldo` double(15,0) NOT NULL DEFAULT '0', "+"`opt` varchar(4) NOT NULL, "+"PRIMARY KEY (`mutasiid`) "+") ENGINE=MyISAM AUTO_INCREMENT=16 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_ksd`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `gl_ksd` ( "+"`kantor` varchar(4) NOT NULL, "+"`nomorid` int(5) NOT NULL AUTO_INCREMENT, "+"`noper` varchar(10) NOT NULL, "+"`nama` varchar(30) NOT NULL, "+"`keterangan` varchar(50) NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`petugas` varchar(30) NOT NULL, "+"`awal` bigint(15) NOT NULL, "+"`mutasi` bigint(15) NOT NULL, "+"`saldo` bigint(15) NOT NULL, "+"PRIMARY KEY (`nomorid`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `gl_ksd_mutasi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `gl_ksd_mutasi` ( "+"`kantor` varchar(4) NOT NULL, "+"`nomorid` int(5) NOT NULL, "+"`mutasiid` int(6) NOT NULL AUTO_INCREMENT, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`keterangan` varchar(30) NOT NULL, "+"`debet` bigint(15) DEFAULT '0', "+"`kredit` bigint(15) DEFAULT '0', "+"`saldo` bigint(15) NOT NULL, "+"`opt` varchar(4) NOT NULL, "+"PRIMARY KEY (`mutasiid`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `jurnal`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `jurnal` ( "+"`KANTOR` char(4) DEFAULT NULL, "+"`idtrans` int(10) NOT NULL AUTO_INCREMENT, "+"`TANGGAL` date DEFAULT '0000-00-00', "+"`BUKTI` char(10) DEFAULT '', "+"`NOPER` char(10) DEFAULT '', "+"`KETERANGAN` char(50) DEFAULT NULL, "+"`JUMLAH` double(15,0) DEFAULT '0', "+"`FLAG_VALID` char(1) DEFAULT '', "+"`ACC` char(4) DEFAULT '', "+"`INPOPR` char(10) DEFAULT NULL, "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(10) DEFAULT NULL, "+"`TGLEDT` datetime DEFAULT NULL, "+"PRIMARY KEY (`idtrans`) "+") ENGINE=MyISAM AUTO_INCREMENT=15193 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `kas_rincian`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `kas_rincian` ( "+"`kantor` char(4) DEFAULT NULL, "+"`CSR` char(2) NOT NULL DEFAULT '01', "+"`TANGGAL` date NOT NULL DEFAULT '0000-00-00', "+"`K100` int(9) DEFAULT '0', "+"`K50` int(9) DEFAULT '0', "+"`K20` int(9) DEFAULT '0', "+"`K10` int(9) DEFAULT '0', "+"`K5` int(9) DEFAULT '0', "+"`K2` int(9) DEFAULT '0', "+"`K1` int(9) DEFAULT '0', "+"`K05` int(9) DEFAULT '0', "+"`K01` int(9) DEFAULT '0', "+"`L1000` int(9) DEFAULT '0', "+"`L500` int(9) DEFAULT '0', "+"`L200` int(9) DEFAULT '0', "+"`L100` int(9) DEFAULT '0', "+"`L50` int(9) DEFAULT '0', "+"`L25` int(9) DEFAULT '0', "+"`L1` int(9) DEFAULT '0', "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL, "+"PRIMARY KEY (`TANGGAL`,`CSR`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `kasir`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `kasir` ( "+"`kantor` varchar(4) NOT NULL, "+"`csr` varchar(2) NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`kode` varchar(2) NOT NULL, "+"`keterangan` varchar(50) NOT NULL, "+"`debet` double(15,0) DEFAULT '0', "+"`kredit` double(15,0) NOT NULL DEFAULT '0', "+"`opt` varchar(10) NOT NULL, "+"`norek` varchar(25) NOT NULL, "+"`jumlah1` double(15,0) NOT NULL, "+"`jumlah2` double(15,0) NOT NULL, "+"`jumlah3` double(15,0) NOT NULL, "+"`jumlah4` double(15,0) NOT NULL, "+"`jumlah5` double(15,0) NOT NULL, "+"`jumlah6` double(15,0) NOT NULL, "+"`jumlah7` double(15,0) NOT NULL, "+"`jumlah8` double(15,0) NOT NULL, "+"`jumlah9` double(15,0) NOT NULL, "+"`jumlah10` double(15,0) NOT NULL, "+"`jumlah11` double(15,0) NOT NULL, "+"`jumlah12` double(15,0) NOT NULL, "+"`tanggal1` date NOT NULL, "+"PRIMARY KEY (`tanggal`,`bukti`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `kasir_datalain`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `kasir_datalain` ( "+"`kantor` varchar(4) NOT NULL, "+"`csr` varchar(2) NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`opt` varchar(3) NOT NULL, "+"`norek` varchar(25) NOT NULL, "+"`nama` varchar(40) NOT NULL, "+"`alamat` varchar(70) NOT NULL, "+"`saldo` double(15,0) NOT NULL, "+"`pokok` double(15,0) NOT NULL DEFAULT '0', "+"`adm` double(15,0) NOT NULL DEFAULT '0', "+"`provisi` double(15,0) NOT NULL DEFAULT '0', "+"`materai` double(15,0) NOT NULL DEFAULT '0', "+"`notaris` double(15,0) NOT NULL DEFAULT '0', "+"`asuransi` double(15,0) NOT NULL DEFAULT '0', "+"`lainlain` double(15,0) NOT NULL DEFAULT '0', "+"PRIMARY KEY (`tanggal`,`bukti`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `kolektif_hasil`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `kolektif_hasil` ( "+"`kantor` varchar(4) NOT NULL, "+"`idtrans` int(10) NOT NULL AUTO_INCREMENT, "+"`kodekolektor` varchar(4) DEFAULT '', "+"`kdtransaksi` varchar(1) DEFAULT '', "+"`tgl` date DEFAULT '0000-00-00', "+"`bukti` varchar(10) DEFAULT '', "+"`ket` varchar(50) DEFAULT '', "+"`norek` char(25) DEFAULT '', "+"`nama` varchar(40) NOT NULL, "+"`alamat` varchar(50) NOT NULL, "+"`kode` varchar(2) DEFAULT '', "+"`tabungan` double DEFAULT '0', "+"`pokok` double DEFAULT '0', "+"`jasa` double DEFAULT '0', "+"`denda` double DEFAULT '0', "+"`lain` double DEFAULT '0', "+"`flag` varchar(1) DEFAULT '', "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT '0000-00-00 00:00:00', "+"PRIMARY KEY (`idtrans`) "+") ENGINE=MyISAM AUTO_INCREMENT=15 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `log_data`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `log_data` ( "+"`nomordata` int(10) NOT NULL AUTO_INCREMENT, "+"`namafile` varchar(30) NOT NULL, "+"`iddata` int(10) NOT NULL, "+"`tanggal` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, "+"`userid` varchar(10) NOT NULL, "+"`tindakan` varchar(10) NOT NULL, "+"`perintah` varchar(40) NOT NULL, "+"`dataasal` blob, "+"`databaru` blob, "+"`useracc` varchar(10) DEFAULT NULL, "+"UNIQUE KEY `nomordata` (`nomordata`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `log_memo`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `log_memo` ( "+"`bag` varchar(4) NOT NULL, "+"`valuta` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`keterangan` varchar(40) NOT NULL, "+"`jumlah` int(12) NOT NULL, "+"`catatan` varchar(40) NOT NULL, "+"`opt` varchar(4) NOT NULL "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `log_proses`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `log_proses` ( "+"`kantor` varchar(4) NOT NULL, "+"`tanggal` date NOT NULL DEFAULT '0000-00-00', "+"`tglproses` date NOT NULL, "+"`keterangan` blob NOT NULL, "+"`opt` varchar(4) NOT NULL, "+"`stat_pros` varchar(1) NOT NULL, "+"KEY `kantor` (`kantor`,`tanggal`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `log_system`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `log_system` ( "+"`iddata` int(11) NOT NULL AUTO_INCREMENT, "+"`tanggal` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`idPC` varchar(25) NOT NULL, "+"`name` varchar(40) NOT NULL, "+"`ip` varchar(20) NOT NULL, "+"`cobaakses` int(9) NOT NULL, "+"`register` varchar(25) NOT NULL, "+"`tglregister` date NOT NULL, "+"`namapemilik` varchar(30) NOT NULL, "+"`jeniskomp` varchar(20) NOT NULL, "+"`letakkomp` varchar(100) NOT NULL, "+"`keterangan` varchar(100) NOT NULL, "+"`tglakhir` date NOT NULL, "+"PRIMARY KEY (`iddata`) "+") ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `log_valid`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `log_valid` ( "+"`kantor` varchar(4) NOT NULL, "+"`tanggal` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP, "+"`modul` varchar(15) NOT NULL, "+"`keterangan` varchar(200) NOT NULL, "+"`opr` varchar(4) NOT NULL, "+"PRIMARY KEY (`tanggal`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `neraca`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `neraca` ( "+"`kantor` varchar(4) NOT NULL, "+"`noper` varchar(10) CHARACTER SET latin1 NOT NULL, "+"`tanggal` date NOT NULL DEFAULT '0000-00-00', "+"`saldoawal` double(15,0) DEFAULT '0', "+"`debet` double(15,0) DEFAULT '0', "+"`kredit` double(15,0) DEFAULT '0', "+"`saldo` double(15,0) DEFAULT '0', "+"PRIMARY KEY (`noper`,`tanggal`) "+") ENGINE=MyISAM DEFAULT CHARSET=utf8"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `neraca_konsol`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `neraca_konsol` ( "+"`noper` varchar(10) CHARACTER SET latin1 NOT NULL, "+"`tanggal` date NOT NULL DEFAULT '0000-00-00', "+"`saldoawal` double(15,0) DEFAULT '0', "+"`debet` double(15,0) DEFAULT '0', "+"`kredit` double(15,0) DEFAULT '0', "+"`saldo` double(15,0) DEFAULT '0', "+"`eliminasi` double(15,0) DEFAULT '0', "+"`saldo_akhir` double(15,0) DEFAULT '0', "+"PRIMARY KEY (`noper`,`tanggal`) "+") ENGINE=MyISAM DEFAULT CHARSET=utf8"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `nonkas`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `nonkas` ( "+"`kantor` varchar(4) NOT NULL, "+"`csr` varchar(2) NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`kode` varchar(2) NOT NULL, "+"`kodebank` int(5) NOT NULL, "+"`keterangan` varchar(50) NOT NULL, "+"`debet` double NOT NULL DEFAULT '0', "+"`kredit` double NOT NULL DEFAULT '0', "+"`opt` varchar(4) NOT NULL, "+"`norek` varchar(25) NOT NULL, "+"PRIMARY KEY (`tanggal`,`bukti`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `perkiraan`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `perkiraan` ( "+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`noper` varchar(10) DEFAULT '', "+"`noper_lama` varchar(10) DEFAULT '', "+"`nama` varchar(40) DEFAULT '', "+"`sandi` varchar(4) DEFAULT '', "+"`kel` varchar(3) DEFAULT '', "+"`keldata` varchar(3) DEFAULT '', "+"`bukubantu` varchar(5) DEFAULT '', "+"`detail` varchar(1) DEFAULT '', "+"`level` varchar(1) DEFAULT '', "+"`font` varchar(1) DEFAULT '', "+"`debet` double(15,0) DEFAULT '0', "+"`kredit` double(15,0) DEFAULT '0', "+"`saldo` double(15,0) DEFAULT '0', "+"`sld_awal_tahun` double(15,0) DEFAULT '0', "+"`sld_awal_bulan` double(15,0) DEFAULT '0', "+"`sld_awal_hari` double(15,0) DEFAULT '0', "+"`sld` double(15,0) DEFAULT '0', "+"`tglterakhir` date DEFAULT NULL, "+"PRIMARY KEY (`iddata`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman` ( "+"`kantor` varchar(4) NOT NULL, "+"`tanggal` date NOT NULL, "+"`tglvaluta` date NOT NULL DEFAULT '0000-00-00', "+"`bukti` varchar(10) NOT NULL, "+"`norek` varchar(25) NOT NULL, "+"`norek_lama` varchar(17) NOT NULL, "+"`nopk` varchar(25) NOT NULL, "+"`kdhit` varchar(1) NOT NULL, "+"`marketing` varchar(3) NOT NULL, "+"`cif` varchar(10) NOT NULL, "+"`tujuan` varchar(30) NOT NULL, "+"`pokok` double(15,0) NOT NULL DEFAULT '0', "+"`rate` decimal(5,2) NOT NULL, "+"`jasa` double(15,0) NOT NULL DEFAULT '0', "+"`lama` tinyint(3) NOT NULL, "+"`tglmulai` date NOT NULL, "+"`tgljtempo` date NOT NULL, "+"`adm` int(10) NOT NULL, "+"`provisi` int(10) NOT NULL, "+"`materai` int(10) NOT NULL DEFAULT '0', "+"`kd_notaris` varchar(4) NOT NULL, "+"`notaris` int(10) NOT NULL DEFAULT '0', "+"`kd_asuransi` varchar(4) NOT NULL, "+"`asuransi` int(10) NOT NULL DEFAULT '0', "+"`lainlain` int(10) NOT NULL DEFAULT '0', "+"`biaya` int(10) NOT NULL DEFAULT '0', "+"`jenis` varchar(4) NOT NULL, "+"`kelompok` varchar(4) NOT NULL, "+"`wilayah` varchar(4) NOT NULL, "+"`penggunaan` varchar(4) NOT NULL, "+"`sektor` varchar(4) NOT NULL, "+"`sumber` varchar(4) NOT NULL, "+"`kpr` varchar(1) NOT NULL, "+"`tgllunas` date NOT NULL, "+"`pot_pokok` int(12) NOT NULL, "+"`pot_bunga` int(11) NOT NULL, "+"`sldawalthn` double(15,0) NOT NULL, "+"`sldawalbln` double(15,0) NOT NULL, "+"`sldawalhr` double(15,0) NOT NULL, "+"`sldsekarang` double(15,0) NOT NULL, "+"`byrangsur` double(15,0) NOT NULL, "+"`sisapokok` double(15,0) NOT NULL, "+"`sisabunga` double(15,0) NOT NULL, "+"`smsjtang` varchar(1) NOT NULL DEFAULT '', "+"`smsjtpinj` varchar(1) NOT NULL DEFAULT '', "+"`tglPermohonan` date NOT NULL DEFAULT '0000-00-00', "+"`srtPermohonan` varchar(25) NOT NULL DEFAULT '', "+"`jmlPermohonan` double(15,0) NOT NULL DEFAULT '0', "+"`tglPersetujuan` date NOT NULL DEFAULT '0000-00-00', "+"`srtPersetujuan` varchar(25) NOT NULL DEFAULT '', "+"PRIMARY KEY (`norek`), "+"UNIQUE KEY `norek` (`norek`), "+"KEY `tanggal` (`tanggal`), "+"KEY `cif` (`cif`), "+"KEY `tgllunas` (`tgllunas`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_akrual`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_akrual` ( "+"`kantor` varchar(4) COLLATE latin2_bin NOT NULL, "+"`norek` varchar(25) COLLATE latin2_bin NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) COLLATE latin2_bin NOT NULL, "+"`keterangan` varchar(30) COLLATE latin2_bin NOT NULL, "+"`bg_debet` double(15,0) NOT NULL, "+"`bg_kredit` double(15,0) NOT NULL, "+"`adm_debet` double(15,0) NOT NULL, "+"`adm_kredit` double(15,0) NOT NULL, "+"`biaya_debet` double(15,0) NOT NULL, "+"`biaya_kredit` double(15,0) NOT NULL, "+"`kontijen_debet` double(15,0) NOT NULL, "+"`kontijen_kredit` double(15,0) NOT NULL, "+"`opt` varchar(4) COLLATE latin2_bin NOT NULL, "+"PRIMARY KEY (`norek`,`tanggal`,`bukti`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin2 COLLATE=latin2_bin"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_jadwal`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_jadwal` ( "+"`kantor` varchar(4) CHARACTER SET latin1 NOT NULL, "+"`norek` varchar(25) CHARACTER SET latin1 NOT NULL, "+"`tanggal` date NOT NULL, "+"`pokok` double(15,0) NOT NULL DEFAULT '0', "+"`jasa` double(15,0) NOT NULL DEFAULT '0', "+"`opt` varchar(4) CHARACTER SET latin1 NOT NULL, "+"PRIMARY KEY (`kantor`,`norek`,`tanggal`) "+") ENGINE=MyISAM DEFAULT CHARSET=utf8"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_jaminan`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_jaminan` ( "+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kantor` varchar(4) CHARACTER SET latin1 NOT NULL, "+"`norek` varchar(25) CHARACTER SET latin1 NOT NULL DEFAULT ' ', "+"`jenis` varchar(20) CHARACTER SET latin1 NOT NULL DEFAULT ' ', "+"`noberkas` varchar(25) CHARACTER SET latin1 NOT NULL DEFAULT ' ', "+"PRIMARY KEY (`iddata`) "+") ENGINE=MyISAM DEFAULT CHARSET=utf8"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_jaminan_bpkb` "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_jaminan_bpkb` ( "+"`kantor` varchar(4) CHARACTER SET latin1 NOT NULL, "+"`noberkas` varchar(25) CHARACTER SET latin1 NOT NULL DEFAULT '0', "+"`merk` varchar(20) CHARACTER SET latin1 NOT NULL, "+"`type` varchar(20) CHARACTER SET latin1 NOT NULL, "+"`tahun` varchar(4) CHARACTER SET latin1 NOT NULL, "+"`nomesin` varchar(30) CHARACTER SET latin1 NOT NULL, "+"`norangka` varchar(30) CHARACTER SET latin1 NOT NULL, "+"`nobpkb` varchar(30) CHARACTER SET latin1 NOT NULL, "+"`nopolisi` varchar(11) CHARACTER SET latin1 NOT NULL, "+"`warna` varchar(20) CHARACTER SET latin1 NOT NULL, "+"`tglstnk` date NOT NULL, "+"`kelengkapan` varchar(40) CHARACTER SET latin1 NOT NULL, "+"`atasnama` varchar(40) CHARACTER SET latin1 NOT NULL, "+"`alamat` varchar(40) CHARACTER SET latin1 NOT NULL, "+"`pengikatan` varchar(4) CHARACTER SET latin1 NOT NULL, "+"`nilai` double(15,0) NOT NULL, "+"`adj_nilai` double(15,0) NOT NULL, "+"`adj_ppap` double(15,0) NOT NULL, "+"`tglmasuk` date NOT NULL, "+"`tglambil` date NOT NULL, "+"`pengambil` varchar(30) CHARACTER SET latin1 NOT NULL "+") ENGINE=MyISAM DEFAULT CHARSET=utf8"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_jaminan_lainnya` "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_jaminan_lainnya` ( "+"`kantor` varchar(4) NOT NULL, "+"`noberkas` varchar(25) NOT NULL, "+"`nama` varchar(30) NOT NULL, "+"`keterangan` varchar(200) NOT NULL, "+"`pengikatan` varchar(4) NOT NULL, "+"`nilai` double(15,0) NOT NULL, "+"`adj_nilai` double(15,0) NOT NULL, "+"`adj_ppap` double(15,0) NOT NULL, "+"`tglmasuk` date NOT NULL, "+"`tglambil` date NOT NULL, "+"`pengambil` varchar(30) NOT NULL "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_jaminan_sertifikat`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_jaminan_sertifikat` ( "+"`kantor` varchar(4) NOT NULL, "+"`noberkas` varchar(25) NOT NULL, "+"`status` varchar(20) NOT NULL, "+"`nosertifikat` varchar(20) NOT NULL, "+"`tglsertifikat` date NOT NULL, "+"`nosuratukur` varchar(20) NOT NULL, "+"`tglsuratukur` date NOT NULL, "+"`luas` int(10) NOT NULL, "+"`nama` varchar(30) NOT NULL, "+"`alamat` varchar(40) NOT NULL, "+"`kelengkapan` varchar(40) NOT NULL, "+"`pengikatan` varchar(4) NOT NULL, "+"`nilai` double(15,0) NOT NULL, "+"`nilaiht` double(15,0) NOT NULL, "+"`adj_nilai` double(15,0) NOT NULL, "+"`tglmasuk` date NOT NULL, "+"`tglambil` date NOT NULL, "+"`pengambil` varchar(30) NOT NULL, "+"PRIMARY KEY (`noberkas`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1 "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_jaminan_simpanan`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_jaminan_simpanan` ( "+"`kantor` varchar(4) NOT NULL, "+"`NOBERKAS` varchar(25) NOT NULL, "+"`NOREK` varchar(25) NOT NULL, "+"`JENIS` varchar(20) NOT NULL, "+"`NAMA` varchar(30) NOT NULL, "+"`ALAMAT` varchar(40) NOT NULL, "+"`JUMLAH` int(10) NOT NULL, "+"`TGLBLOKIR` date NOT NULL, "+"`KELENGKAPAN` varchar(40) NOT NULL, "+"`pengikatan` varchar(4) NOT NULL, "+"`ADJ_NILAI` double(15,0) NOT NULL, "+"`ADJ_PPAP` double(15,0) NOT NULL, "+"`TGLMASUK` date NOT NULL, "+"`TGLAMBIL` date NOT NULL, "+"`PENGAMBIL` varchar(30) NOT NULL "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_mutasi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_mutasi` ( "+"`iddata` int(10) NOT NULL AUTO_INCREMENT, "+"`kantor` varchar(4) CHARACTER SET latin1 NOT NULL, "+"`norek` varchar(25) CHARACTER SET latin1 NOT NULL, "+"`tanggal` date NOT NULL, "+"`tglmutasi` date NOT NULL, "+"`bukti` varchar(10) CHARACTER SET latin1 NOT NULL, "+"`kode` varchar(2) CHARACTER SET latin1 NOT NULL, "+"`pokok` double(15,0) NOT NULL DEFAULT '0', "+"`jasa` double(15,0) NOT NULL DEFAULT '0', "+"`denda` double(15,0) NOT NULL DEFAULT '0', "+"`debet` double(15,0) NOT NULL DEFAULT '0', "+"`kredit` double(15,0) NOT NULL DEFAULT '0', "+"`opt` varchar(10) CHARACTER SET latin1 NOT NULL, "+"`sisapokok` double(15,0) NOT NULL DEFAULT '0', "+"`sisabunga` double(15,0) NOT NULL DEFAULT '0', "+"`tunggpk` double(15,0) NOT NULL DEFAULT '0', "+"`kalipk` int(3) NOT NULL DEFAULT '0', "+"`haripk` int(3) NOT NULL DEFAULT '0', "+"`tunggbg` double(15,0) NOT NULL DEFAULT '0', "+"`kalibg` int(3) NOT NULL DEFAULT '0', "+"`haribg` int(3) NOT NULL DEFAULT '0', "+"`tglod` date NOT NULL, "+"`tglmacet` date NOT NULL, "+"`kol_awal` varchar(1) CHARACTER SET latin1 NOT NULL, "+"`kol` varchar(1) CHARACTER SET latin1 NOT NULL, "+"`dpk` varchar(1) CHARACTER SET latin1 NOT NULL, "+"`ppap` double(15,0) NOT NULL DEFAULT '0', "+"`bgakrual` double(15,0) NOT NULL DEFAULT '0', "+"`kontijensi` double(15,0) NOT NULL DEFAULT '0', "+"`adm` int(10) NOT NULL DEFAULT '0', "+"`provisi` int(10) NOT NULL DEFAULT '0', "+"`biaya` int(10) NOT NULL DEFAULT '0', "+"PRIMARY KEY (`iddata`), "+"KEY `norek` (`norek`), "+"KEY `norek_2` (`norek`,`tanggal`), "+"KEY `tanggal` (`tanggal`) "+") ENGINE=MyISAM AUTO_INCREMENT=8776 DEFAULT CHARSET=latin2 COLLATE=latin2_bin"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `pinjaman_saldo` with "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `pinjaman_saldo` ( "+"`iddata` int(10) NOT NULL AUTO_INCREMENT, "+"`kantor` varchar(4) CHARACTER SET latin1 NOT NULL, "+"`norek` varchar(25) CHARACTER SET latin1 NOT NULL, "+"`tanggal` date NOT NULL, "+"`sisapokok` double(15,0) NOT NULL DEFAULT '0', "+"`sisabunga` double(15,0) NOT NULL DEFAULT '0', "+"`denda` double(15,0) NOT NULL, "+"`tunggpk` double(15,0) NOT NULL DEFAULT '0', "+"`kalipk` int(3) NOT NULL DEFAULT '0', "+"`haripk` int(3) NOT NULL DEFAULT '0', "+"`tunggbg` double(15,0) NOT NULL DEFAULT '0', "+"`kalibg` int(3) NOT NULL DEFAULT '0', "+"`haribg` int(3) NOT NULL DEFAULT '0', "+"`tglod` date NOT NULL, "+"`tglmacet` date NOT NULL, "+"`kol_awal` varchar(1) CHARACTER SET latin1 NOT NULL, "+"`kol` varchar(1) CHARACTER SET latin1 NOT NULL, "+"`dpk` varchar(1) CHARACTER SET latin1 NOT NULL, "+"`ppap` double(15,0) NOT NULL DEFAULT '0', "+"`bgakrual` double(15,0) NOT NULL DEFAULT '0', "+"`kontijensi` double(15,0) NOT NULL DEFAULT '0', "+"`adm` int(10) NOT NULL DEFAULT '0', "+"`provisi` int(10) NOT NULL DEFAULT '0', "+"`biaya` int(10) NOT NULL DEFAULT '0', "+"`opt` varchar(5) COLLATE latin2_bin NOT NULL, "+"PRIMARY KEY (`iddata`), "+"KEY `norek` (`norek`), "+"KEY `norek_2` (`norek`,`tanggal`), "+"KEY `tanggal` (`tanggal`) "+") ENGINE=MyISAM AUTO_INCREMENT=6998 DEFAULT CHARSET=latin2 COLLATE=latin2_bin"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `set_laporan`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `set_laporan` ( "+"`kantor` char(4) DEFAULT NULL, "+"`idlaporan` int(10) NOT NULL AUTO_INCREMENT, "+"`dept` varchar(4) DEFAULT '', "+"`nama` varchar(50) DEFAULT '', "+"`formlaporan` varchar(80) DEFAULT '', "+"`perintah` text, "+"`ver` char(1) DEFAULT '', "+"`penjelasan` char(200) DEFAULT '', "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL, "+"PRIMARY KEY (`idlaporan`) "+") ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `set_print`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `set_print` ( "+"`nomor` int(3) NOT NULL, "+"`template_id` varchar(40) DEFAULT '', "+"`DEPT` varchar(3) DEFAULT 'KRD', "+"`KEL` varchar(1) DEFAULT '1', "+"`nama_menu` varchar(50) NOT NULL, "+"`PENJELASAN` varchar(150) DEFAULT '', "+"`OPT_TYPE` int(1) DEFAULT '1', "+"`TEMPLATE1` blob, "+"`TEMPLATE2` blob, "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `setsandi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `setsandi` ( "+"`kantor` char(4) DEFAULT NULL, "+"`kode` varchar(4) DEFAULT '', "+"`sandi` varchar(4) DEFAULT '', "+"`keterangan` varchar(40) DEFAULT NULL, "+"`ket2` varchar(25) DEFAULT '', "+"`ket3` varchar(25) DEFAULT '', "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL, "+"KEY `kantor` (`kantor`,`kode`,`sandi`), "+"KEY `kantor_2` (`kantor`,`kode`,`sandi`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `setsandi_pinj`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `setsandi_pinj` ( "+"`kantor` varchar(4) NOT NULL, "+"`sandi` varchar(4) NOT NULL DEFAULT '', "+"`keterangan` varchar(40) DEFAULT NULL, "+"`kdhit` varchar(1) NOT NULL, "+"`pembulatan` int(4) NOT NULL, "+"`rate` decimal(6,3) NOT NULL DEFAULT '0.000', "+"`adm` decimal(5,2) NOT NULL DEFAULT '0.00', "+"`prov` decimal(5,2) NOT NULL DEFAULT '0.00', "+"`carahitung` varchar(1) NOT NULL, "+"`periode` varchar(15) NOT NULL, "+"`jurnal_pokok` varchar(10) NOT NULL, "+"`jurnal_jasa` varchar(10) NOT NULL, "+"`jurnal_denda` varchar(10) NOT NULL, "+"`jurnal_adm` varchar(10) NOT NULL, "+"`jurnal_prov` varchar(10) NOT NULL, "+"`jurnal_yadit` varchar(10) NOT NULL, "+"`jurnal_ppap` varchar(10) NOT NULL, "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL, "+"PRIMARY KEY (`sandi`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `setsandi_tab`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `setsandi_tab` ( "+"`kantor` char(4) DEFAULT NULL, "+"`jenis` varchar(1) NOT NULL, "+"`SANDI` char(4) DEFAULT '', "+"`KETERANGAN` varchar(40) DEFAULT NULL, "+"`OPTPASIF` int(1) DEFAULT '1', "+"`HARIPASIF` int(4) DEFAULT '180', "+"`NOMIPASIF` int(10) DEFAULT '0', "+"`VER` int(1) DEFAULT '1', "+"`OPTHARI` int(1) DEFAULT '1', "+"`A_RATE` decimal(5,2) DEFAULT '0.00', "+"`A_RATE1` decimal(5,2) DEFAULT '0.00', "+"`A_RATE2` decimal(5,2) DEFAULT '0.00', "+"`A_RATE3` decimal(5,2) DEFAULT '0.00', "+"`A_RATE4` decimal(5,2) DEFAULT '0.00', "+"`A_RATE5` decimal(5,2) DEFAULT '0.00', "+"`A_NOMI_RATE1` double(15,0) DEFAULT '0', "+"`A_NOMI_RATE2` double(15,0) DEFAULT '0', "+"`A_NOMI_RATE3` double(15,0) DEFAULT '0', "+"`A_NOMI_RATE4` double(15,0) DEFAULT '0', "+"`A_NOMI_RATE5` double(15,0) DEFAULT '0', "+"`A_TYPE_RATE` int(1) DEFAULT '1', "+"`A_OPTADM` int(1) DEFAULT '1', "+"`A_ADM` int(9) DEFAULT '0', "+"`A_ADM1` int(9) DEFAULT '0', "+"`A_ADM2` int(9) DEFAULT '0', "+"`A_ADM3` int(9) DEFAULT '0', "+"`A_ADM4` int(9) DEFAULT '0', "+"`A_ADM5` int(9) DEFAULT '0', "+"`A_NOMI_ADM1` double(15,0) DEFAULT '0', "+"`A_NOMI_ADM2` double(15,0) DEFAULT '0', "+"`A_NOMI_ADM3` double(15,0) DEFAULT '0', "+"`A_NOMI_ADM4` double(15,0) DEFAULT '0', "+"`A_NOMI_ADM5` double(15,0) DEFAULT '0', "+"`P_RATE` decimal(5,2) DEFAULT '0.00', "+"`P_RATE1` decimal(5,2) DEFAULT '0.00', "+"`P_RATE2` decimal(5,2) DEFAULT '0.00', "+"`P_RATE3` decimal(5,2) DEFAULT '0.00', "+"`P_RATE4` decimal(5,2) DEFAULT '0.00', "+"`P_RATE5` decimal(5,2) DEFAULT '0.00', "+"`P_NOMI_RATE1` double(15,0) DEFAULT '0', "+"`P_NOMI_RATE2` double(15,0) DEFAULT '0', "+"`P_NOMI_RATE3` double(15,0) DEFAULT '0', "+"`P_NOMI_RATE4` double(15,0) DEFAULT '0', "+"`P_NOMI_RATE5` double(15,0) DEFAULT '0', "+"`P_TYPE_RATE` int(1) DEFAULT '1', "+"`P_OPTADM` int(1) DEFAULT '1', "+"`P_ADM` int(9) DEFAULT '0', "+"`P_ADM1` int(9) DEFAULT '0', "+"`P_ADM2` int(9) DEFAULT '0', "+"`P_ADM3` int(9) DEFAULT '0', "+"`P_ADM4` int(9) DEFAULT '0', "+"`P_ADM5` int(9) DEFAULT '0', "+"`P_NOMI_ADM1` double(15,0) DEFAULT '0', "+"`P_NOMI_ADM2` double(15,0) DEFAULT '0', "+"`P_NOMI_ADM3` double(15,0) DEFAULT '0', "+"`P_NOMI_ADM4` double(15,0) DEFAULT '0', "+"`P_NOMI_ADM5` double(15,0) DEFAULT '0', "+"`ANTARBANK` char(1) DEFAULT 'T', "+"`SALDOMINIMAL` int(10) DEFAULT '0', "+"`BATASBUNGA` int(10) DEFAULT '0', "+"`BATASPAJAK` int(10) DEFAULT '0', "+"`PAJAK` decimal(5,2) DEFAULT '0.00', "+"`TABWAJIB` INT(10) DEFAULT '0', "+"`JURNALTAB` varchar(10) DEFAULT '', "+"`JURNALUTANGBG` varchar(10) DEFAULT NULL, "+"`JURNALBUNGA` varchar(10) DEFAULT '', "+"`JURNALADM` varchar(10) DEFAULT '', "+"`JURNALADMTUTUP` varchar(10) DEFAULT '', "+"`JURNALPAJAK` varchar(10) DEFAULT '', "+"`JURNALKSD` varchar(10) DEFAULT '', "+"`BUKATGL` int(2) DEFAULT '5', "+"`BUKAKUPON` int(2) DEFAULT '1', "+"`BERHADIAH` smallint(1) DEFAULT '1', "+"`OPTHADIAH` int(1) DEFAULT '1', "+"`KELIPATAN` int(10) DEFAULT '10000', "+"`NOMORKUPON` int(1) DEFAULT '1', "+"`TUTUPCEK1` int(1) DEFAULT '1', "+"`TUTUPCEK2` int(1) DEFAULT '1', "+"`TUTUPCEK3` int(1) DEFAULT '1', "+"`TUTUPHARI` int(1) DEFAULT '1', "+"`TUTUPSALDO` double DEFAULT '1', "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan` ( "+"`kantor` varchar(4) NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) NOT NULL, "+"`jenis` varchar(4) NOT NULL, "+"`produk` varchar(4) NOT NULL, "+"`marketing` varchar(4) NOT NULL, "+"`norek` varchar(25) NOT NULL, "+"`norek_lama` varchar(17) NOT NULL, "+"`nobuku` varchar(25) NOT NULL, "+"`cif` varchar(10) NOT NULL, "+"`pokok` double NOT NULL DEFAULT '0', "+"`rate` decimal(5,2) NOT NULL DEFAULT '0.00', "+"`carahitung` varchar(1) NOT NULL, "+"`bunga_ke` varchar(25) NOT NULL, "+"`bunga_rek` varchar(25) NOT NULL, "+"`bunga_nama` varchar(25) NOT NULL, "+"`kelompok` varchar(4) NOT NULL, "+"`wilayah` varchar(4) NOT NULL, "+"`saldo` double NOT NULL, "+"`tgltutup` date NOT NULL, "+"`pot_simpanan` int(7) NOT NULL, "+"`adm` int(7) NOT NULL, "+"`pot_khusus` varchar(1) NOT NULL, "+"`rate_khusus` varchar(1) NOT NULL, "+"`adm_khusus` varchar(1) NOT NULL, "+"`tglmutasi` date NOT NULL, "+"`sms_stor` tinyint(1) DEFAULT 0, "+"`sms_ambil` tinyint(1) DEFAULT 0, "+"`brsbuku`  tinyint(2) DEFAULT 0, "+"`brskartu` tinyint(2) DEFAULT 0, "+"PRIMARY KEY (`norek`), "+"KEY `tanggal` (`tanggal`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan_akrual`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan_akrual` ( "+"`kantor` varchar(4) COLLATE latin2_bin NOT NULL, "+"`norek` varchar(25) CHARACTER SET latin1 NOT NULL, "+"`tanggal` date NOT NULL, "+"`bukti` varchar(10) CHARACTER SET latin1 NOT NULL, "+"`bunga` int(10) NOT NULL, "+"`pajak` int(10) NOT NULL, "+"`opt` varchar(4) CHARACTER SET latin1 NOT NULL, "+"PRIMARY KEY (`norek`,`tanggal`,`bukti`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin2 COLLATE=latin2_bin"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan_autodebet`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan_autodebet` ( "+"`KANTOR` char(4) DEFAULT NULL, "+"`idautodebet` int(10) NOT NULL AUTO_INCREMENT, "+"`tanggal` date DEFAULT '0000-00-00', "+"`norek` char(25) DEFAULT '', "+"`ket` varchar(40) DEFAULT '', "+"`jumlah` int(12) DEFAULT '0', "+"`opt_rek` tinyint(1) DEFAULT NULL, "+"`norek_tujuan` varchar(25) DEFAULT '', "+"`tglauto` tinyint(2) DEFAULT '1', "+"`tglakhir` date DEFAULT '0000-00-00', "+"`dibuat` varchar(20) DEFAULT '', "+"`disetujui` varchar(20) DEFAULT '', "+"`tglcabut` date NOT NULL, "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL, "+"PRIMARY KEY (`idautodebet`) "+") ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan_autodebet_mutasi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan_autodebet_mutasi` ( "+"`KANTOR` char(4) DEFAULT NULL, "+"`idautodebet` int(10) NOT NULL, "+"`tanggal` date DEFAULT '0000-00-00', "+"`bukti` varchar(10) NOT NULL, "+"`norek` char(25) DEFAULT '', "+"`ket` varchar(40) DEFAULT '', "+"`jadwal` int(12) NOT NULL, "+"`bayar` int(12) NOT NULL, "+"`opt_rek` varchar(1) DEFAULT NULL, "+"`norek_tujuan` varchar(25) DEFAULT '', "+"`pokok` int(11) NOT NULL, "+"`bunga` int(11) NOT NULL, "+"`denda` int(11) NOT NULL, "+"`tabungan` int(11) NOT NULL, "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL, "+"KEY `KANTOR` (`KANTOR`,`idautodebet`,`tanggal`,`bukti`), "+"KEY `KANTOR_2` (`KANTOR`,`idautodebet`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan_bilyet`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan_bilyet` ( "+"`kantor` varchar(4) NOT NULL, "+"`nobilyet` varchar(10) NOT NULL, "+"`norek` varchar(25) NOT NULL, "+"`tanggal` date NOT NULL, "+"`ke` int(3) NOT NULL, "+"`pokok` double NOT NULL DEFAULT '0', "+"`rate` decimal(5,2) NOT NULL DEFAULT '0.00', "+"`carahitung` varchar(1) NOT NULL, "+"`lama` int(3) NOT NULL, "+"`aro` varchar(1) NOT NULL DEFAULT 'Y', "+"`tglawal` date NOT NULL, "+"`tgljtempo` date NOT NULL, "+"PRIMARY KEY (`kantor`,`norek`,`tanggal`,`ke`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan_blokir`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan_blokir` ( "+"`kantor` varchar(4) NOT NULL, "+"`norek` char(25) DEFAULT '', "+"`idblokir` int(10) NOT NULL AUTO_INCREMENT, "+"`tanggal` date DEFAULT '0000-00-00', "+"`saldoblokir` double DEFAULT '0', "+"`blokirsemua` varchar(1) DEFAULT '', "+"`keterangan` varchar(40) DEFAULT '', "+"`tglakhirblokir` date DEFAULT '0000-00-00', "+"`tanpabatas` varchar(1) DEFAULT '', "+"`setujuid` varchar(4) DEFAULT '', "+"`tglcabut` date DEFAULT '0000-00-00', "+"`nosurat` varchar(30) NOT NULL, "+"`INPOPR` char(5) DEFAULT '', "+"`TGLINP` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, "+"`EDTOPR` char(5) DEFAULT '', "+"`TGLEDT` datetime DEFAULT NULL, "+"PRIMARY KEY (`idblokir`) "+") ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan_bunga`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan_bunga` ( "+"`kantor` varchar(4) NOT NULL, "+"`tanggal` date NOT NULL, "+"`norek` varchar(25) NOT NULL, "+"`pokok` bigint(15) NOT NULL DEFAULT '0', "+"`rate` decimal(5,2) NOT NULL DEFAULT '0.00', "+"`carahitung` varchar(1) NOT NULL, "+"`lama` int(3) NOT NULL, "+"`tglawal` date NOT NULL, "+"`tgljtempo` date NOT NULL, "+"`aro` varchar(1) NOT NULL, "+"`bunga_ke` varchar(25) NOT NULL, "+"`bunga_rek` varchar(25) NOT NULL, "+"`bunga_nama` varchar(25) NOT NULL, "+"PRIMARY KEY (`norek`), "+"KEY `norek` (`norek`), "+"KEY `tanggal` (`tanggal`) "+") ENGINE=MyISAM DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan_mutasi`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan_mutasi` ( "+"`iddata` int(11) NOT NULL AUTO_INCREMENT, "+"`kantor` varchar(4) NOT NULL, "+"`norek` char(25) NOT NULL DEFAULT '', "+"`JAM` time DEFAULT '00:00:00', "+"`BUKTI` varchar(10) NOT NULL DEFAULT '', "+"`TANGGAL` date NOT NULL DEFAULT '0000-00-00', "+"`kode` char(2) DEFAULT NULL, "+"`KETERANGAN` varchar(40) DEFAULT '', "+"`DEBET` double(15,0) DEFAULT '0', "+"`KREDIT` double(15,0) DEFAULT '0', "+"`SALDO` double(15,0) DEFAULT '0', "+"`PENYETOR` varchar(25) DEFAULT '', "+"`PENERIMA` varchar(25) DEFAULT '', "+"`SUMBERDANA` varchar(25) DEFAULT '', "+"`BERITA` varchar(25) DEFAULT '', "+"`tgljawal` date NOT NULL, "+"`CETAKKARTU` char(1) DEFAULT '', "+"`CETAKBUKU` char(1) DEFAULT '', "+"`opt` char(5) DEFAULT NULL, "+"PRIMARY KEY (`iddata`), "+"KEY `norek` (`norek`), "+"KEY `TANGGAL` (`TANGGAL`), "+"KEY `kantor` (`kantor`,`norek`,`TANGGAL`,`BUKTI`) "+") ENGINE=MyISAM AUTO_INCREMENT=258964 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `simpanan_saldo`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `simpanan_saldo` ( "+"`iddata` int(11) NOT NULL AUTO_INCREMENT, "+"`kantor` varchar(4) NOT NULL, "+"`tanggal` date NOT NULL, "+"`norek` char(25) NOT NULL DEFAULT '', "+"`SALDO` double(15,0) DEFAULT '0', "+"`utangbunga` int(12) NOT NULL, "+"`bunga` int(12) NOT NULL, "+"`pajak` int(12) NOT NULL, "+"`adm` int(12) NOT NULL, "+"`autodebet` int(12) NOT NULL, "+"`blokir` int(12) NOT NULL, "+"`tglmutasi` date NOT NULL, "+"`aktif` varchar(1) NOT NULL, "+"`hit_adm` int(5) NOT NULL, "+"`hit_rate` decimal(5,2) NOT NULL, "+"`hit_minbunga` int(7) NOT NULL, "+"`hit_minsaldo` int(7) NOT NULL, "+"`jur_utangbg` varchar(10) NOT NULL, "+"`jur_biayabg` varchar(10) NOT NULL, "+"`jur_tab` varchar(10) NOT NULL, "+"`jur_pjk` varchar(10) NOT NULL, "+"`opt` char(5) DEFAULT NULL, "+"PRIMARY KEY (`iddata`), "+"KEY `norek` (`norek`), "+"KEY `kantor` (`kantor`,`norek`) "+") ENGINE=MyISAM AUTO_INCREMENT=48213 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `user`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `user` ( "+"`kantor` varchar(4) NOT NULL, "+"`id` int(5) NOT NULL AUTO_INCREMENT, "+"`userid` varchar(10) NOT NULL, "+"`nama` varchar(30) NOT NULL, "+"`alamat` varchar(30) NOT NULL, "+"`namagroup` varchar(35) NOT NULL, "+"`password` varchar(35) NOT NULL, "+"`tglbuka` date NOT NULL, "+"`tglupdate` date NOT NULL, "+"`tglakhir` date NOT NULL, "+"`stat` varchar(1) NOT NULL, "+"`bataskas` double(15,0) NOT NULL, "+"`aktif` varchar(1) NOT NULL, "+"PRIMARY KEY (`id`), "+"KEY `userid` (`userid`) "+") ENGINE=MyISAM AUTO_INCREMENT=8 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `user_group`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `user_group` ( "+"`kantor` varchar(4) NOT NULL, "+"`id` int(11) NOT NULL AUTO_INCREMENT, "+"`namagroup` varchar(20) NOT NULL, "+"`seting` tinyint(1) NOT NULL DEFAULT '1', "+"`master` tinyint(1) NOT NULL DEFAULT '1', "+"`transaksi` tinyint(1) NOT NULL DEFAULT '1', "+"`laporan` tinyint(1) NOT NULL DEFAULT '1', "+"`proses` tinyint(1) NOT NULL DEFAULT '1', "+"`utility` tinyint(1) NOT NULL DEFAULT '1', "+"`m_anggota` varchar(8) NOT NULL DEFAULT '000000', "+"`m_simpanan` varchar(8) NOT NULL DEFAULT '000000', "+"`m_pinjaman` varchar(8) NOT NULL DEFAULT '000000', "+"`m_kasir` varchar(8) NOT NULL DEFAULT '000000', "+"`m_akuntansi` varchar(8) NOT NULL DEFAULT '000000', "+"`m_kolektor` varchar(8) NOT NULL DEFAULT '000000', "+"`m_user` varchar(8) NOT NULL, "+"`m_setting` varchar(8) NOT NULL, "+"`r_anggota` tinyint(1) NOT NULL DEFAULT '1', "+"`r_simpanan` tinyint(1) NOT NULL DEFAULT '1', "+"`r_pinjaman` tinyint(1) NOT NULL DEFAULT '1', "+"`r_kasir` tinyint(1) NOT NULL DEFAULT '1', "+"`r_akuntansi` tinyint(1) NOT NULL DEFAULT '1', "+"`r_lain` tinyint(1) NOT NULL DEFAULT '1', "+"PRIMARY KEY (`id`) "+") ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=latin1"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `batastanggal`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `batastanggal` ("+"`kantor` VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"`tglawal` DATE NOT NULL DEFAULT '0000-00-00',"+"`tglakhir` DATE NOT NULL DEFAULT '0000-00-00',"+"`tglupdate` DATE NOT NULL DEFAULT '0000-00-00',"+"INDEX ( `kantor` ))"
CSQL = SQLEXEC(OODBC, CSQL)
CSQL = "DROP TABLE IF EXISTS `urutnota`"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE `urutnota` ("+"kantor      VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"statusnomor VARCHAR( 1 ) NOT NULL DEFAULT '0',"+"kas         VARCHAR( 6 ) NOT NULL DEFAULT 'KAS',"+"nomorbukti  VARCHAR( 10 ) NOT NULL DEFAULT '',"+"INDEX ( `kantor` ))"
CSQL = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE set_cetakfrx ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`namafrx` varchar(20) NOT NULL DEFAULT '', "+"`objtype` int(4) NOT NULL DEFAULT '0', "+"`name` varchar(20) NOT NULL DEFAULT '', "+"`expr` varchar(20) NOT NULL DEFAULT '', "+"`vpos` int(9) NOT NULL DEFAULT '0', "+"`hpos` int(9) NOT NULL DEFAULT '0', "+"`height` int(9) NOT NULL DEFAULT '0', "+"`width` int(9) NOT NULL DEFAULT '0', "+"`style` varchar(20) NOT NULL DEFAULT '', "+"`picture` varchar(20) NOT NULL DEFAULT '', "+"`order` varchar(20) NOT NULL DEFAULT '', "+"`comment` varchar(20) NOT NULL DEFAULT '', "+"`fontstyle` varchar(20) NOT NULL DEFAULT '', "+"`fontsize` int(3) NOT NULL DEFAULT '9', "+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Set_cetakfrx, gagal")
ENDIF
CSQL = "CREATE TABLE acc_transaksi ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kantor` VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"`tanggal` DATE NOT NULL DEFAULT '0000-00-00',"+"`bukti` VARCHAR(10) NOT NULL DEFAULT '0000000000',"+"`keterangan` VARCHAR(50 ) NOT NULL DEFAULT '',"+"`jumlah` double(15,0) NOT NULL DEFAULT '0',"+"`opt` VARCHAR( 5 ) NOT NULL DEFAULT '',"+"`tglacc` DATE NOT NULL DEFAULT '0000-00-00',"+"`optacc` VARCHAR( 5 ) NOT NULL DEFAULT '',"+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE acc_harian ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kantor` VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"`tanggal` DATE NOT NULL DEFAULT '0000-00-00',"+"`jenis` varchar(3) NULL DEFAULT '',"+"`nominal1` int(11) NULL DEFAULT '0',"+"`nominal2` int(11) NULL DEFAULT '0',"+"PRIMARY KEY (`iddata`), "+"KEY `norek` (`norek`), "+"KEY `kantor` (`kantor`,`tanggal`) "+"KEY `kantor` (`kantor`,`tanggal`,`jenis`)) "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE acc_harian_bungasimpanan ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id` int(5) NOT NULL DEFAULT '0', "+"`kantor` VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"`tanggal` DATE NOT NULL DEFAULT '0000-00-00',"+"`norek` varchar(17) NULL DEFAULT '',"+"`nama` varchar(30) NULL DEFAULT '',"+"`produk` varchar(30) NULL DEFAULT '',"+"`saldo` double(15,0) NULL DEFAULT '0',"+"`rate` decimal(5,2) NOT NULL,"+"`jasa` int(11) NULL DEFAULT '0',"+"`pajak` int(11) NULL DEFAULT '0',"+"`adm` int(11) NULL DEFAULT '0',"+"`jurtab` varchar(10) DEFAULT '', "+"`jurbg` varchar(10) DEFAULT NULL, "+"`jurpjk` varchar(10) DEFAULT '', "+"`jurutang` varchar(10) DEFAULT '', "+"`juradm` varchar(10) DEFAULT '', "+"`utang` int(10) DEFAULT '0', "+"PRIMARY KEY (`iddata`), "+"KEY `norek` (`norek`)) "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "CREATE TABLE acc_harian_bungadeposito ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id` int(5) NOT NULL DEFAULT '0', "+"`kantor` VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"`tanggal` DATE NOT NULL DEFAULT '0000-00-00',"+"`norek` varchar(17) NULL DEFAULT '',"+"`nama` varchar(30) NULL DEFAULT '',"+"`produk` varchar(30) NULL DEFAULT '',"+"`rate` decimal(5,2) NOT NULL,"+"`saldo` double(15,0) NULL DEFAULT '0',"+"`jasa` int(11) NULL DEFAULT '0',"+"`pajak` int(11) NULL DEFAULT '0',"+"`aro` varchar(1) NULL DEFAULT 'Y',"+"`keterangan` varchar(50) NULL DEFAULT '',"+"`kekantor` varchar(4) DEFAULT '', "+"`bungake` varchar(10) DEFAULT '', "+"`norektujuan` varchar(20) DEFAULT '', "+"`atasnama` varchar(30) DEFAULT '', "+"`jurtab` varchar(10) DEFAULT '', "+"`jurbg` varchar(10) DEFAULT NULL, "+"`jurpjk` varchar(10) DEFAULT '', "+"`jurutang` varchar(10) DEFAULT '', "+"`jurlawan` varchar(10) DEFAULT '', "+"`juraktab` varchar(10) DEFAULT '', "+"`utang` int(10) DEFAULT '0', "+"`stat_data` varchar(1) DEFAULT '', "+"`opt` varchar(10) DEFAULT '', "+"PRIMARY KEY (`iddata`), "+"KEY `norek` (`norek`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal.....")
ENDIF
CSQL = "CREATE TABLE acc_harian_dep_aro ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id` int(5) NOT NULL DEFAULT '0', "+"`kantor` VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"`tanggal` DATE NOT NULL DEFAULT '0000-00-00',"+"`norek` varchar(17) NULL DEFAULT '',"+"`nama` varchar(30) NULL DEFAULT '',"+"`alamat` varchar(50) NULL DEFAULT '',"+"`nobilyet` varchar(10) NULL DEFAULT '',"+"`rate_lama` decimal(5,2) NOT NULL,"+"`ke` int(3) NOT NULL, "+"`pokok` double NOT NULL DEFAULT '0', "+"`rate` decimal(5,2) NOT NULL DEFAULT '0.00', "+"`carahitung` varchar(1) NOT NULL, "+"`lama` int(3) NOT NULL, "+"`aro` varchar(1) NOT NULL DEFAULT 'Y', "+"`tglawal` date NOT NULL, "+"`tgljtempo` date NOT NULL, "+"`opt` varchar(10) DEFAULT '', "+"PRIMARY KEY (`iddata`), "+"KEY `norek` (`norek`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal.....")
ENDIF
CSQL = "CREATE TABLE acc_harian_catatan ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id` int(5) NOT NULL DEFAULT '0', "+"`kantor` VARCHAR( 4 ) NOT NULL DEFAULT '0001',"+"`DEPT` char(3) DEFAULT '',"+"`norek` char(25) DEFAULT '',"+"`idcatatan` int(10) NOT NULL ,"+"`tanggal` date DEFAULT '0000-00-00',"+"`catatan` text,"+"`JUMLAH` double(15,0) DEFAULT '0',"+"`opt` varchar(10) DEFAULT '', "+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal")
ENDIF
CSQL = "CREATE TABLE acc_harian_autodebet ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id` int(5) NOT NULL DEFAULT '0', "+"`KANTOR` char(4) DEFAULT NULL, "+"`idautodebet` int(10) NOT NULL , "+"`tanggal` date DEFAULT '0000-00-00', "+"`norek` char(25) DEFAULT '', "+"`ket` varchar(40) DEFAULT '', "+"`jumlah` int(12) DEFAULT '0', "+"`opt_rek` tinyint(1) DEFAULT NULL, "+"`norek_tujuan` varchar(25) DEFAULT '', "+"`tglauto` tinyint(2) DEFAULT '1', "+"`tglakhir` date DEFAULT '0000-00-00', "+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal")
ENDIF
CSQL = "CREATE TABLE acc_harian_jt_angsuran ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id` int(5) NOT NULL DEFAULT '0', "+"`kantor` char(4) DEFAULT NULL, "+"`tanggal` date DEFAULT '0000-00-00', "+"`tglrealisasi` date DEFAULT '0000-00-00', "+"`norek` char(25) DEFAULT '', "+"`nama` char(30) DEFAULT '', "+"`produk` varchar(30) DEFAULT '', "+"`rate` decimal(5,2) DEFAULT '0', "+"`pokok` double(15,0) DEFAULT '0', "+"`angspokok` int(10) DEFAULT '0', "+"`angsjasa` int(10) DEFAULT '0', "+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal")
ENDIF
CSQL = "CREATE TABLE acc_harian_ulangtahun ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id` int(5) NOT NULL DEFAULT '0', "+"`kantor` char(4) DEFAULT NULL, "+"`tanggal` date DEFAULT '0000-00-00', "+"`tgllahir` date DEFAULT '0000-00-00', "+"`nama` char(30) DEFAULT '', "+"`alamat` varchar(30) DEFAULT '', "+"`fasilitas` varchar(30) DEFAULT '0', "+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal")
ENDIF
CSQL = "CREATE TABLE acc_harian_inventaris ("+"`iddata` int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id` int(5) NOT NULL DEFAULT '0', "+"`kantor` char(4) NOT NULL DEFAULT '0000', "+"`tanggal` date DEFAULT '0000-00-00', "+"`idinvent` INT(5) not null default '0', "+"`keterangan` char(30) DEFAULT '', "+"`debet` double(15,0) DEFAULT '0', "+"`kredit` double(15,0) DEFAULT '0', "+"`opt` varchar(5) DEFAULT '', "+"`nama` varchar(50) DEFAULT '', "+"`jur_biaya` varchar(10) DEFAULT '', "+"`jur_akum` varchar(10) DEFAULT '', "+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal Buat Inventaris")
ENDIF
CSQL = "CREATE TABLE acc_harian_angsuranjt ("+"`iddata`    int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id`    int(5) NOT NULL DEFAULT '0', "+"`kantor`    char(4) NOT NULL DEFAULT '0000', "+"`tanggal`   date DEFAULT '0000-00-00', "+"`norek`     varchar(25) default '', "+"`nama`      varchar(40) DEFAULT '', "+"`alamat`    varchar(40) DEFAULT '', "+"`phone`     varchar(20) DEFAULT '', "+"`tungpk`    double(15,0) DEFAULT '0', "+"`tungbg`    double(15,0) DEFAULT '0', "+"`tungdenda` double(15,0) DEFAULT '0', "+"`angspokok` double(15,0) DEFAULT '0', "+"`angsbunga` double(15,0) DEFAULT '0', "+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal Buat angsuran jt")
ENDIF
CSQL = "CREATE TABLE acc_harian_pinjamanjt ("+"`iddata`    int(5) NOT NULL AUTO_INCREMENT, "+"`kel_id`    int(5) NOT NULL DEFAULT '0', "+"`kantor`    char(4) NOT NULL DEFAULT '0000', "+"`tanggal`   date DEFAULT '0000-00-00', "+"`norek`     varchar(25) default '', "+"`nama`      varchar(40) DEFAULT '', "+"`alamat`    varchar(40) DEFAULT '', "+"`phone`     varchar(20) DEFAULT '', "+"`tungpk`    double(15,0) DEFAULT '0', "+"`tungbg`    double(15,0) DEFAULT '0', "+"`tungdenda` double(15,0) DEFAULT '0', "+"`angspokok` double(15,0) DEFAULT '0', "+"`angsbunga` double(15,0) DEFAULT '0', "+"PRIMARY KEY (`iddata`)) "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal Buat pinjaman jt")
ENDIF
THISFORM.BUATTRIGGER()
IF THISFORM.OPTIONGROUP1.VALUE=1
THISFORM.ISIPERKIRAAN()
ENDIF
IF THISFORM.OPTIONGROUP1.VALUE=2
ENDIF
THISFORM.NILAI = 1
THISFORM.RELEASE
ENDPROC
**
*
*  form_buatdatabased.scx::Command2
**
PROCEDURE Click
THISFORM.NILAI = 0
THISFORM.RELEASE
ENDPROC
**
*
*  form_buatdatabased.scx::Text9
**
PROCEDURE LostFocus
IF THIS.VALUE="NEW"
THISFORM.HEIGHT = 387
ENDIF
ENDPROC
**
*
*  form_buatdatabased.scx::Command3
**
PROCEDURE Click
THISFORM.HEIGHT = 280
THISFORM.MODE = 1
ENDPROC
**
*
*  form_buatdatabased.scx::Command4
**
PROCEDURE Click
THISFORM.BUATTRIGGER()
ENDPROC
**
***
*** form_buatdatabased.sct
***
*
***
*** acc_harian_simpanan.scx
***
*
*
*  acc_harian_simpanan.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND7.VISIBLE = .F.
ELSE
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND5.VISIBLE = .T.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND7.VISIBLE = .F.
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = KETERANGAN
DO CASE
CASE JENIS='S01'
THISFORM.TEXT2.VALUE = "PROSES JASA SIMPANAN TABUNGAN"
CASE JENIS='S02'
THISFORM.TEXT2.VALUE = "PROSES JASA SIMPANAN BERJANGKA"
CASE JENIS='S03'
THISFORM.TEXT2.VALUE = "PROSES AKRUAL JASA SIMPANAN TABUNGAN"
CASE JENIS='S4'
THISFORM.TEXT2.VALUE = "PROSES AKRUAL JASA SIMPANAN BERJANGKA"
CASE JENIS='S05'
THISFORM.TEXT2.VALUE = "PROSES AUTODEBET SIMPANAN"
ENDCASE
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
CSQL = "select SUM(jasa) as js, SUM(pajak) as pjk from acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
THISFORM.TEXT3.VALUE = JS
THISFORM.TEXT4.VALUE = PJK
CSQL = "select * from acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 5
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NOREK"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "TRANS(JASA,'9,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "JASA"
.COLUMN3.ALIGNMENT = 1
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "TRANS(PAJAK,'9,999,999,999')"
.COLUMN4.HEADER1.CAPTION = "PAJAK"
.COLUMN4.ALIGNMENT = 1
.COLUMN5.WIDTH = 90
.COLUMN5.CONTROLSOURCE = "TRANS(ADM,'9,999,999,999')"
.COLUMN5.HEADER1.CAPTION = "ADM"
.COLUMN5.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
*
*  acc_harian_simpanan.scx::Grid1
**
PROCEDURE DblClick
DO FORM acc_harian_simpanan_detail
ENDPROC
**
*
*  acc_harian_simpanan.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_simpanan.scx::Command4
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM frm_bukti TO MBUKTI WITH THISFORM.TEXT1.VALUE
IF  .NOT. EMPTY(MBUKTI)
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
GOTO TOP
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTGL = TANGGAL
MJASA = JASA
MPJK = PAJAK
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
USE
IF MJASA>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABBG+"','"+"JASA SIMPANAN"+"','0','"+STR(MJASA)+"','"+TRANSFORM(MSALDO+MJASA, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF MPJK>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABPJK+"','"+"PAJAK JASA SIMPANAN"+"','"+STR(MPJK)+"','"+STR(0)+"','"+TRANSFORM(MSALDO+MJASA-MPJK, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(MTGL)+"', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT sum( jasa ) AS bg, sum( pajak ) AS pjk, jurtab,jurbg,jurpjk FROM acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"' GROUP BY produk"
LCEK = SQLEXEC(OODBC, CSQL, "JASA")
DO WHILE  .NOT. EOF()
MJURBG = JURBG
MJURPJK = JURPJK
MJURTAB = JURTAB
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURBG+"','JASA SIMPANAN','"+TRANSFORM(BG, '999999999999')+"','"+MOPTACC+"'), "
IF PJK>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURPJK+"','JASA SIMPANAN','"+TRANSFORM(0-PJK, '999999999999')+"','"+MOPTACC+"'), "
ENDIF
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURTAB+"','JASA SIMPANAN','"+TRANSFORM(0-(BG-PJK), '999999999999')+"','"+MOPTACC+"')"
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, MJURBG, MTGL)
HITNERACA(DEFAKANTOR, MJURPJK, MTGL)
HITNERACA(DEFAKANTOR, MJURTAB, MTGL)
SELECT JASA
SKIP
ENDDO
SELECT JASA
USE
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_simpanan.scx::Command5
**
PROCEDURE Click
MTANGGAL = THISFORM.TEXT1.VALUE
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(MTANGGAL)+"' and kode='S01' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_bungasimpanan where tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_simpanan.scx::Command1
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
GOTO TOP
CSQL = "select bukti from simpanan_mutasi where kantor='"+KANTOR+"' and norek='"+NOREK+"' and tanggal='"+SQLDATE(TANGGAL)+"' and kode='"+ALLTRIM(DEFATABBG)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBUKTI = BUKTI
USE
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTGL = TANGGAL
MJASA = JASA
MPJK = PAJAK
CSQL = "delete from simpanan_mutasi where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTGL)+"' and bukti='"+MBUKTI+"' and (kode='"+DEFATABBG+"' or kode='"+DEFATABPJK+"')"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='0000-00-00', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from jurnal where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(MTGL)+"' and bukti='"+MBUKTI+"' and keterangan='JASA SIMPANAN'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus jurnal")
ENDIF
CSQL = "SELECT jurtab,jurbg,jurpjk FROM acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"' GROUP BY produk"
LCEK = SQLEXEC(OODBC, CSQL, "JUR")
DO WHILE  .NOT. EOF()
MJURBG = JURBG
MJURPJK = JURPJK
MJURTAB = JURTAB
HITNERACA(DEFAKANTOR, MJURBG, MTGL)
HITNERACA(DEFAKANTOR, MJURPJK, MTGL)
HITNERACA(DEFAKANTOR, MJURTAB, MTGL)
SELECT JUR
SKIP
ENDDO
SELECT JUR
USE
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_simpanan.scx::Command2
**
PROCEDURE Click
SELECT RINCI_TRANS
REPORT FORM tab_pemberianbunga_tab PREVIEW
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
*
*  acc_harian_simpanan.scx::Command6
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE Click
SELECT RINCI_TRANS
MKEL = KEL_ID
CSQL = "SELECT produk,SUM(jasa) as jasa, SUM(pajak) as pajak "+"FROM acc_harian_bungasimpanan WHERE kel_id='"+STR(MKEL)+"' group by produk"
LCEK = SQLEXEC(OODBC, CSQL, "REKAP")
REPORT FORM tab_pemberianbungatab_rekap PREVIEW
SELECT REKAP
USE
SELECT RINCI_TRANS
ENDPROC
**
*
*  acc_harian_simpanan.scx::Command7
**
PROCEDURE Click
DO FORM acc_harian_simpanan_detail WITH "INPUT"
ENDPROC
**
***
*** acc_harian_simpanan.sct
***
*
***
*** kop0.jpg
***
*
***
*** acc_admin.scx
***
*
*
*  acc_admin.scx::FORM1
**
FUNCTION Unload
SELECT (THISFORM.OLDDBF)
RETURN THISFORM.HASIL
ENDFUNC
**
PROCEDURE Init
THISFORM.TOP = SYSMETRIC(2)/2
THISFORM.LEFT = SYSMETRIC(1)/2
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.IDDATA = IDDATA
THISFORM.OLDDBF = SELECT()
THISFORM.JUMLAH = JUMLAH
THISFORM.LABEL2.CAPTION = LEFT(KETERANGAN, AT(CHR(13), KETERANGAN))+" Rp."+ALLTRIM(TRANSFORM(JUMLAH, "999,999,999,999"))
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.HASIL = 2
CSQL = "delete from acc_transaksi where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_admin.scx::Text2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
*
*  acc_admin.scx::Command2
**
PROCEDURE Click
CSQL = "delete from acc_transaksi where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.HASIL = 2
THISFORM.RELEASE
ENDPROC
**
*
*  acc_admin.scx::Command3
**
PROCEDURE Click
CSQL = "select * from user where userid='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' and password=md5('"+ALLTRIM(THISFORM.TEXT2.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF USERID=THISFORM.TEXT1.VALUE .AND. BATASKAS>=THISFORM.JUMLAH
USE
THISFORM.HASIL = 1
CSQL = "update acc_transaksi  set tglacc='"+SQLDATE(TGLNOW)+"', optacc='"+THISFORM.TEXT1.VALUE+"' where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
USE
SELECT (THISFORM.OLDDBF)
MESSAGEBOX("VALIDASI TRANSAKSI TIDAK DAPAT DILAKUKAN"+CHR(13)+"Terjadi Kesalahan Password atau Melebihi batas Kewenangan", 0, "")
THISFORM.TEXT1.SETFOCUS
RETURN
ENDIF
USE
SELECT (THISFORM.OLDDBF)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_admin.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
***
*** acc_admin.sct
***
*
***
*** tab_nominatif.frx
***
*
***
*** tab_nominatif.frt
***
*
***
*** acc_harian1.scx
***
*
*
*  acc_harian1.scx::VERIFIKASI
**
PROCEDURE mytampil
MYDATA = THISFORM.DATA
SELECT &MYDATA  
WITH THISFORM.PAGEFRAME1.PAGE1.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 3
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.WIDTH = 50
.COLUMN2.CONTROLSOURCE = "KODE"
.COLUMN2.HEADER1.CAPTION = "KODE"
.COLUMN3.WIDTH = 800
.COLUMN3.CONTROLSOURCE = "KETERANGAN"
.COLUMN3.HEADER1.CAPTION = "KETERANGAN"
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
MYDATA2 = THISFORM.DATA2
SELECT &MYDATA2  
WITH THISFORM.PAGEFRAME1.PAGE2.GRID1
.RECORDSOURCE = MYDATA2
.COLUMNCOUNT = 3
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.WIDTH = 50
.COLUMN2.CONTROLSOURCE = "KODE"
.COLUMN2.HEADER1.CAPTION = "KODE"
.COLUMN3.WIDTH = 800
.COLUMN3.CONTROLSOURCE = "KETERANGAN"
.COLUMN3.HEADER1.CAPTION = "KETERANGAN"
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
ENDPROC
**
PROCEDURE mybacasql
MDATA = THISFORM.DATA
CSQL = "select COUNT(tanggal) as jml from acc_harian where tglacc='0000-00-00' and kantor='"+DEFAKANTOR+"' and "
CSQL = CSQL+IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE1.MFILTER.CAPTION), "1", THISFORM.PAGEFRAME1.PAGE1.MFILTER.CAPTION)
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJML = IIF(ISNULL(JML), 0, IIF(VARTYPE(JML)="C", VAL(JML), JML))
THISFORM.JUMREC = MJML
THISFORM.HALAMAN = INT(MJML/THISFORM.PAGEFRAME1.PAGE1.MLIMIT.VALUE)
THISFORM.HALAMAN = IIF(THISFORM.HALAMAN<1, 1, THISFORM.HALAMAN)
IF THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE=0
THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE = THISFORM.HALAMAN
ELSE
THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE = MIN(THISFORM.HALAMAN, THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE)
ENDIF
MLIMIT = ALLTRIM(STR((THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE-1)*THISFORM.PAGEFRAME1.PAGE1.MLIMIT.VALUE))+", "+ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.MLIMIT.VALUE))
CSQL = "select * from acc_harian where tglacc='0000-00-00' and kantor='"+DEFAKANTOR+"' and "
CSQL = CSQL+IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE1.MFILTER.CAPTION), "1", THISFORM.PAGEFRAME1.PAGE1.MFILTER.CAPTION)
CSQL = CSQL+" order by tanggal desc"+" limit "+MLIMIT
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
RETURN
ENDIF
JMLDATA = RECCOUNT()
MDATA2 = THISFORM.DATA2
THISFORM.PAGEFRAME1.PAGE2.HAL.VALUE = 1
MLIMIT = "0,50"
CSQL = "select * from acc_harian where tglacc<>'0000-00-00' and kantor='"+DEFAKANTOR+"' and "
CSQL = CSQL+IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.MFILTER.CAPTION), "1", THISFORM.PAGEFRAME1.PAGE2.MFILTER.CAPTION)
CSQL = CSQL+" order by tanggal desc"+" limit 0,50"
LCEK = SQLEXEC(OODBC, CSQL, MDATA2)
IF LCEK<1
MESSAGEBOX(CSQL)
RETURN
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA)
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MSTATUS
IF VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L"
MMODE = "TAMPIL"
ENDIF
THISFORM.LABEL2.CAPTION = ""
THISFORM.OLDSELECT = SELECT()
THISFORM.PAGEFRAME1.PAGE1.MFILTER.CAPTION = ""
THISFORM.PAGEFRAME1.PAGE1.MLIMIT.VALUE = 50
THISFORM.PAGEFRAME1.PAGE2.MFILTER.CAPTION = ""
THISFORM.PAGEFRAME1.PAGE2.MLIMIT.VALUE = 50
THISFORM.DATA = SYS(2015)
THISFORM.DATA2 = SYS(2015)
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
IF MMODE="CARI"
THISFORM.PAGEFRAME1.PAGE1.CMDCARI1.CLICK
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_harian1.scx::Pageframe1
**
PROCEDURE Page1.Activate
THISFORM.MYTAMPIL()
ENDPROC
**
PROCEDURE Page2.Activate
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.PAGEFRAME1.PAGE1.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  acc_harian1.scx::Cmddatatop1
**
PROCEDURE Click
IF THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE=1
MESSAGEBOX("Halaman Pertama", 16, "")
RETURN
ENDIF
THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE = THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE-1
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(jenis),TRIM(kode),TRIM(keterangan))"+" LIKE "+UPPER(MFILTER)
THISFORM.PAGEFRAME1.PAGE1.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  acc_harian1.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmddatabott1
**
PROCEDURE Click
IF THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE=THISFORM.HALAMAN
MESSAGEBOX("Halaman Terakhir", 16, "")
RETURN
ENDIF
THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE = THISFORM.PAGEFRAME1.PAGE1.HAL.VALUE+1
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::mLimit
**
PROCEDURE LostFocus
THISFORM.HAL.VALUE = 0
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
SELECT (THISFORM.DATA)
IF NKEYCODE=13
DO CASE
CASE KODE='S01A'
DO FORM .\form\acc_harian_simpanan
CASE KODE='S01B'
DO FORM .\form\acc_harian_deposito
CASE KODE='S02'
DO FORM acc_harian_autodebet
CASE KODE='S03'
DO FORM .\form\acc_harian_admsimpanan
CASE KODE='S04'
DO FORM .\form\acc_harian_deposito
CASE KODE='S05'
DO FORM acc_harian_aro
CASE KODE='P01'
CASE KODE='P02'
DO FORM acc_harian_angsuranjt
CASE KODE='P03'
DO FORM acc_harian_pinjamanjt
CASE KODE='A01'
DO FORM acc_harian_catatan
CASE KODE='A02'
DO FORM acc_harian_ulangtahun
CASE KODE='GL1'
DO FORM acc_harian_Invent
CASE KODE='V01'
ENDCASE
KEYBOARD '{LEFTARROW}'
ENDIF
ENDPROC
**
PROCEDURE DblClick
SELECT (THISFORM.DATA)
DO CASE
CASE KODE='S01'
DO FORM .\form\acc_harian_simpanan
CASE KODE='S02'
DO FORM acc_harian_autodebet
CASE KODE='S03'
DO FORM .\form\acc_harian_admsimpanan
CASE KODE='S04'
DO FORM .\form\acc_harian_deposito
CASE KODE='S05'
DO FORM acc_harian_aro
CASE KODE='P01'
CASE KODE='P02'
DO FORM acc_harian_angsuranjt
CASE KODE='P03'
DO FORM acc_harian_pinjamanjt
CASE KODE='A01'
DO FORM acc_harian_catatan
CASE KODE='GL1'
DO FORM acc_harian_Invent
CASE KODE='A02'
DO FORM acc_harian_ulangtahun
ENDCASE
THISFORM.MYBACASQL()
ENDPROC
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  acc_harian1.scx::hal
**
PROCEDURE LostFocus
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmdrefresh1
**
PROCEDURE Click
THISFORM.MYBACASQL()
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmdfilter1
**
PROCEDURE Click
MDATA = THISFORM.DATA
DO FORM .\form\filter_data TO MFILTER WITH MDATA
THISFORM.PAGEFRAME1.PAGE2.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETFOCUS
THISFORM.MYTAMPIL()
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  acc_harian1.scx::Cmddatatop1
**
PROCEDURE Click
IF THISFORM.PAGEFRAME1.PAGE2.HAL.VALUE=1
MESSAGEBOX("Halaman Pertama", 16, "")
RETURN
ENDIF
THISFORM.PAGEFRAME1.PAGE2.HAL.VALUE = THISFORM.PAGEFRAME1.PAGE2.HAL.VALUE-1
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmdcari1
**
PROCEDURE Click
DO FORM .\form\cari_data TO MFILTER
IF EMPTY(MFILTER)
RETURN
ENDIF
MFILTER = "concat(TRIM(jenis),TRIM(kode),TRIM(keterangan))"+" LIKE "+UPPER(MFILTER)
THISFORM.PAGEFRAME1.PAGE2.MFILTER.CAPTION = MFILTER
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETFOCUS
THISFORM.MYTAMPIL2()
ENDPROC
**
*
*  acc_harian1.scx::Cmddataup1
**
PROCEDURE Click
IF  .NOT. BOF()
SKIP -1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmddatabott1
**
PROCEDURE Click
IF THISFORM.PAGEFRAME1.PAGE2.HAL.VALUE=THISFORM.HALAMAN
MESSAGEBOX("Halaman Terakhir", 16, "")
RETURN
ENDIF
THISFORM.PAGEFRAME1.PAGE2.HAL.VALUE = THISFORM.PAGEFRAME1.PAGE2.HAL.VALUE+1
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Cmddatadowm1
**
PROCEDURE Click
IF  .NOT. EOF()
SKIP 1
ENDIF
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::mLimit
**
PROCEDURE LostFocus
THISFORM.HAL.VALUE = 0
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
*
*  acc_harian1.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.MYTAMPIL2()
ENDPROC
**
PROCEDURE DblClick
SELECT (THISFORM.DATA2)
DO CASE
CASE KODE='S01'
DO FORM .\form\acc_harian_simpanan
CASE KODE='S02'
DO FORM acc_harian_autodebet
CASE KODE='S03'
DO FORM .\form\acc_harian_admsimpanan
CASE KODE='S04'
DO FORM .\form\acc_harian_deposito
CASE KODE='S05'
DO FORM acc_harian_aro
CASE KODE='P01'
CASE KODE='P02'
DO FORM acc_harian_angsuranjt
CASE KODE='P03'
DO FORM acc_harian_pinjamanjt
CASE KODE='A01'
DO FORM acc_harian_catatan
CASE KODE='GL1'
DO FORM acc_harian_Invent
CASE KODE='A02'
DO FORM acc_harian_ulangtahun
ENDCASE
THISFORM.MYBACASQL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
SELECT (THISFORM.DATA2)
IF NKEYCODE=13
DO CASE
CASE KODE='S01'
DO FORM .\form\acc_harian_simpanan
CASE KODE='S02'
DO FORM acc_harian_autodebet
CASE KODE='S03'
DO FORM .\form\acc_harian_admsimpanan
CASE KODE='S04'
DO FORM .\form\acc_harian_deposito
CASE KODE='S05'
DO FORM acc_harian_aro
CASE KODE='P01'
CASE KODE='P02'
DO FORM acc_harian_angsuranjt
CASE KODE='P03'
DO FORM acc_harian_pinjamanjt
CASE KODE='A01'
DO FORM acc_harian_catatan
CASE KODE='GL1'
DO FORM acc_harian_Invent
CASE KODE='A02'
DO FORM acc_harian_ulangtahun
ENDCASE
ENDIF
ENDPROC
**
*
*  acc_harian1.scx::hal
**
PROCEDURE LostFocus
THISFORM.MYBACASQL()
THISFORM.MYTAMPIL()
ENDPROC
**
***
*** acc_harian1.sct
***
*
***
*** gl_lap2.scx
***
*
*
*  gl_lap2.scx::FORM1
**
PROCEDURE bacasql
DO CASE
CASE THISFORM.NOMORLAP=1
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)+" s/d. "+DTOC(THISFORM.TEXT3.VALUE)+CHR(13)+ALLTRIM(THISFORM.TEXT4.VALUE)+" : "+ALLTRIM(THISFORM.TEXT7.VALUE)
CSQL = "select *,jumlah as saldoaw from jurnal where kantor='"+DEFAKANTOR+"' and tanggal>='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and tanggal<='"+SQLDATE(THISFORM.TEXT3.VALUE)+"' and noper='"+THISFORM.TEXT4.VALUE+"' order by tanggal,bukti"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca jurnal")
ENDIF
MSALDOAWAL = BACANERACA(THISFORM.TEXT8.VALUE, THISFORM.TEXT4.VALUE, THISFORM.TEXT2.VALUE, "AWAL")
SELECT SMT
REPLACE SALDOAW WITH MSALDOAWAL ALL
GOTO TOP
CASE THISFORM.NOMORLAP=2
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)+" s/d. "+DTOC(THISFORM.TEXT3.VALUE)
CSQL = "select a.*,b.nama from neraca as a left join perkiraan as b on a.noper=b.noper where tanggal>='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and tanggal<='"+SQLDATE(THISFORM.TEXT3.VALUE)+"' and a.noper='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
CASE THISFORM.NOMORLAP=3
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)+" s/d. "+DTOC(THISFORM.TEXT3.VALUE)
CSQL = "select tanggal,bukti,noper,keterangan,IF(jumlah>0,jumlah,0) as debet, if(jumlah<0,0-jumlah,0) as kredit, ' ' as flag "+"from jurnal where tanggal>='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and tanggal<='"+SQLDATE(THISFORM.TEXT3.VALUE)+"' order by tanggal,bukti,IF(jumlah>0,'A','B')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
GOTO TOP
MTANGGAL = TANGGAL
MBUKTI = 'xx'
DO WHILE  .NOT. EOF()
IF TANGGAL<>MTANGGAL .OR. BUKTI<>MBUKTI
REPLACE FLAG WITH '*'
MTANGGAL = TANGGAL
MBUKTI = BUKTI
ENDIF
SKIP
ENDDO
CASE THISFORM.NOMORLAP=4
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)
CSQL = "select * from gl_inventaris where tanggal<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' order by kode"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
CASE THISFORM.NOMORLAP=5
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)+" s/d. "+DTOC(THISFORM.TEXT3.VALUE)
CASE THISFORM.NOMORLAP=8
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)+" s/d. "+DTOC(THISFORM.TEXT3.VALUE)
MTGL = THISFORM.TEXT2.VALUE
MLEVEL = '1'
MKONSOL = IIF(THISFORM.TEXT8.VALUE='0000' .OR. EMPTY(THISFORM.TEXT8.VALUE), 'Y', 'T')
MKANTOR = THISFORM.TEXT8.VALUE
MMODEL = 2
CSQL = "select noper,nama,kel,keldata,detail,level,font,saldo from perkiraan where 1 order by if(keldata='NA','01',if(keldata='NP','02',keldata)),noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
REPLACE SALDO WITH 0 ALL
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, MNOPER, THISFORM.TEXT2.VALUE, "AWAL")
SELECT AA
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MREC = RECNO()
SUM SALDO TO MSALDO FOR NOPER=MNOPER .AND. DETAIL='Y'
SELECT AA
GOTO MREC
REPLACE SALDO WITH MSALDO
SKIP
ENDDO
SET FILTER TO LEVEL<=MLEVEL .AND. KELDATA<>"AD"
GOTO BOTTOM
MNOPER = 'xx'
DO WHILE  .NOT. BOF()
IF ALLTRIM(NOPER)=LEFT(MNOPER, LEN(ALLTRIM(NOPER)))
REPLACE SALDO WITH 0
ENDIF
MNOPER = NOPER
SKIP -1
ENDDO
CREATE CURSOR NERACA (TGLCETAK DATE, RL C (1), ANOPER C (10), ANAMA C (30), AJUMLAH N (15), AFONT C (1), ALEVEL C (1), AKELDATA C (2), AKEL C (4), PNOPER C (10), PNAMA C (30), PJUMLAH N (15), PFONT C (1), PLEVEL C (1), PKELDATA C (2), PKEL C (4))
SELECT AA
GOTO TOP
DO WHILE  .NOT. EOF()
IF KELDATA<>'NA'
EXIT
ENDIF
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
REPLACE ANOPER WITH AA.NOPER, ANAMA WITH MNAMA, AJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
REPLACE AFONT WITH AA.FONT, ALEVEL WITH AA.LEVEL, AKELDATA WITH AA.KELDATA, AKEL WITH AA.KEL
IF AA.FONT='+'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
ENDIF
SELECT AA
SKIP
ENDDO
SELECT NERACA
GOTO TOP
SELECT AA
DO WHILE  .NOT. EOF()
IF KELDATA<>"NP"
EXIT
ENDIF
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
ENDIF
REPLACE PNOPER WITH AA.NOPER, PNAMA WITH MNAMA, PJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO), PFONT WITH AA.FONT
REPLACE PLEVEL WITH AA.LEVEL, PKELDATA WITH AA.KELDATA, PKEL WITH AA.KEL
IF AA.FONT='+'
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
ELSE
SKIP
ENDIF
SKIP
ENDIF
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'N'
ELSE
SKIP
ENDIF
SELECT AA
SKIP
ENDDO
SELECT NERACA
GOTO BOTTOM
MREKRL = RECNO()
MPERTAMA = .T.
MJUMLAH1 = 0
MJUMLAH2 = 0
MJUMLAH3 = 0
JLEVEL = 0
JDATA = 0
SELECT AA
DO WHILE  .NOT. EOF()
IF KELDATA<>'AD'
EXIT
ENDIF
SKIP
ENDDO
DO WHILE  .NOT. EOF()
IF LEFT(KELDATA, 1)>'1'
EXIT
ENDIF
IF LEVEL>'0' .AND. LEVEL<'9'
MJUMLAH1 = MJUMLAH1+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH2 = MJUMLAH2+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH3 = MJUMLAH3+IIF(ISNULL(SALDO), 0, SALDO)
ENDIF
JLEVEL = JLEVEL+IIF(KEL='RA' .OR. KEL='RP', 1, 0)
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
MFNT = IIF(LEVEL='0', 'B', FONT)
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANOPER WITH AA.NOPER, ANAMA WITH MNAMA, AJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO)
REPLACE AFONT WITH MFNT, ALEVEL WITH AA.LEVEL, AKEL WITH AA.KEL
IF AA.FONT='+'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ENDIF
SELECT AA
MKELDATA = KELDATA
MNAMA = NAMA
JDATA = JDATA+1
SKIP
IF .T.
IF MKELDATA='11' .AND. AA.KELDATA<>'11'
IF JDATA>3
MPERTAMA = .F.
JLEVEL = 0
SELECT NERACA
DO CASE
CASE MMODEL=1
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANAMA WITH 'PELAYANAN BRUTO ANGGOTA', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
CASE MMODEL=2
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANAMA WITH 'TOTAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
OTHERWISE
ENDCASE
MJUMLAH1 = 0
ENDIF
JDATA = 0
ENDIF
IF MKELDATA='12' .AND. AA.KELDATA<>'12'
IF JDATA>3
MPERTAMA = .F.
JLEVEL = 0
SELECT NERACA
DO CASE
CASE MMODEL=1
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANAMA WITH 'BEBAN POKOK PELAYANAN', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
CASE MMODEL=2
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
REPLACE ANAMA WITH 'BEBAN BUNGA ', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
OTHERWISE
ENDCASE
MJUMLAH1 = 0
ENDIF
JDATA = 0
ENDIF
IF LEFT(MKELDATA, 1)='1' .AND. LEFT(AA.KELDATA, 1)<>'1'
MPERTAMA = .F.
JLEVEL = 0
SELECT NERACA
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
DO CASE
CASE MMODEL=1
REPLACE ANAMA WITH 'PELAYANAN NETTO ANGGOTA', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
CASE MMODEL=2
REPLACE ANAMA WITH 'PENDAPATAN DAN BEBAN OPERASIONAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH2, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
OTHERWISE
REPLACE ANAMA WITH 'TOTAL PENDAPATAN OPERASIOANAL', AFONT WITH 'B', AJUMLAH WITH MJUMLAH1, ALEVEL WITH AA.LEVEL, AKEL WITH 'RA'
ENDCASE
MJUMLAH1 = 0
ENDIF
ENDIF
SELECT AA
ENDDO
SELECT NERACA
GOTO MREKRL
SKIP
SELECT AA
DO WHILE  .NOT. EOF()
IF LEVEL>'0' .AND. LEVEL<'9'
MJUMLAH1 = MJUMLAH1+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH2 = MJUMLAH2+IIF(ISNULL(SALDO), 0, SALDO)
MJUMLAH3 = MJUMLAH3+IIF(ISNULL(SALDO), 0, SALDO)
ENDIF
MNAMA = IIF(LEN(ALLTRIM(AA.NOPER))<4, "", SPACE((LEN(ALLTRIM(AA.NOPER))-4)*2))+AA.NAMA
MSPASI = MAX(VAL(LEVEL)-1, 0)*5
MNAMA = SPACE(MSPASI)+NAMA
MFNT = IIF(LEVEL='0', 'B', FONT)
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ENDIF
REPLACE PNOPER WITH AA.NOPER, PNAMA WITH MNAMA, PJUMLAH WITH IIF(ISNULL(AA.SALDO), 0, AA.SALDO), PFONT WITH MFNT, PLEVEL WITH AA.LEVEL, PKEL WITH AA.KEL
IF AA.FONT='+'
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
SKIP
ENDIF
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
SELECT AA
MKELDATA = KELDATA
SKIP
IF LEFT(MKELDATA, 1)='2' .AND. LEFT(AA.KELDATA, 1)<>'2'
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'TOTAL BEBAN OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'JUMLAH BEBAN OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'TOTAL PENDAPATAN OPERASIONAL ', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'SHU OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'LABA (RUGI) OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'LABA / RUGI OPERASIONAL', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
ENDIF
IF LEFT(MKELDATA, 1)='3' .AND. LEFT(AA.KELDATA, 1)<>'3'
SELECT NERACA
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'PENDAPATAN DAN BEBAN NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'JUMLAH PENDAPATAN DAN BEBAN NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'LABA/RUGI NON OPERASIONAL', PFONT WITH 'B', PJUMLAH WITH MJUMLAH1, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'SHU SEBELUM PAJAK', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'LABA (RUGI) SEBELUM PAJAK PENGHASILAN', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'LABA / RUGI SEBELUM PAJAK', PJUMLAH WITH IIF(ISNULL(MJUMLAH1), 0, MJUMLAH1), PFONT WITH 'B', PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
IF EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
SKIP
ENDIF
ENDIF
SELECT AA
ENDDO
SELECT NERACA
IF RECCOUNT()=RECNO() .OR. EOF()
APPEND BLANK
REPLACE TGLCETAK WITH MTGL, RL WITH 'R'
ELSE
ENDIF
DO CASE
CASE MMODEL=1
REPLACE PNAMA WITH 'SHU SETELAH PAJAK', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
CASE MMODEL=2
REPLACE PNAMA WITH 'LABA (RUGI) NETTO', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
OTHERWISE
REPLACE PNAMA WITH 'LABA / RUGI SETELAH PAJAK', PFONT WITH 'B', PJUMLAH WITH MJUMLAH3, PLEVEL WITH AA.LEVEL, PKEL WITH 'RA'
ENDCASE
SELECT NERACA
CASE THISFORM.NOMORLAP=9
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)+" s/d. "+DTOC(THISFORM.TEXT3.VALUE)
CSQL = "select a.noper,b.nama,SUM(IF(jumlah>0,jumlah,0)) as debet, SUM(if(jumlah>0,0,jumlah)) as kredit from jurnal as a left join perkiraan as b on a.noper=b.noper "+"where tanggal>='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and tanggal<='"+SQLDATE(THISFORM.TEXT3.VALUE)+"' group by noper"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
CASE THISFORM.NOMORLAP=10
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)
MSALDO = BACANERACA(THISFORM.TEXT8.VALUE, ALLTRIM(DEFANOPERKAS), THISFORM.TEXT2.VALUE, "AWAL")
CSQL = "select a.noper,jumlah,b.nama from jurnal as a left join perkiraan as b on a.noper=b.noper where tanggal='"+SQLDATE(THISFORM.TEXT2.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
CREATE CURSOR REKAP (KD C (1), NOPER C (10), NAMA C (40), KIRI N (15), KANAN N (15))
INDEX ON KD+NOPER TO rekap1
APPEND BLANK
REPLACE KD WITH '1', NOPER WITH ALLTRIM(DEFANOPERKAS), NAMA WITH "SALDO AWAL", KANAN WITH MSALDO
SELECT SMT
JMASUK = 0
JKELUAR = 0
GOTO TOP
DO WHILE  .NOT. EOF()
IF NOPER<>ALLTRIM(DEFANOPERKAS)
IF JUMLAH<0
MKD = '1'
ELSE
MKD = '2'
ENDIF
MNOPER = NOPER
MNAMA = IIF(ISNULL(NAMA), "", NAMA)
MTERIMA = IIF(JUMLAH<0, 0-JUMLAH, 0)
MKELUAR = IIF(JUMLAH>0, JUMLAH, 0)
IF JUMLAH<0
JMASUK = JMASUK+(0-JUMLAH)
ELSE
JKELUAR = JKELUAR+JUMLAH
ENDIF
SELECT REKAP
SEEK MKD+MNOPER 
IF  .NOT. FOUND()
APPEND BLANK
REPLACE KD WITH MKD, NOPER WITH MNOPER, NAMA WITH MNAMA
ENDIF
REPLACE KIRI WITH KIRI+MTERIMA+MKELUAR
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT REKAP
APPEND BLANK
REPLACE KD WITH '1', NOPER WITH '99', NAMA WITH "TOTAL PENERIMAAN ................................................................", KANAN WITH JMASUK
APPEND BLANK
REPLACE KD WITH '1', NOPER WITH '99', NAMA WITH "TOTAL KAS MASUK .................................................................", KANAN WITH JMASUK+MSALDO
APPEND BLANK
REPLACE KD WITH '1', NOPER WITH '99'
APPEND BLANK
REPLACE KD WITH '2', NOPER WITH '99', NAMA WITH "TOTAL PENGELUARAN................................................................", KANAN WITH JKELUAR
APPEND BLANK
REPLACE KD WITH '2', NOPER WITH '99', NAMA WITH "SALDO AKHIR .....................................................................", KANAN WITH JMASUK+MSALDO-JKELUAR
APPEND BLANK
REPLACE KD WITH '2', NOPER WITH '99'
CASE THISFORM.NOMORLAP=11
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)
MTGL = THISFORM.TEXT2.VALUE
CREATE CURSOR REKAP (KEL C (4), NOPER C (10), NAMA C (40), AWAL N (15), DEBET N (15), KREDIT N (15), AWALBLN N (15), SALDO N (15), MUTASI N (15))
INDEX ON NOPER TO x
CSQL = "select a.kel,a.noper,a.nama,a.level,b.saldo from perkiraan as a left join neraca as b on a.noper=b.noper where (kel='NA' or kel='NP') and "+" a.kantor='"+THISFORM.TEXT8.VALUE+"' and "+"b.tanggal=(select MAX(tanggal) from neraca where kantor='"+THISFORM.TEXT8.VALUE+"' and noper=a.noper and tanggal<'"+SQLDATE(AWALBLN(MTGL))+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
SELECT REKAP
APPEND BLANK
REPLACE KEL WITH SMT.KEL, NOPER WITH SMT.NOPER, NAMA WITH UPPER(SMT.NAMA), AWALBLN WITH IIF(ISNULL(SMT.SALDO), 0, SMT.SALDO)
SELECT SMT
SKIP
ENDDO
SELECT REKAP
CSQL = "select a.noper,b.saldoawal,b.debet,b.kredit,b.saldo from perkiraan as a left join neraca as b on a.noper=b.noper "+"where (kel='NA' or kel='NP') and "+"b.tanggal=(select MAX(tanggal) from neraca where kantor='"+THISFORM.TEXT8.VALUE+"' and noper=a.noper and tanggal<'"+SQLDATE(AWALBLN(MTGL))+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
SELECT REKAP
SEEK SMT.NOPER 
IF FOUND()
REPLACE AWAL WITH IIF(ISNULL(SMT.SALDOAWAL), 0, SMT.SALDOAWAL), DEBET WITH IIF(ISNULL(SMT.DEBET), 0, SMT.DEBET)
REPLACE KREDIT WITH IIF(ISNULL(SMT.KREDIT), 0, SMT.KREDIT), SALDO WITH IIF(ISNULL(SMT.SALDO), 0, SMT.SALDO)
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT REKAP
CASE THISFORM.NOMORLAP=12
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)
MTGL = THISFORM.TEXT2.VALUE
CREATE CURSOR REKAP (KEL C (4), NOPER C (10), NAMA C (40), AWAL N (15), DEBET N (15), KREDIT N (15), AWALBLN N (15), SALDO N (15), MUTASI N (15))
INDEX ON NOPER TO x
CSQL = "select a.kel,a.noper,a.nama,a.level,b.saldo from perkiraan as a left join neraca as b on a.noper=b.noper where (kel='RA' or kel='RP') and "+" a.kantor='"+THISFORM.TEXT8.VALUE+"' and "+"b.tanggal=(select MAX(tanggal) from neraca where kantor='"+THISFORM.TEXT8.VALUE+"' and noper=a.noper and tanggal<'"+SQLDATE(AWALBLN(MTGL))+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
SELECT REKAP
APPEND BLANK
REPLACE KEL WITH SMT.KEL, NOPER WITH SMT.NOPER, NAMA WITH UPPER(SMT.NAMA), AWALBLN WITH IIF(ISNULL(SMT.SALDO), 0, SMT.SALDO)
SELECT SMT
SKIP
ENDDO
SELECT REKAP
CSQL = "select a.noper,b.saldoawal,b.debet,b.kredit,b.saldo from perkiraan as a left join neraca as b on a.noper=b.noper "+"where (kel='RA' or kel='RP') and "+"b.tanggal=(select MAX(tanggal) from neraca where kantor='"+THISFORM.TEXT8.VALUE+"' and noper=a.noper and tanggal<'"+SQLDATE(AWALBLN(MTGL))+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
SELECT REKAP
SEEK SMT.NOPER 
IF FOUND()
REPLACE AWAL WITH IIF(ISNULL(SMT.SALDOAWAL), 0, SMT.SALDOAWAL), DEBET WITH IIF(ISNULL(SMT.DEBET), 0, SMT.DEBET)
REPLACE KREDIT WITH IIF(ISNULL(SMT.KREDIT), 0, SMT.KREDIT), SALDO WITH IIF(ISNULL(SMT.SALDO), 0, SMT.SALDO)
ENDIF
SELECT SMT
SKIP
ENDDO
SELECT REKAP
CASE THISFORM.NOMORLAP=13
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT2.VALUE)
CREATE CURSOR camel (ASPEK C (30), RASIO C (50), KET1 C (30), KET2 C (30), JML1 N (15), JML2 N (15))
APPEND BLANK
REPLACE ASPEK WITH "PERMODALAN", RASIO WITH "a. Rasio Modal Sendiri thd Asset"
REPLACE KET1 WITH "Modal Sendiri", KET2 WITH "Total Asset"
APPEND BLANK
REPLACE ASPEK WITH "PERMODALAN", RASIO WITH "b. Rasio Modal Sendiri terhadap Pinjaman diberikan yang berisiko"
REPLACE KET1 WITH "Modal Sendiri", KET2 WITH "Pinjaman diberikan yang berisiko"
APPEND BLANK
REPLACE ASPEK WITH "PERMODALAN", RASIO WITH "c. Rasio Kecukupan Modal Sendiri"
REPLACE KET1 WITH "Modal Sendiri Tertimbang", KET2 WITH "ATMR"
APPEND BLANK
REPLACE ASPEK WITH "KUALITAS AKTIVA PRODUKTIF", RASIO WITH "a. Rasio Volume Pinjaman pada anggota terhadap volume pinjaman diberikan"
REPLACE KET1 WITH "Volume Pinjaman pada Anggota", KET2 WITH "Volume Pinjaman"
APPEND BLANK
REPLACE ASPEK WITH "KUALITAS AKTIVA PRODUKTIF", RASIO WITH "b. Rasio Risiko Pinjaman Bermasalah Terhadap Pinjaman yang diberikan"
REPLACE KET1 WITH "Pinjaman Bermasalah", KET2 WITH "Pinjaman yang diberikan"
APPEND BLANK
REPLACE ASPEK WITH "KUALITAS AKTIVA PRODUKTIF", RASIO WITH "c. Rasio Cadangan Risiko Terhadap Pinjaman Bermasalah"
REPLACE KET1 WITH "Cadangan risiko", KET2 WITH "Pinjaman Bermasalah"
APPEND BLANK
REPLACE ASPEK WITH "KUALITAS AKTIVA PRODUKTIF", RASIO WITH "d. Rasio Pinjaman yang berisiko terhadap pinjaman yang diberikan"
REPLACE KET1 WITH "Pinjaman yang berisiko", KET2 WITH "Pinjaman yang diberikan"
APPEND BLANK
REPLACE ASPEK WITH "MANAJEMEN", RASIO WITH "a. Manajemen Umum"
APPEND BLANK
REPLACE ASPEK WITH "MANAJEMEN", RASIO WITH "b. Kelembagaan"
APPEND BLANK
REPLACE ASPEK WITH "MANAJEMEN", RASIO WITH "c. Manajemen Permodalan"
APPEND BLANK
REPLACE ASPEK WITH "MANAJEMEN", RASIO WITH "d. Manajemen Aktiva"
APPEND BLANK
REPLACE ASPEK WITH "MANAJEMEN", RASIO WITH "e. Manajemen Likuiditas"
APPEND BLANK
REPLACE ASPEK WITH "EFISIENSI", RASIO WITH "a. Rasio beban operasi anggota terhadap partisipasi bruto"
REPLACE KET1 WITH "Beban Operasional Anggota", KET2 WITH "Partisipasi Bruto"
APPEND BLANK
REPLACE ASPEK WITH "EFISIENSI", RASIO WITH "b. Rasio beban usaha terhadap SHU Kotor"
REPLACE KET1 WITH "Beban Usaha", KET2 WITH "SHU Kotor"
APPEND BLANK
REPLACE ASPEK WITH "EFISIENSI", RASIO WITH "c. Rasio efisiensi pelayanan"
REPLACE KET1 WITH "Biaya Karyawan", KET2 WITH "volume Pinjaman"
APPEND BLANK
REPLACE ASPEK WITH "LIKUIDITAS", RASIO WITH "a. Rasio Kas"
REPLACE KET1 WITH "Kas + Bank", KET2 WITH "Kewajiban Lancar"
APPEND BLANK
REPLACE ASPEK WITH "LIKUIDITAS", RASIO WITH "b. Rasio pinjaman yang diberikan terhadap dana yang diterima"
REPLACE KET1 WITH "Pinjaman yang Diberikan", KET2 WITH "Dana yang diterima"
APPEND BLANK
REPLACE ASPEK WITH "KEMANDIRIAN DAN PERTUMBUHAN", RASIO WITH "a. Rentabilitas Asset"
REPLACE KET1 WITH "SHU Sebelum Pajak", KET2 WITH "Total Asset"
APPEND BLANK
REPLACE ASPEK WITH "KEMANDIRIAN DAN PERTUMBUHAN", RASIO WITH "b. Rentabilitas Modal Sendiri"
REPLACE KET1 WITH "SHU Bagian Anggota", KET2 WITH "Total Modal Sendiri"
APPEND BLANK
REPLACE ASPEK WITH "KEMANDIRIAN DAN PERTUMBUHAN", RASIO WITH "c. Kemandirian Operasional Pelayanan"
REPLACE KET1 WITH "Partisipasi Netto", KET2 WITH "Beban Usaha + Beban Perkoperasian"
APPEND BLANK
REPLACE ASPEK WITH "JATIDIRI KOPERASI", RASIO WITH "a. Rasio partisipasi bruto"
REPLACE KET1 WITH "Partisipasi Bruto", KET2 WITH "Partisipasi bruto + Pendapatan"
APPEND BLANK
REPLACE ASPEK WITH "JATIDIRI KOPERASI", RASIO WITH "Rasio promosi ekonomi anggota (PEA)"
REPLACE KET1 WITH "PEA", KET2 WITH "Simpanan Pokok + Simpanan Wajib"
ENDCASE
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
DEFAKETERANGAN = ''
THISFORM.BAR.WIDTH = 0
THISFORM.NOMORLAP = MKE
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "KANTOR")
IF RECCOUNT()>1
APPEND BLANK
REPLACE SANDI WITH '0000', KETERANGAN WITH "KONSOLIDASI"
IF DEFAKANTOR='0001'
THISFORM.TEXT8.ENABLED = .T.
ENDIF
ENDIF
THISFORM.TEXT8.VALUE = DEFAKANTOR
THISFORM.TEXT6.VALUE = NAMAKANTOR(DEFAKANTOR)
THISFORM.TEXT2.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT3.VALUE = TGLNOW
THISFORM.BORDERSTYLE = 2
DO CASE
CASE MKE=1
THISFORM.JUDUL.CAPTION = "RINCIAN TRANSAKSI"
THISFORM.FRXNAME = "akt_transaksi_perperkiraan.frx"
CASE MKE=2
THISFORM.JUDUL.CAPTION = "REKAP BUKU BESAR"
THISFORM.FRXNAME = "akt_bukubesar.frx"
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.HEIGHT = 190
CASE MKE=3
THISFORM.JUDUL.CAPTION = "CETAK JURNAL"
THISFORM.FRXNAME = "akt_jurnal.frx"
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.HEIGHT = 175
CASE MKE=4
THISFORM.JUDUL.CAPTION = "DAFTAR INVENTARIS"
THISFORM.FRXNAME = "akt_inventaris2.frx"
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.TEXT2.VALUE = TGLNOW
THISFORM.HEIGHT = 140
CASE MKE=5
THISFORM.JUDUL.CAPTION = "RINCIAN AKTIVA"
THISFORM.FRXNAME = "akt_detail_aktiva.frx"
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.TEXT2.VALUE = TGLNOW
THISFORM.HEIGHT = 140
CASE MKE=6
THISFORM.JUDUL.CAPTION = "NERACA HARIAN"
THISFORM.FRXNAME = "akt_neraca_level.frx"
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.HEIGHT = 140
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=7
THISFORM.JUDUL.CAPTION = "LABA RUGI HARIAN"
THISFORM.FRXNAME = "akt_labarugi_level.frx"
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.HEIGHT = 140
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=8
THISFORM.JUDUL.CAPTION = "NERACA & HASIL USAHA"
THISFORM.FRXNAME = "akt_neraca_labarugi1.frx"
THISFORM.LABEL2.CAPTION = "TANGGAL LAPORAN"
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.HEIGHT = 140
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=9
THISFORM.JUDUL.CAPTION = "REKAP MUTASI JURNAL"
THISFORM.FRXNAME = "akt_rekap_jurnal.frx"
THISFORM.LABEL2.CAPTION = "TANGGAL LAPORAN"
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.HEIGHT = 175
CASE MKE=10
THISFORM.JUDUL.CAPTION = "REKAP TRANSAKSI HARIAN"
THISFORM.FRXNAME = "akt_rekapharian.frx"
THISFORM.LABEL2.CAPTION = "TANGGAL LAPORAN"
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.HEIGHT = 160
CASE MKE=11
THISFORM.JUDUL.CAPTION = "LAPORAN NERACA"
THISFORM.FRXNAME = "akt_neraca1.frx"
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.HEIGHT = 140
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=12
THISFORM.JUDUL.CAPTION = "PERHITUNGAN HASIL USAHA"
THISFORM.FRXNAME = "akt_phu1.frx"
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.HEIGHT = 140
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=13
THISFORM.JUDUL.CAPTION = "TINGKAT KESEHATAN KOPERASI"
THISFORM.FRXNAME = "akt_camel_kop.frx"
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.HEIGHT = 140
THISFORM.TEXT2.VALUE = TGLNOW
ENDCASE
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT KANTOR
USE
ENDPROC
**
*
*  gl_lap2.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT2.VALUE
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  gl_lap2.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  gl_lap2.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT2.VALUE
REPORT FORM (THISFORM.FRXNAME) PREVIEW
ENDPROC
**
*
*  gl_lap2.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
MKET = THISFORM.JUDUL.CAPTION
TGLCETAK = TGLNOW
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer")
ENDIF
ENDPROC
**
*
*  gl_lap2.scx::Text2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  gl_lap2.scx::Text3
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  gl_lap2.scx::Text4
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
IF LASTKEY()=13
DO FORM ./form/setsandi TO MSANDI WITH "GL01"
IF EMPTY(MSANDI)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDIF
ELSE
MSANDI = THIS.VALUE
ENDIF
CSQL = "select noper,nama,kel from perkiraan where noper='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Perkiraan tidak terbaca")
ENDIF
IF RECCOUNT()>0
THIS.VALUE = MSANDI
THISFORM.TEXT7.VALUE = NAMA
SELECT SMT
USE
SELECT (OLDSELECT)
ELSE
MESSAGEBOX("Kode Perkiraan tidak ada")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
SELECT (OLDSELECT)
RETURN
ENDIF
DEFAKETERANGAN = DEFAKETERANGAN+CHR(13)+ALLTRIM(TRANSFORM(THISFORM.TEXT4.VALUE, "@R !!!!.!!!!"))+" : "+ALLTRIM(THISFORM.TEXT7.VALUE)
ENDPROC
**
*
*  gl_lap2.scx::Text5
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  gl_lap2.scx::Text6
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  gl_lap2.scx::Text7
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
*
*  gl_lap2.scx::text8
**
PROCEDURE InteractiveChange
THISFORM.TEXT9.VALUE = KETERANGAN
ENDPROC
**
***
*** gl_lap2.sct
***
*
***
*** gl_bukubesar_koreksi.scx
***
*
*
*  gl_bukubesar_koreksi.scx::FORM1
**
PROCEDURE Init
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = SALDOAWAL
THISFORM.TEXT3.VALUE = DEBET
THISFORM.TEXT4.VALUE = KREDIT
THISFORM.TEXT5.VALUE = SALDO
ENDPROC
**
*
*  gl_bukubesar_koreksi.scx::Text4
**
PROCEDURE LostFocus
THISFORM.TEXT5.VALUE = THISFORM.TEXT2.VALUE+THISFORM.TEXT3.VALUE-THISFORM.TEXT4.VALUE
ENDPROC
**
*
*  gl_bukubesar_koreksi.scx::Command1
**
PROCEDURE Click
CSQL = "update neraca set saldoawal='"+TRANSFORM(THISFORM.TEXT2.VALUE, '999999999999999')+"', "+"debet='"+TRANSFORM(THISFORM.TEXT3.VALUE, '999999999999999')+"', "+"kredit='"+TRANSFORM(THISFORM.TEXT4.VALUE, '999999999999999')+"', "+"saldo='"+TRANSFORM(THISFORM.TEXT5.VALUE, '999999999999999')+"' where kantor='"+DEFAKANTOR+"' and noper='"+NOPER+"' and tanggal='"+SQLDATE(THISFORM.TEXT1.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MSALDO = THISFORM.TEXT5.VALUE
MAWAL = THISFORM.TEXT2.VALUE
DO WHILE  .NOT. BOF()
CSQL = "update neraca set saldoawal='"+TRANSFORM(MAWAL, '999999999999999')+"', "+"saldo='"+TRANSFORM(MSALDO, '999999999999999')+"' where kantor='"+DEFAKANTOR+"' and noper='"+NOPER+"' and tanggal='"+SQLDATE(TANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MAWAL = MSALDO
SKIP -1
MSALDO = MSALDO+DEBET-KREDIT
ENDDO
MESSAGEBOX("xx")
THISFORM.RELEASE
ENDPROC
**
*
*  gl_bukubesar_koreksi.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** gl_bukubesar_koreksi.sct
***
*
***
*** frm_bukti.scx
***
*
*
*  frm_bukti.scx::FORM1
**
FUNCTION Unload
RETURN THISFORM.NILAI
ENDFUNC
**
PROCEDURE Init
PARAMETER MTGL
THISFORM.TEXT1.VALUE = MTGL
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.NILAI = ''
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  frm_bukti.scx::Text2
**
PROCEDURE LostFocus
OLDDBF = SELECT()
CSQL = "select bukti from jurnal where tanggal='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and bukti='"+THISFORM.TEXT2.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt00")
IF BUKTI=THISFORM.TEXT2.VALUE
MESSAGEBOX("Nomor Bukti sudah pernah masuk", 16, "")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  frm_bukti.scx::Command1
**
PROCEDURE Click
THISFORM.NILAI = THISFORM.TEXT2.VALUE
THISFORM.RELEASE
ENDPROC
**
*
*  frm_bukti.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** frm_bukti.sct
***
*
***
*** pinjaman_lainnya.scx
***
*
*
*  pinjaman_lainnya.scx::FORM1
**
PROCEDURE Unload
SELECT LAINNYA
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK
THISFORM.IDDATA = MNOREK
THISFORM.OLDSELECT = SELECT()
CSQL = "select tglpermohonan,srtpermohonan,tglpersetujuan,srtpersetujuan,sms_jtang,sms_jtpinj "+"from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "LAINNYA")
THISFORM.TEXT1.VALUE = IIF(ISNULL(TGLPERMOHONAN), CTOD('  -  -    '), TGLPERMOHONAN)
THISFORM.TEXT2.VALUE = IIF(ISNULL(SRTPERMOHONAN), "", SRTPERMOHONAN)
THISFORM.TEXT3.VALUE = IIF(ISNULL(TGLPERSETUJUAN), CTOD('  -  -    '), TGLPERSETUJUAN)
THISFORM.TEXT4.VALUE = IIF(ISNULL(SRTPERSETUJUAN), "", SRTPERSETUJUAN)
THISFORM.CHECK1.VALUE = VAL(SMS_JTANG)
THISFORM.CHECK2.VALUE = VAL(SMS_JTPINJ)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  pinjaman_lainnya.scx::Command1
**
PROCEDURE Click
CSQL = "update pinjaman set "+"sms_jtang='"+ALLTRIM(STR(THISFORM.CHECK1.VALUE))+"', sms_jtpinj='"+ALLTRIM(STR(THISFORM.CHECK2.VALUE))+"', tglpermohonan='"+SQLDATE(THISFORM.TEXT1.VALUE)+"', srtpermohonan='"+THISFORM.TEXT2.VALUE+"', tglpersetujuan='"+SQLDATE(THISFORM.TEXT3.VALUE)+"', srtpersetujuan='"+THISFORM.TEXT4.VALUE+"' where norek='"+THISFORM.IDDATA+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MESSAGEBOX(CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_lainnya.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** pinjaman_lainnya.sct
***
*
***
*** anggota_lainnya.scx
***
*
*
*  anggota_lainnya.scx::FORM1
**
PROCEDURE Init
PARAMETER MNOREK
THISFORM.IDDATA = MNOREK
ENDPROC
**
*
*  anggota_lainnya.scx::Command1
**
PROCEDURE Click
CSQL = "update pinjaman set sms_jtang='"+ALLTRIM(STR(THISFORM.CHECK1.VALUE))+"', sms_jtpinj='"+ALLTRIM(STR(THISFORM.CHECK2.VALUE))+"' where norek='"+THISFORM.IDDATA+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_lainnya.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** anggota_lainnya.sct
***
*
***
*** simpanan_lainnya.scx
***
*
*
*  simpanan_lainnya.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
DO CASE
CASE NKEYCODE=49
THISFORM.LABEL1.CLICK
CASE NKEYCODE=50
THISFORM.LABEL2.CLICK
ENDCASE
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK
THISFORM.OLDSELECT = SELECT()
THISFORM.IDDATA = MNOREK
THISFORM.LEFT = THISFORM.LEFT+300
THISFORM.TOP = THISFORM.TOP-50
IF EMPTY(TGLTUTUP)
THISFORM.LABEL2.CAPTION = "2. Tutup Rekening Tabungan"
ELSE
THISFORM.LABEL2.CAPTION = "2. Batal Tutup Rekening Tabungan"
ENDIF
ENDPROC
**
*
*  simpanan_lainnya.scx::Label1
**
PROCEDURE Click
DO FORM simpanan_lainnya_smsgateway WITH THISFORM.IDDATA
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
ENDPROC
**
*
*  simpanan_lainnya.scx::Label2
**
PROCEDURE Click
SELECT (THISFORM.OLDSELECT)
IF EMPTY(TGLTUTUP)
DO FORM simpanan_tutuprekening
ELSE
DO FORM simpanan_batal_tutup
ENDIF
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
ENDPROC
**
***
*** simpanan_lainnya.sct
***
*
***
*** sms_ucapan.scx
***
*
*
*  sms_ucapan.scx::FORM1
**
PROCEDURE Init
PARAMETER MKODE
DO CASE
CASE MKODE='A01'
MJUDUL = "UCAPAN ULANG TAHUN"
CASE MKODE='A02'
MJUDUL = "UCAPAN LEBARAN"
CASE MKODE='A03'
MJUDUL = "UCAPAN NATAL"
CASE MKODE='S01'
MJUDUL = "PENGAMBILAN SIMPANAN"
CASE MKODE='S02'
MJUDUL = "SETORAN SIMPANAN"
CASE MKODE='P01'
MJUDUL = "JATUH TEMPO ANGSURAN"
CASE MKODE='P02'
MJUDUL = "JATUH TEMPO PINJAMAN"
ENDCASE
THISFORM.LABEL1.CAPTION = MJUDUL
CSQL = "select ucapan from sms_ucapan where kode='"+MKODE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.EDIT1.VALUE = ALLTRIM(UCAPAN)
THISFORM.KODE = MKODE
ENDPROC
**
*
*  sms_ucapan.scx::Command1
**
PROCEDURE Click
MKODE = THISFORM.KODE
CSQL = "select kode from sms_ucapan where kode='"+MKODE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE=MKODE
CSQL = "update sms_ucapan set ucapan='"+THISFORM.EDIT1.VALUE+"' where kode='"+MKODE+"'"
ELSE
CSQL = "insert into sms_ucapan (kode,ucapan) value ('"+MKODE+"','"+THISFORM.EDIT1.VALUE+"')"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  sms_ucapan.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** sms_ucapan.sct
***
*
***
*** sms_reg.scx
***
*
*
*  sms_reg.scx::Command1
**
PROCEDURE Click
CSQL = "insert into sms_reg (tanggal,nama,phone,fasilitas,norek) values "+"('"+SQLDATE(THISFORM.TEXT1.VALUE)+"','"+THISFORM.TEXT2.VALUE+"','"+THISFORM.TEXT3.VALUE+"','"+ALLTRIM(STR(THISFORM.OPTIONGROUP1.VALUE))+"','"+THISFORM.TEXT4.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  sms_reg.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** sms_reg.sct
***
*
***
*** a4.scx
***
*
*
*  a4.scx::Command1
**
PROCEDURE Click
THISFORM.OLECONTROL1.NAVIGATE(GETFILE("Microsoft Office Files:xls,xlsx,doc,docx,ppt,pptx"))
ENDPROC
**
***
*** a4.sct
***
*
***
*** acc_harian_autodebet.scx
***
*
*
*  acc_harian_autodebet.scx::FORM1
**
PROCEDURE rekap
OLDSELE = SELECT()
CSQL = "SELECT count(norek) as user,sum(jumlah) as jumlah FROM acc_harian_autodebet where kel_id='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "rekap")
THISFORM.TEXT3.VALUE = USER
THISFORM.TEXT4.VALUE = JUMLAH
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = KETERANGAN
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
CSQL = "select * from acc_harian_autodebet where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 5
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 90
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NOREK"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "trans(SALDO,'999,999,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "SALDO"
.COLUMN3.ALIGNMENT = 1
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "trans(jumlah,'999,999,999,999,999')"
.COLUMN4.HEADER1.CAPTION = "AUTODEBET"
.COLUMN4.ALIGNMENT = 1
.COLUMN5.WIDTH = 400
.COLUMN5.CONTROLSOURCE = "KET"
.COLUMN5.HEADER1.CAPTION = "KETERANGAN"
.COLUMN5.ALIGNMENT = 0
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_harian_autodebet.scx::Grid1
**
PROCEDURE DblClick
DO FORM simpanan_autodebet
ENDPROC
**
*
*  acc_harian_autodebet.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_autodebet.scx::Command4
**
PROCEDURE Click
DO FORM frm_bukti TO MBUKTI WITH TGLNOW
IF EMPTY(MBUKTI)
RETURN
ENDIF
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MIDDATA = IDDATA
MIDAUTODEBET = IDAUTODEBET
MNOREK = NOREK
MKET = KET
MJUMLAH = JUMLAH
MNOREK_TUJUAN = NOREK_TUJUAN
MPIL = OPT_REK
MSALDO = SALDO
STORE '' TO MJURTAB, MKE_JURTAB, MKE_POKOK, MKE_BUNGA, MKE_DENDA, MKE_NOPER
STORE 0 TO MTAB, MANGPK, MANGBG, MANGDND, MAKT, MTABAUTO
CSQL = "select jurnaltab from simpanan as a left join setsandi_tab as b on a.produk=b.sandi "+"where b.jenis='1' and a.norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJURTAB = JURNALTAB
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(TGLNOW)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MTABAUTO = MIN(SALDO, MJUMLAH)
MSALDOTAB = SALDO
CSQL = "insert into simpanan_mutasi (kantor,norek,BUKTI,TANGGAL, kode, KETERANGAN,DEBET,KREDIT,SALDO,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+MBUKTI+"','"+SQLDATE(TGLNOW)+"','"+DEFATABPBK+"','"+"AUTODEBET KE "+MNOREK_TUJUAN+"','"+STR(MTABAUTO)+"','0','"+STR(MSALDOTAB-MTABAUTO)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
DO CASE
CASE MPIL=1
CSQL = "select jurnaltab from simpanan as a left join setsandi_tab as b on a.produk=b.sandi "+"where b.jenis='1' and a.norek='"+MNOREK_TUJUAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, 'smt')
MKE_JURTAB = JURNALTAB
MTAB = MTABAUTO
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK_TUJUAN+"' and tanggal<='"+SQLDATE(TGLNOW)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
CSQL = "insert into simpanan_mutasi (kantor,norek,BUKTI,TANGGAL, kode, KETERANGAN,DEBET,KREDIT,SALDO,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK_TUJUAN+"','"+MBUKTI+"','"+SQLDATE(TGLNOW)+"','"+DEFATABPBK+"','"+"AUTODEBET DR "+MNOREK+"','"+STR(0)+"','"+STR(MTAB)+"','"+STR(SALDO+MTAB)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
CASE MPIL=2
CSQL = "select jurnal_pokok,jurnal_jasa,jurnal_denda from pinjaman as a left join setsandi_pinj as b on a.jenis=b.sandi "+"where a.norek='"+MNOREK_TUJUAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, 'smt')
MKE_POKOK = JURNAL_POKOK
MKE_BUNGA = JURNAL_JASA
MKE_DENDA = JURNAL_DENDA
CSQL = "select pokok,jasa,kdhit from pinjaman where norek='"+MNOREK_TUJUAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MPOKOKAWAL = IIF(ISNULL(POKOK), 0, POKOK)
MJASAAWAL = IIF(ISNULL(JASA), 0, JASA)
MKDHIT = KDHIT
CSQL = "select SUM(pokok) as pokok, SUM(jasa) as jasa, sum(debet) as debet, SUM(kredit) as kredit from pinjaman_mutasi where norek='"+MNOREK_TUJUAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MANGSPOKOK = IIF(ISNULL(POKOK), 0, POKOK)
MANGSBUNGA = IIF(ISNULL(JASA), 0, JASA)
IF MKDHIT='H'
MSISAPOKOK = KREDIT-DEBET
MSISAJASA = 0
ELSE
MSISAPOKOK = MPOKOKAWAL-MANGSPOKOK
MSISAJASA = MJASAAWAL-MANGSBUNGA
ENDIF
MDEBET = IIF(ISNULL(DEBET), 0, DEBET)
MKREDIT = IIF(ISNULL(KREDIT), 0, KREDIT)
CSQL = "select pokok,jasa from pinjaman_jadwal where norek='"+MNOREK_TUJUAN+"' and tanggal="+"(select MAX(tanggal) from pinjaman_jadwal where norek='"+MNOREK_TUJUAN+"' and tanggal<'"+SQLDATE(AKHIRBLN(TGLNOW))+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJDW = POKOK+JASA
MANGS = MTABAUTO
IF MJDW=0
MPOKOK = MANGS
ELSE
MKALI = ROUND(MANGS/MJDW, 0)
MPOKOK = POKOK*MKALI
ENDIF
MPOKOK = MIN(MPOKOK, MANGS)
MANGPK = MIN(MPOKOK, MSISAPOKOK)
MANGBG = MANGS-MPOKOK
IF MKDHIT='H'
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,"+"debet,opt,sisapokok) value "+"('"+DEFAKANTOR+"','"+MNOREK_TUJUAN+"','"+SQLDATE(TGLNOW)+"','"+SQLDATE(TGLNOW)+"','"+MBUKTI+"','"+DEFAPINPBK+"','"+STR(MTABAUTO)+"','"+DEFAUSERID+"','"+STR(MSISAPOKOK-MTABAUTO)+"')"
ELSE
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,"+"pokok,jasa,opt,sisapokok,sisabunga) value "+"('"+DEFAKANTOR+"','"+MNOREK_TUJUAN+"','"+SQLDATE(TGLNOW)+"','"+SQLDATE(TGLNOW)+"','"+MBUKTI+"','"+DEFAPINPBK+"','"+STR(MANGPK)+"','"+STR(MANGBG)+"','"+DEFAUSERID+"','"+STR(MSISAPOKOK-MANGPK)+"','"+STR(MSISAJASA-MANGBG)+"')"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
CASE MPIL=3
MKE_NOPER = MNOREK_TUJUAN
MAKT = MTABAUTO
ENDCASE
SELECT RINCI_TRANS
CSQL = "update acc_harian_autodebet set jurtab='"+MJURTAB+"', tab='"+STR(MTAB)+"', "+"pokok='"+STR(MANGPK)+"', bunga='"+STR(MANGBG)+"', "+"denda='0', akt='"+STR(MAKT)+"', ke_jurtab='"+MKE_JURTAB+"', "+"ke_pokok='"+MKE_POKOK+"', ke_bunga='"+MKE_BUNGA+"', ke_denda='"+MKE_DENDA+"', "+"ke_noper='"+MKE_NOPER+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
ENDIF
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(TGLNOW)+"', optacc='"+MOPTACC+"' where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
MTOT = 0
CSQL = "select SUM(tab) as tab, SUM(pokok) as pokok, SUM(bunga) as bunga, SUM(denda) as denda, SUM(akt) as akt, jurtab from acc_harian_autodebet where kel_id='"+STR(THISFORM.IDDATA)+"' group by jurtab"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
CSQL = "insert into jurnal (KANTOR, TANGGAL, BUKTI, NOPER, KETERANGAN, JUMLAH,inpopr) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MBUKTI+"','"+JURTAB+"','"+"AUTODEBET TABUNGAN"+"','"+STR(TAB+POKOK+BUNGA+DENDA+AKT)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
MTOT = MTOT+(TAB+POKOK+BUNGA+DENDA+AKT)
HITNERACA(DEFAKANTOR, JURTAB, TGLNOW)
SKIP
ENDDO
CSQL = "select SUM(tab) as tab, ke_jurtab from acc_harian_autodebet where tab>'0' and kel_id='"+STR(THISFORM.IDDATA)+"' group by ke_jurtab"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
CSQL = "insert into jurnal (KANTOR, TANGGAL, BUKTI, NOPER, KETERANGAN, JUMLAH,inpopr) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MBUKTI+"','"+KE_JURTAB+"','"+"AUTODEBET TABUNGAN"+"','"+STR(0-TAB)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, KE_JURTAB, TGLNOW)
MTOT = MTOT-TAB
SKIP
ENDDO
CSQL = "select SUM(pokok) as pokok, SUM(bunga) as bunga, SUM(denda) as denda, ke_pokok,ke_bunga,ke_denda from acc_harian_autodebet where (pokok+bunga+denda)>'0' and kel_id='"+STR(THISFORM.IDDATA)+"' group by ke_pokok"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
CSQL = "insert into jurnal (KANTOR, TANGGAL, BUKTI, NOPER, KETERANGAN, JUMLAH,inpopr) value "
IF POKOK>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MBUKTI+"','"+KE_POKOK+"','"+"AUTODEBET TABUNGAN"+"','"+STR(0-POKOK)+"','"+DEFAUSERID+"'), "
ENDIF
IF BUNGA>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MBUKTI+"','"+KE_BUNGA+"','"+"AUTODEBET TABUNGAN"+"','"+STR(0-BUNGA)+"','"+DEFAUSERID+"'), "
ENDIF
IF DENDA>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MBUKTI+"','"+KE_DENDA+"','"+"AUTODEBET TABUNGAN"+"','"+STR(0-DENDA)+"','"+DEFAUSERID+"'), "
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-2)
LCEK = SQLEXEC(OODBC, CSQL)
MTOT = MTOT-(POKOK+BUNGA+DENDA)
HITNERACA(DEFAKANTOR, KE_POKOK, TGLNOW)
HITNERACA(DEFAKANTOR, KE_BUNGA, TGLNOW)
HITNERACA(DEFAKANTOR, KE_DENDA, TGLNOW)
SKIP
ENDDO
CSQL = "select SUM(akt) as akt, ke_noper from acc_harian_autodebet where akt>'0' and kel_id='"+STR(THISFORM.IDDATA)+"' group by ke_noper"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
CSQL = "insert into jurnal (KANTOR, TANGGAL, BUKTI, NOPER, KETERANGAN, JUMLAH,inpopr) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MBUKTI+"','"+KE_NOPER+"','"+"AUTODEBET TABUNGAN"+"','"+STR(0-AKT)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, KE_NOPER, TGLNOW)
MTOT = MTOT-AKT
SKIP
ENDDO
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_autodebet.scx::Command5
**
PROCEDURE Click
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(TANGGAL)+"' and kode='S02' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_autodebet where tanggal='"+SQLDATE(TANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_autodebet.scx::Label8
**
PROCEDURE Click
REPORT FORM tab_autodebet PREVIEW
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
***
*** acc_harian_autodebet.sct
***
*
***
*** simpanan_cetak_buku.scx
***
*
*
*  simpanan_cetak_buku.scx::FORM1
**
PROCEDURE bacadata
CSQL = "select * from simpanan_mutasi where norek='"+THISFORM.NOREK+"' order by iddata"
LCEK = SQLEXEC(OODBC, CSQL, "BUKUTAB")
ENDPROC
**
PROCEDURE tampil
WITH THISFORM.GRID1
.RECORDSOURCE = "BUKUTAB"
.COLUMNCOUNT = 7
.FONTSIZE = 8
.COLUMN1.WIDTH = 75
.COLUMN1.CONTROLSOURCE = "IDDATA"
.COLUMN1.HEADER1.CAPTION = "ID"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN2.WIDTH = 70
.COLUMN2.CONTROLSOURCE = "TANGGAL"
.COLUMN2.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN3.WIDTH = 70
.COLUMN3.CONTROLSOURCE = "BUKTI"
.COLUMN3.HEADER1.CAPTION = "BUKTI"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN4.WIDTH = 80
.COLUMN4.CONTROLSOURCE = "trans(DEBET,'999,999,999,999')"
.COLUMN4.HEADER1.CAPTION = "DEBET"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.ALIGNMENT = 1
.COLUMN5.WIDTH = 80
.COLUMN5.CONTROLSOURCE = "trans(KREDIT,'999,999,999,999')"
.COLUMN5.HEADER1.CAPTION = "KREDIT"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.ALIGNMENT = 1
.COLUMN6.WIDTH = 80
.COLUMN6.CONTROLSOURCE = "trans(SALDO,'999,999,999,999')"
.COLUMN6.HEADER1.CAPTION = "SALDO"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.ALIGNMENT = 1
.COLUMN7.WIDTH = 40
.COLUMN7.CONTROLSOURCE = "OPT"
.COLUMN7.HEADER1.CAPTION = "OPT"
.COLUMN7.HEADER1.FONTBOLD = .T.
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(cetakbuku='*', RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.TEXT1.VALUE = IDDATA
THISFORM.TEXT2.VALUE = TANGGAL
THISFORM.TEXT3.VALUE = BUKTI
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Unload
SELECT BUKUTAB
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK, BRSCTK
THISFORM.OLDSELECT = SELECT()
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.NOREK = MNOREK
THISFORM.TEXT4.VALUE = IIF(ISNULL(BRSBUKU) .OR. BRSBUKU=0, 1, BRSBUKU)
THISFORM.BACADATA()
LOCATE FOR CETAKBUKU<>'*'
IF  .NOT. FOUND()
APPEND BLANK
ENDIF
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_cetak_buku.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TEXT1.VALUE = IDDATA
THISFORM.TEXT2.VALUE = TANGGAL
THISFORM.TEXT3.VALUE = BUKTI
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_cetak_buku.scx::Text1
**
PROCEDURE LostFocus
LOCATE FOR IDDATA=THIS.VALUE
THISFORM.TAMPIL()
ENDPROC
**
*
*  simpanan_cetak_buku.scx::Command1
**
PROCEDURE Click
OLDSELE = SELECT()
SELECT BUKUTAB
LOCATE FOR IDDATA=THISFORM.TEXT1.VALUE
MBRS = THISFORM.TEXT4.VALUE
MKOL = 2
MTAMBAH = 0
IF MYPRINT("ON", "century gothic", 8)
DO WHILE .T.
SELECT (OLDSELE)
DO WHILE  .NOT. EOF()
IF  .NOT. EMPTY(IDDATA)
@ 5+MTAMBAH+MBRS, MKOL SAY TRANSFORM(MBRS, '99')+"    "+DTOC(TANGGAL)+"   "+KODE+"                 "+TRANSFORM(DEBET, '999,999,999,999')+"                 "+TRANSFORM(KREDIT, '999,999,999,999')+"              "+TRANSFORM(SALDO, '999,999,999,999')+"          "+IIF(ISNULL(OPT), '', OPT)
CSQL = "update simpanan_mutasi set cetakbuku='*' where iddata='"+STR(IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT (OLDSELE)
IF MBRS=16
MTAMBAH = 4
ENDIF
IF MBRS=34
MBRS = 1
EXIT
ENDIF
MBRS = MBRS+1
SELECT (OLDSELE)
ENDIF
SKIP
ENDDO
THISFORM.TEXT1.VALUE = IDDATA
CSQL = "update simpanan set brsbuku='"+ALLTRIM(STR(MBRS))+"' where norek='"+THISFORM.NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT (OLDSELE)
THISFORM.TEXT4.VALUE = MBRS
IF  .NOT. EOF()
MYPRINT("OFF")
MTAMBAH = 0
MESSAGEBOX("ganti halaman / ganti buku", 0, "")
IF LASTKEY()=27
EXIT
ENDIF
MYPRINT("ON", "century gothic", 8)
ELSE
EXIT
ENDIF
ENDDO
ENDIF
MYPRINT("OFF")
LOCATE FOR CETAKBUKU<>'*'
IF  .NOT. FOUND()
APPEND BLANK
ENDIF
THISFORM.TAMPIL()
ENDPROC
**
*
*  simpanan_cetak_buku.scx::Command2
**
PROCEDURE Click
OLDSELE = SELECT()
SELECT BUKUTAB
MURUT = CETAKTABUNGAN(THISFORM.TEXT1.VALUE, THISFORM.TEXT4.VALUE)
THISFORM.TEXT4.VALUE = MURUT
SELECT (THISFORM.OLDSELECT)
MNOREK = NOREK
REPLACE BRSBUKU WITH MURUT
CSQL = "update simpanan set brsbuku='"+STR(MURUT)+"' where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT BUKUTAB
ENDPROC
**
***
*** simpanan_cetak_buku.sct
***
*
***
*** symbol configuration 2.bmp
***
*
***
*** frm_tunggu_proses.scx
***
*
*
*  frm_tunggu_proses.scx::FORM1
**
PROCEDURE Init
THISFORM.TITLEBAR = 0
THISFORM.BORDERSTYLE = 1
THISFORM.TIMER1.INTERVAL = 200
ENDPROC
**
*
*  frm_tunggu_proses.scx::Timer1
**
PROCEDURE Timer
IF THISFORM.LABEL1.VISIBLE=.F.
THISFORM.LABEL1.VISIBLE = .T.
ELSE
THISFORM.LABEL1.VISIBLE = .F.
ENDIF
ENDPROC
**
***
*** frm_tunggu_proses.sct
***
*
***
*** acc_opt.scx
***
*
*
*  acc_opt.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.TOP = SYSMETRIC(2)/2
THISFORM.LEFT = SYSMETRIC(1)/2
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.NILAI = ''
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.NILAI
ENDFUNC
**
*
*  acc_opt.scx::Text2
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
*
*  acc_opt.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_opt.scx::Command3
**
PROCEDURE Click
CSQL = "select * from user where userid='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' and password=md5('"+ALLTRIM(THISFORM.TEXT2.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
IF USERID=THISFORM.TEXT1.VALUE
THISFORM.NILAI = USERID
ELSE
MESSAGEBOX("VALIDASI TRANSAKSI GAGAL DILAKUKAN", 0, "")
THISFORM.NILAI = ''
ENDIF
USE
THISFORM.RELEASE
ENDPROC
**
*
*  acc_opt.scx::Text1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
***
*** acc_opt.sct
***
*
***
*** acc_harian_deposito.scx
***
*
*
*  acc_harian_deposito.scx::FORM1
**
PROCEDURE rekap
MIDDATA = THISFORM.IDDATA
OLDSELECT = SELECT()
CSQL = "select SUM(jasa) as js, SUM(pajak) as pjk from acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
THISFORM.TEXT3.VALUE = JS
THISFORM.TEXT4.VALUE = PJK
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE bacadata
MIDDATA = THISFORM.IDDATA
CSQL = "select * from acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
ENDPROC
**
PROCEDURE tampil
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 9
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NOREK"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "TRANS(SALDO,'9999,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "POKOK"
.COLUMN3.ALIGNMENT = 1
.COLUMN4.WIDTH = 40
.COLUMN4.CONTROLSOURCE = "TRANS(RATE,'99.99')"
.COLUMN4.HEADER1.CAPTION = "RATE"
.COLUMN4.ALIGNMENT = 1
.COLUMN5.WIDTH = 30
.COLUMN5.CONTROLSOURCE = "TRANS(HARI,'99')"
.COLUMN5.HEADER1.CAPTION = "HARI"
.COLUMN5.ALIGNMENT = 2
.COLUMN6.WIDTH = 30
.COLUMN6.CONTROLSOURCE = "CARAHIT"
.COLUMN6.HEADER1.CAPTION = "KD"
.COLUMN6.ALIGNMENT = 0
.COLUMN7.WIDTH = 90
.COLUMN7.CONTROLSOURCE = "TRANS(JASA,'9,999,999,999')"
.COLUMN7.HEADER1.CAPTION = "JASA"
.COLUMN7.ALIGNMENT = 1
.COLUMN8.WIDTH = 90
.COLUMN8.CONTROLSOURCE = "TRANS(PAJAK,'9,999,999,999')"
.COLUMN8.HEADER1.CAPTION = "PAJAK"
.COLUMN8.ALIGNMENT = 1
.COLUMN9.WIDTH = 150
.COLUMN9.CONTROLSOURCE = "KETERANGAN"
.COLUMN9.HEADER1.CAPTION = "KETERANGAN"
.COLUMN9.ALIGNMENT = 0
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = KETERANGAN
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
THISFORM.REKAP()
THISFORM.BACADATA()
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_harian_deposito.scx::Grid1
**
PROCEDURE DblClick
DO FORM acc_harian_dep_detail
THISFORM.REKAP()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM acc_harian_dep_detail
THISFORM.REKAP()
ENDIF
ENDPROC
**
*
*  acc_harian_deposito.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_deposito.scx::Command4
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM frm_bukti TO MBUKTI WITH THISFORM.TEXT1.VALUE
IF  .NOT. EMPTY(MBUKTI)
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MREK = RECNO()
MIDMUTASI = IDDATA
MNOREK = NOREK
MTGL = TANGGAL
MJASA = JASA
MPJK = PAJAK
MBUNGAKE = BUNGAKE
MNOREKTUJUAN = NOREKTUJUAN
MATASNAMA = ATASNAMA
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') "+" and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDOPK = SALDO
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') "+" and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDOBG = SALDO
USE
IF MJASA>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFADEPBG+"','"+"JASA SIMPANAN DEPOSITO"+"','0','"+STR(MJASA)+"','"+TRANSFORM(MSALDOBG+MJASA, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal insert bunga")
ENDIF
ENDIF
IF MPJK>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFADEPPJK+"','"+"PAJAK JASA SIMPANAN DEPOSITO"+"','"+STR(MPJK)+"','"+STR(0)+"','"+TRANSFORM(MSALDOBG+MJASA-MPJK, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal insert bunga")
ENDIF
ENDIF
IF MBUNGAKE="TABUNGAN" .OR. MBUNGAKE="DEPOSITO"
IF MBUNGAKE="TABUNGAN"
MNOREKTAB = MNOREKTUJUAN
CSQL = "select a.kantor,b.jurnaltab from simpanan as a left join setsandi_tab as b on a.produk=b.sandi where a.norek='"+MNOREKTAB+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKANTORTAB = ALLTRIM(DEFANOPERAKP)+RIGHT(ALLTRIM(KANTOR), 2)
MKANTOR = KANTOR
MJURLAWAN = JURNALTAB
MKANTARTAB = ''
CSQL = "update acc_harian_bungadeposito set kekantor='"+MKANTOR+"', jurlawan='"+JURNALTAB+"' where iddata='"+STR(MIDMUTASI)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') "+" and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MSALDOBG = SALDO
IF MSALDOBG>0
MKET = "TRANSFER KE TAB."+ALLTRIM(MNOREKTAB)
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFADEPBG+"','"+MKET+"','"+STR(MJASA-MPJK)+"','"+STR(0)+"','"+TRANSFORM(MSALDOBG-(MJASA-MPJK), '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREKTAB+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREKTAB+"' and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDOTAB = SALDO
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+MKANTOR+"','"+MNOREKTAB+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABBGDEP+"','"+"DARI JASA SIMPANAN DEPOSITO"+"','0','"+STR(MJASA-MPJK)+"','"+TRANSFORM(MSALDOTAB+(MJASA-MPJK), '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal transfer ke tabungan")
ENDIF
SELECT RINCI_TRANS
IF MKANTOR=DEFAKANTOR
REPLACE JURLAWAN WITH MJURLAWAN
ELSE
REPLACE JURLAWAN WITH MKANTARTAB
REPLACE JURAKTAB WITH MJURLAWAN
ENDIF
ELSE
MNOREKTAB = MNOREKTUJUAN
CSQL = "select a.kantor,b.jurnaltab from simpanan as a left join setsandi_tab as b on a.produk=b.sandi where a.norek='"+MNOREKTAB+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKANTORTAB = ALLTRIM(DEFANOPERAKP)+RIGHT(ALLTRIM(KANTOR), 2)
MKANTOR = KANTOR
MJURLAWAN = JURNALTAB
MKANTARTAB = ''
CSQL = "update acc_harian_bungadeposito set kekantor='"+MKANTOR+"', jurlawan='"+JURNALTAB+"' where iddata='"+STR(MIDMUTASI)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREKTAB+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREKTAB+"' and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDOBG = SALDO
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFADEPAMBBG+"','"+"AMB UNTUK STOR POKOK "+"','"+STR(MJASA-MPJK)+"','"+STR(0)+"','"+TRANSFORM(MSALDOBG-(MJASA-MPJK), '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal ambil bunga")
ENDIF
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') "+" and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDOPK = SALDO
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+MKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFADEPPBKPK2+"','"+"JASA SIMPANAN"+"','0','"+STR(MJASA-MPJK)+"','"+TRANSFORM(MSALDOPK+(MJASA-MPJK), '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT RINCI_TRANS
IF MKANTOR=DEFAKANTOR
REPLACE JURLAWAN WITH MJURLAWAN
ELSE
REPLACE JURLAWAN WITH MKANTARTAB
REPLACE JURAKTAB WITH MJURLAWAN
ENDIF
ENDIF
ENDIF
SELECT RINCI_TRANS
GOTO MREK
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(MTGL)+"', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT sum( jasa ) AS bg, sum( pajak ) AS pjk, jurtab,jurbg,jurpjk FROM acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"' GROUP BY produk"
LCEK = SQLEXEC(OODBC, CSQL, "JUR")
MTOT = 0
DO WHILE  .NOT. EOF()
MJURPK = JURTAB
MJURBG = JURBG
MJURPJK = JURPJK
MREK = RECNO()
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+MJURBG+"','JASA SIMPANAN','"+TRANSFORM(BG, '999999999999')+"','"+MOPTACC+"'), "
IF PJK>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+MJURPJK+"','PAJAK SIMPANAN','"+TRANSFORM(0-PJK, '999999999999')+"','"+MOPTACC+"'), "
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-2)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal")
ENDIF
MTOT = MTOT+(BG-PJK)
HITNERACA(DEFAKANTOR, MJURBG, MTGL)
HITNERACA(DEFAKANTOR, MJURPJK, MTGL)
SELECT JUR
SKIP
ENDDO
SELECT JUR
USE
CSQL = "SELECT sum( jasa ) AS bg, sum( pajak ) AS pjk, jurlawan FROM acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"' and kekantor='"+DEFAKANTOR+"' GROUP BY jurlawan"
LCEK = SQLEXEC(OODBC, CSQL, "JUR")
DO WHILE  .NOT. EOF()
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURLAWAN+"','KE TABUNGAN/DEPOSITO','"+TRANSFORM(0-(BG-PJK), '999999999999')+"','"+MOPTACC+"') "
LCEK = SQLEXEC(OODBC, CSQL)
MTOT = MTOT-(BG-PJK)
HITNERACA(DEFAKANTOR, JURLAWAN, MTGL)
SELECT JUR
SKIP
ENDDO
SELECT JUR
USE
CSQL = "SELECT sum( jasa ) AS bg, sum( pajak ) AS pjk, jurlawan,juraktab,kekantor FROM acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"' and kekantor<>'"+DEFAKANTOR+"' and kekantor<>'' GROUP BY jurlawan"
LCEK = SQLEXEC(OODBC, CSQL, "JUR")
DO WHILE  .NOT. EOF()
MAKP = ALLTRIM(DEFANOPERAKP)+ALLTRIM(DEFAKANTOR)
MAKA = ALLTRIM(DEFANOPERAKA)+ALLTRIM(KEKANTOR)
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+MAKA+"','JASA SIMPANAN AKA','"+TRANSFORM(0-(BG-PJK), '999999999999')+"','"+MOPTACC+"'), "+"('"+KEKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+MAKP+"','JASA SIMPANAN AKA','"+TRANSFORM((BG-PJK), '999999999999')+"','"+MOPTACC+"'), "+"('"+KEKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURLAWAN+"','JASA SIMPANAN AKA','"+TRANSFORM(0-(BG-PJK), '999999999999')+"','"+MOPTACC+"') "
LCEK = SQLEXEC(OODBC, CSQL)
MTOT = MTOT-(BG-PJK)
HITNERACA(DEFAKANTOR, MAKA, MTGL)
HITNERACA(KEKANTOR, MAKP, MTGL)
HITNERACA(KEKANTOR, JURLAWAN, MTGL)
SELECT JUR
SKIP
ENDDO
IF MTOT>0
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFANOPERTTPDEP+"','TITIPAN','"+TRANSFORM(0-(MTOT), '999999999999')+"','"+MOPTACC+"') "
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, DEFANOPERTTPDEP, MTGL)
ENDIF
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_deposito.scx::Command5
**
PROCEDURE Click
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(TANGGAL)+"' and kode='S04' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_bungadeposito where tanggal='"+SQLDATE(TANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_deposito.scx::Label8
**
PROCEDURE Click
REPORT FORM tab_pemberianbunga_dep PREVIEW
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
*
*  acc_harian_deposito.scx::Label9
**
PROCEDURE Click
REPORT FORM tab_pemberianbunga_rekap PREVIEW
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
*
*  acc_harian_deposito.scx::Command1
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
GOTO TOP
CSQL = "select bukti from simpanan_mutasi where kantor='"+KANTOR+"' and norek='"+NOREK+"' and tanggal='"+SQLDATE(TANGGAL)+"' and kode='"+ALLTRIM(DEFADEPBG)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBUKTI = BUKTI
USE
SELECT RINCI_TRANS
GOTO TOP
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTGL = TANGGAL
MJASA = JASA
MPJK = PAJAK
CSQL = "delete from simpanan_mutasi where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTGL)+"' and bukti='"+ALLTRIM(MBUKTI)+"' and (kode='"+ALLTRIM(DEFADEPBG)+"' or kode='"+ALLTRIM(DEFADEPPJK)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from simpanan_bilyet where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTGL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='0000-00-00', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from jurnal where kantor='"+DEFAKANTOR+"' and norek='"+MNOREK+"' and tanggal='"+SQLDATE(MTGL)+"' and bukti='"+MBUKTI+"' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT jurtab,jurbg,jurpjk FROM acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"' GROUP BY produk"
LCEK = SQLEXEC(OODBC, CSQL, "JUR")
DO WHILE  .NOT. EOF()
MJURBG = JURBG
MJURPJK = JURPJK
MJURTAB = JURTAB
HITNERACA(DEFAKANTOR, MJURBG, MTGL)
HITNERACA(DEFAKANTOR, MJURPJK, MTGL)
HITNERACA(DEFAKANTOR, MJURTAB, MTGL)
SELECT JUR
SKIP
ENDDO
SELECT JUR
USE
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_deposito.scx::Command2
**
PROCEDURE Click
SELECT RINCI_TRANS
XIDDATA = IDDATA
XKELID = KEL_ID
MYT = MESSAGEBOX("Nomor Rekening "+ALLTRIM(NOREK)+", Benar Akan dihapus", 36, "")
IF MYT=6
CSQL = "delete from acc_harian_bungadeposito where iddata=?xiddata and kel_id=?xkelid"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BACADATA()
THISFORM.TAMPIL()
ENDIF
ENDPROC
**
***
*** acc_harian_deposito.sct
***
*
***
*** acc_harian_dep_detail.scx
***
*
*
*  acc_harian_dep_detail.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.DBF = SELECT()
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = SALDO
THISFORM.TEXT4.VALUE = CARAHIT
THISFORM.TEXT5.VALUE = RATE
THISFORM.TEXT6.VALUE = HARI
THISFORM.TEXT7.VALUE = JASA
THISFORM.TEXT8.VALUE = PAJAK
THISFORM.COMBO1.VALUE = BUNGAKE
THISFORM.TEXT16.VALUE = NOREKTUJUAN
THISFORM.TEXT10.VALUE = ATASNAMA
ENDPROC
**
*
*  acc_harian_dep_detail.scx::Command1
**
PROCEDURE Click
THISFORM.TEXT7.ENABLED = .T.
THISFORM.TEXT8.ENABLED = .T.
THISFORM.COMBO1.ENABLED = .T.
THISFORM.TEXT16.ENABLED = .T.
THISFORM.TEXT10.ENABLED = .T.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
ENDPROC
**
*
*  acc_harian_dep_detail.scx::Command2
**
PROCEDURE Click
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.COMBO1.ENABLED = .F.
THISFORM.TEXT16.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THIS.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
ENDPROC
**
*
*  acc_harian_dep_detail.scx::Command3
**
PROCEDURE Click
SELECT (THISFORM.DBF)
REPLACE JASA WITH THISFORM.TEXT7.VALUE
REPLACE PAJAK WITH THISFORM.TEXT8.VALUE
REPLACE BUNGAKE WITH THISFORM.COMBO1.VALUE
REPLACE NOREKTUJUAN WITH THISFORM.TEXT16.VALUE
REPLACE ATASNAMA WITH THISFORM.TEXT10.VALUE
MKET = "Jasa Ditransfer ke rek. Tabungan no"+ALLTRIM(THISFORM.TEXT16.VALUE)
REPLACE KETERANGAN WITH MKET
CSQL = "update acc_harian_bungadeposito set jasa='"+STR(THISFORM.TEXT7.VALUE)+"', "+"pajak='"+STR(THISFORM.TEXT8.VALUE)+"', "+"bungake='"+THISFORM.COMBO1.VALUE+"', "+"norektujuan='"+THISFORM.TEXT16.VALUE+"', "+"atasnama='"+THISFORM.TEXT10.VALUE+"' "+"keterangan='"+MKET+"' "+"where iddata='"+STR(IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_dep_detail.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_dep_detail.scx::Combo1
**
PROCEDURE Init
THIS.ADDITEM("TUNAI")
THIS.ADDITEM("TABUNGAN")
THIS.ADDITEM("DEPOSITO")
ENDPROC
**
PROCEDURE LostFocus
DO CASE
CASE EMPTY(THIS.VALUE)
THISFORM.TEXT16.VALUE = ""
THISFORM.TEXT10.VALUE = ""
THISFORM.TEXT16.ENABLED = .F.
CASE THIS.VALUE="TUNAI"
THISFORM.TEXT16.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.TEXT16.VALUE = ''
THISFORM.TEXT10.VALUE = ''
CASE THIS.VALUE="TABUNGAN"
THISFORM.TEXT16.ENABLED = .T.
THISFORM.COMMAND5.ENABLED = .T.
CASE THIS.VALUE="ARO"
THISFORM.TEXT16.ENABLED = .T.
THISFORM.COMMAND5.ENABLED = .T.
THISFORM.TEXT16.VALUE = THISFORM.TEXT1.VALUE
THISFORM.TEXT10.VALUE = THISFORM.TEXT2.VALUE
ENDCASE
ENDPROC
**
*
*  acc_harian_dep_detail.scx::Text16
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THISFORM.TEXT16.VALUE = MNOREK
ENDIF
MNOREK = TRIM(THIS.VALUE)
CSQL = "select norek,cif from simpanan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MCIF = CIF
VNOREK = NOREK
USE
CSQL = "select nama from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF VNOREK=MNOREK
THISFORM.TEXT10.VALUE = NAMA
USE
SELECT (OLDSELECT)
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27 .OR. NKEYCODE=5
RETURN
ENDIF
ENDPROC
**
*
*  acc_harian_dep_detail.scx::Command5
**
PROCEDURE Click
OLDSELECT = SELECT()
DO FORM simpanan TO MNOREK WITH "CARI"
THISFORM.TEXT16.VALUE = MNOREK
SELECT (OLDSELECT)
ENDPROC
**
***
*** acc_harian_dep_detail.sct
***
*
***
*** simpanan_mutasi_dep.scx
***
*
*
*  simpanan_mutasi_dep.scx::FORM1
**
PROCEDURE bacadata
MDATA = THISFORM.DATA1
MNOREK = THISFORM.NOREKASAL
CSQL = "select * from simpanan_mutasi where norek='"+MNOREK+"' and ("+"kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or "+"kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') order by tanggal,iddata"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MDATA = THISFORM.DATA2
MNOREK = THISFORM.NOREKASAL
CSQL = "select * from simpanan_mutasi where norek='"+MNOREK+"' and ("+"kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or "+"kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') order by tanggal,iddata"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDPROC
**
PROCEDURE tampilkan
MYDATA = THISFORM.DATA1
SELECT &MYDATA  
WITH THISFORM.PAGEFRAME1.PAGE1.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 8
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KODE"
.COLUMN3.HEADER1.CAPTION = "KODE"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 200
.COLUMN4.CONTROLSOURCE = "KETERANGAN"
.COLUMN4.HEADER1.CAPTION = "KETERANGAN"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "DEBET"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "DEBET"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.COLUMN6.WIDTH = 100
.COLUMN6.CONTROLSOURCE = "KREDIT"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "KREDIT"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 9
.COLUMN7.WIDTH = 100
.COLUMN7.CONTROLSOURCE = "SALDO"
.COLUMN7.INPUTMASK = "999,999,999,999"
.COLUMN7.ALIGNMENT = 1
.COLUMN7.HEADER1.CAPTION = "SALDO"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 9
.COLUMN8.WIDTH = 50
.COLUMN8.CONTROLSOURCE = "OPT"
.COLUMN8.HEADER1.CAPTION = "OPT"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 9
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
MYDATA = THISFORM.DATA2
SELECT &MYDATA  
WITH THISFORM.PAGEFRAME1.PAGE2.GRID1
.RECORDSOURCE = MYDATA
.COLUMNCOUNT = 8
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "TANGGAL"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "BUKTI"
.COLUMN2.HEADER1.CAPTION = "BUKTI"
.COLUMN2.HEADER1.FONTBOLD = .T.
.COLUMN2.HEADER1.FONTSIZE = 9
.COLUMN3.WIDTH = 40
.COLUMN3.CONTROLSOURCE = "KODE"
.COLUMN3.HEADER1.CAPTION = "KODE"
.COLUMN3.HEADER1.FONTBOLD = .T.
.COLUMN3.HEADER1.FONTSIZE = 9
.COLUMN4.WIDTH = 200
.COLUMN4.CONTROLSOURCE = "KETERANGAN"
.COLUMN4.HEADER1.CAPTION = "KETERANGAN"
.COLUMN4.HEADER1.FONTBOLD = .T.
.COLUMN4.HEADER1.FONTSIZE = 9
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "DEBET"
.COLUMN5.INPUTMASK = "999,999,999,999"
.COLUMN5.ALIGNMENT = 1
.COLUMN5.HEADER1.CAPTION = "DEBET"
.COLUMN5.HEADER1.FONTBOLD = .T.
.COLUMN5.HEADER1.FONTSIZE = 9
.COLUMN6.WIDTH = 100
.COLUMN6.CONTROLSOURCE = "KREDIT"
.COLUMN6.INPUTMASK = "999,999,999,999"
.COLUMN6.ALIGNMENT = 1
.COLUMN6.HEADER1.CAPTION = "KREDIT"
.COLUMN6.HEADER1.FONTBOLD = .T.
.COLUMN6.HEADER1.FONTSIZE = 9
.COLUMN7.WIDTH = 100
.COLUMN7.CONTROLSOURCE = "SALDO"
.COLUMN7.INPUTMASK = "999,999,999,999"
.COLUMN7.ALIGNMENT = 1
.COLUMN7.HEADER1.CAPTION = "SALDO"
.COLUMN7.HEADER1.FONTBOLD = .T.
.COLUMN7.HEADER1.FONTSIZE = 9
.COLUMN8.WIDTH = 50
.COLUMN8.CONTROLSOURCE = "OPT"
.COLUMN8.HEADER1.CAPTION = "OPT"
.COLUMN8.HEADER1.FONTBOLD = .T.
.COLUMN8.HEADER1.FONTSIZE = 9
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE tampil2
THISFORM.PAGEFRAME1.PAGE2.TEXT3.VALUE = KETERANGAN
ENDPROC
**
PROCEDURE tampil1
THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE = KETERANGAN
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.OLDSELECT = SELECT()
THISFORM.MODE = MMODE
THISFORM.NOREKASAL = NOREK
THISFORM.DATA1 = SYS(2015)
THISFORM.DATA2 = SYS(2015)
WITH THISFORM
IF MMODE='TAMPIL' .OR. MMODE='EDIT'
SELECT (THISFORM.OLDSELECT)
.TEXT32.VALUE = NOREK
.TEXT33.VALUE = NOBUKU
.TEXT1.VALUE = CIF
.TEXT2.VALUE = NAMA
IF MMODE="TAMPIL"
THIS.SETALL("enabled", .F., "Textbox")
THISFORM.CMDKELUAR1.SETFOCUS
ENDIF
ENDIF
ENDWITH
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL1()
THISFORM.TAMPIL2()
ENDPROC
**
FUNCTION Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  simpanan_mutasi_dep.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT35.VALUE = DESA
THISFORM.TEXT36.VALUE = KECAMATAN
THISFORM.TEXT37.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. (EMPTY(THIS.VALUE) .OR. TRIM(THIS.VALUE)=".")
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
*
*  simpanan_mutasi_dep.scx::Text32
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
ENDPROC
**
*
*  simpanan_mutasi_dep.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_mutasi_dep.scx::Pageframe1
**
PROCEDURE Page1.Activate
THISFORM.MJENISMUTASI = 1
ENDPROC
**
PROCEDURE Page2.Activate
THISFORM.MJENISMUTASI = 2
ENDPROC
**
*
*  simpanan_mutasi_dep.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
*
*  simpanan_mutasi_dep.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL2()
ENDPROC
**
*
*  simpanan_mutasi_dep.scx::Command1
**
PROCEDURE Click
MBGPK = THISFORM.MJENISMUTASI
DO FORM form_pbk WITH "DEP", THISFORM.TEXT32.VALUE, '', MBGPK
THISFORM.BACADATA()
THISFORM.TAMPILKAN()
THISFORM.TAMPIL2()
ENDPROC
**
***
*** simpanan_mutasi_dep.sct
***
*
***
*** simpanan_data_bilyet.scx
***
*
*
*  simpanan_data_bilyet.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK, MNAMA, MMODE
THISFORM.TEXT2.VALUE = MNAMA
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.MODE = MMODE
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
IF MMODE="TAMPIL" .OR. MMODE="EDIT" .OR. MMODE="HAPUS"
THISFORM.TEXT3.VALUE = KE
THISFORM.TEXT4.VALUE = POKOK
THISFORM.TEXT5.VALUE = RATE
THISFORM.TEXT6.VALUE = CARAHITUNG
THISFORM.TEXT11.VALUE = IIF(CARAHITUNG="E", "HARI EFEKTIF", "RATA-RATA")
THISFORM.TEXT7.VALUE = LAMA
THISFORM.TEXT8.VALUE = TGLAWAL
THISFORM.TEXT9.VALUE = TGLJTEMPO
THISFORM.TEXT10.VALUE = ARO
ENDIF
IF MMODE="INPUT" .OR. MMODE="EDIT"
THISFORM.TEXT3.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .T.
THISFORM.TEXT5.ENABLED = .T.
THISFORM.TEXT6.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .T.
THISFORM.TEXT8.ENABLED = .T.
THISFORM.TEXT9.ENABLED = .T.
THISFORM.TEXT10.ENABLED = .T.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .T.
ENDIF
IF MMODE="HAPUS"
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
ENDIF
IF MMODE="INPUT"
IF EMPTY(NOREK)
THISFORM.TEXT3.VALUE = 0
THISFORM.TEXT6.VALUE = "E"
THISFORM.TEXT10.VALUE = "Y"
THISFORM.TEXT8.VALUE = TGLNOW
ELSE
THISFORM.TEXT3.VALUE = KE+1
THISFORM.TEXT4.VALUE = POKOK
THISFORM.TEXT5.VALUE = RATE
THISFORM.TEXT6.VALUE = CARAHITUNG
THISFORM.TEXT11.VALUE = IIF(CARAHITUNG="E", "HARI EFEKTIF", "RATA-RATA")
THISFORM.TEXT7.VALUE = LAMA
THISFORM.TEXT8.VALUE = TGLNOW
MTGL = TGLNOW
FOR A = 1 TO LAMA
MTGL = MAJU1BLN(MTGL)
ENDFOR
THISFORM.TEXT9.VALUE = MTGL
THISFORM.TEXT10.VALUE = ARO
ENDIF
ENDIF
ENDPROC
**
*
*  simpanan_data_bilyet.scx::Text6
**
PROCEDURE LostFocus
IF THIS.VALUE='E'
THISFORM.TEXT11.VALUE = "HARI EFEKTIF"
ENDIF
IF THIS.VALUE='R'
THISFORM.TEXT11.VALUE = "RATA-RATA"
ENDIF
IF  .NOT. (THIS.VALUE='E' .OR. THIS.VALUE='R')
MESSAGEBOX('Cara hitung Bunga tersedia "E" atau "R"', 0, '')
RETURN
NODEFAULT
ENDIF
ENDPROC
**
*
*  simpanan_data_bilyet.scx::Text7
**
PROCEDURE InteractiveChange
MTGL = THISFORM.TEXT8.VALUE
FOR A = 1 TO THIS.VALUE
MTGL = MAJU1BLN(MTGL)
ENDFOR
THISFORM.TEXT9.VALUE = MTGL
ENDPROC
**
*
*  simpanan_data_bilyet.scx::Text8
**
PROCEDURE LostFocus
MTGL = THIS.VALUE
FOR A = 1 TO THISFORM.TEXT7.VALUE
MTGL = MAJU1BLN(MTGL)
ENDFOR
THISFORM.TEXT9.VALUE = MTGL
ENDPROC
**
*
*  simpanan_data_bilyet.scx::Command1
**
PROCEDURE Click
THISFORM.TEXT3.ENABLED = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .F.
ENDPROC
**
*
*  simpanan_data_bilyet.scx::Command2
**
PROCEDURE Click
IF THISFORM.MODE="INPUT"
CSQL = "insert into simpanan_bilyet (kantor,norek,tanggal,ke,pokok,rate,carahitung,lama,aro,tglawal, tgljtempo,opt) value ("+"'"+DEFAKANTOR+"','"+THISFORM.TEXT1.VALUE+"','"+SQLDATE(TGLNOW)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+TRANSFORM(THISFORM.TEXT4.VALUE, '999999999999999')+"','"+TRANSFORM(THISFORM.TEXT5.VALUE, '999.99')+"','"+THISFORM.TEXT6.VALUE+"','"+STR(THISFORM.TEXT7.VALUE)+"','"+THISFORM.TEXT10.VALUE+"','"+SQLDATE(THISFORM.TEXT8.VALUE)+"','"+SQLDATE(THISFORM.TEXT9.VALUE)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
MESSAGEBOX("Gagal simpan data")
ENDIF
ELSE
CSQL = "update simpanan_bilyet set "+"ke='"+STR(THISFORM.TEXT3.VALUE)+"', "+"pokok='"+TRANSFORM(THISFORM.TEXT4.VALUE, '999999999999999')+"', "+"rate='"+TRANSFORM(THISFORM.TEXT5.VALUE, '999.99')+"', "+"carahitung='"+THISFORM.TEXT6.VALUE+"', "+"lama='"+STR(THISFORM.TEXT7.VALUE)+"', "+"aro='"+THISFORM.TEXT10.VALUE+"', "+"tglawal='"+SQLDATE(THISFORM.TEXT8.VALUE)+"', "+"tgljtempo='"+SQLDATE(THISFORM.TEXT9.VALUE)+"' "+"where norek='"+THISFORM.TEXT1.VALUE+"' and tanggal='"+SQLDATE(TANGGAL)+"' and ke='"+STR(KE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data")
ELSE
REPLACE KE WITH THISFORM.TEXT3.VALUE
REPLACE POKOK WITH THISFORM.TEXT4.VALUE
REPLACE RATE WITH THISFORM.TEXT5.VALUE
REPLACE CARAHITUNG WITH THISFORM.TEXT6.VALUE
REPLACE LAMA WITH THISFORM.TEXT7.VALUE
REPLACE ARO WITH THISFORM.TEXT10.VALUE
REPLACE TGLAWAL WITH THISFORM.TEXT8.VALUE
REPLACE TGLJTEMPO WITH THISFORM.TEXT9.VALUE
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data_bilyet.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_data_bilyet.scx::Command3
**
PROCEDURE Click
YT = MESSAGEBOX("Benar Data ini akan dihapus", 36, "")
IF YT=6
CSQL = "delete from simpanan_bilyet where kantor='"+KANTOR+"' and norek='"+NOREK+"' and tanggal='"+SQLDATE(TANGGAL)+"' and ke='"+STR(KE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.RELEASE
ENDIF
ENDPROC
**
***
*** simpanan_data_bilyet.sct
***
*
***
*** tab_pemberianbunga_dep.frx
***
*
***
*** tab_pemberianbunga_dep.frt
***
*
***
*** tab_pemberianbunga_rekap.frx
***
*
***
*** tab_pemberianbunga_rekap.frt
***
*
***
*** tab_pemberianbunga_tab.frx
***
*
***
*** tab_pemberianbunga_tab.frt
***
*
***
*** tab_pemberianbungatab_rekap.frx
***
*
***
*** tab_pemberianbungatab_rekap.frt
***
*
***
*** acc_harian_aro.scx
***
*
*
*  acc_harian_aro.scx::FORM1
**
PROCEDURE rekap
MIDDATA = THISFORM.IDDATA
OLDSELECT = SELECT()
CSQL = "select COUNT(norek) as jml from acc_harian_dep_aro where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
THISFORM.TEXT3.VALUE = VAL(JML)
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = KETERANGAN
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
THISFORM.REKAP()
CSQL = "select * from acc_harian_dep_aro where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 8
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NOREK"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "TRANS(POKOK,'9999,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "POKOK"
.COLUMN3.ALIGNMENT = 1
.COLUMN4.WIDTH = 40
.COLUMN4.CONTROLSOURCE = "TRANS(RATE_LAMA,'99.99')"
.COLUMN4.HEADER1.CAPTION = "RATE LAMA"
.COLUMN4.ALIGNMENT = 1
.COLUMN5.WIDTH = 40
.COLUMN5.CONTROLSOURCE = "TRANS(RATE,'99.99')"
.COLUMN5.HEADER1.CAPTION = "RATE BARU"
.COLUMN5.ALIGNMENT = 1
.COLUMN6.WIDTH = 40
.COLUMN6.CONTROLSOURCE = "TRANS(LAMA,'99')"
.COLUMN6.HEADER1.CAPTION = "JW"
.COLUMN6.ALIGNMENT = 1
.COLUMN7.WIDTH = 80
.COLUMN7.CONTROLSOURCE = "TGLAWAL"
.COLUMN7.HEADER1.CAPTION = "TGL AWAL"
.COLUMN7.ALIGNMENT = 1
.COLUMN8.WIDTH = 80
.COLUMN8.CONTROLSOURCE = "TGLJTEMPO"
.COLUMN8.HEADER1.CAPTION = "TGL JT TEMPO"
.COLUMN8.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
*
*  acc_harian_aro.scx::Grid1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
DO FORM acc_harian_aro_detail
THISFORM.REKAP()
ENDIF
ENDPROC
**
PROCEDURE DblClick
DO FORM acc_harian_aro_detail
THISFORM.REKAP()
ENDPROC
**
*
*  acc_harian_aro.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_aro.scx::Command4
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
IF .T.
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MREK = RECNO()
MIDMUTASI = IDDATA
MNOREK = NOREK
MTANGGAL = TANGGAL
MKE = KE
MPOKOK = POKOK
MRATE = RATE
MCARAHITUNG = CARAHITUNG
MLAMA = LAMA
MARO = ARO
MTGLAWAL = TGLAWAL
MTGLJTEMPO = TGLJTEMPO
CSQL = "insert into simpanan_bilyet (kantor,norek,tanggal,ke,pokok,rate,carahitung,lama,aro,"+"tglawal,tgljtempo) value ("+"'"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(THISFORM.TEXT1.VALUE)+"','"+STR(MKE)+"','"+STR(MPOKOK)+"','"+STR(MRATE)+"','"+MCARAHITUNG+"','"+STR(MLAMA)+"','"+MARO+"','"+SQLDATE(MTGLAWAL)+"','"+SQLDATE(MTGLJTEMPO)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
ENDIF
SELECT RINCI_TRANS
GOTO MREK
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(THISFORM.TEXT1.VALUE)+"', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_aro.scx::Command5
**
PROCEDURE Click
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(TANGGAL)+"' and kode='S05' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_autodebet where tanggal='"+SQLDATE(TANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_aro.scx::Label8
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE Click
REPORT FORM tab_perpanjangan_aro PREVIEW
ENDPROC
**
*
*  acc_harian_aro.scx::Label9
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
***
*** acc_harian_aro.sct
***
*
***
*** acc_harian_aro_detail.scx
***
*
*
*  acc_harian_aro_detail.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.DBF = SELECT()
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = POKOK
THISFORM.TEXT13.VALUE = RATE_LAMA
THISFORM.TEXT9.VALUE = TANGGAL
THISFORM.TEXT10.VALUE = KE
THISFORM.TEXT4.VALUE = CARAHITUNG
IF CARAHITUNG="E"
THISFORM.TEXT12.VALUE = "HARI EFEKTIF"
ELSE
THISFORM.TEXT12.VALUE = "RATA-RATA"
ENDIF
THISFORM.TEXT5.VALUE = RATE
THISFORM.TEXT6.VALUE = LAMA
THISFORM.TEXT7.VALUE = TGLAWAL
THISFORM.TEXT8.VALUE = TGLJTEMPO
THISFORM.TEXT11.VALUE = ARO
ENDPROC
**
*
*  acc_harian_aro_detail.scx::Text4
**
PROCEDURE LostFocus
IF THIS.VALUE="E" .OR. THIS.VALUE="R"
THISFORM.TEXT12.VALUE = IIF(THIS.VALUE='E', 'HARI EFEKTIF', 'RATA-RATA')
ELSE
THIS.SETFOCUS
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  acc_harian_aro_detail.scx::Text7
**
PROCEDURE LostFocus
MTGL = THIS.VALUE
FOR A = 1 TO THISFORM.TEXT6.VALUE
MTGL = MAJU1BLN(MTGL)
ENDFOR
THISFORM.TEXT8.VALUE = MTGL
ENDPROC
**
*
*  acc_harian_aro_detail.scx::Command1
**
PROCEDURE Click
THISFORM.TEXT5.ENABLED = .T.
THISFORM.TEXT6.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .T.
THISFORM.TEXT8.ENABLED = .T.
THISFORM.TEXT11.ENABLED = .T.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
ENDPROC
**
*
*  acc_harian_aro_detail.scx::Command2
**
PROCEDURE Click
THISFORM.TEXT5.ENABLED = .F.
THISFORM.TEXT6.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT11.ENABLED = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THIS.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
ENDPROC
**
*
*  acc_harian_aro_detail.scx::Command3
**
PROCEDURE Click
SELECT (THISFORM.DBF)
REPLACE CARAHITUNG WITH THISFORM.TEXT4.VALUE
REPLACE RATE WITH THISFORM.TEXT5.VALUE
REPLACE LAMA WITH THISFORM.TEXT6.VALUE
REPLACE TGLAWAL WITH THISFORM.TEXT7.VALUE
REPLACE TGLJTEMPO WITH THISFORM.TEXT8.VALUE
REPLACE ARO WITH THISFORM.TEXT11.VALUE
CSQL = "update acc_harian_dep_aro set "+"carahitung='"+THISFORM.TEXT4.VALUE+"', "+"rate='"+TRANSFORM(THISFORM.TEXT5.VALUE, '999.99')+"', "+"lama='"+STR(THISFORM.TEXT6.VALUE)+"', "+"tglawal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"', "+"tgljtempo='"+SQLDATE(THISFORM.TEXT8.VALUE)+"' "+"aro='"+THISFORM.TEXT11.VALUE+"' "+"where iddata='"+STR(IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_aro_detail.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_aro_detail.scx::Text6
**
PROCEDURE LostFocus
THISFORM.TEXT7.VALUE = THISFORM.TEXT9.VALUE
ENDPROC
**
*
*  acc_harian_aro_detail.scx::Text11
**
PROCEDURE LostFocus
IF  .NOT. (THIS.VALUE='Y' .OR. THIS.VALUE='T')
MESSAGEBOX("ARO harus berisi Y / T", 0, "")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** acc_harian_aro_detail.sct
***
*
***
*** tab_perpanjangan_aro.frx
***
*
***
*** tab_perpanjangan_aro.frt
***
*
***
*** acc_harian_catatan.scx
***
*
*
*  acc_harian_catatan.scx::FORM1
**
PROCEDURE tampil
THISFORM.TEXT1.VALUE = DEPT
THISFORM.TEXT2.VALUE = NOREK
THISFORM.EDIT1.VALUE = CATATAN
OLDSELE = SELECT()
DO CASE
CASE DEPT='ANG'
THISFORM.LABEL2.CAPTION = "NOMOR ANGGOTA"
CSQL = "select nama from anggota where cif='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT3.VALUE = NAMA
USE
CASE DEPT="PIN"
THISFORM.LABEL2.CAPTION = "NOMOR REKENING"
CSQL = "select nama from pinjaman as a left join anggota as b on a.cif=b.cif where norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT3.VALUE = NAMA
USE
CASE DEPT="SIM"
THISFORM.LABEL2.CAPTION = "NOMOR REKENING"
CSQL = "select nama from simpanan as a left join anggota as b on a.cif=b.cif where norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT3.VALUE = NAMA
USE
OTHERWISE
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.TEXT3.VISIBLE = .F.
ENDCASE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
ENDIF
THISFORM.BORDERSTYLE = 2
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
CSQL = "select * from acc_harian_catatan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 5
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 60
.COLUMN1.CONTROLSOURCE = "DEPT"
.COLUMN1.HEADER1.CAPTION = "BAGIAN"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 70
.COLUMN2.CONTROLSOURCE = "TANGGAL"
.COLUMN2.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "NOREK"
.COLUMN3.HEADER1.CAPTION = "NOREK"
.COLUMN3.ALIGNMENT = 1
.COLUMN4.WIDTH = 200
.COLUMN4.CONTROLSOURCE = "CATATAN"
.COLUMN4.HEADER1.CAPTION = "CATATAN"
.COLUMN4.ALIGNMENT = 1
.COLUMN5.WIDTH = 100
.COLUMN5.CONTROLSOURCE = "TRANS(JUMLAH,'999,999,999,999')"
.COLUMN5.HEADER1.CAPTION = "JUMLAH"
.COLUMN5.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.TAMPIL()
THISFORM.GRID1.SETFOCUS
ENDPROC
**
*
*  acc_harian_catatan.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.TAMPIL()
ENDPROC
**
*
*  acc_harian_catatan.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** acc_harian_catatan.sct
***
*
***
*** setting3.scx
***
*
*
*  setting3.scx::FORM1
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
ENDPROC
**
PROCEDURE simpan
PARAMETER MIDDATA, MDATA
OLDSELE = SELECT()
CSQL = "select ket2 from setsandi where ket2='"+MIDDATA+"' and kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal Baca setsandi")
ENDIF
IF KET2=MIDDATA
CSQL = "update setsandi set keterangan='"+MDATA+"' where ket2='"+MIDDATA+"' and kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into setsandi (kantor,kode,sandi,ket2,keterangan) value "+"('"+DEFAKANTOR+"','SYS','PUB','"+MIDDATA+"','"+MDATA+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  setting3.scx::Command1
**
PROCEDURE Click
THISFORM.SIMPAN("PROS_MIGRASI", THISFORM.TEXT1.VALUE)
ENDPROC
**
***
*** setting3.sct
***
*
***
*** tab_autodebet.frx
***
*
***
*** tab_autodebet.frt
***
*
***
*** pinjaman_cekhitung.scx
***
*
*
*  pinjaman_cekhitung.scx::FORM1
**
PROCEDURE Init
MNOREK = '01.302.05204.1'
THISFORM.SETALL("fontname", "Cambria", "Textbox")
CSQL = "select SUM(pokok) as pokok, SUM(jasa) as jasa from pinjaman_jadwal where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT2.VALUE = POKOK
THISFORM.TEXT4.VALUE = JASA
CSQL = "select SUM(pokok) as pokok, SUM(jasa) as jasa from pinjaman_mutasi where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT6.VALUE = POKOK
THISFORM.TEXT8.VALUE = JASA
THISFORM.TEXT10.VALUE = THISFORM.TEXT2.VALUE-THISFORM.TEXT6.VALUE
THISFORM.TEXT17.VALUE = THISFORM.TEXT4.VALUE-THISFORM.TEXT8.VALUE
MCUR = SALDOKRD(MNOREK, TGLNOW)
SELECT (MCUR)
THISFORM.TEXT1.VALUE = JUMJDWPK
THISFORM.TEXT3.VALUE = JUMJDWBG
THISFORM.TEXT9.VALUE = CEILING(KALIPK)
THISFORM.TEXT16.VALUE = CEILING(KALIBG)
THISFORM.TEXT5.VALUE = THISFORM.TEXT1.VALUE-THISFORM.TEXT9.VALUE
THISFORM.TEXT7.VALUE = THISFORM.TEXT3.VALUE-THISFORM.TEXT16.VALUE
THISFORM.TEXT19.VALUE = KOL
THISFORM.TEXT20.VALUE = IIF(KOL='1', 'LANCAR', IIF(KOL='2', 'KURANG LANCAR', IIF(KOL='3', 'DIRAGUKAN', 'MACET')))
THISFORM.TEXT11.VALUE = JAMINAN
THISFORM.TEXT21.VALUE = IIF(KOL='1', 0.5 , IIF(KOL='2', 10, IIF(KOL='3', 50, 100)))
CSQL = "select tgljtempo from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJT = CEILING(TGLNOW-TGLJTEMPO)/28
THISFORM.TEXT18.VALUE = MAX(MJT, 0)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  pinjaman_cekhitung.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** pinjaman_cekhitung.sct
***
*
***
*** krd_blmbayar.frx
***
*
***
*** krd_blmbayar.frt
***
*
***
*** krd_penerimaan_angs.frx
***
*
***
*** krd_penerimaan_angs.frt
***
*
***
*** akt_labarugi_perbandingan1.frx
***
*
***
*** akt_labarugi_perbandingan1.frt
***
*
***
*** pros2.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
**
FUNCTION ijinmenu
PARAMETER MMENUNAMA
IJIN = .F.
MN = IIF(MMENUNAMA="SET", 1, IIF(MMENUNAMA="MASTER", 2, IIF(MMENUNAMA="TRANSAKSI", 3, IIF(MMENUNAMA="LAPORAN", 4, IIF(MMENUNAMA="PROSES", 5, IIF(MMENUNAMA="UTILITY", 6, 7))))))
IF MMENUNAMA="USER"
IJIN = AT('1', DEFAHAKUSER)
IJIN = IIF(IJIN>0, "1", "0")
ELSE
IJIN = SUBSTR(DEFAHAKMENU, MN, 1)
ENDIF
IJIN = IIF(IJIN="1", .T., .F.)
RETURN IJIN
ENDFUNC
**
FUNCTION ijinmodul
PARAMETER MMENUNAMA, MAKSES
IJIN = .F.
MN = IIF(MAKSES="VIEW", 1, IIF(MAKSES="INPUT", 2, IIF(MAKSES="EDIT", 3, IIF(MAKSES="HAPUS", 4, IIF(MAKSES="CATATAN", 5, IIF(MAKSES="CETAK", 6, IIF(MAKSES="ADMIN", 7, 8)))))))
IF MAKSES="ALL"
DO CASE
CASE MMENUNAMA="ANGG"
IJIN = IIF(ALLTRIM(DEFAHAKANGG)='1111111', .T., .F.)
CASE MMENUNAMA="SIMP"
IJIN = IIF(ALLTRIM(DEFAHAKSIMP)='1111111', .T., .F.)
CASE MMENUNAMA="PINJ"
IJIN = IIF(ALLTRIM(DEFAHAKPINJ)='1111111', .T., .F.)
CASE MMENUNAMA="KAS"
IJIN = IIF(ALLTRIM(DEFAHAKKAS)='1111111', .T., .F.)
CASE MMENUNAMA="AKT"
IJIN = IIF(ALLTRIM(DEFAHAKAKT)='1111111', .T., .F.)
CASE MMENUNAMA="COL"
IJIN = IIF(ALLTRIM(DEFAHAKCOL)='1111111', .T., .F.)
CASE MMENUNAMA="USER"
IJIN = IIF(ALLTRIM(DEFAHAKUSER)='1111111', .T., .F.)
CASE MMENUNAMA="SET"
IJIN = IIF(ALLTRIM(DEFAHAKSET)='1111111', .T., .F.)
ENDCASE
ELSE
DO CASE
CASE MMENUNAMA="ANGG"
IJIN = SUBSTR(DEFAHAKANGG, MN, 1)
CASE MMENUNAMA="SIMP"
IJIN = SUBSTR(DEFAHAKSIMP, MN, 1)
CASE MMENUNAMA="PINJ"
IJIN = SUBSTR(DEFAHAKPINJ, MN, 1)
CASE MMENUNAMA="KAS"
IJIN = SUBSTR(DEFAHAKKAS, MN, 1)
CASE MMENUNAMA="AKT"
IJIN = SUBSTR(DEFAHAKAKT, MN, 1)
CASE MMENUNAMA="COL"
IJIN = SUBSTR(DEFAHAKCOL, MN, 1)
CASE MMENUNAMA="USER"
IJIN = SUBSTR(DEFAHAKUSER, MN, 1)
CASE MMENUNAMA="SET"
IJIN = SUBSTR(DEFAHAKSET, MN, 1)
OTHERWISE
IJIN = "0"
ENDCASE
IJIN = IIF(IJIN="1", .T., .F.)
ENDIF
RETURN IJIN
ENDFUNC
**
FUNCTION ijinLap
PARAMETER MMENUNAMA
IJIN = .F.
MN = IIF(MMENUNAMA="ANGG", 1, IIF(MMENUNAMA="SIMP", 2, IIF(MMENUNAMA="PINJ", 3, IIF(MMENUNAMA="KAS", 4, IIF(MMENUNAMA="AKT", 5, IIF(MMENUNAMA="LAIN", 6, 7))))))
IJIN = SUBSTR(DEFAHAKMENU, MN, 1)
IJIN = IIF(IJIN="1", .T., .F.)
RETURN IJIN
ENDFUNC
**
FUNCTION ijinACC
IJIN = (IJINMODUL("ANGG", "ADMIN") .OR. IJINMODUL("SIMP", "ADMIN") .OR. IJINMODUL("PINJ", "ADMIN") .OR. IJINMODUL("AKT", "ADMIN") .OR. IJINMODUL("LAIN", "ADMIN"))
RETURN IJIN
ENDFUNC
**
PROCEDURE xpass
IF IJINMENU("USER")
DO FORM atur_user
ELSE
DO FORM atur_pass_ganti WITH 'EDIT'
ENDIF
RETURN
ENDPROC
**
PROCEDURE accxa30
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE accxa31
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE accxa32
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE prosharian
LPARAMETERS MPARA
DO FORM proses_harian2 WITH MPARA
ENDPROC
**
PROCEDURE prosBulanan
DO FORM proses_bulanan
ENDPROC
**
PROCEDURE prosTahunan
DO FORM proses_tahunan
ENDPROC
**
PROCEDURE xlogPass
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE xLogEdit
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE xLOgDelete
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE xLOgBackDate
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE xLOgNonKas
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** acc_harian_admsimpanan.scx
***
*
*
*  acc_harian_admsimpanan.scx::FORM1
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = KETERANGAN
DO CASE
CASE JENIS='S01'
THISFORM.TEXT2.VALUE = "PROSES JASA SIMPANAN TABUNGAN"
CASE JENIS='S02'
THISFORM.TEXT2.VALUE = "PROSES JASA SIMPANAN BERJANGKA"
CASE JENIS='S03'
THISFORM.TEXT2.VALUE = "PROSES ADMINISTRASI SIMPANAN"
CASE JENIS='S4'
THISFORM.TEXT2.VALUE = "PROSES AKRUAL JASA SIMPANAN BERJANGKA"
CASE JENIS='S05'
THISFORM.TEXT2.VALUE = "PROSES AUTODEBET SIMPANAN"
ENDCASE
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
CSQL = "select SUM(adm) as adm from acc_harian_admsimpanan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
THISFORM.TEXT3.VALUE = ADM
CSQL = "select * from acc_harian_admsimpanan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 3
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NOREK"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 300
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 90
.COLUMN3.CONTROLSOURCE = "TRANS(ADM,'9,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "ADM"
.COLUMN3.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_harian_admsimpanan.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_admsimpanan.scx::Command4
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM frm_bukti TO MBUKTI WITH THISFORM.TEXT1.VALUE
IF  .NOT. EMPTY(MBUKTI)
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTGL = TANGGAL
MADM = ADM
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
USE
IF MADM>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABADM+"','"+"ADM SIMPANAN"+"','"+STR(MADM)+"','"+STR(0)+"','"+TRANSFORM(MSALDO-MADM, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(MTGL)+"', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT sum(adm ) AS adm, jurtab,juradm FROM acc_harian_admsimpanan where kel_id='"+STR(MIDDATA)+"' GROUP BY produk"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURTAB+"','ADM SIMPANAN','"+TRANSFORM(ADM, '999999999999')+"','"+MOPTACC+"'), "
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURADM+"','ADM SIMPANAN','"+TRANSFORM(0-(ADM), '999999999999')+"','"+MOPTACC+"')"
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, JURTAB, MTGL)
HITNERACA(DEFAKANTOR, JURADM, MTGL)
SELECT SMT
SKIP
ENDDO
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_admsimpanan.scx::Command5
**
PROCEDURE Click
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(TANGGAL)+"' and kode='S03' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_bungasimpanan where tanggal='"+SQLDATE(TANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_admsimpanan.scx::Label8
**
PROCEDURE Click
REPORT FORM acc_admsimpanan PREVIEW
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
*
*  acc_harian_admsimpanan.scx::Label9
**
PROCEDURE Click
REPORT FORM tab_pemberianbungatab_rekap PREVIEW
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
***
*** acc_harian_admsimpanan.sct
***
*
***
*** tab_admtab_rekap.frx
***
*
***
*** tab_admtab_rekap.frt
***
*
***
*** tab_adm_tab.frx
***
*
***
*** tab_adm_tab.frt
***
*
***
*** ctk_validasi.frx
***
*
***
*** ctk_validasi.frt
***
*
***
*** form_pbk.scx
***
*
*
*  form_pbk.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MDEPT, MNOREK, MKODE, MBGDEP
IF PARAMETERS()=1
MNOREK = ''
MKODE = 0
ENDIF
THISFORM.KDPOKOK = MBGDEP
THISFORM.OLDSELECT = SELECT()
THISFORM.DEPT = MDEPT
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.KODE = MKODE
IF MDEPT="SIMP"
CSQL = "select nama,jenis,produk,phone from simpanan as a left join anggota as b on a.cif=b.cif where norek=?mnorek"
LCEK = SQLEXEC(OODBC, CSQL, "PBK")
THISFORM.TEXT2.VALUE = NAMA
MJENIS = JENIS
MPRODUK = PRODUK
THISFORM.PRODUK = PRODUK
THISFORM.JENIS = JENIS
THISFORM.PHONE = PHONE
CSQL = "select saldo from simpanan_mutasi where iddata=("+"select MAX(iddata) from simpanan_mutasi where norek=?mnorek)"
LCEK = SQLEXEC(OODBC, CSQL, "PBK")
THISFORM.SALDO = SALDO
MSALDO = SALDO
USE
STORE 0 TO MBLOKIR, MSALDOMINIMAL
CSQL = "select blokirsemua from simpanan_blokir where norek=?mnorek and tglcabut='0000-00-00' and blokirsemua='Y'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
MBLOKIR = MSALDO
ELSE
CSQL = "select SUM(saldoblokir) as blokir from simpanan_blokir where norek=?mnorek and tglcabut='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBLOKIR = IIF(ISNULL(BLOKIR), 0, BLOKIR)
ENDIF
IF MJENIS='1'
CSQL = "select saldominimal from setsandi_tab where sandi=?mproduk"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MSALDOMINIMAL = SALDOMINIMAL
ENDIF
MMAXAMBIL = MSALDO-MBLOKIR-MSALDOMINIMAL
MMAXAMBIL = MAX(MMAXAMBIL, 0)
THISFORM.TEXT3.VALUE = MMAXAMBIL
THISFORM.MAX_MTS = IIF(ISNULL(MMAXAMBIL), 0, MMAXAMBIL)
ENDIF
IF MDEPT="DEP"
MBGDEP = IIF(MBGDEP=1, 1, 2)
CSQL = "select nama,jenis,produk,phone from simpanan as a left join anggota as b on a.cif=b.cif where norek=?mnorek"
LCEK = SQLEXEC(OODBC, CSQL, "PBK")
THISFORM.TEXT2.VALUE = NAMA
MJENIS = JENIS
MPRODUK = PRODUK
THISFORM.PRODUK = PRODUK
THISFORM.JENIS = JENIS
THISFORM.PHONE = PHONE
IF MBGDEP=1
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek=?mnorek"+" and (kode='"+ALLTRIM(DEFADEPSTOR)+"' or kode='"+ALLTRIM(DEFADEPAMBPK)+"' or kode='"+ALLTRIM(DEFADEPPBKPK1)+"' or kode='"+ALLTRIM(DEFADEPPBKPK2)+"')) "
LCEK = SQLEXEC(OODBC, CSQL, "PBK")
ELSE
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek=?mnorek"+" and (kode='"+ALLTRIM(DEFADEPBG)+"' or kode='"+ALLTRIM(DEFADEPPJK)+"' or kode='"+ALLTRIM(DEFADEPAMBBG)+"' or kode='"+ALLTRIM(DEFADEPPBKBG)+"')) "
LCEK = SQLEXEC(OODBC, CSQL, "PBK")
ENDIF
THISFORM.SALDO = SALDO
MSALDO = SALDO
USE
STORE 0 TO MBLOKIR, MSALDOMINIMAL
CSQL = "select blokirsemua from simpanan_blokir where norek=?mnorek and tglcabut='0000-00-00' and blokirsemua='Y'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
MBLOKIR = MSALDO
ELSE
CSQL = "select SUM(saldoblokir) as blokir from simpanan_blokir where norek=?mnorek and tglcabut='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBLOKIR = IIF(ISNULL(BLOKIR), 0, BLOKIR)
ENDIF
MMAXAMBIL = MSALDO-MBLOKIR
THISFORM.TEXT3.VALUE = MMAXAMBIL
THISFORM.MAX_MTS = IIF(ISNULL(MMAXAMBIL), 0, MMAXAMBIL)
ENDIF
IF MDEPT="PINJ"
CSQL = "select kdhit,tglvaluta,jenis,pokok,nama from pinjaman as a left join anggota as b on a.cif=b.cif where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PBK")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.PRODUK = JENIS
THISFORM.KDHIT = KDHIT
MPLAFON = POKOK
MMAX = 0
THISFORM.SALDO = 0
IF THISFORM.KODE=1 .AND.  .NOT. EMPTY(TGLVALUTA)
MESSAGEBOX("Pinjaman Sudah Di Realisasi", 0, "")
THISFORM.RELEASE
ENDIF
IF THISFORM.KODE=2
CSQL = "select SUM(debet) as debet,SUM(kredit) as kredit from pinjaman_mutasi where norek=?mnorek group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "PBK")
MMAX = MPLAFON-(IIF(ISNULL(DEBET), 0, DEBET)-IIF(ISNULL(KREDIT), 0, KREDIT))
THISFORM.SALDO = IIF(ISNULL(DEBET), 0, DEBET)-IIF(ISNULL(KREDIT), 0, KREDIT)
ELSE
MMAX = MPLAFON
ENDIF
THISFORM.TEXT3.VALUE = MMAX
THISFORM.MAX_MTS = MMAX
USE
ENDIF
IF MDEPT="ANGS"
THISFORM.VAR1 = POKOK
THISFORM.VAR2 = JASA
THISFORM.VAR3 = DENDA
MANGPK = POKOK
MANGBG = JASA
CSQL = "select kdhit,tglvaluta,jenis,pokok,nama from pinjaman as a left join anggota as b on a.cif=b.cif where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PBK")
IF LCEK<1
ENDIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = MANGPK+MANGBG
THISFORM.PRODUK = JENIS
THISFORM.KDHIT = KDHIT
MPLAFON = MANGPK+MANGBG
MMAX = MPLAFON
THISFORM.SALDO = MPLAFON
THISFORM.TEXT3.VALUE = MMAX
THISFORM.MAX_MTS = MMAX
USE
ENDIF
IF MDEPT="AKT"
THISFORM.LABEL3.CAPTION = "Nomor Perkiraan"
THISFORM.LABEL5.CAPTION = "Jumlah"
THISFORM.TEXT1.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT3.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .F.
ENDIF
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.HASIL
ENDFUNC
**
*
*  form_pbk.scx::Text1
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
IF THISFORM.DEPT="AKT"
OLDSELECT = SELECT()
IF THIS.VALUE=TRANSFORM(" ", DEFAFMTAKT)
DO FORM ./form/setsandi TO MNOPER WITH "GL01"
IF EMPTY(MNOPER)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ELSE
MNOPER = THIS.VALUE
ENDIF
CSQL = "select noper,nama,kel,detail from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Kode Perkiraan tidak terbaca")
ENDIF
IF RECCOUNT()>0 .AND. DETAIL='Y'
THIS.VALUE = MNOPER
THISFORM.TEXT2.VALUE = NAMA
SELECT SMT
USE
SELECT (OLDSELECT)
ELSE
MESSAGEBOX("Kode Perkiraan tidak ada, Atau nomor tidak dapat digunakan transaksi")
NODEFAULT
THIS.SETFOCUS
SELECT SMT
USE
SELECT (OLDSELECT)
RETURN
ENDIF
ENDIF
ENDPROC
**
*
*  form_pbk.scx::Text3
**
PROCEDURE LostFocus
IF THISFORM.DEPT="AKT"
THISFORM.TEXT7.VALUE = THIS.VALUE
ENDIF
ENDPROC
**
*
*  form_pbk.scx::Combo1
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
NODEFAULT
RETURN
ENDIF
THISFORM.LABEL13.VISIBLE = .T.
THISFORM.LABEL14.VISIBLE = .T.
THISFORM.TEXT4.VISIBLE = .T.
THISFORM.TEXT11.VISIBLE = .T.
THISFORM.LABEL15.VISIBLE = .T.
THISFORM.TEXT12.VISIBLE = .T.
THISFORM.LABEL7.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.LABEL8.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.LABEL9.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.LABEL10.VISIBLE = .F.
THISFORM.LABEL11.VISIBLE = .F.
THISFORM.LABEL12.VISIBLE = .F.
THISFORM.TEXT8.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.TEXT10.VISIBLE = .F.
THISFORM.TEXT5.VALUE = ""
THISFORM.TEXT4.VALUE = TGLNOW
DO CASE
CASE THIS.VALUE="SIMPANAN"
THISFORM.LABEL7.VISIBLE = .T.
THISFORM.TEXT5.VISIBLE = .T.
THISFORM.LABEL8.VISIBLE = .T.
THISFORM.TEXT6.VISIBLE = .T.
THISFORM.LABEL9.VISIBLE = .T.
THISFORM.TEXT7.VISIBLE = .T.
THISFORM.LABEL7.CAPTION = "Nomor Rekening"
THISFORM.LABEL8.CAPTION = "Atas Nama"
THISFORM.TEXT5.INPUTMASK = DEFAFMTSIMP
CASE THIS.VALUE="PINJAMAN"
THISFORM.LABEL7.VISIBLE = .T.
THISFORM.TEXT5.VISIBLE = .T.
THISFORM.LABEL8.VISIBLE = .T.
THISFORM.TEXT6.VISIBLE = .T.
THISFORM.LABEL9.VISIBLE = .T.
THISFORM.TEXT7.VISIBLE = .T.
THISFORM.LABEL10.VISIBLE = .T.
THISFORM.LABEL11.VISIBLE = .T.
THISFORM.LABEL12.VISIBLE = .T.
THISFORM.TEXT8.VISIBLE = .T.
THISFORM.TEXT9.VISIBLE = .T.
THISFORM.TEXT10.VISIBLE = .T.
THISFORM.LABEL7.CAPTION = "Nomor Rekening"
THISFORM.LABEL8.CAPTION = "Atas Nama"
THISFORM.TEXT5.INPUTMASK = DEFAFMTPINJ
CASE THIS.VALUE="AKUNTANSI"
THISFORM.LABEL7.VISIBLE = .T.
THISFORM.TEXT5.VISIBLE = .T.
THISFORM.LABEL8.VISIBLE = .T.
THISFORM.TEXT6.VISIBLE = .T.
THISFORM.LABEL9.VISIBLE = .T.
THISFORM.TEXT7.VISIBLE = .T.
THISFORM.LABEL7.CAPTION = "No. Perkiraan"
THISFORM.LABEL8.CAPTION = "Nama Perkiraan"
THISFORM.TEXT5.INPUTMASK = DEFAFMTAKT
THISFORM.TEXT6.ENABLED = .F.
ENDCASE
IF THISFORM.DEPT="PINJ" .AND. THISFORM.KODE=1
THISFORM.TEXT7.VALUE = THISFORM.TEXT3.VALUE
ENDIF
IF THISFORM.DEPT="ANGS"
THISFORM.TEXT7.VALUE = THISFORM.TEXT3.VALUE
ENDIF
IF THISFORM.DEPT="PINJ"
IF THISFORM.TEXT3.VALUE<=0
MESSAGEBOX("Plafon pinjaman sudah habis", 0, '')
NODEFAULT
ENDIF
ENDIF
IF THISFORM.DEPT="SIMP"
IF THISFORM.TEXT3.VALUE<=0
MESSAGEBOX("Saldo Sudah Habis / Tidak dapat melakukan transaksi", 0, '')
NODEFAULT
ENDIF
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDITEM("SIMPANAN")
THIS.ADDITEM("PINJAMAN")
THIS.ADDITEM("AKUNTANSI")
ENDPROC
**
*
*  form_pbk.scx::Text5
**
PROCEDURE LostFocus
DO CASE
CASE THISFORM.COMBO1.VALUE="SIMPANAN"
IF THIS.VALUE=TRANSFORM(" ", DEFAFMTPINJ)
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ELSE
MNOREK = THIS.VALUE
ENDIF
CSQL = "select a.*,b.* from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOREK=ALLTRIM(MNOREK)
THISFORM.TEXT6.VALUE = NAMA
ELSE
NODEFAULT
RETURN
ENDIF
CASE THISFORM.COMBO1.VALUE="PINJAMAN"
IF THIS.VALUE=TRANSFORM(" ", DEFAFMTSIMP)
DO FORM pinjaman TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ELSE
MNOREK = THIS.VALUE
ENDIF
CSQL = "select nama,kdhit,pokok from pinjaman as a, anggota as b  where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT6.VALUE = NAMA
MPOKOKAWAL = POKOK
IF KDHIT="H"
THISFORM.TEXT8.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.TEXT10.VISIBLE = .F.
THISFORM.LABEL10.VISIBLE = .F.
THISFORM.LABEL11.VISIBLE = .F.
THISFORM.LABEL12.VISIBLE = .F.
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from pinjaman_mutasi "+"where norek='"+THISFORM.TEXT5.VALUE+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDOPINJ = DEBET-KREDIT
IF MSALDOPINJ>THISFORM.TEXT3.VALUE
MESSAGEBOX("Pindah Buku melebihi Saldo Pinjaman")
ENDIF
ENDIF
CASE THISFORM.COMBO1.VALUE="AKUNTANSI"
IF THIS.VALUE=TRANSFORM(" ", DEFAFMTAKT)
DO FORM ./form/setsandi TO MNOPER WITH "GL01"
THIS.VALUE = MNOPER
ELSE
MNOPER = THIS.VALUE
ENDIF
CSQL = "select nama from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.TEXT6.VALUE = NAMA
ENDCASE
ENDPROC
**
*
*  form_pbk.scx::Text7
**
PROCEDURE LostFocus
IF THIS.VALUE>THISFORM.TEXT3.VALUE
MESSAGEBOX("Pengambilan Melebihi Batas Ketentuan")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  form_pbk.scx::Text8
**
PROCEDURE InteractiveChange
THISFORM.TEXT10.VALUE = THISFORM.TEXT7.VALUE-THISFORM.TEXT8.VALUE-THISFORM.TEXT9.VALUE
ENDPROC
**
*
*  form_pbk.scx::Text9
**
PROCEDURE InteractiveChange
THISFORM.TEXT10.VALUE = THISFORM.TEXT7.VALUE-THISFORM.TEXT8.VALUE-THISFORM.TEXT9.VALUE
ENDPROC
**
*
*  form_pbk.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  form_pbk.scx::Command2
**
PROCEDURE Click
IF THISFORM.TEXT7.VALUE>DEFABATASKAS
MBAG = IIF(THISFORM.DEPT="SIMP", "SIMPANAN", IIF(THISFORM.DEPT="PINJ", "PINJAMAN", "AKUNTANSI"))
DO WHILE .T.
MKATA = IIF(THISFORM.DEPT="AKT", "NO.PERKIRAAN  	", "NOMOR REKENING	")
MKETACC = "OVERBOOKING "+MBAG+CHR(13)+"---------------------------------------------------"+CHR(13)+MKATA+": "+THISFORM.TEXT1.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT2.VALUE+CHR(13)+"		TRANS.DEBET	: "+TRANSFORM(THISFORM.TEXT7.VALUE, "999,999,999,999")+CHR(13)+"---------------------------------------------------"+CHR(13)
DO CASE
CASE THISFORM.COMBO1.VALUE="SIMPANAN"
MKETACC = "NOMOR REKENING	: "+THISFORM.TEXT5.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT6.VALUE+CHR(13)+"		TRANS.DEBET	: "+TRANSFORM(THISFORM.TEXT7.VALUE, "999,999,999,999")+CHR(13)
CASE THISFORM.COMBO1.VALUE="PINJAMAN"
MKETACC = "NOMOR REKENING	: "+THISFORM.TEXT5.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT6.VALUE+CHR(13)+"		      POKOK : "+TRANSFORM(THISFORM.TEXT8.VALUE, "999,999,999,999")+CHR(13)+"		      JASA  : "+TRANSFORM(THISFORM.TEXT9.VALUE, "999,999,999,999")+CHR(13)+"		      DENDA : "+TRANSFORM(THISFORM.TEXT10.VALUE, "999,999,999,999")+CHR(13)
CASE THISFORM.COMBO1.VALUE="AKUNTANSI"
MKETACC = "NO.PERKIRAAN  	: "+THISFORM.TEXT5.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT6.VALUE+CHR(13)+"		     JUMLAH : "+TRANSFORM(THISFORM.TEXT7.VALUE, "999,999,999,999")+CHR(13)
ENDCASE
HASIL = 1
EXIT
ENDDO
IF HASIL=2
RETURN
ENDIF
ENDIF
DO CASE
CASE THISFORM.DEPT="SIMP"
CSQL = "select jurnaltab from setsandi_tab where jenis='"+THISFORM.JENIS+"' and sandi='"+THISFORM.PRODUK+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNAL1 = JURNALTAB
USE
IF THISFORM.JENIS='1'
MKDMTS = DEFATABPBK
ELSE
MKDMTS = DEFADEPPBKPK2
MKDMTS2 = DEFADEPPBKBG
ENDIF
MKET = IIF(EMPTY(THISFORM.TEXT12.VALUE), "OVB "+ALLTRIM(THISFORM.TEXT1.VALUE)+" KE :"+ALLTRIM(THISFORM.TEXT5.VALUE), THISFORM.TEXT12.VALUE)
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+THISFORM.TEXT11.VALUE+"',"+"'"+MKDMTS+"',"+"'"+MKET+"',"+"'"+TRANSFORM(THISFORM.TEXT7.VALUE, "999999999999999")+"',"+"'"+STR(0)+"',"+"'"+TRANSFORM(THISFORM.TEXT3.VALUE-THISFORM.TEXT7.VALUE, '999999999999999')+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
CSQLJUR = "('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL1+"','"+MKET+"','"+TRANSFORM(THISFORM.TEXT7.VALUE, "999999999999999")+"'), "
IF ALLTRIM(DEFANOTIFIKASI)='1'
CSQL = "select cif,sms_stor,sms_ambil from simpanan where norek='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSMS_STOR = SMS_STOR
MSMS_AMBIL = SMS_AMBIL
MCIF = CIF
DEFADBFSMS = ALLTRIM(DEFADBFSMS)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFJML'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBATASNOTIF = VAL(KETERANGAN)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFKATA2'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKATAAMBIL = ALLTRIM(KETERANGAN)
MPHONE = THISFORM.PHONE
MSLD = 0
MCTK = 'T'
IF MSMS_AMBIL=1 .AND. MBATASNOTIF<=THISFORM.TEXT7.VALUE
MKATA = MKATAAMBIL
MSLD = THISFORM.TEXT3.VALUE-THISFORM.TEXT7.VALUE
MCTK = 'Y'
ENDIF
IF MCTK='Y'
MNOREK0 = ALLTRIM(THISFORM.TEXT1.VALUE)
MKATA = STRTRAN(MKATA, "<<nama>>", ALLTRIM(THISFORM.TEXT2.VALUE))
MKATA = STRTRAN(MKATA, "<<norek>>", MNOREK0)
MKATA = STRTRAN(MKATA, "<<saldo>>", ALLTRIM(TRANSFORM(MSLD, "99,999,999,999")))
MKATA = STRTRAN(MKATA, "<<ambil>>", ALLTRIM(TRANSFORM(THISFORM.TEXT7.VALUE, "99,999,999,999")))
MKATA = STRTRAN(MKATA, "<<tanggal>>", DTOC(THISFORM.TEXT4.VALUE))
MKATA = STRTRAN(MKATA, "<<jam>>", TIME())
MKATA = STRTRAN(MKATA, "<<bukti>>", THISFORM.TEXT11.VALUE)
MKATA = STRTRAN(MKATA, "<<tunai>>", "OVERBOOKING")
CSQL = "insert into "+DEFADBFSMS+".outbox (Text,DestinationNumber) value (?mkata,?mphone)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDIF
CASE THISFORM.DEPT="DEP"
CSQL = "select jurnaltab,jurnalbunga from setsandi_tab where jenis='2' and sandi='"+THISFORM.PRODUK+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNAL1 = JURNALTAB
USE
IF THISFORM.KDPOKOK=1
MKDMTS = DEFADEPPBKPK
MJURNAL = MJURNAL1
ELSE
MKDMTS = DEFADEPPBKBG
MJURNAL = DEFANOPERTTPDEP
ENDIF
MKET = IIF(EMPTY(THISFORM.TEXT12.VALUE), "OVB "+ALLTRIM(THISFORM.TEXT1.VALUE)+" KE :"+ALLTRIM(THISFORM.TEXT5.VALUE), THISFORM.TEXT12.VALUE)
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+THISFORM.TEXT11.VALUE+"',"+"'"+MKDMTS+"',"+"'"+MKET+"',"+"'"+TRANSFORM(IIF(THISFORM.TEXT7.VALUE>0, THISFORM.TEXT7.VALUE, 0), "999999999999999")+"',"+"'"+TRANSFORM(IIF(THISFORM.TEXT7.VALUE>0, 0, 0-THISFORM.TEXT7.VALUE), "999999999999999")+"',"+"'"+TRANSFORM(THISFORM.TEXT3.VALUE-THISFORM.TEXT7.VALUE, '999999999999999')+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
CSQLJUR = "('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL+"','"+MKET+"','"+TRANSFORM(THISFORM.TEXT7.VALUE, "999999999999999")+"'), "
CASE THISFORM.DEPT="PINJ"
CSQL = "select jurnal_pokok from setsandi_pinj where sandi='"+THISFORM.PRODUK+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNAL1 = JURNAL_POKOK
USE
IF THISFORM.KODE=1
MKDMTS = DEFAPINTRK
MKET = IIF(EMPTY(THISFORM.TEXT12.VALUE), "OVB REAL."+ALLTRIM(THISFORM.TEXT1.VALUE)+" KE :"+ALLTRIM(THISFORM.TEXT5.VALUE), THISFORM.TEXT12.VALUE)
CSQL = "update pinjaman set tglvaluta='"+SQLDATE(THISFORM.TEXT4.VALUE)+"' where norek='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF THISFORM.KDHIT='H'
MKET = IIF(EMPTY(THISFORM.TEXT12.VALUE), "OVB TRK RK"+ALLTRIM(THISFORM.TEXT1.VALUE)+" KE :"+ALLTRIM(THISFORM.TEXT5.VALUE), THISFORM.TEXT12.VALUE)
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+THISFORM.TEXT11.VALUE+"',"+"'"+MKDMTS+"',"+"'"+TRANSFORM(THISFORM.TEXT7.VALUE, "999999999999999")+"',"+"'"+STR(0)+"',"+"'"+TRANSFORM(THISFORM.SALDO+THISFORM.TEXT7.VALUE, "999999999999999")+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
MESSAGEBOX(CSQL)
ENDIF
ELSE
MKDMTS = DEFAPINTRK
MKET = IIF(EMPTY(THISFORM.TEXT12.VALUE), "OVB TRK RK"+ALLTRIM(THISFORM.TEXT1.VALUE)+" KE :"+ALLTRIM(THISFORM.TEXT5.VALUE), THISFORM.TEXT12.VALUE)
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+THISFORM.TEXT11.VALUE+"',"+"'"+MKDMTS+"',"+"'"+TRANSFORM(THISFORM.TEXT7.VALUE, "999999999999999")+"',"+"'"+STR(0)+"',"+"'"+TRANSFORM(THISFORM.SALDO+THISFORM.TEXT7.VALUE, "999999999999999")+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
ENDIF
CSQLJUR = "('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL1+"','"+MKET+"','"+TRANSFORM(THISFORM.TEXT7.VALUE, "999999999999999")+"'), "
CASE THISFORM.DEPT="ANGS"
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,pokok,jasa,denda,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+THISFORM.TEXT11.VALUE+"',"+"'"+DEFAPINPBK+"',"+"'"+TRANSFORM(0-THISFORM.VAR1, "999999999999999")+"',"+"'"+TRANSFORM(0-THISFORM.VAR2, "999999999999999")+"',"+"'"+TRANSFORM(0-THISFORM.VAR3, "999999999999999")+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select jurnal_pokok,jurnal_jasa,jurnal_denda from setsandi_pinj where sandi='"+THISFORM.PRODUK+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNAL1 = JURNAL_POKOK
MJURNAL2 = JURNAL_JASA
MJURNAL3 = JURNAL_DENDA
USE
CSQLJUR = ""
MKET = "KOREKSI ANGS. AN."+ALLTRIM(THISFORM.TEXT2.VALUE)
IF THISFORM.VAR1>0
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL1+"','"+MKET+"','"+TRANSFORM(THISFORM.VAR1, "999999999999999")+"'), "
ENDIF
IF THISFORM.VAR2>0
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL2+"','"+MKET+"','"+TRANSFORM(THISFORM.VAR2, "999999999999999")+"'), "
ENDIF
IF THISFORM.VAR3>0
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL3+"','"+MKET+"','"+TRANSFORM(THISFORM.VAR3, "999999999999999")+"'), "
ENDIF
CASE THISFORM.DEPT="AKT"
MJURNAL1 = ALLTRIM(THISFORM.TEXT1.VALUE)
MKET = IIF(EMPTY(THISFORM.TEXT12.VALUE), "OVB."+ALLTRIM(THISFORM.TEXT1.VALUE)+" KE "+ALLTRIM(THISFORM.TEXT5.VALUE), THISFORM.TEXT12.VALUE)
CSQLJUR = "('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL1+"','"+MKET+"','"+TRANSFORM(THISFORM.TEXT7.VALUE, "999999999999999")+"'), "
ENDCASE
DO CASE
CASE THISFORM.COMBO1.VALUE="SIMPANAN"
CSQL = "select jenis,produk,phone from simpanan as a left join anggota as b on a.cif=b.cif where norek='"+THISFORM.TEXT5.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJENIS2 = JENIS
MPRODUK2 = PRODUK
MPHONE2 = PHONE
CSQL = "select jurnaltab from setsandi_tab where jenis='"+MJENIS2+"' and sandi='"+MPRODUK2+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNAL2A = JURNALTAB
USE
IF MJENIS2='1'
MKDMTS = DEFATABPBK
ELSE
MKDMTS = DEFADEPPBKPK2
MKDMTS2 = DEFADEPPBKBG
ENDIF
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi where "+"norek='"+THISFORM.TEXT5.VALUE+"' group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO2 = SALDO
MKET = IIF(EMPTY(THISFORM.TEXT12.VALUE), "OVB "+ALLTRIM(THISFORM.TEXT1.VALUE)+" KE: "+ALLTRIM(THISFORM.TEXT5.VALUE), THISFORM.TEXT12.VALUE)
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT5.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+THISFORM.TEXT11.VALUE+"',"+"'"+MKDMTS+"',"+"'"+MKET+"',"+"'"+TRANSFORM(0, "999999999999999")+"',"+"'"+TRANSFORM(THISFORM.TEXT7.VALUE, '999999999999999')+"',"+"'"+TRANSFORM(MSALDO2+THISFORM.TEXT7.VALUE, '999999999999999')+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL2A+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT7.VALUE, "999999999999999")+"')"
IF ALLTRIM(DEFANOTIFIKASI)='1'
CSQL = "select cif,sms_stor,sms_ambil from simpanan where norek='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSMS_STOR = SMS_STOR
MSMS_AMBIL = SMS_AMBIL
MCIF = CIF
DEFADBFSMS = ALLTRIM(DEFADBFSMS)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFJML'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBATASNOTIF = VAL(KETERANGAN)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFKATA1'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKATASTOR = ALLTRIM(KETERANGAN)
MPHONE = MPHONE2
MSLD = 0
MCTK = 'T'
IF MSMS_STOR=1 .AND. MBATASNOTIF<=THISFORM.TEXT7.VALUE
MKATA = MKATASTOR
MSLD = MSALDO2+THISFORM.TEXT7.VALUE
MCTK = 'Y'
ENDIF
IF MCTK='Y'
MNOREK0 = ALLTRIM(THISFORM.TEXT1.VALUE)
MKATA = STRTRAN(MKATA, "<<nama>>", ALLTRIM(THISFORM.TEXT2.VALUE))
MKATA = STRTRAN(MKATA, "<<norek>>", MNOREK0)
MKATA = STRTRAN(MKATA, "<<saldo>>", ALLTRIM(TRANSFORM(MSLD, "99,999,999,999")))
MKATA = STRTRAN(MKATA, "<<stor>>", ALLTRIM(TRANSFORM(THISFORM.TEXT7.VALUE, "99,999,999,999")))
MKATA = STRTRAN(MKATA, "<<tanggal>>", DTOC(THISFORM.TEXT4.VALUE))
MKATA = STRTRAN(MKATA, "<<jam>>", TIME())
MKATA = STRTRAN(MKATA, "<<bukti>>", THISFORM.TEXT11.VALUE)
MKATA = STRTRAN(MKATA, "<<tunai>>", "OVERBOOKING")
CSQL = "insert into "+DEFADBFSMS+".outbox (Text,DestinationNumber) value (?mkata,?mphone)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
CSQL = ''
ENDIF
ENDIF
CSQLJUR = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "+CSQLJUR
LCEK = SQLEXEC(OODBC, CSQLJUR)
IF LCEK<1
MESSAGEBOX(CSQLJUR)
ENDIF
HITNERACA(DEFAKANTOR, MJURNAL1, THISFORM.TEXT4.VALUE)
HITNERACA(DEFAKANTOR, MJURNAL2A, THISFORM.TEXT4.VALUE)
IF DEFAVALIDASI='1'
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/OB/"+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT7.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT11.VALUE)+'/'+DTOC(THISFORM.TEXT4.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = "DEBET : "+ALLTRIM(THISFORM.TEXT1.VALUE)+'/'+ALLTRIM(THISFORM.TEXT2.VALUE)
MBARIS3 = "KREDIT: "+ALLTRIM(THISFORM.TEXT5.VALUE)+'/'+ALLTRIM(THISFORM.TEXT6.VALUE)
MBARIS4 = MKET
CETAKVALIDASI(MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
CASE THISFORM.COMBO1.VALUE="PINJAMAN"
CSQL = "select jenis,phone,kdhit,pokok from pinjaman as a ,anggota as b where a.cif=b.cif and norek='"+ALLTRIM(THISFORM.TEXT5.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MPRODUK2 = JENIS
MPHONE2 = PHONE
MKDHIT = KDHIT
MPLAFON = POKOK
CSQL = "select jurnal_pokok,jurnal_jasa,jurnal_denda from setsandi_pinj where sandi='"+MPRODUK2+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNAL2A = JURNAL_POKOK
MJURNAL2B = JURNAL_JASA
MJURNAL2C = JURNAL_DENDA
USE
IF MKDHIT='H'
MKDMTS = DEFAPINPBK
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from pinjaman_mutasi where "+"norek='"+THISFORM.TEXT5.VALUE+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO2 = DEBET-KREDIT
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT5.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+THISFORM.TEXT11.VALUE+"',"+"'"+MKDMTS+"',"+"'"+TRANSFORM(0, "999999999999999")+"',"+"'"+TRANSFORM(THISFORM.TEXT7.VALUE, '999999999999999')+"',"+"'"+TRANSFORM(MSALDO2-THISFORM.TEXT7.VALUE, '999999999999999')+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL2A+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT7.VALUE, "999999999999999")+"')"
ELSE
MKDMTS = DEFAPINPBK
CSQL = "select SUM(pokok) as pokok, SUM(jasa) as jasa from pinjaman_mutasi where "+"norek='"+THISFORM.TEXT5.VALUE+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO2 = MPLAFON-POKOK
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,bukti,kode,pokok,jasa,denda,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT5.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+SQLDATE(THISFORM.TEXT4.VALUE)+"',"+"'"+THISFORM.TEXT11.VALUE+"',"+"'"+MKDMTS+"',"+"'"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"',"+"'"+TRANSFORM(THISFORM.TEXT9.VALUE, '999999999999999')+"',"+"'"+TRANSFORM(THISFORM.TEXT10.VALUE, '999999999999999')+"',"+"'OPT')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
IF THISFORM.TEXT8.VALUE>0
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL2A+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT8.VALUE, "999999999999999")+"'),"
ENDIF
IF THISFORM.TEXT9.VALUE>0
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL2B+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT9.VALUE, "999999999999999")+"'),"
ENDIF
IF THISFORM.TEXT10.VALUE>0
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL2C+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT10.VALUE, "999999999999999")+"'),"
ENDIF
CSQLJUR = LEFT(CSQLJUR, LEN(CSQLJUR)-1)
ENDIF
CSQLJUR = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "+CSQLJUR
LCEK = SQLEXEC(OODBC, CSQLJUR)
IF LCEK<1
MESSAGEBOX(CSQLJUR)
ENDIF
HITNERACA(DEFAKANTOR, MJURNAL1, THISFORM.TEXT4.VALUE)
HITNERACA(DEFAKANTOR, MJURNAL2A, THISFORM.TEXT4.VALUE)
HITNERACA(DEFAKANTOR, MJURNAL2B, THISFORM.TEXT4.VALUE)
HITNERACA(DEFAKANTOR, MJURNAL2C, THISFORM.TEXT4.VALUE)
IF DEFAVALIDASI='1'
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/OB/"+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT7.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT11.VALUE)+'/'+DTOC(THISFORM.TEXT4.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = "DEBET : "+ALLTRIM(THISFORM.TEXT1.VALUE)+'/'+ALLTRIM(THISFORM.TEXT2.VALUE)
MBARIS3 = "KREDIT: "+ALLTRIM(THISFORM.TEXT5.VALUE)+'/'+ALLTRIM(THISFORM.TEXT6.VALUE)
IF MKDHIT="H"
MBARIS4 = ""
ELSE
MBARIS4 = "        POKOK:"+ALLTRIM(TRANSFORM(THISFORM.TEXT8.VALUE, "999,999,999,999"))+"JASA:"+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, "999,999,999,999"))+"DENDA:"+ALLTRIM(TRANSFORM(THISFORM.TEXT10.VALUE, "999,999,999,999"))
ENDIF
CETAKVALIDASI(MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
CASE THISFORM.COMBO1.VALUE="AKUNTANSI"
MJURNAL2A = ALLTRIM(THISFORM.TEXT5.VALUE)
CSQLJUR = CSQLJUR+"('"+ALLTRIM(DEFAKANTOR)+"','"+SQLDATE(THISFORM.TEXT4.VALUE)+"','"+THISFORM.TEXT11.VALUE+"','"+MJURNAL2A+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT7.VALUE, "999999999999999")+"')"
CSQLJUR = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "+CSQLJUR
LCEK = SQLEXEC(OODBC, CSQLJUR)
IF LCEK<1
MESSAGEBOX(CSQLJUR)
ENDIF
HITNERACA(DEFAKANTOR, MJURNAL1, THISFORM.TEXT4.VALUE)
HITNERACA(DEFAKANTOR, MJURNAL2A, THISFORM.TEXT4.VALUE)
IF DEFAVALIDASI='1'
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/OB/"+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT7.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT11.VALUE)+'/'+DTOC(THISFORM.TEXT4.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = "DEBET : "+ALLTRIM(THISFORM.TEXT1.VALUE)+'/'+ALLTRIM(THISFORM.TEXT2.VALUE)
MBARIS3 = "KREDIT: "+ALLTRIM(THISFORM.TEXT5.VALUE)+'/'+ALLTRIM(THISFORM.TEXT6.VALUE)
MBARIS4 = MKET
CETAKVALIDASI(MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
ENDCASE
THISFORM.HASIL = .T.
THISFORM.RELEASE
ENDPROC
**
*
*  form_pbk.scx::Text11
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Bukti Tidak Boleh Kosong", 0, "")
NODEFAULT
RETURN
ENDIF
THISFORM.COMMAND2.ENABLED = .T.
ENDPROC
**
***
*** form_pbk.sct
***
*
***
*** akt_jurnal.frx
***
*
***
*** akt_jurnal.frt
***
*
***
*** anggota_data.scx
***
*
*
*  anggota_data.scx::FORM1
**
PROCEDURE foto
PARAMETER CFOTO, CTTD, CPARAF
OLDSELE = SELECT()
MFOTO = SYS(2023)+"\foto.jpg"
ERASE &MFOTO
MTTD = SYS(2023)+"\tandatangan.jpg"
ERASE &MFOTO
MPARAF = SYS(2023)+"\paraf.jpg"
ERASE &MFOTO
IF .T.
NHANDLE = FCREATE(MFOTO)
IF NHANDLE>0
FWRITE(NHANDLE, CFOTO)
FCLOSE(NHANDLE)
ELSE
MESSAGEBOX("xx")
ENDIF
ELSE
MFOTO = ''
ENDIF
THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE = MFOTO
THISFORM.PAGEFRAME1.PAGE1.TEXT21.VALUE = MFOTO
IF  .NOT. EMPTY(MTTD)
NHANDLE = FCREATE(MTTD)
IF NHANDLE>0
FWRITE(NHANDLE, CTTD)
FCLOSE(NHANDLE)
ENDIF
ENDIF
THISFORM.PAGEFRAME1.PAGE1.IMAGE2.PICTURE = MTTD
THISFORM.PAGEFRAME1.PAGE1.TEXT22.VALUE = MTTD
IF  .NOT. EMPTY(MPARAF)
NHANDLE = FCREATE(MPARAF)
IF NHANDLE>0
FWRITE(NHANDLE, CPARAF)
FCLOSE(NHANDLE)
ENDIF
ENDIF
THISFORM.PAGEFRAME1.PAGE1.IMAGE3.PICTURE = MPARAF
THISFORM.PAGEFRAME1.PAGE1.TEXT23.VALUE = MPARAF
ENDPROC
**
PROCEDURE Activate
CFOTO = CAST('' AS W )
CTTD = CAST('' AS W )
CPARAF = CAST('' AS W )
THISFORM.FOTO(CFOTO, CTTD, CPARAF)
ENDPROC
**
FUNCTION Unload
ERASE SYS(2023)+"\foto.jpg"
ERASE SYS(2023)+"\tandatangan.jpg"
ERASE SYS(2023)+"\paraf.jpg"
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDSELECT)
RETURN THISFORM.MYPILIH
ENDFUNC
**
PROCEDURE Init
PARAMETER MMODE, MIDDATA, MSTATUS
IF MSTATUS='A'
THISFORM.COMMAND10.CAPTION = "KELUAR"
ELSE
THISFORM.COMMAND10.CAPTION = "BTL KELUAR"
ENDIF
THISFORM.MODE = MMODE
THISFORM.COMMAND1.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
THISFORM.COMMAND4.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
THISFORM.COMMAND5.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
THISFORM.COMMAND6.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
THISFORM.COMMAND7.VISIBLE = (IJINMODUL("ANGG", "INPUT") .OR. IJINMODUL("ANGG", "EDIT") .OR. IJINMODUL("ANGG", "HAPUS"))
IF DEFAPROSMIGRASI<>"Y"
THISFORM.PAGEFRAME1.PAGE1.LABEL11.VISIBLE = .F.
THISFORM.PAGEFRAME1.PAGE1.LABEL13.VISIBLE = .F.
THISFORM.PAGEFRAME1.PAGE1.TEXT9.VISIBLE = .F.
THISFORM.PAGEFRAME1.PAGE1.TEXT11.VISIBLE = .F.
ENDIF
THISFORM.IDDATA = MIDDATA
THISFORM.OLDSELECT = SELECT()
THISFORM.DATA1 = SYS(2015)
DATA1 = THISFORM.DATA1
CSQL = "Select * from anggota where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, DATA1)
CFOTO = IIF(ISNULL(FOTO), '', CAST(FOTO AS W ))
CTTD = IIF(ISNULL(TANDATANGAN), '', CAST(TANDATANGAN AS W ))
CPARAF = IIF(ISNULL(PARAF), '', CAST(PARAF AS W ))
IF MMODE<>"INPUT"
ENDIF
THISFORM.COMMAND12.SETFOCUS
THISFORM.PAGEFRAME1.PAGE1.TEXT1.INPUTMASK = DEFAFMTANGG
IF MMODE="TAMPIL"
THISFORM.PAGEFRAME1.PAGE1.SETALL("enabled", .F., "textbox")
THISFORM.PAGEFRAME1.PAGE1.SETALL("enabled", .F., "combobox")
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
IF MMODE="TAMPIL" .OR. MMODE="EDIT"
IF MMODE="EDIT"
THISFORM.PAGEFRAME1.PAGE1.TEXT12.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.LABEL2.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.TEXT12.VALUE = CTOD('00-00-0000')
ENDIF
THISFORM.PAGEFRAME1.PAGE1.TEXT10.VALUE = TANGGAL
THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE = CIF
THISFORM.PAGEFRAME1.PAGE1.TEXT9.VALUE = CIF_LAMA
THISFORM.PAGEFRAME1.PAGE1.TEXT11.VALUE = CIF_SMT
THISFORM.PAGEFRAME1.PAGE1.TEXT14.VALUE = NOKTP
THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE = NAMA
THISFORM.PAGEFRAME1.PAGE1.TEXT15.VALUE = TEMPATLHR
THISFORM.PAGEFRAME1.PAGE1.TEXT16.VALUE = TANGGALLHR
THISFORM.PAGEFRAME1.PAGE1.TEXT17.VALUE = JENISKL
THISFORM.PAGEFRAME1.PAGE1.TEXT18.VALUE = RT
THISFORM.PAGEFRAME1.PAGE1.TEXT19.VALUE = IIF(ISNULL(STATUSKAWIN), '', STATUSKAWIN)
THISFORM.PAGEFRAME1.PAGE1.TEXT20.VALUE = IIF(ISNULL(PEKERJAAN), '', PEKERJAAN)
THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE = ALAMAT
THISFORM.PAGEFRAME1.PAGE1.TEXT4.VALUE = DESA
THISFORM.PAGEFRAME1.PAGE1.TEXT5.VALUE = KECAMATAN
THISFORM.PAGEFRAME1.PAGE1.TEXT6.VALUE = KOTA
THISFORM.PAGEFRAME1.PAGE1.TEXT7.VALUE = IBU
THISFORM.PAGEFRAME1.PAGE1.TEXT8.VALUE = AGAMA
THISFORM.PAGEFRAME1.PAGE1.TEXT13.VALUE = PHONE
THISFORM.PAGEFRAME1.PAGE1.COMBO2.VALUE = KELKERJA
THISFORM.PAGEFRAME1.PAGE1.TEXT12.VALUE = TGLKELUAR
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+KELKERJA+"'"
LCEK = SQLEXEC(OODBC, CSQL, "DUMMY")
THISFORM.PAGEFRAME1.PAGE1.KET_INSTANSI.VALUE = KETERANGAN
USE
SELECT (THISFORM.OLDSELECT)
ENDIF
IF MMODE="INPUT"
THISFORM.PAGEFRAME1.PAGE1.TEXT1.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE1.TEXT10.VALUE = TGLNOW
THISFORM.PAGEFRAME1.PAGE1.TEXT16.VALUE = CTOD('00-00-0000')
THISFORM.PAGEFRAME1.PAGE1.TEXT10.SETFOCUS
ELSE
ENDIF
IF MMODE="INPUT" .OR. MMODE="EDIT"
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' "
LCEK = SQLEXEC(OODBC, CSQL, "DUMMY")
IF EMPTY(KETERANGAN)
THISFORM.PAGEFRAME1.PAGE1.COMBO2.ENABLED = .F.
ELSE
THISFORM.PAGEFRAME1.PAGE1.COMBO2.ENABLED = .T.
ENDIF
SELECT (DATA1)
THISFORM.PAGEFRAME1.PAGE1.LABEL22.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.LABEL23.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.LABEL24.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.TEXT21.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.TEXT22.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.TEXT23.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.COMMAND1.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.COMMAND2.VISIBLE = .T.
THISFORM.PAGEFRAME1.PAGE1.COMMAND3.VISIBLE = .T.
ENDIF
THISFORM.COMMAND8.CLICK
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Load
THISFORM.OLDSELECT = SELECT()
ENDPROC
**
*
*  anggota_data.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_data.scx::Command3
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
IF EMPTY(THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE)
MESSAGEBOX("Nama Tidak Boleh Kosong", 0, "")
THISFORM.PAGEFRAME1.PAGE1.TEXT2.SETFOCUS
RETURN
ENDIF
HASIL = ''
NHANDLE = FOPEN(THISFORM.PAGEFRAME1.PAGE1.TEXT21.VALUE)
IF NHANDLE>0
NSIZE = FSEEK(NHANDLE, 0, 2)
= FSEEK(NHANDLE, 0, 0)
HASIL = FREAD(NHANDLE, NSIZE)
ENDIF
FCLOSE(NHANDLE)
MFOTO = HASIL
NHANDLE = FOPEN(THISFORM.PAGEFRAME1.PAGE1.TEXT22.VALUE)
IF NHANDLE>0
NSIZE = FSEEK(NHANDLE, 0, 2)
= FSEEK(NHANDLE, 0, 0)
HASIL = FREAD(NHANDLE, NSIZE)
ENDIF
FCLOSE(NHANDLE)
MTTD = HASIL
NHANDLE = FOPEN(THISFORM.PAGEFRAME1.PAGE1.TEXT23.VALUE)
IF NHANDLE>0
NSIZE = FSEEK(NHANDLE, 0, 2)
= FSEEK(NHANDLE, 0, 0)
HASIL = FREAD(NHANDLE, NSIZE)
ENDIF
FCLOSE(NHANDLE)
MPARAF = HASIL
IF THISFORM.MODE="INPUT"
THISFORM.MYPILIH = ""
CSQL = "select MAX(cif) as cif from anggota"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MCIF = IIF(ISNULL(CIF), "0", ALLTRIM(CIF))
MLEN = LEN(ALLTRIM(DEFAFMTANGG))
MCIF = RIGHT('00000000000000000'+ALLTRIM(STR(VAL(MCIF)+1)), MLEN)
MCIF_SMT = THISFORM.PAGEFRAME1.PAGE1.TEXT11.VALUE
MNAMA = THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE
MTGLLHR = SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT16.VALUE)
CSQL = "insert into anggota (kantor,tanggal,cif,cif_smt,noktp,nama,"+"tempatlhr,tanggallhr,jeniskl,alamat,rt,desa,"+"kecamatan,kota,agama,phone,ibu,kelkerja,"+"statuskawin,pekerjaan,"+"foto,tandatangan,paraf) value "+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT10.VALUE)+"',"+"'"+MCIF+"',"+"'"+MCIF_SMT+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT14.VALUE+"',"+"?mNama,"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT15.VALUE+"',"+"'"+SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT16.VALUE)+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT17.VALUE+"',"+"?thisform.pageframe1.page1.text3.Value,"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT18.VALUE+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT4.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT5.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT6.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT8.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT13.VALUE)+"',"+"'"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT7.VALUE)+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.COMBO2.VALUE+"',"+"'"+THISFORM.PAGEFRAME1.PAGE1.TEXT19.VALUE+"','"+THISFORM.PAGEFRAME1.PAGE1.TEXT20.VALUE+"',"+"?mfoto,?mttd,?mparaf)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert data anggota")
ENDIF
ENDIF
IF THISFORM.MODE="EDIT"
MCIFASAL = CIF
MNAMA = THISFORM.PAGEFRAME1.PAGE1.TEXT2.VALUE
CSQL = "update anggota set "+" cif='"+THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE+"',"+" cif_smt='"+THISFORM.PAGEFRAME1.PAGE1.TEXT11.VALUE+"',"+" tanggal='"+SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT10.VALUE)+"',"+" noktp='"+THISFORM.PAGEFRAME1.PAGE1.TEXT14.VALUE+"',"+" nama=?mNama,"+" tempatlhr='"+THISFORM.PAGEFRAME1.PAGE1.TEXT15.VALUE+"',"+" tanggallhr='"+SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT16.VALUE)+"',"+" jeniskl='"+THISFORM.PAGEFRAME1.PAGE1.TEXT17.VALUE+"',"+" alamat='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT3.VALUE)+"',"+" rt='"+THISFORM.PAGEFRAME1.PAGE1.TEXT18.VALUE+"',"+" desa='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT4.VALUE)+"',"+" kecamatan='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT5.VALUE)+"',"+" kota='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT6.VALUE)+"',"+" ibu='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT7.VALUE)+"',"+" agama='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT8.VALUE)+"', "+" statuskawin='"+THISFORM.PAGEFRAME1.PAGE1.TEXT19.VALUE+"',"+" pekerjaan='"+THISFORM.PAGEFRAME1.PAGE1.TEXT20.VALUE+"',"+" phone='"+CEKCHAR(THISFORM.PAGEFRAME1.PAGE1.TEXT13.VALUE)+"', "+" kelkerja='"+THISFORM.PAGEFRAME1.PAGE1.COMBO2.VALUE+"', "+" tglkeluar='"+SQLDATE(THISFORM.PAGEFRAME1.PAGE1.TEXT12.VALUE)+"',foto=?mfoto,tandatangan=?mttd,paraf=?mparaf "+" where idData='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF MCIFASAL<>THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE
CSQL = "update anggota_mutasi set cif='"+THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE+"' where cif='"+MCIFASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan set cif='"+THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE+"' where cif='"+MCIFASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman set cif='"+THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE+"' where cif='"+MCIFASAL+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_data.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_data.scx::Command1
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_fasilitas
ENDPROC
**
*
*  anggota_data.scx::Command4
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_mutasi WITH "TAMPIL", "1"
ENDPROC
**
*
*  anggota_data.scx::Command5
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_mutasi WITH "TAMPIL", "2"
ENDPROC
**
*
*  anggota_data.scx::Command6
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_potong_gaji
ENDPROC
**
*
*  anggota_data.scx::Command7
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM anggota_mutasi WITH "TAMPIL", "3"
ENDPROC
**
*
*  anggota_data.scx::Text2
**
PROCEDURE LostFocus
IF EMPTY(THIS.VALUE)
MESSAGEBOX("Nama Tidak Boleh Kosong", 0, "")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
*
*  anggota_data.scx::Text8
**
PROCEDURE InteractiveChange
DO CASE
CASE "ISLAM"=ALLTRIM(THIS.VALUE)
THIS.VALUE = "ISLAM"
CASE "KRISTEN"=ALLTRIM(THIS.VALUE)
THIS.VALUE = "KRISTEN"
CASE "KATOLIK"=ALLTRIM(THIS.VALUE)
THIS.VALUE = "KATOLIK"
CASE "HINDU"=ALLTRIM(THIS.VALUE)
THIS.VALUE = "HINDU"
CASE "BUDHA"=ALLTRIM(THIS.VALUE)
THIS.VALUE = "BUDHA"
OTHERWISE
ENDCASE
ENDPROC
**
*
*  anggota_data.scx::Combo2
**
PROCEDURE InteractiveChange
OLDSELECT = SELECT()
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+THIS.SANDI+"' and sandi='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "CEK")
THISFORM.PAGEFRAME1.PAGE1.KET_INSTANSI.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE Init
MSANDI = 'P003'
THIS.ADDPROPERTY("sandi", MSANDI)
THIS.ADDPROPERTY("data", SELECT())
THIS.CLEAR
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT00")
THIS.ROWSOURCE = "SMT00"
IF EMPTY(SANDI)
THIS.ENABLED = .F.
ENDIF
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH THIS.SANDI
THIS.VALUE = MSANDI
ENDIF
MSANDI = THIS.VALUE
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='"+THIS.SANDI+"' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("Kode Instansi Tidak Tersedia")
NODEFAULT
SELECT (OLDSELECT)
RETURN
ENDIF
THISFORM.PAGEFRAME1.PAGE1.KET_INSTANSI.VALUE = KETERANGAN
SELECT SMT
USE
SELECT (THIS.DATA)
ENDFUNC
**
*
*  anggota_data.scx::Text13
**
PROCEDURE LostFocus
IF THISFORM.MODE="INPUT" .AND. THISFORM.PAGEFRAME1.PAGE1.COMBO2.ENABLED=.F.
THISFORM.COMMAND3.SETFOCUS
ENDIF
ENDPROC
**
*
*  anggota_data.scx::Text17
**
PROCEDURE InteractiveChange
IF 'LAKI-LAKI'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'LAKI-LAKI'
ENDIF
IF 'PEREMPUAN'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'PEREMPUAN'
ENDIF
IF 'WANITA'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'WANITA'
ENDIF
ENDPROC
**
*
*  anggota_data.scx::Text18
**
PROCEDURE Init
THIS.VALUE = '000/000'
ENDPROC
**
*
*  anggota_data.scx::Text19
**
PROCEDURE InteractiveChange
IF 'KAWIN'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'KAWIN'
ENDIF
IF 'BELUM KAWIN'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'BELUM KAWIN'
ENDIF
IF 'DUDA'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'DUDA'
ENDIF
IF 'JANDA'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'JANDA'
ENDIF
IF 'TIDAK KAWIN'=ALLTRIM(THIS.VALUE)
THIS.VALUE = 'TIDAK KAWIN'
ENDIF
ENDPROC
**
*
*  anggota_data.scx::Command1
**
PROCEDURE Click
MDRIV = SYS(5)+SYS(2003)
MFILE = GETFILE("jpg,bmp")
THISFORM.PAGEFRAME1.PAGE1.TEXT21.VALUE = MFILE
THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE = MFILE
SET DEFAULT TO &MDRIV
ENDPROC
**
*
*  anggota_data.scx::Text21
**
PROCEDURE LostFocus
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  anggota_data.scx::Image2
**
PROCEDURE DblClick
DO FORM anggota_foto WITH SYS(2023)+"\tandatangan.jpg"
ENDPROC
**
*
*  anggota_data.scx::Image1
**
PROCEDURE DblClick
DO FORM anggota_foto WITH SYS(2023)+"\foto.jpg"
ENDPROC
**
*
*  anggota_data.scx::Image3
**
PROCEDURE DblClick
DO FORM anggota_foto WITH SYS(2023)+"\paraf.jpg"
ENDPROC
**
*
*  anggota_data.scx::Command2
**
PROCEDURE Click
MDRIV = SYS(5)+SYS(2003)
MFILE = GETFILE("jpg,bmp")
THISFORM.PAGEFRAME1.PAGE1.TEXT22.VALUE = MFILE
THISFORM.PAGEFRAME1.PAGE1.IMAGE2.PICTURE = MFILE
SET DEFAULT TO &MDRIV
ENDPROC
**
*
*  anggota_data.scx::Text22
**
PROCEDURE LostFocus
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  anggota_data.scx::Command3
**
PROCEDURE Click
MDRIV = SYS(5)+SYS(2003)
MFILE = GETFILE("jpg,bmp")
THISFORM.PAGEFRAME1.PAGE1.TEXT23.VALUE = MFILE
THISFORM.PAGEFRAME1.PAGE1.IMAGE3.PICTURE = MFILE
SET DEFAULT TO &MDRIV
ENDPROC
**
*
*  anggota_data.scx::Text23
**
PROCEDURE LostFocus
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  anggota_data.scx::Cmdcatatan1
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
DO FORM .\form\catatan WITH "ANGG", CIF
SELECT (THISFORM.DATA1)
ENDPROC
**
*
*  anggota_data.scx::Command9
**
PROCEDURE Click
DO FORM pinjaman_lainnya
ENDPROC
**
*
*  anggota_data.scx::Command8
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
IF THISFORM.MODE<>"INPUT"
CFOTO = CAST(FOTO AS W )
CTTD = CAST(TANDATANGAN AS W )
CPARAF = CAST(PARAF AS W )
THISFORM.FOTO(CFOTO, CTTD, CPARAF)
ENDIF
ENDPROC
**
*
*  anggota_data.scx::Command10
**
PROCEDURE Click
DO FORM anggota_tutup WITH THISFORM.PAGEFRAME1.PAGE1.TEXT1.VALUE
ENDPROC
**
***
*** anggota_data.sct
***
*
***
*** akt_neraca_labarugi1.frx
***
*
***
*** akt_neraca_labarugi1.frt
***
*
***
*** copy of crdfle13.ico
***
*
***
*** form_option_cetak.scx
***
*
*
*  form_option_cetak.scx::FORM1
**
PROCEDURE Init
THISFORM.BACADATA()
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  form_option_cetak.scx::Pageframe1
**
PROCEDURE Page2.Activate
CSQL = "select * from set_cetakfrx where namafrx='BUKU_TAB_HEAD'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_buku_header.frx
LOCATE FOR ALLTRIM(EXPR)="norek"
THISFORM.PAGEFRAME1.PAGE2.TEXT1.VALUE = VPOS
THISFORM.PAGEFRAME1.PAGE2.TEXT2.VALUE = HPOS
MOBJTYPE = OBJTYPE
MOBJCODE = OBJCODE
MHEIGHT = HEIGHT
MHPOS = HPOS
MVPOS = VPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,objtype,objcode,height,hpos,vpos) values "+"('BUKU_TAB_HEAD','"+STR(MOBJTYPE)+"','"+STR(MOBJCODE)+"','"+STR(MHEIGHT)+"','"+STR(MHPOS)+"','"+STR(MVPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height,vpos,hpos from set_cetakfrx where namafrx='BUKU_TAB_HEAD'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE2.TEXT1.VALUE = VPOS
THISFORM.PAGEFRAME1.PAGE2.TEXT2.VALUE = HPOS
ENDIF
CSQL = "select * from set_cetakfrx where namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_buku_mutasi.frx
LOCATE FOR OBJCODE=1
THISFORM.PAGEFRAME1.PAGE2.TEXT5.VALUE = HEIGHT
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE2.TEXT3.VALUE = 27
THISFORM.PAGEFRAME1.PAGE2.TEXT6.VALUE = 3
THISFORM.PAGEFRAME1.PAGE2.TEXT4.VALUE = 13
LOCATE FOR ALLTRIM(EXPR)="nomor"
THISFORM.PAGEFRAME1.PAGE2.TEXT7.VALUE = HPOS
LOCATE FOR ALLTRIM(EXPR)="tanggal"
THISFORM.PAGEFRAME1.PAGE2.TEXT8.VALUE = HPOS
LOCATE FOR ALLTRIM(EXPR)="kode"
THISFORM.PAGEFRAME1.PAGE2.TEXT9.VALUE = HPOS
LOCATE FOR ALLTRIM(EXPR)="debet"
THISFORM.PAGEFRAME1.PAGE2.TEXT10.VALUE = HPOS
LOCATE FOR ALLTRIM(EXPR)="kredit"
THISFORM.PAGEFRAME1.PAGE2.TEXT11.VALUE = HPOS
LOCATE FOR ALLTRIM(EXPR)="saldo"
THISFORM.PAGEFRAME1.PAGE2.TEXT12.VALUE = HPOS
LOCATE FOR ALLTRIM(EXPR)="opt"
THISFORM.PAGEFRAME1.PAGE2.TEXT13.VALUE = HPOS
USE
WITH THISFORM.PAGEFRAME1.PAGE2
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('BUKU_TAB_MUTASI','','"+STR(9)+"','"+STR(1)+"','"+STR(MHEIGHT)+"',''), "+"('BUKU_TAB_MUTASI','nomor'  ,'"+STR(8)+"','"+STR(0)+"','"+STR(1771)+"','"+STR(.TEXT7.VALUE)+"'),"+"('BUKU_TAB_MUTASI','tanggal','"+STR(8)+"','"+STR(0)+"','"+STR(1771)+"','"+STR(.TEXT8.VALUE)+"'),"+"('BUKU_TAB_MUTASI','kode'   ,'"+STR(8)+"','"+STR(0)+"','"+STR(1771)+"','"+STR(.TEXT9.VALUE)+"'),"+"('BUKU_TAB_MUTASI','debet'  ,'"+STR(8)+"','"+STR(0)+"','"+STR(1771)+"','"+STR(.TEXT10.VALUE)+"'),"+"('BUKU_TAB_MUTASI','kredit' ,'"+STR(8)+"','"+STR(0)+"','"+STR(1771)+"','"+STR(.TEXT11.VALUE)+"'),"+"('BUKU_TAB_MUTASI','saldo'  ,'"+STR(8)+"','"+STR(0)+"','"+STR(1771)+"','"+STR(.TEXT12.VALUE)+"'),"+"('BUKU_TAB_MUTASI','opt'    ,'"+STR(8)+"','"+STR(0)+"','"+STR(1771)+"','"+STR(.TEXT13.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDWITH
ELSE
CSQL = "select * from set_cetakfrx where namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
WITH THISFORM.PAGEFRAME1.PAGE2
DO WHILE  .NOT. EOF()
DO CASE
CASE OBJCODE=1
.TEXT3.VALUE = BARIS
.TEXT4.VALUE = BRSHAL1
.TEXT5.VALUE = HEIGHT
.TEXT6.VALUE = ANTARA
CASE ALLTRIM(EXPR)="nomor"
.TEXT7.VALUE = HPOS
CASE ALLTRIM(EXPR)="tanggal"
.TEXT8.VALUE = HPOS
CASE ALLTRIM(EXPR)="kode"
.TEXT9.VALUE = HPOS
CASE ALLTRIM(EXPR)="debet"
.TEXT10.VALUE = HPOS
CASE ALLTRIM(EXPR)="kredit"
.TEXT11.VALUE = HPOS
CASE ALLTRIM(EXPR)="saldo"
.TEXT12.VALUE = HPOS
CASE ALLTRIM(EXPR)="opt"
.TEXT13.VALUE = HPOS
ENDCASE
SKIP
ENDDO
ENDWITH
USE
ENDIF
ENDPROC
**
*
*  form_option_cetak.scx::Pageframe1
**
PROCEDURE Page1.Activate
CSQL = "select * from set_cetakfrx where c"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT1.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT2.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_SIMP_STOR','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_SIMP_STOR','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
RETURN
ENDIF
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_SIMP_STOR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT1.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_SIMP_STOR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT2.VALUE = HPOS
ENDIF
CSQL = "select * from set_cetakfrx where namafrx='VLD_SIMP_AMBIL'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT3.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT4.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_SIMP_AMBIL','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_SIMP_AMBIL','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_SIMP_AMBIL'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT3.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_SIMP_AMBIL'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT4.VALUE = HPOS
ENDIF
CSQL = "select * from set_cetakfrx where namafrx='VLD_SIMP_PBK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT5.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT6.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_SIMP_PBK','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_SIMP_PBK','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_SIMP_PBK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT5.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_SIMP_PBK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT6.VALUE = HPOS
ENDIF
ENDPROC
**
PROCEDURE Page2.Activate
CSQL = "select * from set_cetakfrx where namafrx='VLD_PINJ_REAL'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT1.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT2.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_PINJ_REAL','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_PINJ_REAL','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_PINJ_REAL'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT1.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_PINJ_REAL'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT2.VALUE = HPOS
ENDIF
CSQL = "select * from set_cetakfrx where namafrx='VLD_PINJ_ANGS'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT3.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT4.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_PINJ_ANGS','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_PINJ_ANGS','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_PINJ_ANGS'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT3.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_PINJ_ANGS'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT4.VALUE = HPOS
ENDIF
CSQL = "select * from set_cetakfrx where namafrx='VLD_PINJ_PBKCAIR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT5.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT6.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_PINJ_PBKCAIR','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_PINJ_PBKCAIR','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_PINJ_PBKCAIR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT5.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_PINJ_PBKCAIR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT6.VALUE = HPOS
ENDIF
CSQL = "select * from set_cetakfrx where namafrx='VLD_PINJ_PBKTARIK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT7.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT8.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_PINJ_PBKTARIK','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_PINJ_PBKTARIK','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_PINJ_PBKTARIK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT7.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_PINJ_PBKTARIK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT8.VALUE = HPOS
ENDIF
ENDPROC
**
PROCEDURE Page3.Activate
CSQL = "select * from set_cetakfrx where namafrx='VLD_KOLEKTOR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE3.TEXT1.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE3.TEXT2.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_KOLEKTOR','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_KOLEKTOR','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_KOLEKTOR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE3.TEXT1.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_KOLEKTOR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE3.TEXT2.VALUE = HPOS
ENDIF
ENDPROC
**
PROCEDURE Page4.Activate
CSQL = "select * from set_cetakfrx where namafrx='VLD_INSTANSI'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE4.TEXT1.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE4.TEXT2.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_INSTANSI','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_INSTANSI','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_INSTANSI'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE4.TEXT1.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_INSTANSI'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE4.TEXT2.VALUE = HPOS
ENDIF
ENDPROC
**
PROCEDURE Page5.Activate
CSQL = "select * from set_cetakfrx where namafrx='VLD_LAIN_MASUK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT1.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT2.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_LAIN_MASUK','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_LAIN_MASUK','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_LAIN_MASUK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT1.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_LAIN_MASUK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT2.VALUE = HPOS
ENDIF
CSQL = "select * from set_cetakfrx where namafrx='VLD_LAIN_KELUAR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT3.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT4.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_LAIN_KELUAR','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_LAIN_KELUAR','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_LAIN_KELUAR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT3.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_LAIN_KELUAR'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT4.VALUE = HPOS
ENDIF
CSQL = "select * from set_cetakfrx where namafrx='VLD_LAIN_PBK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()=0
USE ctk_validasi.frx
LOCATE FOR OBJCODE=1
MHEIGHT = HEIGHT
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT5.VALUE = HEIGHT
LOCATE FOR ALLTRIM(EXPR)="cetak"
MHPOS = HPOS
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT6.VALUE = HPOS
USE
CSQL = "insert into set_cetakfrx (namafrx,expr,objtype,objcode,height,hpos) values "+"('VLD_LAIN_PBK','','9','1','"+STR(MHEIGHT)+"',''),"+"('VLD_LAIN_PBK','cetak','8','0','1875','"+STR(MHPOS)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "select height from set_cetakfrx where objcode='1' and namafrx='VLD_LAIN_PBK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT5.VALUE = HEIGHT
CSQL = "select hpos from set_cetakfrx where expr='cetak'  and namafrx='VLD_LAIN_PBK'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT6.VALUE = HPOS
ENDIF
ENDPROC
**
*
*  form_option_cetak.scx::Command1
**
PROCEDURE Click
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT1.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_SIMP_STOR' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT2.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_SIMP_STOR' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT3.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_SIMP_AMBIL' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT4.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_SIMP_AMBIL' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT5.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_SIMP_PBK' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE1.TEXT6.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_SIMP_PBK' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
*
*  form_option_cetak.scx::Command1
**
PROCEDURE Click
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT1.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_PINJ_REAL' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT2.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_PINJ_REAL' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT3.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_PINJ_ANGS' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT4.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_PINJ_ANGS' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT5.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_PINJ_PBKCAIR' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT6.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_PINJ_PBKCAIR' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT7.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_PINJ_PBKTARIK' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE2.TEXT8.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_PINJ_PBKTARIK' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
*
*  form_option_cetak.scx::Command1
**
PROCEDURE Click
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE3.TEXT1.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_KOLEKTOR' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE3.TEXT2.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_KOLEKTOR' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
*
*  form_option_cetak.scx::Command1
**
PROCEDURE Click
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE4.TEXT1.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_INSTANSI' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE4.TEXT2.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_INSTANSI' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
*
*  form_option_cetak.scx::Command1
**
PROCEDURE Click
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT1.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_LAIN_MASUK' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT2.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_LAIN_MASUK' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT3.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_LAIN_KELUAR' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT4.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_LAIN_KELUAR' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
MHEIGHT = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT5.VALUE
CSQL = "update set_cetakfrx set height='"+STR(MHEIGHT)+"' where namafrx='VLD_LAIN_PBK' and objcode='1'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE1.PAGEFRAME1.PAGE5.TEXT6.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"' where namafrx='VLD_LAIN_PBK' and expr='cetak'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
*
*  form_option_cetak.scx::Command1
**
PROCEDURE Click
MVPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT1.VALUE
MHPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT2.VALUE
CSQL = "update set_cetakfrx set vpos='"+STR(MVPOS)+"', hpos='"+STR(MHPOS)+"'  where namafrx='BUKU_TAB_HEAD'"
LCEK = SQLEXEC(OODBC, CSQL)
MJARAK = THISFORM.PAGEFRAME1.PAGE2.TEXT5.VALUE
MBARIS = THISFORM.PAGEFRAME1.PAGE2.TEXT3.VALUE
MHAL1 = THISFORM.PAGEFRAME1.PAGE2.TEXT4.VALUE
MANTARA = THISFORM.PAGEFRAME1.PAGE2.TEXT6.VALUE
CSQL = "update set_cetakfrx set height='"+ALLTRIM(STR(MJARAK))+"', baris='"+STR(MBARIS)+"', antara='"+STR(MANTARA)+"', brshal1='"+STR(MHAL1)+"'  where objcode='1' and namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT7.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"'  where expr='nomor' and namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT8.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"'  where expr='tanggal' and namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT9.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"'  where expr='kode' and namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT10.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"'  where expr='debet' and namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT11.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"'  where expr='kredit' and namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT12.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"'  where expr='saldo' and namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL)
MHPOS = THISFORM.PAGEFRAME1.PAGE2.TEXT13.VALUE
CSQL = "update set_cetakfrx set hpos='"+STR(MHPOS)+"'  where expr='opt' and namafrx='BUKU_TAB_MUTASI'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
***
*** form_option_cetak.sct
***
*
***
*** ctk_buku_mutasi.frx
***
*
***
*** ctk_buku_mutasi.frt
***
*
***
*** krd_mutasi_rk.frx
***
*
***
*** krd_mutasi_rk.frt
***
*
***
*** acc_harian_invent.scx
***
*
*
*  acc_harian_invent.scx::FORM1
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .T.
ELSE
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND5.VISIBLE = .T.
THISFORM.COMMAND1.VISIBLE = .F.
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TANGGAL
THISFORM.TEXT2.VALUE = "PROSES PENYUSUTAN INVENTARIS"
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
CSQL = "select SUM(debet) as jml from acc_harian_inventaris where kel_id='"+ALLTRIM(STR(MIDDATA))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
THISFORM.TEXT3.VALUE = JML
CSQL = "select * from acc_harian_inventaris where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 4
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "idinvent"
.COLUMN1.HEADER1.CAPTION = "NO.INVENTARIS"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 250
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 100
.COLUMN3.CONTROLSOURCE = "TRANS(debet-kredit,'9,999,999,999')"
.COLUMN3.HEADER1.CAPTION = "JUMLAH"
.COLUMN3.ALIGNMENT = 1
.COLUMN4.WIDTH = 40
.COLUMN4.CONTROLSOURCE = "opt"
.COLUMN4.HEADER1.CAPTION = "OPT"
.COLUMN4.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_harian_invent.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_invent.scx::Command4
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM frm_bukti TO MBUKTI WITH THISFORM.TEXT1.VALUE
IF  .NOT. EMPTY(MBUKTI)
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
GOTO TOP
DO WHILE  .NOT. EOF()
MNOMORID = IDINVENT
MTGL = TANGGAL
MKETERANGAN = KETERANGAN
MDEBET = DEBET
MKREDIT = KREDIT
MOPT = OPT
MNAMA = NAMA
MMTS = IIF(ISNULL(DEBET), 0, DEBET)-IIF(ISNULL(KREDIT), 0, KREDIT)
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from gl_inventaris_mutasi where nomorid='"+STR(MNOMORID)+"' group by nomorid"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
JMLMTS = IIF(ISNULL(KREDIT), 0, KREDIT)-IIF(ISNULL(DEBET), 0, DEBET)
USE
CSQL = "select tanggal,harga,penyusutan from gl_inventaris where nomorid='"+STR(MNOMORID)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = IIF(ISNULL(HARGA), 0, HARGA)-JMLMTS-MMTS
IF MMTS<>0
CSQL = "insert into gl_inventaris_mutasi (kantor,nomorid,tanggal,bukti,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+STR(MNOMORID)+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+MKETERANGAN+"','"+TRANSFORM(IIF(MMTS<0, 0-MMTS, 0), '999999999999999')+"','"+TRANSFORM(IIF(MMTS>0, MMTS, 0), '999999999999999')+"','"+TRANSFORM(MSALDO, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(MTGL)+"', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT sum( debet ) AS debet, sum(kredit ) AS kredit, jur_biaya,jur_akum FROM acc_harian_inventaris where kel_id='"+STR(MIDDATA)+"' GROUP BY jur_biaya"
LCEK = SQLEXEC(OODBC, CSQL, "JUR")
DO WHILE  .NOT. EOF()
MJUR_BIAYA = IIF(ISNULL(JUR_BIAYA), "", JUR_BIAYA)
MJUR_AKUM = IIF(ISNULL(JUR_AKUM), "", JUR_AKUM)
MDEBET = IIF(ISNULL(DEBET), 0, DEBET)
MKREDIT = IIF(ISNULL(KREDIT), 0, KREDIT)
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+MJUR_BIAYA+"','"+MKETERANGAN+"','"+TRANSFORM(MDEBET-MKREDIT, '999999999999')+"','"+MOPTACC+"'), "
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+MJUR_AKUM+"','"+MKETERANGAN+"','"+TRANSFORM(0-(MDEBET-MKREDIT), '999999999999')+"','"+MOPTACC+"')"
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, MJUR_BIAYA, MTGL)
HITNERACA(DEFAKANTOR, MJUR_AKUM, MTGL)
SELECT JUR
SKIP
ENDDO
SELECT JUR
USE
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_invent.scx::Command5
**
PROCEDURE Click
MTANGGAL = THISFORM.TEXT1.VALUE
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(MTANGGAL)+"' and kode='GL1' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_inventaris where tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_invent.scx::Command1
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
GOTO TOP
CSQL = "select bukti from gl_inventaris_mutasi where kantor='"+DEFAKANTOR+"' and nomorid='"+STR(IDINVENT)+"' and tanggal='"+SQLDATE(TANGGAL)+"' and keterangan='"+KETERANGAN+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBUKTI = BUKTI
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MIDINVENT = IDINVENT
MTGL = TANGGAL
MKETERANGAN = KETERANGAN
CSQL = "delete from gl_inventaris_mutasi where kantor='"+DEFAKANTOR+"' and nomorid='"+STR(MIDINVENT)+"' and tanggal='"+SQLDATE(MTGL)+"' and keterangan='"+MKETERANGAN+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select SUM(debet) as debet, SUM(kredit) as kredit from gl_inventaris_mutasi where nomorid='"+STR(MIDINVENT)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
MAKUM = KREDIT-DEBET
CSQL = "select harga from gl_inventaris where nomorid='"+STR(MIDINVENT)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
MHARGA = HARGA
MBUKU = MHARGA-MAKUM
CSQL = "update gl_inventaris set akumulasi=?mAkum, nilaibuku=?mbuku, tglmutasi=?mtgl where  nomorid='"+STR(MIDINVENT)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='0000-00-00', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from jurnal where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(MTGL)+"' and bukti='"+MBUKTI+"' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT jur_biaya,jur_akum FROM acc_harian_inventaris where kel_id='"+STR(MIDDATA)+"' GROUP BY jur_biaya"
LCEK = SQLEXEC(OODBC, CSQL, "JUR")
DO WHILE  .NOT. EOF()
MJUR_BIAYA = IIF(ISNULL(JUR_BIAYA), "", JUR_BIAYA)
MJUR_AKUM = IIF(ISNULL(JUR_AKUM), "", JUR_AKUM)
HITNERACA(DEFAKANTOR, MJUR_BIAYA, MTGL)
HITNERACA(DEFAKANTOR, MJUR_AKUM, MTGL)
SELECT JUR
SKIP
ENDDO
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_invent.scx::Command2
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE Click
SELECT RINCI_TRANS
REPORT FORM tab_pemberianbunga_tab PREVIEW
ENDPROC
**
*
*  acc_harian_invent.scx::Command6
**
PROCEDURE Click
SELECT RINCI_TRANS
MKEL = KEL_ID
CSQL = "SELECT produk,SUM(jasa) as jasa, SUM(pajak) as pajak "+"FROM acc_harian_bungasimpanan WHERE kel_id='"+STR(MKEL)+"' group by produk"
LCEK = SQLEXEC(OODBC, CSQL, "REKAP")
REPORT FORM tab_pemberianbungatab_rekap PREVIEW
SELECT REKAP
USE
SELECT RINCI_TRANS
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
***
*** acc_harian_invent.sct
***
*
***
*** ctk_buku_header.frx
***
*
***
*** ctk_buku_header.frt
***
*
***
*** proses_harian3.scx
***
*
*
*  proses_harian3.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
IF PARAMETERS()=0
MMODE = 1
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.MODE = MMODE
IF MMODE=1
THISFORM.LABEL3.CAPTION = "PROSES"
THISFORM.TEXT2.VISIBLE = .F.
THISFORM.COMBO1.VISIBLE = .T.
THISFORM.SETALL("visible", .F., "checkbox")
THISFORM.SHAPE4.TOP = 80
THISFORM.COMMAND2.TOP = 90
THISFORM.COMMAND3.TOP = 90
THISFORM.CONTAINER2.TOP = 120
THISFORM.CONTAINER2.HEIGHT = 378
THISFORM.LABEL2.CAPTION = "PROSES PER BAGIAN"
ENDIF
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
CSQL = "select MAX(tglproses) as tgl from log_proses"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT1.VALUE = IIF(EMPTY(TGL), TGLNOW, TGL)
IF ISNULL(TGL) .OR. EMPTY(TGL)
CSQL = "select MIN(tanggal) as tgl from jurnal"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF ISNULL(TGL) .OR. EMPTY(TGL)
THISFORM.TEXT1.VALUE = TGLNOW
ELSE
THISFORM.TEXT1.VALUE = TGL
ENDIF
ELSE
THISFORM.TEXT1.VALUE = TGL
ENDIF
THISFORM.TEXT2.VALUE = TGLNOW
IF DEFASYSTEMAKT=1 .OR. EMPTY(DEFASYSTEMAKT)
THISFORM.SIMP1.VALUE = 0
THISFORM.PINJ1.VALUE = 0
THISFORM.PINJ2.VALUE = 0
THISFORM.PINJ3.VALUE = 0
THISFORM.AKT2.VALUE = 0
THISFORM.SIMP1.READONLY = .T.
THISFORM.PINJ1.READONLY = .T.
THISFORM.PINJ2.READONLY = .T.
THISFORM.PINJ3.READONLY = .T.
THISFORM.AKT2.READONLY = .T.
ELSE
THISFORM.SIMP1.VALUE = DEFAAKRUSIMPANAN
THISFORM.PINJ1.VALUE = DEFAAKRUPINJAMAN
THISFORM.PINJ2.VALUE = DEFAAKRUADM
THISFORM.PINJ3.VALUE = DEFAAKRUBIAYA
ENDIF
ENDPROC
**
*
*  proses_harian3.scx::Combo1
**
PROCEDURE LostFocus
THISFORM.SETALL("value", 0, "checkbox")
DO CASE
CASE THIS.VALUE="BUNGA SIMPANAN (AKRUAL)"
THISFORM.SIMP1.VALUE = 1
CASE THIS.VALUE="PERPANJANGAN ARO"
THISFORM.SIMP2.VALUE = 1
CASE THIS.VALUE="AUTODEBET SIMPANAN"
THISFORM.SIMP3.VALUE = 1
CASE THIS.VALUE="JASA SIMPANAN TAB/DEP"
THISFORM.SIMP4.VALUE = 1
CASE THIS.VALUE="BUNGA AKRUAL PINJAMAN"
THISFORM.PINJ1.VALUE = 1
CASE THIS.VALUE="AMORTISASI PROVISI (AKRUAL)"
THISFORM.PINJ2.VALUE = 1
CASE THIS.VALUE="AMORTISASI BIAYA (AKRUAL)"
THISFORM.PINJ3.VALUE = 1
CASE THIS.VALUE="PROSES LABA/RUGI"
THISFORM.AKT1.VALUE = 1
CASE THIS.VALUE="AMORTISASI BIAYA (AKRUAL)"
THISFORM.AKT2.VALUE = 1
CASE THIS.VALUE="PENYUSUTAN INVENTARIS"
THISFORM.AKT3.VALUE = 1
CASE THIS.VALUE="CEK CATATAN"
THISFORM.LAIN1.VALUE = 1
CASE THIS.VALUE="CEK VALIDASI"
THISFORM.LAIN2.VALUE = 1
CASE THIS.VALUE="ULANG TAHUN"
THISFORM.LAIN3.VALUE = 1
CASE THIS.VALUE="JATUH TEMPO ANGSURAN"
THISFORM.LAIN4.VALUE = 1
CASE THIS.VALUE="JATUH TEMPO PINJAMAN"
THISFORM.LAIN5.VALUE = 1
ENDCASE
ENDPROC
**
PROCEDURE Init
THIS.ADDITEM("BUNGA SIMPANAN (AKRUAL)")
THIS.ADDITEM("PERPANJANGAN ARO")
THIS.ADDITEM("AUTODEBET SIMPANAN")
THIS.ADDITEM("JASA SIMPANAN TAB/DEP")
THIS.ADDITEM("BUNGA AKRUAL PINJAMAN")
THIS.ADDITEM("AMORTISASI PROVISI (AKRUAL)")
THIS.ADDITEM("AMORTISASI BIAYA (AKRUAL)")
THIS.ADDITEM("PROSES LABA/RUGI")
THIS.ADDITEM("AMORTISASI BIAYA (AKRUAL)")
THIS.ADDITEM("PENYUSUTAN INVENTARIS")
THIS.ADDITEM("CEK CATATAN")
THIS.ADDITEM("CEK VALIDASI")
THIS.ADDITEM("ULANG TAHUN")
THIS.ADDITEM("JATUH TEMPO ANGSURAN")
THIS.ADDITEM("JATUH TEMPO PINJAMAN")
ENDPROC
**
*
*  proses_harian3.scx::Command3
**
PROCEDURE Click
IF THISFORM.CONTAINER2.SIMP1.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.SIMP2.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.SIMP3.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.PINJ1.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.PINJ2.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.PINJ3.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.AKT1.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.AKT2.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.LAIN1.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.LAIN2.VALUE=1
ENDIF
ENDPROC
**
*
*  proses_harian3.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  proses_harian3.scx::Command3
**
PROCEDURE Click
LOCAL MTGLPROSES
MTGLPROSES = THISFORM.TEXT1.VALUE
MBUKTI = RIGHT(ALLTRIM(STR(YEAR(TGLNOW))), 2)+RIGHT("00"+ALLTRIM(STR(MONTH(TGLNOW))), 2)+RIGHT("00"+ALLTRIM(STR(DAY(TGLNOW))), 2)+LEFT(TIME(), 2)+SUBSTR(TIME(), 4, 2)
CSQL = "update acc_harian set tglacc='"+SQLDATE(TGLNOW)+"' where tanggal<'"+SQLDATE(TGLNOW)+"' and (kode='A01' or kode='V01' or kode='A02' or kode='P02' or kode='P03')"
LCEK = SQLEXEC(OODBC, CSQL)
MEDIT = ""
MJURBUNGA = 0
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "update acc_harian set tglacc='"+SQLDATE(TGLNOW)+"', optacc='SYS' where tglacc='0000-00-00' and tanggal<'"+SQLDATE(TGLNOW)+"' and kode='A01'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
IF THISFORM.SIMP4.VALUE=1
CSQL = "delete from simpanan_saldo where tanggal='"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(TGLNOW)+"' and kode='S01'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S01'
MIDDATA = 0
MEDIT = MEDIT+CHR(13)+"PERHITUNGAN JASA SIMPANAN "+CHR(13)+"----------------------------------------"+CHR(13)
CREATE CURSOR daftbunga (NOREK C (17), BUNGA N (12), UTANG N (12), PAJAK N (12), JURTAB C (10), JURBG C (10), JURPJK C (10), JURUTANG C (10))
CREATE CURSOR coba (NOREK C (17), JUMLAH N (12))
FOR MPROSESKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MPROSESKE
THISFORM.CONTAINER2.LABEL3.CAPTION = "PERHITUNGAN JASA SIMPANAN : "+DTOC(MTGLPROSES)
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF MONTH(MTGLPROSES+1)<>MONTH(MTGLPROSES)
CSQL = "select a.norek,a.produk,b.nama from simpanan as a left join anggota as b on a.cif=b.cif  where a.kantor='"+DEFAKANTOR+"' and tgltutup='0000-00-00' and jenis='1'"
LCEK = SQLEXEC(OODBC, CSQL, "SIMPANAN")
PERTAMA = .T.
MHSL1 = 0
MR = 0
JUMREC = RECCOUNT()
IF JUMREC>0
GOTO TOP
DO WHILE  .NOT. EOF()
MREK = RECNO()
THISFORM.CONTAINER2.SHAPE5.WIDTH = (RECNO()/JUMREC)*705
MNOREK = NOREK
MNAMA = NAMA
MPRODUK = PRODUK
HASIL = LISTBUNGA(MNOREK, MTGLPROSES)
HSL1 = VAL(LEFT(HASIL, AT('|', HASIL)-1))
HSL2 = VAL(SUBSTR(HASIL, AT('|', HASIL)+1))
IF HSL1<>0
MHSL1 = HSL1
IF PERTAMA
PERTAMA = .F.
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S01','PERHITUNGAN JASA SIMPANAN SUKARELA (TABUNGAN)')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S01'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
MIDDATA = IDDATA
USE
ENDIF
MTGLPROS = SQLDATE(MTGLPROSES)
MHSL1 = STR(HSL1)
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi "+"where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLPROS)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = SALDO
USE
CSQL = "insert into acc_harian_bungasimpanan ("+"kel_id,kantor,tanggal,norek,nama,produk,saldo,jasa,pajak) "+"value (?mIddata,?DefaKantor,?tglnow,?mnorek,?mNama,?mproduk,'"+TRANSFORM(MSALDO, '999999999999999')+"',?hsl1,?hsl2)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert ke acc_harian_bungasimpanan", 0, "")
RETURN
ENDIF
ENDIF
SELECT SIMPANAN
SKIP
ENDDO
IF  .NOT. PERTAMA
CSQL = "select distinct produk from acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca produk")
ENDIF
DO WHILE  .NOT. EOF()
MPRODUK = PRODUK
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='1' and sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX("Gagal baca sandi")
ENDIF
MKET = KETERANGAN
MJURTAB = IIF(ISNULL(JURNALTAB), '', JURNALTAB)
MJURBG = IIF(ISNULL(JURNALBUNGA), '', JURNALBUNGA)
MJURPJK = IIF(ISNULL(JURNALPAJAK), '', JURNALPAJAK)
CSQL = "update acc_harian_bungasimpanan set produk='"+MKET+"', jurtab='"+MJURTAB+"', jurbg='"+MJURBG+"', jurpjk='"+MJURPJK+"' "+"where kel_id='"+STR(MIDDATA)+"' and produk='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update")
ENDIF
SELECT SMT
SKIP
ENDDO
ENDIF
ENDIF
SELECT SIMPANAN
USE
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.SIMP4.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='S03'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S03'
CSQL = "select * from setsandi_tab where a_adm+a_adm1+a_adm2+a_adm3+a_adm4+a_adm5+p_adm+p_adm1+p_adm2+p_adm3+p_adm4+p_adm5>0"
LCEK = SQLEXEC(OODBC, CSQL, "SANDI")
IF  .NOT. EMPTY(SANDI)
MIDDATA = 0
MEDIT = MEDIT+CHR(13)+"PERHITUNGAN ADMINISTRASI SIMPANAN "+CHR(13)+"----------------------------------------"+CHR(13)
CREATE CURSOR daftbunga (NOREK C (17), BUNGA N (12), UTANG N (12), PAJAK N (12), JURTAB C (10), JURBG C (10), JURPJK C (10), JURUTANG C (10))
CREATE CURSOR coba (NOREK C (17), JUMLAH N (12))
FOR MPROSESKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MPROSESKE
THISFORM.CONTAINER2.LABEL3.CAPTION = "PERHITUNGAN ADM SIMPANAN : "+DTOC(MTGLPROSES)
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF MONTH(MTGLPROSES+1)<>MONTH(MTGLPROSES)
SELECT SANDI
DO WHILE  .NOT. EOF()
MPRODUK = SANDI
MOPTAKTIF = A_OPTADM
MOPTPASIF = P_OPTADM
CSQL = "select a.norek,a.produk,b.nama from simpanan as a left join anggota as b on a.cif=b.cif  where a.kantor='"+DEFAKANTOR+"' and tgltutup='0000-00-00' and jenis='1' and a.produk='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SIMPANAN")
PERTAMA = .T.
MHSL1 = 0
MR = 0
JUMREC = RECCOUNT()
IF JUMREC>0
GOTO TOP
DO WHILE  .NOT. EOF()
MREK = RECNO()
THISFORM.CONTAINER2.SHAPE5.WIDTH = (RECNO()/JUMREC)*705
MNOREK = NOREK
MNAMA = NAMA
MPRODUK = PRODUK
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from "+"simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"' group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = SALDO
CSQL = "select tanggal from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi where "+"norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"' and "+"(kode='"+DEFATABSTOR+"' or kode='"+DEFATABAMB+"' or kode='"+DEFATABPBK+"' ) group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
VTGLMUTASI = TANGGAL
SELECT SANDI
VAKTIF = "Y"
DO CASE
CASE OPTPASIF=1
IF HARIPASIF<MTGLPROSES-VTGLMUTASI
VAKTIF = "T"
ENDIF
CASE OPTPASIF=2
IF NOMIPASIF<VSALDO
VAKTIF = "T"
ENDIF
CASE OPTPASIF=3
IF HARIPASIF<MTGLPROSES-VTGLMUTASI .AND. NOMIPASIF<VSALDO
VAKTIF = "T"
ENDIF
ENDCASE
IF VAKTIF="T"
DO CASE
CASE MSALDO<P_NOMI_ADM1 .OR. P_NOMI_ADM1=0
MADM = P_ADM
CASE MSALDO>=P_NOMI_ADM1 .AND. MSALDO<P_NOMI_ADM2
MADM = P_ADM1
CASE MSALDO>=P_NOMI_ADM2 .AND. MSALDO<P_NOMI_ADM3
MADM = P_ADM2
CASE MSALDO>=P_NOMI_ADM3 .AND. MSALDO<P_NOMI_ADM4
MADM = P_ADM3
CASE MSALDO>=P_NOMI_ADM4 .AND. MSALDO<P_NOMI_ADM5
MADM = P_ADM4
CASE MSALDO>=P_NOMI_ADM5
MADM = P_ADM5
ENDCASE
ELSE
DO CASE
CASE MSALDO<A_NOMI_ADM1 .OR. A_NOMI_ADM1=0
MADM = A_ADM
CASE MSALDO>=A_NOMI_ADM1 .AND. MSALDO<A_NOMI_ADM2
MADM = A_ADM1
CASE MSALDO>=A_NOMI_ADM2 .AND. MSALDO<A_NOMI_ADM3
MADM = A_ADM2
CASE MSALDO>=A_NOMI_ADM3 .AND. MSALDO<A_NOMI_ADM4
MADM = A_ADM3
CASE MSALDO>=A_NOMI_ADM4 .AND. MSALDO<A_NOMI_ADM5
MADM = A_ADM4
CASE MSALDO>=A_NOMI_ADM5
MADM = A_ADM5
ENDCASE
ENDIF
MJURNALTAB = JURNALTAB
MJURNALADM = JURNALADM
MADM = MIN(MADM, MSALDO)
IF MADM<>0
IF PERTAMA
PERTAMA = .F.
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S03','PERHITUNGAN ADMINISTRASI SIMPANAN SUKARELA (TABUNGAN)')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S03'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
MIDDATA = IDDATA
USE
ENDIF
CSQL = "insert into acc_harian_admsimpanan ("+"kel_id,kantor,tanggal,norek,nama,produk,saldo,adm,jurtab,juradm) "+"value ('"+ALLTRIM(STR(MIDDATA))+"','"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MNOREK+"','"+MNAMA+"','"+MPRODUK+"','"+TRANSFORM(MSALDO, "999999999999999")+"','"+STR(MADM)+"','"+MJURALTAB+"','"+MJURNALADM+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert ke acc_harian_admsimpanan", 0, "")
RETURN
ENDIF
ENDIF
SELECT SIMPANAN
SKIP
ENDDO
ENDIF
SELECT SIMPANAN
USE
SELECT SANDI
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
ENDIF
IF THISFORM.SIMP4.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='S04'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S04'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "PERHITUNGAN BUNGA SIMPANAN BERJANGKA"
MEDIT = MEDIT+CHR(13)+"PERHITUNGAN JASA SIMPANAN BERJANGKA"+CHR(13)+"----------------------------------------"+CHR(13)
NUSER = 0
ADA = .F.
FOR A = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+A
CSQL = "select a.*,b.* from simpanan as a left join simpanan_bilyet as b on a.norek=b.norek where a.jenis='2' and "+"tgltutup='0000-00-00' and tglawal<'"+SQLDATE(MTGLPROSES)+"' and tgljtempo>'"+SQLDATE(MTGLPROSES)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "DEP")
PERTAMA = .T.
JUMREC = RECCOUNT()
IF JUMREC>0
DO WHILE  .NOT. EOF()
THISFORM.CONTAINER2.SHAPE5.WIDTH = (RECNO()/JUMREC)*705
MJTDEP = 'T'
MTGLHITJT = TGLAWAL
FOR AA = 0 TO LAMA
MTGLHITJT = MAJU1BLN(MTGLHITJT, TGLAWAL)
IF MTGLHITJT=MTGLPROSES
MJTDEP = 'Y'
ENDIF
ENDFOR
IF MJTDEP='Y'
MNOREK = NOREK
MTANGGAL = TANGGAL
MKE = KE
MPOKOK = POKOK
MRATE = RATE
MCARAHITUNG = CARAHITUNG
MLAMA = LAMA
MARO = ARO
MTGLAWAL = TGLAWAL
MTGLJTEMPO = TGLJTEMPO
MTGLHIT = MTGLAWAL
MCIF = CIF
MPRODUK = PRODUK
CSQL = "select nama from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNAMA = NAMA
CSQL = "select b.* from simpanan as a left join setsandi_tab as b on b.jenis=a.jenis and b.sandi=a.produk where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca setsandi")
ENDIF
MJURTAB = JURNALTAB
MJURBUNGA = JURNALBUNGA
MJURPAJAK = JURNALPAJAK
MBUNGA = 0
MPAJAK = 0
MBATASPJK = BATASPAJAK
MBGPAJAK = PAJAK
NUSER = NUSER+1
MHARI = DAY(AWALBLN(MTGLPROSES)-1)
IF MCARAHITUNG='E' .OR. EMPTY(MCARAHITUNG)
MBUNGA = (MHARI/365)*(MRATE/100)*MPOKOK
IF MPOKOK>MBATASPJK
MPAJAK = MBUNGA*(MBGPAJAK/100)
ENDIF
ENDIF
IF MCARAHITUNG='R'
MBUNGA = ((MRATE/100)*MPOKOK)/12
IF MPOKOK>MBATASPJK
MPAJAK = MBUNGA*(MBGPAJAK/100)
ENDIF
ENDIF
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S04'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S04','PERHITUNGAN JASA SIMPANAN BERJANGKA (DEPOSITO)')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S04'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT DEP
DO CASE
CASE BUNGA_KE="DEPOSITO"
MKET = "DEPOSITO / Perpanjangan Otomatis"
CASE BUNGA_KE="TUNAI"
MKET = "Jasa diambil tunai"
CASE BUNGA_KE="TABUNGAN"
MKET = "Jasa Ditransfer ke rek. Tabungan no."+ALLTRIM(BUNGA_REK)+" ("+ALLTRIM(BUNGA_NAMA)+")"
OTHERWISE
MKET = ""
ENDCASE
CSQL = "insert into acc_harian_bungadeposito (kel_id,kantor,tanggal,norek,nama,produk,rate,"+"hari,carahit,saldo,jasa,pajak, aro,keterangan,bungake,norektujuan,atasnama,jurtab,jurbg, jurpjk) value "+"('"+ALLTRIM(STR(MIDDATA))+"','"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MNOREK+"','"+MNAMA+"','"+MPRODUK+"','"+TRANSFORM(MRATE, '99,99')+"','"+STR(MHARI)+"','"+MCARAHITUNG+"','"+TRANSFORM(MPOKOK, '999999999999999')+"','"+STR(MBUNGA)+"','"+STR(MPAJAK)+"','"+MARO+"','"+MKET+"','"+BUNGA_KE+"','"+BUNGA_REK+"','"+BUNGA_NAMA+"','"+MJURTAB+"','"+MJURBUNGA+"','"+MJURPAJAK+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert ke acc_harian_bungadeposito", 0, "")
RETURN
ENDIF
ENDIF
SELECT DEP
SKIP
ENDDO
SELECT DEP
USE
CSQL = "select distinct produk from acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca produk")
ENDIF
DO WHILE  .NOT. EOF()
MPRODUK = PRODUK
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='2' and sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX("Gagal baca sandi")
ENDIF
MKET = KETERANGAN
MJURTAB = IIF(ISNULL(JURNALTAB), '', JURNALTAB)
MJURBG = IIF(ISNULL(JURNALBUNGA), '', JURNALBUNGA)
MJURPJK = IIF(ISNULL(JURNALPAJAK), '', JURNALPAJAK)
CSQL = "update acc_harian_bungadeposito set produk='"+MKET+"', jurtab='"+MJURTAB+"', jurbg='"+MJURBG+"', jurpjk='"+MJURPJK+"' "+"where kel_id='"+STR(MIDDATA)+"' and produk='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update")
ENDIF
SELECT SMT
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
IF NUSER>0
MEDIT = MEDIT+"Perhitungan Jasa Simpanan Berjangka sebanyak "+ALLTRIM(STR(NUSER))+" Simpanan Berjangka"
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDIF
ENDIF
ENDIF
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
IF THISFORM.SIMP2.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='S05'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S05'
THISFORM.CONTAINER2.LABEL3.CAPTION = "PERPENJANGAN OTOMATIS SIMPANAN BERJANGKA"
MEDIT = MEDIT+CHR(13)+"PERPANJANGAN OTOMATIS SIMPANAN BERJANGKA"+CHR(13)+"----------------------------------------"+CHR(13)
PERTAMA = .T.
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "select a.*,b.* from simpanan as a left join simpanan_bilyet as b on a.norek=b.norek "+"where a.jenis='2' and b.tgljtempo='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and tgltutup='0000-00-00'"
IF DAY(MTGLPROSES)>28
MDAY = "day(b.tanggal)>'28'"
ELSE
MDAY = "day(b.tanggal)='"+STR(DAY(MTGLPROSES))+"'"
ENDIF
CSQL = "select a.norek as norek,b.tanggal as tanggal,ke,b.pokok as pokok,b.rate as rate,b.carahitung,lama,tglawal,tgljtempo,aro from simpanan as a left join simpanan_bilyet as b on a.norek=b.norek where b.tanggal="+"(select MAX(tanggal) from simpanan_bilyet where norek=a.norek) and b.tgljtempo='"+SQLDATE(MTGLPROSES)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "DEP")
JUMREC = RECCOUNT()
IF JUMREC>0
NUSER = 0
DO WHILE  .NOT. EOF()
NUSER = NUSER+1
MNOREK = NOREK
MTANGGAL = TANGGAL
MKE = KE
MPOKOK = POKOK
MRATE = RATE
MCARAHITUNG = CARAHITUNG
MLAMA = LAMA
MARO = ARO
MTGLAWAL = TGLAWAL
MTGLJTEMPO = TGLJTEMPO
MTGLJT = MTGLJTEMPO
FOR A = 1 TO MLAMA
MTGLJT = MAJU1BLN(MTGLJT, MTGLAWAL)
ENDFOR
CSQL = "select nama,alamat from simpanan as a left join anggota as b on a.cif=b.cif where a.norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNAMA = NAMA
MALAMAT = ALAMAT
USE
SELECT DEP
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S05'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S05','PERPANJANGAN OTOMATIS (ARO) SIMPANAN BERJANGKA (DEPOSITO)' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S05'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_dep_aro where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
CSQL = "insert into acc_harian_dep_aro (kel_id,kantor,tanggal,norek,nama,alamat,"+"nobilyet,rate_lama,ke,pokok,rate,carahitung,lama,aro,tglawal,tgljtempo,opt) "+" value ('"+STR(MIDDATA)+"','"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MNOREK+"','"+MNAMA+"','"+MALAMAT+"','"+MNOBILYET+"','"+TRANSFORM(MRATE, '999.99')+"','"+STR(MKE+1)+"','"+STR(MPOKOK)+"','"+STR(MRATE)+"','"+MCARAHITUNG+"','"+STR(MLAMA)+"','"+MARO+"','"+SQLDATE(MTGLJTEMPO)+"','"+SQLDATE(MTGLJT)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal baca")
ENDIF
SELECT DEP
SKIP
ENDDO
SELECT DEP
USE
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.SIMP3.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='S05'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S05'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "PROSES AUTODEBET"
MEDIT = MEDIT+CHR(13)+"PROSES AUTODEBET"+CHR(13)+"----------------------------------------"+CHR(13)+"Dalam Perbaikan"+CHR(13)
MPERTAMA = .T.
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "select * from simpanan_autodebet where tglcabut='000-00-00' and tglauto='"+STR(DAY(MTGLPROSES))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
MIDAUTODEBET = IDAUTODEBET
MNOREK = NOREK
CSQL = "select saldo from simpanan_mutasi where iddata="+"(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(TGLNOW)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "simp")
MSALDO = SALDO
USE
CSQL = "select nama from simpanan as a left join anggota as b on a.cif=b.cif where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
MNAMA = NAMA
USE
SELECT SMT
MKET = KET
MJUMLAH = JUMLAH
MNOREK_TUJUAN = NOREK_TUJUAN
MPIL = OPT_REK
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S02','DAFTAR AUTO DEBET SIMPANAN' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_autodebet where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT SMT
CSQL = "insert into acc_harian_autodebet (kel_id,KANTOR,idautodebet,tanggal,norek,nama,saldo,ket,"+"jumlah,opt_rek,norek_tujuan,tglauto,tglakhir) values ('"+STR(MIDDATA)+"','"+DEFAKANTOR+"','"+STR(IDAUTODEBET)+"','"+SQLDATE(TANGGAL)+"','"+NOREK+"','"+MNAMA+"','"+TRANSFORM(MSALDO, '999999999999999')+"','"+KET+"','"+TRANSFORM(JUMLAH, '999999999999999')+"','"+STR(OPT_REK)+"','"+NOREK_TUJUAN+"','"+STR(TGLAUTO)+"','"+SQLDATE(TGLAKHIR)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan autodebet")
ENDIF
SKIP
ENDDO
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
IF THISFORM.AKT1.VALUE=1
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "PROSES POSTING NERACA / LABA - RUGI"
MEDIT = MEDIT+CHR(13)+"PROSES POSTING NERACA"+CHR(13)+"----------------------------------------"+CHR(13)
CSQL = "select * from jurnal where tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and tanggal<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
DO WHILE  .NOT. EOF()
MNOPER = NOPER
CSQL = "select noper,detail from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek1")
IF NOPER<>MNOPER
MEDIT = MEDIT+"Tanggal : "+DTOC(CEK.TANGGAL)+" Bukti : "+CEK.BUKTI+" Nomor Perkiraan tidak terdapat di Daftar Perkiraan"+CHR(13)
ENDIF
IF DETAIL='T'
MEDIT = MEDIT+"Tanggal : "+DTOC(CEK.TANGGAL)+" Bukti : "+CEK.BUKTI+" Nomor Tidak dapat digunakan untuk transaksi"+CHR(13)
ENDIF
USE
SELECT CEK
SKIP
ENDDO
SELECT CEK
USE
MTGLPROSES = THISFORM.TEXT1.VALUE
DO WHILE .T.
IF MTGLPROSES>THISFORM.TEXT2.VALUE
EXIT
ENDIF
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "delete from neraca where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(MTGLPROSES)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select noper from perkiraan where detail='Y'"
LCEK = SQLEXEC(OODBC, CSQL, "AKT")
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
JUMREC = RECCOUNT()
GOTO TOP
DO WHILE  .NOT. EOF()
THISFORM.CONTAINER2.SHAPE5.WIDTH = (RECNO()/JUMREC)*705
HITNERACA(DEFAKANTOR, ALLTRIM(NOPER), MTGLPROSES)
SELECT AKT
SKIP
ENDDO
HITLABA(MTGLPROSES)
SELECT AKT
USE
MTGLPROSES = MTGLPROSES+1
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDDO
ENDIF
IF THISFORM.AKT3.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='GL1'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'GL1'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "PROSES PENYUSUTAN INVENTARIS"
MEDIT = MEDIT+CHR(13)+"PROSES PENYUSUTAN INVENTARIS"+CHR(13)+"----------------------------------------------"+CHR(13)
CSQL = "select * from gl_inventaris where nilaibuku>0"
LCEK = SQLEXEC(OODBC, CSQL, "INV")
PERTAMA = .T.
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF MTGLPROSES=AKHIRBLN(MTGLPROSES) .AND. THISFORM.AKT3.VALUE=1
MR = 0
SELECT INV
GOTO TOP
DO WHILE  .NOT. EOF()
MBUKT = MBUKTI
MNOMORID = NOMORID
MTANGGAL = TANGGAL
MHARGA = HARGA
MLAMA = LAMA
MPERBLN = PENYUSUTAN
MJURBIAYA = JUR_BIAYA
MJURAKUM = JUR_AKUM
MNAMA = NAMA
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='GL1'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','GL1','PENYUSUTAN INVENTARIS' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='GL1'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_inventaris where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
CSQL = "select SUM(kredit)-SUM(debet) as jmlmts from gl_inventaris_mutasi where nomorid='"+STR(MNOMORID)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "MTS")
MJMLMTS = MAX(IIF(ISNULL(JMLMTS), 0, JMLMTS), 0)
IF MJMLMTS<MHARGA
IF .T.
MBLN = (YEAR(MTGLPROSES)-YEAR(MTANGGAL))*12+(MONTH(MTGLPROSES)-MONTH(MTANGGAL))+1
MHARUS = MBLN*MPERBLN
MSELISIH = MHARUS-MJMLMTS
IF MSELISIH>0
CSQL = "insert into acc_harian_inventaris (kel_id,kantor,tanggal,idinvent,keterangan,debet,kredit,opt,nama,jur_biaya,jur_akum) value "+"(?mIdData,?DefaKantor,?mtglproses,?mNomorId,'"+"PENYUSUTAN BLN "+ALLTRIM(STR(MONTH(MTGLPROSES)))+"',?mselisih,'0',?DefaUserId,?mNama,?mJurbiaya,?mjurakum)"
LCEK = SQLEXEC(OODBC, CSQL, 'SMT')
ENDIF
ELSE
ENDIF
ENDIF
SELECT INV
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN4.VALUE=1
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
HARISEBELUM = VAL(CARIPUBLIC("HARIJTANGS"))
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='P02'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'P02'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "JATUH TEMPO ANGSURAN"
MEDIT = MEDIT+CHR(13)+"JATUH TEMPO ANGSURAN"+CHR(13)+"----------------------------------------------"+CHR(13)
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
MAKHBLN = .F.
IF MTGLPROSES=AKHIRBLN(MTGLPROSES)
MAKHBLN = .T.
ENDIF
IF .T.
IF MAKHBLN
CSQL = "select a.tanggal,a.norek,a.pokok,a.rate,a.lama,a.tgljtempo,b.nama,b.alamat,b.phone from pinjaman as a, anggota as b where "+"a.cif=b.cif and tgllunas='000-00-00' and tgljtempo>'"+SQLDATE(MTGLPROSES-HARISEBELUM)+"' and DAY(a.tanggal)>='"+STR(DAY(MTGLPROSES-HARISEBELUM))+"'"
ELSE
CSQL = "select a.tanggal,a.norek,a.pokok,a.rate,a.lama,a.tgljtempo,b.nama,b.alamat,b.phone from pinjaman as a, anggota as b where "+"a.cif=b.cif and tgllunas='000-00-00' and tgljtempo>'"+SQLDATE(MTGLPROSES-HARISEBELUM)+"' and DAY(a.tanggal)='"+STR(DAY(MTGLPROSES-HARISEBELUM))+"'"
ENDIF
PERTAMA = .T.
LCEK = SQLEXEC(OODBC, CSQL, "KRD")
MR = 0
GOTO TOP
DO WHILE  .NOT. EOF()
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='P02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','P02','PINJAMAN JATUH TEMPO ANGSURAN' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='P02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_angsuranjt where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT KRD
MNAMA = NAMA
MALAMAT = ALAMAT
MNOREK = NOREK
MPHONE = PHONE
MCUR = SALDOKRD(MNOREK, MTGLPROSES)
SELECT (MCUR)
MTUNGPK = ODPK
MTUNGBG = ODBG
MDENDA = DENDA
MANGSPK = NJDWPK
MANGSBG = NJDWBG
USE
SELECT KRD
CSQL = "insert into acc_harian_angsuranjt (kel_id,kantor,tanggal,norek,nama,alamat,phone,tungpk,tungbg,tungdenda,angspokok,angsbunga) value "+"(?mIdData,?DefaKantor,?tglnow,?mnorek,?mNama,?mAlamat,?mPhone,?mtungpk,?mtungbg,?mdenda,?mAngspk,?mAngsbg)"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT KRD
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN5.VALUE=1
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
HARISEBELUM = VAL(CARIPUBLIC("HARIJTPINJ"))
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='P03'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'P03'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "JATUH TEMPO PINJAMAN"
MEDIT = MEDIT+CHR(13)+"JATUH TEMPO PINJAMAN"+CHR(13)+"----------------------------------------------"+CHR(13)
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF .T.
CSQL = "select a.tanggal,a.norek,a.pokok,a.rate,a.lama,a.tgljtempo,b.nama,b.alamat,b.phone from pinjaman as a, anggota as b where "+"a.cif=b.cif and tgllunas='000-00-00' and tgljtempo='"+SQLDATE(MTGLPROSES-HARISEBELUM)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "KRD")
PERTAMA = .T.
MR = 0
GOTO TOP
DO WHILE  .NOT. EOF()
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='P03'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','P03','PINJAMAN JATUH TEMPO PERJANJIAN' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='P02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_pinjamanjt where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT KRD
MNAMA = NAMA
MALAMAT = ALAMAT
MNOREK = NOREK
MPHONE = PHONE
MCUR = SALDOKRD(MNOREK, MTGLPROSES)
SELECT (MCUR)
MTUNGPK = ODPK
MTUNGBG = ODBG
MDENDA = DENDA
MANGSPK = NJDWPK
MANGSBG = NJDWBG
USE
SELECT KRD
CSQL = "insert into acc_harian_pinjamanjt (kel_id,kantor,tanggal,norek,nama,alamat,phone,tungpk,tungbg,tungdenda,angspokok,angsbunga) value "+"(?mIdData,?DefaKantor,?tglnow,?mnorek,?mNama,?mAlamat,?mPhone,?mtungpk,?mtungbg,?mdenda,?mAngspk,?mAngsbg)"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT KRD
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN3.VALUE=1
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
HARISEBELUM = VAL(CARIPUBLIC("HARIULTAH"))
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='A02'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'A02'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "ULANG TAHUN NASABAH"
MEDIT = MEDIT+CHR(13)+"ULANG TAHUN NASABAH"+CHR(13)+"----------------------------------------------"+CHR(13)
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF .T.
CSQL = "select * from anggota where DAY(tanggallhr)='"+STR(DAY(MTGLPROSES-HARISEBELUM))+"' and MONTH(tanggallhr)='"+STR(MONTH(MTGLPROSES-HARISEBELUM))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "ULTAH")
MR = 0
PERTAMA = .T.
GOTO TOP
DO WHILE  .NOT. EOF()
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='A02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','A02','ULANG TAHUN ANGGOTA / NASABAH' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='A02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_ulangtahun where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT ULTAH
MNAMA = NAMA
MALAMAT = ALAMAT
MNOANGG = CIF
MPHONE = PHONE
MTGLLAHIR = TANGGALLHR
MUMUR = YEAR(TGLNOW)-YEAR(TANGGALLHR)
CSQL = "insert into acc_harian_ulangtahun (kel_id,kantor,tanggal,noangg,nama,alamat,phone,tgllahir,umur) value "+"(?mIdData,?DefaKantor,?tglnow,?mnoangg,?mNama,?mAlamat,?mPhone,?mtgllahir,?mumur)"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT ULTAH
SKIP
ENDDO
ENDIF
SELECT ULTAH
USE
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN1.VALUE=1
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
HARISEBELUM = VAL(CARIPUBLIC("HARICTT"))
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='A01'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'A01'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "CEK CATATAN"
MEDIT = MEDIT+CHR(13)+"CATATAN"+CHR(13)+"----------------------------------------"+CHR(13)
CSQL = "select * from catatan where tglselesai='0000-00-00' and vld<>'1'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
PERTAMA = .T.
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
GOTO TOP
DO WHILE  .NOT. EOF()
ADA = .F.
DO CASE
CASE VLD2="1"
IF TGLVALID>=MTGLPROSES-HARISEBELUM
ADA = .T.
MCATATAN = CATATAN
ENDIF
CASE VLD2="2"
IF TGLVALID=MTGLPROSES-HARISEBELUM
ADA = .T.
MCATATAN = CATATAN
ENDIF
CASE VLD2="3"
IF DAY(TGLVALID)=DAY(MTGLPROSES-HARISEBELUM)
ADA = .T.
MCATATAN = CATATAN
ENDIF
ENDCASE
IF PERTAMA .AND. ADA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='A01'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','A01','TERDAPAT CATATAN' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='A01'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_catatan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT SMT
IF ADA
CSQL = "insert into acc_harian_catatan (kel_id,kantor,DEPT,norek,idcatatan,tanggal,catatan) value ("+"'"+STR(MIDDATA)+"','"+DEFAKANTOR+"','"+DEPT+"','"+NOREK+"','"+STR(IDCATATAN)+"','"+SQLDATE(TANGGAL)+"','"+CATATAN+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SKIP
ENDDO
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN2.VALUE=1
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "CEK VALIDASI"
MEDIT = MEDIT+CHR(13)+"VALIDASI DATA"+CHR(13)+"----------------------------------------"+CHR(13)
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and ket2='NRC_AKT'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOPER1 = ALLTRIM(KETERANGAN)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and ket2='NRC_PSV'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOPER2 = ALLTRIM(KETERANGAN)
USE
CSQL = "select noper,hitneraca('"+DEFAKANTOR+"',noper,'"+SQLDATE(MTGLPROSES)+"') as saldo from  perkiraan where "+"LEFT(noper,length("+STR(LEN(MNOPER1))+"))='"+MNOPER1+"' or LEFT(noper,length("+STR(LEN(MNOPER2))+"))='"+MNOPER2+"' "
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca neraca")
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
CSQL = "insert into log_proses (kantor,tanggal,tglproses,keterangan,opt) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+SQLDATE(THISFORM.TEXT2.VALUE)+"','"+MEDIT+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
THISFORM.CONTAINER2.EDIT1.VALUE = CSQL
ENDIF
CSQL = "update batastanggal set tglawal='"+SQLDATE(THISFORM.TEXT2.VALUE)+"', tglakhir='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
MESSAGEBOX("PROSES HARIAN, SELESAI", 0, "")
THISFORM.COMMAND2.SETFOCUS
ENDPROC
**
*
*  proses_harian3.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  proses_harian3.scx::Text1
**
PROCEDURE LostFocus
IF THISFORM.MODE=1
THISFORM.TEXT2.VALUE = THIS.VALUE
ENDIF
ENDPROC
**
*
*  proses_harian3.scx::Text2
**
PROCEDURE LostFocus
IF LASTKEY()=5
RETURN
ENDIF
IF THIS.VALUE<THISFORM.TEXT1.VALUE
MESSAGEBOX("Tanggal proses Harap dicek lagi")
NODEFAULT
RETURN
ENDIF
IF THIS.VALUE-THISFORM.TEXT1.VALUE>60
MESSAGEBOX("Proses Terlalu lama, harap diproses bertahap")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** proses_harian3.sct
***
*
***
*** a3.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
CLOSE DATABASES
CLEAR
CREATE CURSOR tempcursor (NOREK C (25), NAMA C (25), ALAMAT C (40))
APPEND BLANK
REPLACE NOREK WITH "130.01.000001", NAMA WITH "COBA NAMA", ALAMAT WITH "ALAAAAAAAAAMAAAAAAAAAAATTT"
LCTMPFRX = "Test.frx"
CREATE REPORT (LCTMPFRX) FROM (DBF())
SELECT 0
USE ctk_buku_header.frx
SELECT 0
USE EXCLUSIVE (LCTMPFRX)
ZAP
APPEND FROM ctk_buku_header.frx
SELECT * FROM (LCTMPFRX) INTO TABLE temp.frx
USE
SELECT TEMPCURSOR
REPORT FORM temp PREVIEW
RETURN
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** test.frx
***
*
***
*** test.frt
***
*
***
*** temp.frx
***
*
***
*** temp.frt
***
*
***
*** acc_harian_angsuranjt.scx
***
*
*
*  acc_harian_angsuranjt.scx::FORM1
**
FUNCTION cekservice
PARAMETER LCSERVICENAME
OSHELLAPP = CREATEOBJECT("Shell.Application")
IF  .NOT. OSHELLAPP.ISSERVICERUNNING(LCSERVICENAME)
IF OSHELLAPP.SERVICESTART(LCSERVICENAME, .F.)
RETURN .T.
ELSE
RETURN .F.
ENDIF
ELSE
RETURN .T.
ENDIF
ENDFUNC
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
ELSE
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND5.VISIBLE = .T.
ENDIF
THISFORM.LABEL8.CAPTION = DTOC(TANGGAL)
THISFORM.LABEL2.CAPTION = DTOC(TANGGAL)
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
MSERVICE = THISFORM.CEKSERVICE("GAMMUSMSD")
THISFORM.COMMAND4.ENABLED = MSERVICE
CSQL = "select COUNT(norek) as user, sum(angspokok) as pk, SUM(angsbunga) as bg from acc_harian_angsuranjt where kel_id='"+STR(MIDDATA)+"' group by kel_id"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
THISFORM.TEXT3.VALUE = VAL(USER)
THISFORM.TEXT4.VALUE = PK+BG
CSQL = "select * from acc_harian_angsuranjt where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 6
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NO.REKENING"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 200
.COLUMN3.CONTROLSOURCE = "ALAMAT"
.COLUMN3.HEADER1.CAPTION = "ALAMAT"
.COLUMN3.ALIGNMENT = 0
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "PHONE"
.COLUMN4.HEADER1.CAPTION = "PHONE"
.COLUMN4.ALIGNMENT = 0
.COLUMN5.WIDTH = 90
.COLUMN5.CONTROLSOURCE = "TRANS(ANGSPOKOK,'9,999,999,999')"
.COLUMN5.HEADER1.CAPTION = "ANGS. POKOK"
.COLUMN5.ALIGNMENT = 1
.COLUMN6.WIDTH = 90
.COLUMN6.CONTROLSOURCE = "TRANS(ANGSBUNGA,'9,999,999,999')"
.COLUMN6.HEADER1.CAPTION = "ANGS. BUNGA"
.COLUMN6.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_harian_angsuranjt.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_angsuranjt.scx::Command4
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM frm_bukti TO MBUKTI WITH THISFORM.TEXT1.VALUE
IF  .NOT. EMPTY(MBUKTI)
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTGL = TANGGAL
MJASA = JASA
MPJK = PAJAK
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
USE
IF MJASA>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABBG+"','"+"JASA SIMPANAN"+"','0','"+STR(MJASA)+"','"+TRANSFORM(MSALDO+MJASA, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF MPJK>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABPJK+"','"+"PAJAK JASA SIMPANAN"+"','"+STR(MPJK)+"','"+STR(0)+"','"+TRANSFORM(MSALDO+MJASA-MPJK, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(MTGL)+"', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT sum( jasa ) AS bg, sum( pajak ) AS pjk, jurtab,jurbg,jurpjk FROM acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"' GROUP BY produk"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
MJURBG = JURBG
MJURPJK = JURPJK
MJURTAB = JURTAB
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURBG+"','JASA SIMPANAN','"+TRANSFORM(BG, '999999999999')+"','"+MOPTACC+"'), "
IF PJK>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURPJK+"','JASA SIMPANAN','"+TRANSFORM(0-PJK, '999999999999')+"','"+MOPTACC+"'), "
ENDIF
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURTAB+"','JASA SIMPANAN','"+TRANSFORM(0-(BG-PJK), '999999999999')+"','"+MOPTACC+"')"
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, MJURBG, MTGL)
HITNERACA(DEFAKANTOR, MJURPJK, MTGL)
HITNERACA(DEFAKANTOR, MJURTAB, MTGL)
SELECT SMT
SKIP
ENDDO
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_angsuranjt.scx::Command5
**
PROCEDURE Click
MTANGGAL = CTOD(THISFORM.LABEL8.CAPTION)
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(MTANGGAL)+"' and kode='P02' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_angsuranjt where tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_angsuranjt.scx::Command2
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE Click
SELECT RINCI_TRANS
REPORT FORM acc_angsuranjt PREVIEW
ENDPROC
**
***
*** acc_harian_angsuranjt.sct
***
*
***
*** acc_harian_pinjamanjt.scx
***
*
*
*  acc_harian_pinjamanjt.scx::FORM1
**
FUNCTION cekservice
PARAMETER LCSERVICENAME
OSHELLAPP = CREATEOBJECT("Shell.Application")
IF  .NOT. OSHELLAPP.ISSERVICERUNNING(LCSERVICENAME)
IF OSHELLAPP.SERVICESTART(LCSERVICENAME, .F.)
RETURN .T.
ELSE
RETURN .F.
ENDIF
ELSE
RETURN .T.
ENDIF
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
ELSE
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND5.VISIBLE = .T.
ENDIF
THISFORM.LABEL8.CAPTION = DTOC(TANGGAL)
THISFORM.LABEL2.CAPTION = DTOC(TANGGAL)
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
MSERVICE = THISFORM.CEKSERVICE("GAMMUSMSD")
THISFORM.COMMAND4.ENABLED = MSERVICE
CSQL = "select COUNT(norek) as user, sum(angspokok) as pk, SUM(angsbunga) as bg from acc_harian_pinjamanjt where kel_id='"+STR(MIDDATA)+"' group by kel_id"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
THISFORM.TEXT3.VALUE = VAL(USER)
THISFORM.TEXT4.VALUE = PK+BG
CSQL = "select * from acc_harian_pinjamanjt where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 6
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NO.REKENING"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 200
.COLUMN3.CONTROLSOURCE = "ALAMAT"
.COLUMN3.HEADER1.CAPTION = "ALAMAT"
.COLUMN3.ALIGNMENT = 0
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "PHONE"
.COLUMN4.HEADER1.CAPTION = "PHONE"
.COLUMN4.ALIGNMENT = 0
.COLUMN5.WIDTH = 90
.COLUMN5.CONTROLSOURCE = "TRANS(ANGSPOKOK,'9,999,999,999')"
.COLUMN5.HEADER1.CAPTION = "ANGS. POKOK"
.COLUMN5.ALIGNMENT = 1
.COLUMN6.WIDTH = 90
.COLUMN6.CONTROLSOURCE = "TRANS(ANGSBUNGA,'9,999,999,999')"
.COLUMN6.HEADER1.CAPTION = "ANGS. BUNGA"
.COLUMN6.ALIGNMENT = 1
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
*
*  acc_harian_pinjamanjt.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_pinjamanjt.scx::Command4
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM frm_bukti TO MBUKTI WITH THISFORM.TEXT1.VALUE
IF  .NOT. EMPTY(MBUKTI)
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTGL = TANGGAL
MJASA = JASA
MPJK = PAJAK
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
USE
IF MJASA>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABBG+"','"+"JASA SIMPANAN"+"','0','"+STR(MJASA)+"','"+TRANSFORM(MSALDO+MJASA, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF MPJK>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABPJK+"','"+"PAJAK JASA SIMPANAN"+"','"+STR(MPJK)+"','"+STR(0)+"','"+TRANSFORM(MSALDO+MJASA-MPJK, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(MTGL)+"', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT sum( jasa ) AS bg, sum( pajak ) AS pjk, jurtab,jurbg,jurpjk FROM acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"' GROUP BY produk"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
MJURBG = JURBG
MJURPJK = JURPJK
MJURTAB = JURTAB
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURBG+"','JASA SIMPANAN','"+TRANSFORM(BG, '999999999999')+"','"+MOPTACC+"'), "
IF PJK>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURPJK+"','JASA SIMPANAN','"+TRANSFORM(0-PJK, '999999999999')+"','"+MOPTACC+"'), "
ENDIF
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURTAB+"','JASA SIMPANAN','"+TRANSFORM(0-(BG-PJK), '999999999999')+"','"+MOPTACC+"')"
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, MJURBG, MTGL)
HITNERACA(DEFAKANTOR, MJURPJK, MTGL)
HITNERACA(DEFAKANTOR, MJURTAB, MTGL)
SELECT SMT
SKIP
ENDDO
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_pinjamanjt.scx::Command5
**
PROCEDURE Click
MTANGGAL = CTOD(THISFORM.LABEL8.CAPTION)
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(MTANGGAL)+"' and kode='P03' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_pinjamanjt where tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_pinjamanjt.scx::Command2
**
PROCEDURE Click
SELECT RINCI_TRANS
REPORT FORM acc_pinjamanjt PREVIEW
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
***
*** acc_harian_pinjamanjt.sct
***
*
***
*** acc_harian_ulangtahun.scx
***
*
*
*  acc_harian_ulangtahun.scx::FORM1
**
FUNCTION cekservice
PARAMETER LCSERVICENAME
OSHELLAPP = CREATEOBJECT("Shell.Application")
IF  .NOT. OSHELLAPP.ISSERVICERUNNING(LCSERVICENAME)
IF OSHELLAPP.SERVICESTART(LCSERVICENAME, .F.)
RETURN .T.
ELSE
RETURN .F.
ENDIF
ELSE
RETURN .T.
ENDIF
ENDFUNC
**
PROCEDURE Init
IF  .NOT. EMPTY(TGLACC)
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
ELSE
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND5.VISIBLE = .T.
ENDIF
THISFORM.LABEL8.CAPTION = DTOC(TANGGAL)
THISFORM.LABEL2.CAPTION = DTOC(TANGGAL)
MIDDATA = IDDATA
THISFORM.IDDATA = IDDATA
THISFORM.OLDSELECT = SELECT()
MSERVICE = THISFORM.CEKSERVICE("GAMMUSMSD")
THISFORM.COMMAND4.ENABLED = MSERVICE
CSQL = "select COUNT(noangg) as user from acc_harian_ulangtahun where kel_id='"+STR(MIDDATA)+"' group by kel_id"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
THISFORM.TEXT3.VALUE = VAL(USER)
CSQL = "select * from acc_harian_ulangtahun where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "Rinci_trans")
WITH THISFORM.GRID1
.RECORDSOURCE = "Rinci_trans"
.COLUMNCOUNT = 4
.COLUMN1.WIDTH = 100
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = "NO.REKENING"
.COLUMN1.ALIGNMENT = 0
.COLUMN2.WIDTH = 150
.COLUMN2.CONTROLSOURCE = "NAMA"
.COLUMN2.HEADER1.CAPTION = "NAMA"
.COLUMN2.ALIGNMENT = 0
.COLUMN3.WIDTH = 200
.COLUMN3.CONTROLSOURCE = "ALAMAT"
.COLUMN3.HEADER1.CAPTION = "ALAMAT"
.COLUMN3.ALIGNMENT = 0
.COLUMN4.WIDTH = 90
.COLUMN4.CONTROLSOURCE = "PHONE"
.COLUMN4.HEADER1.CAPTION = "PHONE"
.COLUMN4.ALIGNMENT = 0
.REFRESH
ENDWITH
THISFORM.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Unload
SELECT RINCI_TRANS
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_harian_ulangtahun.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_ulangtahun.scx::Command4
**
PROCEDURE Click
MIDDATA = THISFORM.IDDATA
DO FORM frm_bukti TO MBUKTI WITH THISFORM.TEXT1.VALUE
IF  .NOT. EMPTY(MBUKTI)
DO FORM acc_opt TO MOPTACC
IF  .NOT. EMPTY(MOPTACC)
SELECT RINCI_TRANS
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MTGL = TANGGAL
MJASA = JASA
MPJK = PAJAK
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGL)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
USE
IF MJASA>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABBG+"','"+"JASA SIMPANAN"+"','0','"+STR(MJASA)+"','"+TRANSFORM(MSALDO+MJASA, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF MPJK>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+DEFATABPJK+"','"+"PAJAK JASA SIMPANAN"+"','"+STR(MPJK)+"','"+STR(0)+"','"+TRANSFORM(MSALDO+MJASA-MPJK, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SELECT RINCI_TRANS
SKIP
ENDDO
CSQL = "UPDATE acc_harian set tglacc='"+SQLDATE(MTGL)+"', optacc='"+MOPTACC+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "SELECT sum( jasa ) AS bg, sum( pajak ) AS pjk, jurtab,jurbg,jurpjk FROM acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"' GROUP BY produk"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
MJURBG = JURBG
MJURPJK = JURPJK
MJURTAB = JURTAB
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI, NOPER,KETERANGAN,JUMLAH,INPOPR) value "+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURBG+"','JASA SIMPANAN','"+TRANSFORM(BG, '999999999999')+"','"+MOPTACC+"'), "
IF PJK>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURPJK+"','JASA SIMPANAN','"+TRANSFORM(0-PJK, '999999999999')+"','"+MOPTACC+"'), "
ENDIF
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(MTGL)+"','"+MBUKTI+"','"+JURTAB+"','JASA SIMPANAN','"+TRANSFORM(0-(BG-PJK), '999999999999')+"','"+MOPTACC+"')"
LCEK = SQLEXEC(OODBC, CSQL)
HITNERACA(DEFAKANTOR, MJURBG, MTGL)
HITNERACA(DEFAKANTOR, MJURPJK, MTGL)
HITNERACA(DEFAKANTOR, MJURTAB, MTGL)
SELECT SMT
SKIP
ENDDO
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_ulangtahun.scx::Command5
**
PROCEDURE Click
MTANGGAL = CTOD(THISFORM.LABEL8.CAPTION)
CSQL = "delete from acc_harian where tanggal='"+SQLDATE(MTANGGAL)+"' and kode='A02' "
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "delete from acc_harian_ulangtahun where tanggal='"+SQLDATE(MTANGGAL)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_ulangtahun.scx::Command2
**
PROCEDURE MouseLeave
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .F.
THIS.FONTUNDERLINE = .F.
ENDPROC
**
PROCEDURE MouseMove
LPARAMETERS NBUTTON, NSHIFT, NXCOORD, NYCOORD
THIS.FONTBOLD = .T.
THIS.FONTUNDERLINE = .T.
ENDPROC
**
PROCEDURE Click
SELECT RINCI_TRANS
REPORT FORM acc_ulangtahun PREVIEW
ENDPROC
**
***
*** acc_harian_ulangtahun.sct
***
*
***
*** acc_pinjamanjt.frx
***
*
***
*** acc_pinjamanjt.frt
***
*
***
*** acc_angsuranjt.frx
***
*
***
*** acc_angsuranjt.frt
***
*
***
*** acc_ulangtahun.frx
***
*
***
*** acc_ulangtahun.frt
***
*
***
*** smsgateway1.scx
***
*
*
*  smsgateway1.scx::FORM1
**
PROCEDURE simpan
PARAMETER MIDDATA, MDATA
LOCAL OLDSELE
OLDSELE = SELECT()
CSQL = "select ket2 from setsandi where ket2='"+MIDDATA+"' and kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal Baca setsandi")
ENDIF
IF KET2=MIDDATA
CSQL = "update setsandi set keterangan='"+MDATA+"' where ket2='"+MIDDATA+"' and kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL)
ELSE
CSQL = "insert into setsandi (kantor,kode,sandi,ket2,keterangan) value "+"('"+DEFAKANTOR+"','SYS','PUB','"+MIDDATA+"','"+MDATA+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE Init
THISFORM.DATABASE = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'SMSGATEWAY'))
IF EMPTY(THISFORM.DATABASE)
THISFORM.PAGEFRAME1.PAGE1.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE2.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE3.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE4.ENABLED = .F.
ELSE
THISFORM.PAGEFRAME1.ACTIVEPAGE = 1
ENDIF
THISFORM.PAGEFRAME1.PAGE1.FONTNAME = "Calibri"
THISFORM.PAGEFRAME1.PAGE2.FONTNAME = "Calibri"
THISFORM.PAGEFRAME1.PAGE3.FONTNAME = "Calibri"
THISFORM.PAGEFRAME1.PAGE4.FONTNAME = "Calibri"
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE1.FONTNAME = "Calibri"
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.FONTNAME = "Calibri"
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.FONTNAME = "Calibri"
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE4.FONTNAME = "Calibri"
ENDPROC
**
*
*  smsgateway1.scx::Pageframe1
**
PROCEDURE Page1.Activate
CSQL = "select * from "+ALLTRIM(THISFORM.DATABASE)+".inbox where UpdatedInDB>='"+SQLDATE(TGLNOW-3)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "inbox")
WITH THISFORM.PAGEFRAME1.PAGE1.GRID1
.RECORDSOURCE = "inbox"
.COLUMNCOUNT = 3
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "ReceivingDateTime"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "SMSCNumber"
.COLUMN2.HEADER1.CAPTION = "SMSCNumber"
.COLUMN3.WIDTH = 500
.COLUMN3.CONTROLSOURCE = "TEXT"
.COLUMN3.HEADER1.CAPTION = "TEXT"
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.PAGEFRAME1.PAGE1.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Page1.Deactivate
SELECT INBOX
USE
ENDPROC
**
PROCEDURE Page2.Activate
CSQL = "select * from "+ALLTRIM(THISFORM.DATABASE)+".sentitems where UpdatedInDB>='"+SQLDATE(TGLNOW-3)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "outbox")
WITH THISFORM.PAGEFRAME1.PAGE2.GRID1
.RECORDSOURCE = "outbox"
.COLUMNCOUNT = 3
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "UpdatedInDB"
.COLUMN1.HEADER1.CAPTION = "TANGGAL"
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "DestinationNumber"
.COLUMN2.HEADER1.CAPTION = "NO. TUJUAN"
.COLUMN3.WIDTH = 500
.COLUMN3.CONTROLSOURCE = "TEXT"
.COLUMN3.HEADER1.CAPTION = "TEXT"
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.PAGEFRAME1.PAGE2.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Page2.Deactivate
SELECT OUTBOX
USE
ENDPROC
**
PROCEDURE Page3.Activate
CSQL = "select * from "+ALLTRIM(THISFORM.DATABASE)+".inbox where UpdatedInDB>='"+SQLDATE(TGLNOW-3)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "gagal")
WITH THISFORM.PAGEFRAME1.PAGE3.GRID1
.RECORDSOURCE = "gagal"
.COLUMNCOUNT = 3
.BACKCOLOR = RGB(230, 255, 230)
.COLUMN1.WIDTH = 70
.COLUMN1.CONTROLSOURCE = "ReceivingDateTime"
.COLUMN1.HEADER1.CAPTION = "Tanggal"
.COLUMN2.WIDTH = 90
.COLUMN2.CONTROLSOURCE = "DestinationNumber"
.COLUMN2.HEADER1.CAPTION = "No. Tujuan"
.COLUMN3.WIDTH = 500
.COLUMN3.CONTROLSOURCE = "TEXT"
.COLUMN3.HEADER1.CAPTION = "Text"
.REFRESH
ENDWITH
THISFORM.PAGEFRAME1.PAGE3.GRID1.SETALL("DynamicBackColor", "IIF(MOD(RECNO( ), 2)=0, RGB(170,255,170) , RGB(230,255,230))", "Column")
THISFORM.PAGEFRAME1.PAGE3.GRID1.SETFOCUS
ENDPROC
**
PROCEDURE Page3.Deactivate
SELECT GAGAL
USE
ENDPROC
**
*
*  smsgateway1.scx::Pageframe1
**
PROCEDURE Page1.Activate
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE1.TEXT9.VALUE = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'SMSGATEWAY'))
ENDPROC
**
PROCEDURE Page2.Activate
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.EDIT1.VALUE = CARIPUBLIC("NOTIFULTAH")
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.EDIT2.VALUE = CARIPUBLIC("NOTIFLEBARAN")
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.EDIT3.VALUE = CARIPUBLIC("NOTIFNATAL")
ENDPROC
**
PROCEDURE Page3.Activate
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOTIFOPT = VAL(CARIPUBLIC("NOTIFOPTION"))
MNOTIFOPT = IIF(MNOTIFOPT=0, 1, MNOTIFOPT)
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.TEXT1.VALUE = VAL(CARIPUBLIC("NOTIFJML"))
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.OPTIONGROUP1.VALUE = MNOTIFOPT
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.EDIT1.VALUE = CARIPUBLIC("NOTIFKATA1")
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.EDIT2.VALUE = CARIPUBLIC("NOTIFKATA2")
ENDPROC
**
PROCEDURE Page4.Activate
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE4.EDIT1.VALUE = CARIPUBLIC("NOTIFJTANGS")
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE4.EDIT2.VALUE = CARIPUBLIC("NOTIFJTPINJ")
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE4.EDIT3.VALUE = CARIPUBLIC("NOTIFTUNGG")
ENDPROC
**
*
*  smsgateway1.scx::Cmdsimpan1
**
PROCEDURE Click
THISFORM.READINI1._WRITE('CONECTION', 'SMSGATEWAY', THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE1.TEXT9.VALUE)
THISFORM.DATABASE = THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE1.TEXT9.VALUE
IF EMPTY(THISFORM.DATABASE)
THISFORM.PAGEFRAME1.PAGE1.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE2.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE3.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE1.ACTIVATE
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.ENABLED = .F.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE4.ENABLED = .F.
ELSE
THISFORM.PAGEFRAME1.PAGE1.ENABLED = .T.
THISFORM.PAGEFRAME1.PAGE2.ENABLED = .T.
THISFORM.PAGEFRAME1.PAGE3.ENABLED = .T.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.ENABLED = .T.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.ENABLED = .T.
THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE4.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  smsgateway1.scx::Cmdsimpan1
**
PROCEDURE Click
THISFORM.SIMPAN("NOTIFULTAH", THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.EDIT1.VALUE)
THISFORM.SIMPAN("NOTIFLEBARAN", THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.EDIT2.VALUE)
THISFORM.SIMPAN("NOTIFNATAL", THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE2.EDIT3.VALUE)
ENDPROC
**
*
*  smsgateway1.scx::Cmdsimpan1
**
PROCEDURE Click
THISFORM.SIMPAN("NOTIFJML", STR(THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.TEXT1.VALUE))
THISFORM.SIMPAN("NOTIFOPTION", STR(THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.OPTIONGROUP1.VALUE))
THISFORM.SIMPAN("NOTIFKATA1", THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.EDIT1.VALUE)
THISFORM.SIMPAN("NOTIFKATA2", THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.EDIT2.VALUE)
ENDPROC
**
*
*  smsgateway1.scx::Cmdsimpan1
**
PROCEDURE Click
THISFORM.SIMPAN("NOTIFJTANGS", THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.EDIT1.VALUE)
THISFORM.SIMPAN("NOTIFJTPINJ", THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.EDIT2.VALUE)
THISFORM.SIMPAN("NOTIFTUNGG", THISFORM.PAGEFRAME1.PAGE4.PAGEFRAME1.PAGE3.EDIT3.VALUE)
ENDPROC
**
***
*** smsgateway1.sct
***
*
***
*** acc_penyusutan.frx
***
*
***
*** acc_penyusutan.frt
***
*
***
*** acc_admsimpanan.frx
***
*
***
*** acc_admsimpanan.frt
***
*
***
*** webcap.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
LOCAL OFORM
OFORM = CREATEOBJECT("Tform")
OFORM.SHOW(1)
ENDPROC
**
DEFINE CLASS Tform AS Form
WIDTH = 340
HEIGHT = 310
AUTOCENTER = .T.
CAPTION = "Using Video Capture"
MINBUTTON = .F.
MAXBUTTON = .F.
HWINDOW = 0
HCAPTURE = 0
CAPWIDTH = 0
CAPHEIGHT = 0
CAPOVERLAY = 0
ADD OBJECT CMDGETFRAME AS COMMANDBUTTON WITH DEFAULT = .T., LEFT = 15, TOP = 264, HEIGHT = 27, WIDTH = 90, CAPTION = "Get Frame", ENABLED = .F.
ADD OBJECT CMDPREVIEW AS COMMANDBUTTON WITH DEFAULT = .T., LEFT = 106, TOP = 264, HEIGHT = 27, WIDTH = 100, CAPTION = "Preview Video", ENABLED = .F.
ADD OBJECT CMDCLOSE AS COMMANDBUTTON WITH CANCEL = .T., LEFT = 250, TOP = 264, HEIGHT = 27, WIDTH = 70, CAPTION = "Close"
**
PROCEDURE Activate
IF THIS.HWINDOW=0
DECLARE INTEGER GetFocus IN user32
THIS.HWINDOW = GETFOCUS()
THIS.CREATECAPTUREWINDOW
THIS.DRIVERCONNECT
ENDIF
ENDPROC
**
PROCEDURE Destroy
THIS.RELEASECAPTUREWINDOW
ENDPROC
**
PROCEDURE cmdClose.Click
THISFORM.RELEASE
ENDPROC
**
PROCEDURE cmdGetFrame.Click
THISFORM.GETFRAME
ENDPROC
**
PROCEDURE cmdPreview.Click
THISFORM.STARTPREVIEW
ENDPROC
**
PROCEDURE GetFrame
THIS.MSG(001084, 0, 0)
ENDPROC
**
PROCEDURE CreateCaptureWindow
DECLARE INTEGER capCreateCaptureWindow IN avicap32 STRING, LONG, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER
THIS.HCAPTURE = CAPCREATECAPTUREWINDOW("", 1342177280, 10, 8, 320, 240, THIS.HWINDOW, 1)
ENDPROC
**
PROCEDURE DriverConnect
THIS.MSG(001034, 0, 0)
IF THIS.ISCAPTURECONNECTED()
THIS.GETCAPTUREDIMENSIONS
STORE .T. TO THIS.CMDGETFRAME.ENABLED, THIS.CMDPREVIEW.ENABLED
THIS.CAPTION = THIS.CAPTION+": connected, "+LTRIM(STR(THIS.CAPWIDTH))+"x"+LTRIM(STR(THIS.CAPHEIGHT))
ELSE
THIS.CAPTION = THIS.CAPTION+": failed to connect"
ENDIF
ENDPROC
**
PROCEDURE DriverDisconnect
THIS.MSG(001035, 0, 0)
ENDPROC
**
PROCEDURE ReleaseCaptureWindow
IF THIS.HCAPTURE<>0
THIS.DRIVERDISCONNECT
DECLARE INTEGER DestroyWindow IN user32 INTEGER
= DESTROYWINDOW(THIS.HCAPTURE)
THIS.HCAPTURE = 0
ENDIF
ENDPROC
**
PROCEDURE msg
LPARAMETERS MSG, WPARAM, LPARAM, NMODE
IF THIS.HCAPTURE=0
RETURN
ENDIF
IF VARTYPE(NMODE)<>"N" .OR. NMODE=0
DECLARE INTEGER SendMessage IN user32 INTEGER, INTEGER, INTEGER, INTEGER
= SENDMESSAGE(THIS.HCAPTURE, MSG, WPARAM, LPARAM)
ELSE
DECLARE INTEGER SendMessage IN user32 INTEGER, INTEGER, INTEGER, STRING @
= SENDMESSAGE(THIS.HCAPTURE, MSG, WPARAM, @LPARAM)
ENDIF
ENDPROC
**
FUNCTION IsCaptureConnected
LOCAL CBUFFER, NRESULT
CBUFFER = REPLICATE(CHR(0), 44)
THIS.MSG(001038, LEN(CBUFFER), @CBUFFER, 1)
THIS.CAPOVERLAY = BUF2DWORD(SUBSTR(CBUFFER, 5, 4))
NRESULT = ASC(SUBSTR(CBUFFER, 21, 1))
RETURN (NRESULT<>0)
ENDFUNC
**
PROCEDURE GetCaptureDimensions
LOCAL CBUFFER
CBUFFER = REPLICATE(CHR(0), 76)
THIS.MSG(001078, LEN(CBUFFER), @CBUFFER, 1)
THIS.CAPWIDTH = BUF2DWORD(SUBSTR(CBUFFER, 1, 4))
THIS.CAPHEIGHT = BUF2DWORD(SUBSTR(CBUFFER, 5, 4))
ENDPROC
**
PROCEDURE StartPreview
THIS.MSG(001076, 30, 0)
THIS.MSG(001074, 1, 0)
IF THIS.CAPOVERLAY<>0
THIS.MSG(001075, 1, 0)
ENDIF
ENDPROC
**
PROCEDURE StopPreview
THIS.MSG(001074, 0, 0)
ENDPROC
**
ENDDEFINE
**
FUNCTION buf2dword
LPARAMETERS LCBUFFER
RETURN ASC(SUBSTR(LCBUFFER, 1, 1))+BITLSHIFT(ASC(SUBSTR(LCBUFFER, 2, 1)), 8)+BITLSHIFT(ASC(SUBSTR(LCBUFFER, 3, 1)), 16)+BITLSHIFT(ASC(SUBSTR(LCBUFFER, 4, 1)), 24)
ENDFUNC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** krd_pelunasan1.frx
***
*
***
*** krd_pelunasan1.frt
***
*
***
*** pinjaman_mutasi_detail.scx
***
*
*
*  pinjaman_mutasi_detail.scx::FORM1
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDDBF)
ENDPROC
**
PROCEDURE Init
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.IDDATA = IDDATA
THISFORM.OLDDBF = SELECT()
THISFORM.DATA1 = "ANGS_DETAIL"
CSQL = "select * from pinjaman_mutasi where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, THISFORM.DATA1)
IF LCEK<1
MESSAGEBOX("gagal baca angsuran")
ENDIF
MNOREK = NOREK
CSQL = "select cif,kdhit from pinjaman where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("gagal baca pinjaman")
ENDIF
MCIF = CIF
MKDHIT = KDHIT
THISFORM.KDHIT = MKDHIT
CSQL = "select nama,alamat from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("gagal baca Anggota")
ENDIF
MNAMA = NAMA
IF MKDHIT='H'
THISFORM.LABEL7.CAPTION = "Debet"
THISFORM.LABEL8.CAPTION = "Kredit"
THISFORM.LABEL9.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
ELSE
THISFORM.LABEL7.CAPTION = "Pokok"
THISFORM.LABEL8.CAPTION = "Jasa"
THISFORM.LABEL9.VISIBLE = .T.
THISFORM.TEXT9.VISIBLE = .T.
ENDIF
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
SELECT (THISFORM.DATA1)
THISFORM.TEXT4.VALUE = TANGGAL
THISFORM.TEXT5.VALUE = BUKTI
THISFORM.TEXT6.VALUE = KODE
IF MKDHIT="H"
THISFORM.TEXT7.VALUE = DEBET
THISFORM.TEXT8.VALUE = KREDIT
THISFORM.TEXT9.VALUE = 0
ELSE
THISFORM.TEXT7.VALUE = POKOK
THISFORM.TEXT8.VALUE = JASA
THISFORM.TEXT9.VALUE = DENDA
ENDIF
THISFORM.TEXT10.VALUE = POKOK+JASA+DENDA+DEBET+KREDIT
THISFORM.TEXT11.VALUE = OPT
THISFORM.TEXT12.VALUE = LOGREFF
MASAL = ALLTRIM(MNOREK)+","+ALLTRIM(MNAMA)+","+DTOC(TANGGAL)+","+ALLTRIM(BUKTI)+","+KODE+","+ALLTRIM(STR(POKOK))+","+ALLTRIM(STR(JASA))+","+ALLTRIM(STR(DENDA))+","+ALLTRIM(STR(DEBET))+","+ALLTRIM(STR(KREDIT))+","+ALLTRIM(OPT)
THISFORM.DATA_ASAL = MASAL
THISFORM.COMMAND4.SETFOCUS
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  pinjaman_mutasi_detail.scx::Text7
**
PROCEDURE InteractiveChange
THISFORM.TEXT10.VALUE = THISFORM.TEXT7.VALUE+THISFORM.TEXT8.VALUE+THISFORM.TEXT9.VALUE
ENDPROC
**
*
*  pinjaman_mutasi_detail.scx::Text8
**
PROCEDURE InteractiveChange
THISFORM.TEXT10.VALUE = THISFORM.TEXT7.VALUE+THISFORM.TEXT8.VALUE+THISFORM.TEXT9.VALUE
ENDPROC
**
*
*  pinjaman_mutasi_detail.scx::Text9
**
PROCEDURE InteractiveChange
THISFORM.TEXT10.VALUE = THISFORM.TEXT7.VALUE+THISFORM.TEXT8.VALUE+THISFORM.TEXT9.VALUE
ENDPROC
**
*
*  pinjaman_mutasi_detail.scx::Command1
**
PROCEDURE Click
DO FORM frm_bukti TO MBUKTI WITH TGLNOW
IF EMPTY(MBUKTI)
NODEFAULT
RETURN
ENDIF
THISFORM.BUKTI = MBUKTI
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .T.
THISFORM.TEXT8.ENABLED = .T.
THISFORM.TEXT9.ENABLED = .T.
THISFORM.LABEL13.CAPTION = "KOREKSI SLIP ANGSURAN"
THISFORM.LABEL14.CAPTION = THISFORM.LABEL13.CAPTION
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  pinjaman_mutasi_detail.scx::Command2
**
PROCEDURE Click
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.LABEL13.CAPTION = "SLIP ANGSURAN"
THISFORM.LABEL14.CAPTION = THISFORM.LABEL13.CAPTION
ENDPROC
**
*
*  pinjaman_mutasi_detail.scx::Command3
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
IF THISFORM.TEXT10.VALUE<>POKOK+JASA+DENDA+DEBET+KREDIT
MESSAGEBOX("HARAP DIPERIKSA LAGI"+CHR(13)+"Jumlah Koreksi Tidak sama dengan"+CHR(13)+"Jumlah Awal", 16, "")
THISFORM.TEXT7.SETFOCUS
NODEFAULT
RETURN
ENDIF
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
MBARU = ALLTRIM(THISFORM.TEXT1.VALUE)+","+ALLTRIM(THISFORM.TEXT2.VALUE)+","+DTOC(THISFORM.TEXT4.VALUE)+","+ALLTRIM(THISFORM.TEXT5.VALUE)+","+THISFORM.TEXT6.VALUE+","+ALLTRIM(STR(IIF(THISFORM.KDHIT="H", 0, THISFORM.TEXT7.VALUE)))+","+ALLTRIM(STR(IIF(THISFORM.KDHIT="H", 0, THISFORM.TEXT8.VALUE)))+","+ALLTRIM(STR(IIF(THISFORM.KDHIT="H", 0, THISFORM.TEXT9.VALUE)))+","+ALLTRIM(STR(IIF(THISFORM.KDHIT="H", DEBET, 0)))+","+ALLTRIM(STR(IIF(THISFORM.KDHIT="H", KREDIT, 0)))+","+ALLTRIM(OPT)
CSQL = "insert into log_data (namafile,iddata,userid,tindakan,perintah,"+"dataasal,databaru) value ('"+"pinjaman_mutasi"+"','"+STR(THISFORM.IDDATA)+"','"+DEFAUSERID+"','"+"EDIT"+"','','"+THISFORM.DATA_ASAL+"','"+MBARU+"')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select MAX(nomordata) as nomordata from log_data where namafile='pinjaman_mutasi' and iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MLOGREFF = IIF(EMPTY(THISFORM.TEXT12.VALUE), "", ALLTRIM(THISFORM.TEXT12.VALUE)+",")+ALLTRIM(STR(NOMORDATA))
IF THISFORM.KDHIT="H"
CSQL = "update pinjaman_mutasi set "+"norek='"+THISFORM.TEXT1.VALUE+"', "+"debet=' "+TRANSFORM(THISFORM.TEXT7.VALUE, '999999999999999')+"', "+"kredit='"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"', "+"opt='"+DEFAUSERID+"', "+"logreff='"+MLOGREFF+"' "+"where iddata='"+STR(THISFORM.IDDATA)+"'"
ELSE
CSQL = "update pinjaman_mutasi set "+"norek='"+THISFORM.TEXT1.VALUE+"', "+"pokok='"+TRANSFORM(THISFORM.TEXT7.VALUE, '999999999999999')+"', "+"jasa='"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"', "+"denda='"+TRANSFORM(THISFORM.TEXT9.VALUE, '999999999999999')+"', "+"opt='"+DEFAUSERID+"', "+"logreff='"+MLOGREFF+"' "+"where iddata='"+STR(THISFORM.IDDATA)+"'"
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan Data koreksi Angsuran")
ENDIF
SELECT (THISFORM.DATA1)
CSQL = "select jenis from pinjaman where norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJENIS = JENIS
CSQL = "select jurnal_pokok, jurnal_jasa, jurnal_denda from setsandi_pinj where kantor='"+DEFAKANTOR+"' and sandi='"+MJENIS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJURPK1 = JURNAL_POKOK
MJURBG1 = JURNAL_JASA
MJURDN1 = JURNAL_DENDA
CSQL = "select jenis from pinjaman where norek='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJENIS = JENIS
CSQL = "select jurnal_pokok, jurnal_jasa, jurnal_denda from setsandi_pinj where kantor='"+DEFAKANTOR+"' and sandi='"+MJENIS+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJURPK2 = JURNAL_POKOK
MJURBG2 = JURNAL_JASA
MJURDN2 = JURNAL_DENDA
USE
SELECT (THISFORM.DATA1)
MKET = "KOREKSI ANGS."+ALLTRIM(NOREK)+"/"+DTOC(TANGGAL)+"/"+BUKTI
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI,NOPER,KETERANGAN,JUMLAH,INPOPR) value "
IF THISFORM.KDHIT="H"
IF DEBET<>THISFORM.TEXT7.VALUE
IF THISFORM.TEXT7.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURPK1+"','"+MKET+"','"+TRANSFORM(THISFORM.TEXT7.VALUE, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
IF DEBET<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURPK2+"','"+MKET+"','"+TRANSFORM(0-DEBET, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
ENDIF
IF KREDIT<>THISFORM.TEXT8.VALUE
IF DEBET<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURPK1+"','"+MKET+"','"+TRANSFORM(THISFORM.TEXT8.VALUE, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
IF DEBET<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURPK2+"','"+MKET+"','"+TRANSFORM(0-KREDIT, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
ENDIF
ELSE
IF POKOK<>THISFORM.TEXT7.VALUE
IF POKOK<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURPK1+"','"+MKET+"','"+TRANSFORM(POKOK, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
IF THISFORM.TEXT7.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURPK2+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT7.VALUE, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
ENDIF
IF JASA<>THISFORM.TEXT8.VALUE
IF JASA<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURBG1+"','"+MKET+"','"+TRANSFORM(JASA, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
IF THISFORM.TEXT8.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURBG2+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT8.VALUE, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
ENDIF
IF DENDA<>THISFORM.TEXT9.VALUE
IF DENDA<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURDN1+"','"+MKET+"','"+TRANSFORM(DENDA, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURDN2+"','"+MKET+"','"+TRANSFORM(0-THISFORM.TEXT9.VALUE, '999999999999999')+"','"+DEFAUSERID+"'),"
ENDIF
ENDIF
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal membuat jurnal")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_mutasi_detail.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** pinjaman_mutasi_detail.sct
***
*
***
*** akt_rekap_jurnal.frx
***
*
***
*** akt_rekap_jurnal.frt
***
*
***
*** kas_rekap_transaksi.frx
***
*
***
*** kas_rekap_transaksi.frt
***
*
***
*** simpanan_mutasi_detail.scx
***
*
*
*  simpanan_mutasi_detail.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.IDDATA = IDDATA
THISFORM.OLDDBF = SELECT()
THISFORM.DATA1 = "SIMP_DETAIL"
CSQL = "select * from simpanan_mutasi where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, THISFORM.DATA1)
IF LCEK<1
MESSAGEBOX("gagal baca Slip Simpanan")
ENDIF
THISFORM.LABEL13.CAPTION = IIF(KREDIT>0, "SLIP SETORAN", "SLIP PENGAMBILAN")
THISFORM.LABEL14.CAPTION = THISFORM.LABEL13.CAPTION
MNOREK = NOREK
CSQL = "select cif from simpanan where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("gagal baca simpanan")
ENDIF
MCIF = CIF
CSQL = "select nama,alamat from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("gagal baca Anggota")
ENDIF
MNAMA = NAMA
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
SELECT (THISFORM.DATA1)
THISFORM.TEXT4.VALUE = TANGGAL
THISFORM.TEXT5.VALUE = BUKTI
THISFORM.TEXT6.VALUE = KODE
THISFORM.TEXT7.VALUE = DEBET
THISFORM.TEXT8.VALUE = KREDIT
THISFORM.TEXT9.VALUE = KETERANGAN
THISFORM.TEXT11.VALUE = OPT
THISFORM.TEXT12.VALUE = LOGREFF
MASAL = ALLTRIM(MNOREK)+","+ALLTRIM(MNAMA)+","+DTOC(TANGGAL)+","+ALLTRIM(BUKTI)+","+KODE+","+ALLTRIM(STR(DEBET))+","+ALLTRIM(STR(KREDIT))+","+KETERANGAN+","+ALLTRIM(OPT)
THISFORM.DATA_ASAL = MASAL
ENDPROC
**
PROCEDURE Unload
SELECT (THISFORM.DATA1)
USE
SELECT (THISFORM.OLDDBF)
ENDPROC
**
*
*  simpanan_mutasi_detail.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
SELECT (THISFORM.DATA1)
MKET = "KOREKSI: "+ALLTRIM(NOREK)+"/"+DTOC(TANGGAL)+"/"+BUKTI
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
MNOREK = THIS.VALUE
CSQL = "select a.norek,b.nama,b.alamat from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT9.VALUE = MKET
ENDFUNC
**
*
*  simpanan_mutasi_detail.scx::Command1
**
PROCEDURE Click
DO FORM frm_bukti TO MBUKTI WITH TGLNOW
IF EMPTY(MBUKTI)
NODEFAULT
RETURN
ENDIF
THISFORM.BUKTI = MBUKTI
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .T.
THISFORM.LABEL13.CAPTION = "KOREKSI "+THISFORM.LABEL13.CAPTION
THISFORM.LABEL14.CAPTION = THISFORM.LABEL13.CAPTION
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  simpanan_mutasi_detail.scx::Command2
**
PROCEDURE Click
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.LABEL13.CAPTION = "SLIP ANGSURAN"
THISFORM.LABEL14.CAPTION = THISFORM.LABEL13.CAPTION
ENDPROC
**
*
*  simpanan_mutasi_detail.scx::Command3
**
PROCEDURE Click
SELECT (THISFORM.DATA1)
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
MKANTOR = KANTOR
MNOREK = NOREK
MDEBET = DEBET
MKREDIT = KREDIT
MOPT = OPT
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from "+"simpanan_mutasi where norek='"+MNOREK+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = SALDO
MBARU = ALLTRIM(THISFORM.TEXT1.VALUE)+","+ALLTRIM(THISFORM.TEXT2.VALUE)+","+DTOC(THISFORM.TEXT4.VALUE)+","+ALLTRIM(THISFORM.TEXT5.VALUE)+","+THISFORM.TEXT6.VALUE+","+ALLTRIM(STR(THISFORM.TEXT7.VALUE))+","+ALLTRIM(STR(THISFORM.TEXT8.VALUE))+","+THISFORM.TEXT9.VALUE+","+DEFAUSERID
CSQL = "insert into log_data (namafile,iddata,userid,tindakan,perintah,"+"dataasal,databaru) value ('"+"simpanan_mutasi"+"','"+STR(THISFORM.IDDATA)+"','"+DEFAUSERID+"','"+"EDIT"+"','','"+THISFORM.DATA_ASAL+"','"+MBARU+"')"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select MAX(nomordata) as nomordata from log_data where namafile='simpanan_mutasi' and iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MLOGREFF = IIF(EMPTY(THISFORM.TEXT12.VALUE), "", ALLTRIM(THISFORM.TEXT12.VALUE)+",")+ALLTRIM(STR(NOMORDATA))
CSQL = "insert into simpanan_mutasi (kantor,norek,JAM,BUKTI,TANGGAL,kode, KETERANGAN,"+"DEBET,KREDIT,SALDO,opt) value "+"('"+DEFAKANTOR+"','"+MNOREK+"','"+TIME()+"','"+THISFORM.BUKTI+"','"+SQLDATE(TGLNOW)+"','"+DEFATABEDT+"','"+THISFORM.TEXT9.VALUE+"','"+TRANSFORM(MKREDIT, '999999999999999')+"','"+TRANSFORM(MDEBET, '999999999999999')+"','"+TRANSFORM(MSALDO-MKREDIT+MDEBET, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan Data koreksi simpanan")
ENDIF
CSQL = "select saldo from simpanan_mutasi where norek='"+THISFORM.TEXT1.VALUE+"' and iddata=(select MAX(iddata) from "+"simpanan_mutasi where norek='"+THISFORM.TEXT1.VALUE+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = SALDO
CSQL = "insert into simpanan_mutasi (kantor,norek,JAM,BUKTI,TANGGAL,kode, KETERANGAN,"+"DEBET,KREDIT,SALDO,opt) value "+"('"+DEFAKANTOR+"','"+THISFORM.TEXT1.VALUE+"','"+TIME()+"','"+THISFORM.BUKTI+"','"+SQLDATE(TGLNOW)+"','"+DEFATABEDT+"','"+THISFORM.TEXT9.VALUE+"','"+TRANSFORM(MDEBET, '999999999999999')+"','"+TRANSFORM(MKREDIT, '999999999999999')+"','"+TRANSFORM(MSALDO-MDEBET+MKREDIT, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan Data koreksi simpanan")
ENDIF
CSQL = "update simpanan_mutasi set "+"logreff='"+MLOGREFF+"' "+"where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan Data koreksi simpanan")
ENDIF
SELECT (THISFORM.DATA1)
MNOREK = NOREK
CSQL = "select jenis,produk from simpanan where norek='"+NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJENIS = JENIS
MPRODUK = PRODUK
CSQL = "select jurnaltab from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='"+MJENIS+"' and sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJURTAB1 = JURNALTAB
CSQL = "select jenis,produk from simpanan where norek='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJENIS = JENIS
MPRODUK = PRODUK
CSQL = "select jurnaltab from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='"+MJENIS+"' and sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MJURTAB2 = JURNALTAB
USE
SELECT (THISFORM.DATA1)
IF THISFORM.TEXT1.VALUE<>MNOREK
MJUMLAH = THISFORM.TEXT7.VALUE-THISFORM.TEXT8.VALUE
MKET = "KOREKSI SIMPANAN "+ALLTRIM(NOREK)+"/"+DTOC(TANGGAL)+"/"+BUKTI
CSQL = "insert into jurnal (KANTOR,TANGGAL,BUKTI,NOPER,KETERANGAN,JUMLAH,INPOPR) value "
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURTAB1+"','"+MKET+"','"+TRANSFORM(0-MJUMLAH, '999999999999999')+"','"+DEFAUSERID+"'),"
CSQL = CSQL+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+THISFORM.BUKTI+"','"+MJURTAB2+"','"+MKET+"','"+TRANSFORM(MJUMLAH, '999999999999999')+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal membuat jurnal")
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_mutasi_detail.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_mutasi_detail.scx::Command5
**
PROCEDURE Click
CSQL = "delete from simpanan_mutasi where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_mutasi_detail.sct
***
*
***
*** form_backupdata.scx
***
*
*
*  form_backupdata.scx::FORM1
**
PROCEDURE Init
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.TEXT1.VALUE = "BACKUP-"+DTOC(TGLNOW)+".sql"
ENDPROC
**
*
*  form_backupdata.scx::Command1
**
PROCEDURE Click
MDIR = GETDIR()
THISFORM.TEXT1.VALUE = MDIR+"BACKUP-"+DTOC(TGLNOW)+".SQL"
ENDPROC
**
*
*  form_backupdata.scx::Command2
**
PROCEDURE Click
MSERVER = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'SERVER'))
MDATABASED = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'DATABASED'))
MUSER = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'USER'))
MPASS = ALLTRIM(THISFORM.READINI1._READ('CONECTION', 'PASSWORD'))
EXECSCRIPT("! mysqldump -u "+MUSER+" -p"+MPASS+" "+MDATABASED+" > "+ALLTRIM(THISFORM.TEXT1.VALUE))
ENDPROC
**
*
*  form_backupdata.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** form_backupdata.sct
***
*
***
*** proses_ceksaldo.scx
***
*
*
*  proses_ceksaldo.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK
IF PARAMETERS()=0
MNOREK = ''
ENDIF
THISFORM.NOREK = MNOREK
THISFORM.BAR1.WIDTH = 0
THISFORM.BORDERSTYLE = 2
THISFORM.JUDUL.CAPTION = "PROSES CEK SALDO"
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.BACASQL()
ENDPROC
**
*
*  proses_ceksaldo.scx::Command1
**
PROCEDURE Click
IF EMPTY(THISFORM.NOREK)
CSQL = "select norek,jenis from simpanan where tgltutup='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.BAR1.WIDTH = 0
JUMREC = RECCOUNT()
MREK = 1
DO WHILE  .NOT. EOF()
THISFORM.BAR1.WIDTH = INT((MREK/JUMREC)*400)
MREK = MREK+1
MNOREK = NOREK
MJENIS = JENIS
IF MJENIS='1'
CSQL = "select norek,saldo from simpanan_mutasi where norek='"+MNOREK+"' and "+"iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF NOREK=MNOREK
MSALDO = SALDO
ELSE
MSALDO = 0
ENDIF
CSQL = "select * from simpanan_mutasi where norek='"+MNOREK+"' and tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' order by iddata"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
GOTO TOP
DO WHILE  .NOT. EOF()
MIDDATA = IDDATA
VSALDO = SALDO
MSALDO = MSALDO+KREDIT-DEBET
IF VSALDO<>MSALDO
CSQL = "update simpanan_mutasi set saldo='"+TRANSFORM(MSALDO, '999999999999999')+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SELECT SMT1
SKIP
ENDDO
ELSE
CSQL = "select norek,saldo from simpanan_mutasi where iddata="+"(select MAX(iddata) from simpanan_mutasi where (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') and norek='"+MNOREK+"' and tanggal<'"+SQLDATE(THISFORM.TEXT1.VALUE)+"' group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF NOREK=MNOREK
MSALDO = SALDO
ELSE
MSALDO = 0
ENDIF
CSQL = "select * from simpanan_mutasi where (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') and norek='"+MNOREK+"' and tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' order by iddata"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
GOTO TOP
DO WHILE  .NOT. EOF()
MIDDATA = IDDATA
MSALDO = MSALDO+KREDIT-DEBET
IF SALDO<>MSALDO
CSQL = "update simpanan_mutasi set saldo='"+TRANSFORM(MSALDO, '999999999999999')+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SKIP
ENDDO
CSQL = "select * from simpanan_mutasi where iddata="+"(select MAX(iddata) from simpanan_mutasi where (kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') and norek='"+MNOREK+"' and tanggal<'"+SQLDATE(THISFORM.TEXT1.VALUE)+"' order by iddata"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF NOREK=MNOREK
MSALDO = SALDO
ELSE
MSALDO = 0
ENDIF
CSQL = "select * from simpanan_mutasi where (kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') and norek='"+MNOREK+"' and tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' order by iddata"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
GOTO TOP
DO WHILE  .NOT. EOF()
MIDDATA = IDDATA
MSALDO = MSALDO+KREDIT-DEBET
IF SALDO<>MSALDO
CSQL = "update simpanan_mutasi set saldo='"+TRANSFORM(MSALDO, '999999999999999')+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SKIP
ENDDO
ENDIF
SELECT SMT
SKIP
ENDDO
ELSE
MNOREK = THISFORM.NOREK
CSQL = "select norek,saldo from simpanan_mutasi where norek='"+MNOREK+"' and "+"iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<'"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF NOREK=MNOREK
MSALDO = SALDO
ELSE
MSALDO = 0
ENDIF
CSQL = "select * from simpanan_mutasi where norek='"+MNOREK+"' and tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' order by iddata"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
GOTO TOP
DO WHILE  .NOT. EOF()
MIDDATA = IDDATA
VSALDO = SALDO
MSALDO = MSALDO+KREDIT-DEBET
IF VSALDO<>MSALDO
CSQL = "update simpanan_mutasi set saldo='"+TRANSFORM(MSALDO, '999999999999999')+"' where iddata='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SELECT SMT1
SKIP
ENDDO
ENDIF
MESSAGEBOX("Proses Hitung Ulang sudah Selesai", 64, "")
THISFORM.RELEASE
ENDPROC
**
***
*** proses_ceksaldo.sct
***
*
***
*** anggota_foto.scx
***
*
*
*  anggota_foto.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MFOTO
THISFORM.IMAGE1.PICTURE = MFOTO
ENDPROC
**
***
*** anggota_foto.sct
***
*
***
*** kas_simpanan.scx
***
*
*
*  kas_simpanan.scx::FORM1
**
PROCEDURE ubahwarna
PARAMETER MKDKAS
IF MKDKAS="M"
THISFORM.SHAPE10.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE9.BACKCOLOR = RGB(157, 217, 19)
THISFORM.SHAPE13.BACKCOLOR = RGB(204, 243, 114)
THISFORM.SHAPE8.BACKCOLOR = RGB(204, 243, 114)
THISFORM.TEXT11.VALUE = "KAS MASUK"
THISFORM.LABEL16.CAPTION = "PENERIMAAN KAS"
THISFORM.LABEL7.CAPTION = "JUMLAH SETORAN"
ELSE
THISFORM.SHAPE10.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE9.BACKCOLOR = RGB(204, 208, 17)
THISFORM.SHAPE13.BACKCOLOR = RGB(244, 238, 113)
THISFORM.SHAPE8.BACKCOLOR = RGB(244, 238, 113)
THISFORM.TEXT11.VALUE = "KAS KELUAR"
THISFORM.LABEL16.CAPTION = "PENGELUARAN KAS"
THISFORM.LABEL7.CAPTION = "JUMLAH PENARIKAN"
ENDIF
ENDPROC
**
PROCEDURE tampil
DO CASE
CASE THISFORM.JENIS='1'
THISFORM.LABEL17.CAPTION = "TABUNGAN"
THISFORM.LABEL14.CAPTION = "SALDO MINIMAL"
THISFORM.LABEL15.CAPTION = "MAXIMAL PENGAMBILAN"
CASE THISFORM.JENIS='2'
THISFORM.LABEL17.CAPTION = "DEPOSITO"
THISFORM.LABEL14.CAPTION = "MAX. AMBIL POKOK"
THISFORM.LABEL15.CAPTION = "SALDO JASA"
CASE THISFORM.JENIS='3'
THISFORM.LABEL17.CAPTION = "SERTIFIKAT SIMPANAN"
THISFORM.LABEL14.CAPTION = "MAX. AMBIL POKOK"
THISFORM.LABEL15.CAPTION = "SALDO JASA"
ENDCASE
ENDPROC
**
PROCEDURE foto
CFOTO = CAST(FOTO AS W )
CTTD = CAST(TANDATANGAN AS W )
CPARAF = CAST(PARAF AS W )
IF EMPTY(FOTO) .OR. ISNULL(FOTO)
THISFORM.IMAGE3.VISIBLE = .F.
ELSE
THISFORM.IMAGE3.VISIBLE = .T.
MFOTO = SYS(2023)+"\foto.jpg"
NHANDLE = FCREATE(MFOTO)
IF NHANDLE>0
FWRITE(NHANDLE, CFOTO)
FCLOSE(NHANDLE)
ENDIF
THISFORM.IMAGE3.PICTURE = MFOTO
ENDIF
IF EMPTY(TANDATANGAN) .OR. ISNULL(TANDATANGAN)
THISFORM.IMAGE1.VISIBLE = .F.
ELSE
THISFORM.IMAGE1.VISIBLE = .T.
MTTD = SYS(2023)+"\tandatangan.jpg"
NHANDLE = FCREATE(MTTD)
IF NHANDLE>0
FWRITE(NHANDLE, CTTD)
FCLOSE(NHANDLE)
ENDIF
THISFORM.IMAGE1.PICTURE = MTTD
ENDIF
IF EMPTY(CPARAF) .OR. ISNULL(CPARAF)
THISFORM.IMAGE2.VISIBLE = .F.
ELSE
THISFORM.IMAGE2.VISIBLE = .T.
MPARAF = SYS(2023)+"\paraf.jpg"
NHANDLE = FCREATE(MPARAF)
IF NHANDLE>0
FWRITE(NHANDLE, CPARAF)
FCLOSE(NHANDLE)
ENDIF
THISFORM.IMAGE2.PICTURE = MPARAF
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MKAS
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.TANGGAL = TGLNOW
THISFORM.BUKTI = ' '
THISFORM.MODE = IIF(VARTYPE(MMODE)="X" .OR. VARTYPE(MMODE)="L", "INPUT", MMODE)
THISFORM.KAS = IIF(VARTYPE(MKAS)="X" .OR. VARTYPE(MKAS)="L", "KAS", MKAS)
IF THISFORM.KAS="NONKAS"
THISFORM.LABEL2.CAPTION = "TRANSAKSI SIMPANAN VIA BANK"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 128, 0)
THISFORM.LABEL22.VISIBLE = .T.
THISFORM.TEXT20.VISIBLE = .T.
THISFORM.TEXT34.VISIBLE = .T.
ENDIF
DEFAKANTORASAL = DEFAKANTOR
THISFORM.OLDSELECT = SELECT()
SELECT (THISFORM.OLDSELECT)
MTGL = TANGGAL
MBKT = BUKTI
MKDKAS = IIF(DEBET-KREDIT>0, "M", "K")
MSETOR = JUMLAH6
IF THISFORM.MODE="INPUT"
THISFORM.TEXT4.SETFOCUS
THISFORM.TEXT7.VALUE = DEFATGLKAS
ENDIF
IF THISFORM.MODE="TAMPIL" .OR. THISFORM.MODE="HAPUS"
THISFORM.TEXT4.VALUE = NOREK
THISFORM.TEXT5.VALUE = TANGGAL1
THISFORM.TEXT6.VALUE = JUMLAH1
THISFORM.TEXT12.VALUE = JUMLAH2
THISFORM.TEXT13.VALUE = JUMLAH3
THISFORM.TEXT14.VALUE = JUMLAH4
THISFORM.TEXT15.VALUE = JUMLAH5
THISFORM.TEXT9.VALUE = JUMLAH6
THISFORM.TEXT17.VALUE = JUMLAH7
THISFORM.TEXT21.VALUE = JUMLAH6+JUMLAH7
THISFORM.UBAHWARNA(MKDKAS)
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.TEXT4.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.TEXT18.ENABLED = .F.
MNOREK = NOREK
THISFORM.TEXT7.VALUE = TANGGAL
THISFORM.TEXT8.VALUE = BUKTI
THISFORM.TEXT10.VALUE = MKDKAS
THISFORM.TEXT18.VALUE = KETERANGAN
CSQL = "select a.*,b.* from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca data simpanan", 0, "")
ENDIF
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT16.VALUE = KOTA
THISFORM.TEXT19.VALUE = PHONE
THISFORM.PRODUK = PRODUK
THISFORM.JENIS = JENIS
THISFORM.FOTO()
THISFORM.TAMPIL()
IF MKDKAS='K' .AND. THISFORM.JENIS<>'1'
THISFORM.LABEL21.VISIBLE = .T.
THISFORM.LABEL7.CAPTION = "PENGAMBILAN POKOK"
THISFORM.LABEL21.CAPTION = "PENGAMBILAN JASA"
ENDIF
USE
SELECT (THISFORM.OLDSELECT)
IF THISFORM.MODE="HAPUS"
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
ENDIF
ENDIF
ENDPROC
**
FUNCTION Unload
ERASE SYS(2023)+"\foto.jpg"
ERASE SYS(2023)+"\tandatangan.jpg"
ERASE SYS(2023)+"\paraf.jpg"
IF THISFORM.MODE="INPUT"
CEKURUTNOTA("KAS", THISFORM.TANGGAL, THISFORM.BUKTI)
ENDIF
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  kas_simpanan.scx::Command2
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan.scx::Command3
**
PROCEDURE Click
MKD = '02'
MKDKAS = THISFORM.TEXT10.VALUE
OLDSELECT = SELECT()
IF THISFORM.KAS="KAS"
IF THISFORM.TEXT10.VALUE="M"
MNOMORTR = "01"
ELSE
MNOMORTR = "02"
ENDIF
ELSE
IF THISFORM.TEXT10.VALUE="M"
MNOMORTR = "03"
ELSE
MNOMORTR = "04"
ENDIF
ENDIF
IF THISFORM.TEXT10.VALUE='K' .AND. THISFORM.TEXT9.VALUE>DEFABATASKAS
DO WHILE .T.
MKETACC = "PENGAMBILAN SIMPANAN"+CHR(13)+"---------------------------------------------------"+CHR(13)+"NOMOR REKENING	: "+THISFORM.TEXT4.VALUE+CHR(13)+"NAMA				: "+THISFORM.TEXT2.VALUE+CHR(13)+"		JML AMBIL	: "+TRANSFORM(THISFORM.TEXT9.VALUE, "999,999,999,999")+CHR(13)+"---------------------------------------------------"+CHR(13)+"JML PENGAMBILAN	: "+TRANSFORM(THISFORM.TEXT9.VALUE, "999,999,999,999")
DO FORM acc_client TO HASIL WITH THISFORM.TEXT7.VALUE, ALLTRIM(THISFORM.TEXT8.VALUE), MKETACC, THISFORM.TEXT9.VALUE
IF HASIL=1 .OR. HASIL=2
EXIT
ENDIF
ENDDO
IF HASIL=2
RETURN
ENDIF
ENDIF
CSQL = "select jurnaltab from setsandi_tab where jenis='"+THISFORM.JENIS+"' and sandi='"+THISFORM.PRODUK+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNALTAB = JURNALTAB
USE
IF THISFORM.TEXT10.VALUE="M"
IF THISFORM.JENIS='1'
MKDMTS = DEFATABSTOR
ELSE
MKDMTS = DEFADEPSTOR
ENDIF
ELSE
IF THISFORM.JENIS='1'
MKDMTS = DEFATABAMB
ELSE
MKDMTS = DEFADEPAMBPK
MKDMTS2 = DEFADEPAMBBG
ENDIF
ENDIF
MSALDO = 0
MSALDOJASA = 0
IF THISFORM.JENIS='1'
CSQL = "select saldo from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
ELSE
CSQL = "select saldo from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and (kode='"+DEFADEPSTOR+"' or kode='"+DEFADEPAMBPK+"' or kode='"+DEFADEPPBKPK1+"' or kode='"+DEFADEPPBKPK2+"') "+"and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
CSQL = "select saldo from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' and (kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') "+"and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDOJASA = SALDO
ENDIF
USE
SELECT (OLDSELECT)
MKET = THISFORM.TEXT18.VALUE
IF THISFORM.TEXT9.VALUE>0
SALDOBARU = MSALDO+IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE)
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT4.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKDMTS+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0))+"',"+"'"+TRANSFORM(SALDOBARU, '999999999999999')+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi1")
RETURN
ENDIF
IF SALDOBARU=0
CSQL = "update simpanan set tgltutup='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' where kantor='"+DEFAKANTOR+"' and norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
ENDIF
IF THISFORM.TEXT17.VALUE>0
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT4.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKDMTS2+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT17.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT17.VALUE, 0))+"',"+"'"+TRANSFORM(MSALDOJASA+IIF(MKDKAS="M", THISFORM.TEXT17.VALUE, 0-THISFORM.TEXT17.VALUE), '999999999999999')+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi2")
RETURN
ENDIF
ENDIF
MSMS_STOR = 0
MSMS_AMBIL = 0
IF ALLTRIM(DEFANOTIFIKASI)='1' .AND. THISFORM.TEXT9.VALUE>0
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFOPTION'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MOPTNOTIF = VAL(KETERANGAN)
DO CASE
CASE MOPTNOTIF=1
MSMS_STOR = 0
MSMS_AMBIL = 0
CASE MOPTNOTIF=2
CSQL = "select cif,sms_stor,sms_ambil from simpanan where norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSMS_STOR = SMS_STOR
MSMS_AMBIL = SMS_AMBIL
MCIF = CIF
DEFADBFSMS = ALLTRIM(DEFADBFSMS)
CASE MOPTNOTIF=3
MSMS_STOR = 1
MSMS_AMBIL = 1
ENDCASE
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFJML'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBATASNOTIF = VAL(KETERANGAN)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFKATA1'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKATASETOR = ALLTRIM(KETERANGAN)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and "+"ket2='NOTIFKATA2'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MKATAAMBIL = ALLTRIM(KETERANGAN)
MPHONE = ALLTRIM(THISFORM.TEXT19.VALUE)
MSLD = 0
MCTK = 'T'
IF MKDKAS="M" .AND. MSMS_STOR=1 .AND. MBATASNOTIF<=THISFORM.TEXT9.VALUE
MKATA = MKATASETOR
MSLD = THISFORM.TEXT12.VALUE+THISFORM.TEXT9.VALUE
MCTK = 'Y'
ENDIF
IF MKDKAS="K" .AND. MSMS_AMBIL=1 .AND. MBATASNOTIF<=THISFORM.TEXT9.VALUE
MKATA = MKATAAMBIL
MSLD = THISFORM.TEXT12.VALUE-THISFORM.TEXT9.VALUE
MCTK = 'Y'
ENDIF
IF MCTK='Y'
MNOREK0 = ALLTRIM(THISFORM.TEXT4.VALUE)
MKATA = STRTRAN(MKATA, "<<nama>>", ALLTRIM(THISFORM.TEXT2.VALUE))
MKATA = STRTRAN(MKATA, "<<norek>>", MNOREK0)
MKATA = STRTRAN(MKATA, "<<noangg>>", THISFORM.TEXT1.VALUE)
MKATA = STRTRAN(MKATA, "<<saldo>>", ALLTRIM(TRANSFORM(MSLD, "99,999,999,999")))
MKATA = STRTRAN(MKATA, "<<stor>>", ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, "99,999,999,999")))
MKATA = STRTRAN(MKATA, "<<ambil>>", STR(THISFORM.TEXT9.VALUE))
MKATA = STRTRAN(MKATA, "<<tanggal>>", DTOC(THISFORM.TEXT7.VALUE))
MKATA = STRTRAN(MKATA, "<<jam>>", TIME())
MKATA = STRTRAN(MKATA, "<<bukti>>", THISFORM.TEXT8.VALUE)
IF THISFORM.KAS="KAS"
MKATA = STRTRAN(MKATA, "<<tunai>>", "TUNAI")
ELSE
MKATA = STRTRAN(MKATA, "<<tunai>>", "VIA BANK")
ENDIF
CSQL = "insert into "+DEFADBFSMS+".outbox (TextDecoded,DestinationNumber,creatorId) value (?mkata,?mphone,'System')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ENDIF
ENDIF
CSQL = "SELECT sum(if(kode='07',kredit,0)) as bunga, "+"sum(if(kode='08',debet,0)) as adm, "+"sum(if(kode='13',debet,0)) as pajak "+"FROM simpanan_mutasi WHERE norek='"+THISFORM.TEXT4.VALUE+"' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MBUNGA = BUNGA
MADM = ADM
MPJK = PAJAK
USE
CSQL = "select SUM(jadwal)-SUM(bayar) as autodebet from simpanan_autodebet_mutasi where norek='"+THISFORM.TEXT4.VALUE+"' order by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MAUTODEBET = IIF(ISNULL(AUTODEBET), 0, AUTODEBET)
CSQL = "select SUM(saldoblokir) as blokir from simpanan_blokir where norek='"+THISFORM.TEXT4.VALUE+"' and tglcabut='0000-00-00' group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MBLOKIR = IIF(ISNULL(BLOKIR), 0, BLOKIR)
CSQL = "select a.norek,b.* from simpanan as a left join setsandi_tab as b on a.kantor=b.kantor and a.jenis=b.jenis and a.produk=b.sandi where a.norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca ")
ENDIF
MADM = IIF(ISNULL(A_ADM), 0, A_ADM)
MRATE = IIF(ISNULL(A_RATE), 0, A_RATE)
MSLDMIN = IIF(ISNULL(SALDOMINIMAL), 0, SALDOMINIMAL)
MBATASBUNGA = IIF(ISNULL(BATASBUNGA), 0, BATASBUNGA)
MJURUTANG = IIF(ISNULL(JURNALUTANGBG), '', JURNALUTANGBG)
MJURBUNGA = IIF(ISNULL(JURNALBUNGA), '', JURNALBUNGA)
MJURTAB = IIF(ISNULL(JURNALTAB), '', JURNALTAB)
MJURPAJAK = IIF(ISNULL(JURNALPAJAK), '', JURNALPAJAK)
CSQL = "select norek from simpanan_saldo where kantor='"+DEFAKANTOR+"' and norek='"+THISFORM.TEXT4.VALUE+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF NOREK<>THISFORM.TEXT4.VALUE
CSQL = "insert into simpanan_saldo (kantor,tanggal,norek,SALDO,"+"bunga,pajak,adm,autodebet,blokir,tglmutasi,aktif,hit_adm,hit_rate,"+"hit_minbunga,hit_minsaldo,jur_utangbg,jur_biayabg,jur_tab,jur_pjk,opt) value ('"+DEFAKANTOR+"','"+SQLDATE(THISFORM.TEXT7.VALUE)+"','"+THISFORM.TEXT4.VALUE+"','"+TRANSFORM(MSALDO+IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE), '999999999999999')+"','"+STR(MBUNGA)+"','"+STR(MPJK)+"','"+STR(MADM)+"','"+STR(MAUTODEBET)+"','"+STR(MBLOKIR)+"','"+SQLDATE(THISFORM.TEXT7.VALUE)+"','"+"A"+"','"+STR(MADM)+"','"+STR(MRATE)+"','"+STR(MBATASBUNGA)+"','"+STR(MSLDMIN)+"','"+MJURUTANG+"','"+MJURBUNGA+"','"+MJURTAB+"','"+MJURPAJAK+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert saldo simpanan 1")
RETURN
ENDIF
ELSE
CSQL = "update simpanan_saldo set "+"SALDO='"+TRANSFORM(MSALDO+IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE), '999999999999999')+"', "+"bunga='"+STR(MBUNGA)+"', "+"pajak='"+STR(MPJK)+"', "+"adm='"+STR(MADM)+"', "+"autodebet='"+STR(MAUTODEBET)+"', "+"blokir='"+STR(MBLOKIR)+"', "+"tglmutasi='"+SQLDATE(THISFORM.TEXT7.VALUE)+"', "+"aktif='"+"A"+"', "+"hit_adm='"+STR(MADM)+"', "+"hit_rate='"+STR(MRATE)+"', "+"hit_minbunga='"+STR(MBATASBUNGA)+"', "+"hit_minsaldo='"+STR(MSLDMIN)+"', "+"jur_utangbg='"+MJURUTANG+"', "+"jur_biayabg='"+MJURBUNGA+"', "+"jur_tab='"+MJURTAB+"', "+"jur_pjk='"+MJURPAJAK+"' "+"where kantor='"+DEFAKANTOR+"' and norek='"+THISFORM.TEXT4.VALUE+"' and "+"tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update saldo simpanan")
THISFORM.EDIT1.VALUE = CSQL
RETURN
ENDIF
ENDIF
MNOREK = THISFORM.TEXT4.VALUE
IF THISFORM.KAS="KAS"
CSQL = "insert into kasir (kantor,csr,tanggal,bukti,kode,keterangan,debet,kredit,opt,norek,"+"tanggal1,jumlah1,jumlah2,jumlah3,jumlah4,jumlah5,jumlah6,jumlah7) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"?thisform.text18.Value,"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT21.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT21.VALUE, 0))+"',"+"'"+DEFAUSERID+"',"+"'"+MNOREK+"',"+"'"+SQLDATE(THISFORM.TEXT5.VALUE)+"',"+"'"+STR(THISFORM.TEXT6.VALUE)+"',"+"'"+STR(THISFORM.TEXT12.VALUE)+"',"+"'"+STR(THISFORM.TEXT13.VALUE)+"',"+"'"+STR(THISFORM.TEXT14.VALUE)+"',"+"'"+STR(THISFORM.TEXT15.VALUE)+"',"+"'"+STR(THISFORM.TEXT9.VALUE)+"',"+"'"+STR(THISFORM.TEXT17.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
ELSE
CSQL = "insert into nonkas (kantor,csr,tanggal,bukti,kode,kodebank,keterangan,debet,kredit,opt,norek) value "+"('"+DEFAKANTOR+"',"+"'"+"01"+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MKD+"',"+"'"+STR(THISFORM.TEXT20.VALUE)+"',"+"?thisform.text18.Value,"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT21.VALUE, 0))+"',"+"'"+STR(IIF(MKDKAS="K", THISFORM.TEXT21.VALUE, 0))+"',"+"'"+DEFAUSERID+"',"+"'"+MNOREK+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT10.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
JURNALANTARKANTOR(THISFORM.TEXT7.VALUE, THISFORM.TEXT8.VALUE, THISFORM.TEXT18.VALUE, DEFAKANTOR, DEFAKANTORASAL, MJUMLAH)
ENDIF
MKET = THISFORM.TEXT18.VALUE
IF THISFORM.JENIS='1'
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERKAS+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE))+"'),"
ENDIF
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MJURNALTAB+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", 0-THISFORM.TEXT9.VALUE, THISFORM.TEXT9.VALUE))+"'),"
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan Jurnal")
ENDIF
ELSE
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "
IF THISFORM.TEXT21.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MNOPERKAS+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", THISFORM.TEXT21.VALUE, 0-THISFORM.TEXT21.VALUE))+"'),"
ENDIF
IF THISFORM.TEXT9.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MJURTAB+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", 0-THISFORM.TEXT9.VALUE, THISFORM.TEXT9.VALUE))+"'),"
ENDIF
IF THISFORM.TEXT17.VALUE<>0
CSQL = CSQL+"('"+DEFAKANTORASAL+"',"+"'"+SQLDATE(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"',"+"'"+MJURUTANG+"',"+"?mket,"+"'"+STR(IIF(MKDKAS="M", 0-THISFORM.TEXT17.VALUE, THISFORM.TEXT17.VALUE))+"'),"
ENDIF
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan Jurnal")
ENDIF
HITNERACA(DEFAKANTORASAL, MJURTAB, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MJURBUNGA, THISFORM.TEXT7.VALUE)
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MJURNALTAB, THISFORM.TEXT7.VALUE)
IF DEFAVALIDASI='1'
MKET = ''
IF THISFORM.TEXT10.VALUE='K'
MNAMACETAK = "VLD_SIMP_AMBIL"
IF THISFORM.JENIS='1'
MKET = IIF(THISFORM.TEXT9.VALUE>0, "/AMBIL TAB:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+" ", "")
ELSE
MKET = IIF(THISFORM.TEXT9.VALUE>0, "/AMBIL PK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+" ", "")
MKET = MKET+IIF(THISFORM.TEXT17.VALUE>0, "/AMBIL JASA:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT17.VALUE, '999,999,999,999'))+" ", "")
ENDIF
ELSE
MNAMACETAK = "VLD_SIMP_STOR"
IF THISFORM.JENIS='1'
MKET = IIF(THISFORM.TEXT9.VALUE>0, "/STOR TAB:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+" ", "")
ELSE
MKET = IIF(THISFORM.TEXT9.VALUE>0, "/STOR PK:Rp."+ALLTRIM(TRANSFORM(THISFORM.TEXT9.VALUE, '999,999,999,999'))+" ", "")
ENDIF
ENDIF
MKET = SUBSTR(MKET, 2)
MBARIS1 = ALLTRIM(DEFAKANTOR)+"/SIMP/"+'Rp.'+ALLTRIM(TRANSFORM(THISFORM.TEXT21.VALUE, '999,999,999,999'))+'/'+ALLTRIM(THISFORM.TEXT8.VALUE)+'/'+DTOC(THISFORM.TEXT7.VALUE)+'/'+TIME()+'/'+DEFAUSERID
MBARIS2 = ALLTRIM(THISFORM.TEXT4.VALUE)+'/'+ALLTRIM(THISFORM.TEXT2.VALUE)
MBARIS3 = MKET
MBARIS4 = ''
CETAKVALIDASI(MNAMACETAK, MBARIS1, MBARIS2, MBARIS3, MBARIS4)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF=MCIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = DESA
THISFORM.TEXT5.VALUE = KECAMATAN
THISFORM.TEXT6.VALUE = KOTA
RETURN
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13 .AND. EMPTY(THIS.VALUE)
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
ENDPROC
**
*
*  kas_simpanan.scx::Text8
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
MBUKTI = TRIM(THIS.VALUE)
OLDSELECT = SELECT()
CSQL = "select bukti from kasir where tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBKT = BUKTI
USE
SELECT (OLDSELECT)
IF ISNULL(MBKT) .OR. EMPTY(MBKT)
THISFORM.TANGGAL = THISFORM.TEXT7.VALUE
THISFORM.BUKTI = THISFORM.TEXT8.VALUE
RETURN
ENDIF
MESSAGEBOX("Bukti Sudah Pernah Masuk", 0, "Validasi Bukti")
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan.scx::Text9
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THISFORM.TEXT9.VALUE+THISFORM.TEXT17.VALUE
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF THISFORM.TEXT10.VALUE="M"
IF THIS.VALUE>=0
RETURN
ELSE
MESSAGEBOX("Tidak ada mutasi dng Nilai Negatif")
ENDIF
ELSE
IF THISFORM.JENIS='1'
IF THIS.VALUE>THISFORM.TEXT15.VALUE
MESSAGEBOX("Pengambilan Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ELSE
IF THIS.VALUE>THISFORM.TEXT14.VALUE
MESSAGEBOX("Pengambilan Pokok Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ENDIF
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan.scx::Text4
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
MNOREK = THIS.VALUE
CSQL = "select a.*,b.* from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MPRODUK = PRODUK
IF NOREK=MNOREK
DEFAKANTORASAL = KANTOR
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT16.VALUE = DESA
THISFORM.TEXT19.VALUE = PHONE
THISFORM.PRODUK = PRODUK
THISFORM.JENIS = JENIS
THISFORM.TAMPIL()
THISFORM.FOTO()
IF TGLTUTUP<>CTOD('00-00-0000')
THISFORM.LABEL24.VISIBLE = .T.
NODEFAULT
RETURN
ENDIF
USE
CSQL = "select MAX(tanggal) as tanggal from simpanan_mutasi where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MTANGGAL = IIF(ISNULL(TANGGAL), CTOD('  -  -    '), TANGGAL)
CSQL = "select debet,kredit from simpanan_mutasi where tanggal=?mtanggal and  norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MUTASI = KREDIT-DEBET
THISFORM.TEXT5.VALUE = MTANGGAL
THISFORM.TEXT6.VALUE = IIF(ISNULL(MUTASI), 0, MUTASI)
IF THISFORM.JENIS='1'
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
ELSE
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"'  and "+"(kode='"+ALLTRIM(DEFADEPSTOR)+"' or kode='"+ALLTRIM(DEFADEPAMBPK)+"' or kode='"+ALLTRIM(DEFADEPPBKPK1)+"' or kode='"+ALLTRIM(DEFADEPPBKPK2)+"')) "
ENDIF
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca saldo")
ENDIF
THISFORM.TEXT12.VALUE = IIF(ISNULL(SALDO), 0, SALDO)
CSQL = "select blokirsemua from simpanan_blokir where norek=?mnorek and tglcabut='0000-00-00' and blokirsemua='Y'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF RECCOUNT()>0
MBLOKIR = THISFORM.TEXT12.VALUE
ELSE
CSQL = "select SUM(saldoblokir) as blokir from simpanan_blokir where norek=?mnorek and tglcabut='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MBLOKIR = IIF(ISNULL(BLOKIR), 0, BLOKIR)
ENDIF
THISFORM.TEXT13.VALUE = IIF(ISNULL(MBLOKIR), 0, MBLOKIR)
IF THISFORM.JENIS='1'
CSQL = "select saldominimal from setsandi_tab where sandi=?mproduk"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT14.VALUE = SALDOMINIMAL
MMAXAMBIL = THISFORM.TEXT12.VALUE-THISFORM.TEXT13.VALUE-THISFORM.TEXT14.VALUE
MMAXAMBIL = MAX(MMAXAMBIL, 0)
THISFORM.TEXT15.VALUE = IIF(ISNULL(MMAXAMBIL), 0, MMAXAMBIL)
ELSE
THISFORM.TEXT14.VALUE = THISFORM.TEXT12.VALUE-MBLOKIR
CSQL = "select saldo from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+DEFADEPBG+"' or kode='"+DEFADEPPJK+"' or kode='"+DEFADEPAMBBG+"' or kode='"+DEFADEPPBKBG+"') "+"and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(THISFORM.TEXT7.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = IIF(ISNULL(SALDO), 0, SALDO)
THISFORM.TEXT15.VALUE = MSALDO
USE
ENDIF
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
SELECT (OLDSELECT)
ELSE
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
ENDFUNC
**
*
*  kas_simpanan.scx::Text10
**
PROCEDURE LostFocus
IF LASTKEY()=27
RETURN
ENDIF
IF  .NOT. (THIS.VALUE="M" .OR. THIS.VALUE="K")
MESSAGEBOX("Gunakan Huruf "+CHR(13)+"M : Untuk Kas Masuk"+CHR(13)+"K  : Untuk Kas Keluar", 64, "TIDAK VALID")
THIS.SETFOCUS
NODEFAULT
ENDIF
THISFORM.UBAHWARNA(THIS.VALUE)
DO CASE
CASE THISFORM.JENIS='1'
MKET = "TAB."
CASE THISFORM.JENIS='2'
MKET = "DEP."
CASE THISFORM.JENIS='3'
MKET = "SMK."
OTHERWISE
MKET = "SIMP."
ENDCASE
IF THIS.VALUE="M"
THISFORM.TEXT18.VALUE = "STR "+MKET+ALLTRIM(THISFORM.TEXT4.VALUE)+" AN."+ALLTRIM(THISFORM.TEXT2.VALUE)
ELSE
IF THISFORM.JENIS='1'
THISFORM.LABEL21.VISIBLE = .F.
THISFORM.TEXT17.VISIBLE = .F.
ELSE
THISFORM.LABEL21.VISIBLE = .T.
THISFORM.TEXT17.VISIBLE = .T.
THISFORM.LABEL7.CAPTION = "PENGAMBILAN POKOK"
THISFORM.LABEL21.CAPTION = "PENGAMBILAN JASA"
ENDIF
THISFORM.TEXT18.VALUE = "AMB "+MKET+ALLTRIM(THISFORM.TEXT4.VALUE)+" AN."+ALLTRIM(THISFORM.TEXT2.VALUE)
ENDIF
ENDPROC
**
*
*  kas_simpanan.scx::Text11
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_simpanan.scx::Text20
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM gl_aba TO MNOMORBUKU WITH "CARI"
THIS.VALUE = MNOMORBUKU
SELECT (OLDSELECT)
ENDIF
MNOMORBUKU = THIS.VALUE
CSQL = "select * from gl_antarbank where nomorbuku='"+ALLTRIM(STR(MNOMORBUKU))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOMORBUKU=MNOMORBUKU
THISFORM.TEXT34.VALUE = NAMABANK
THISFORM.NOPERBANK = NOPER
USE
RETURN
ENDIF
USE
SELECT (OLDSELECT)
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan.scx::Text34
**
PROCEDURE LostFocus
THISFORM.TEXT8.VALUE = URUTBUKTI("KAS")
ENDPROC
**
*
*  kas_simpanan.scx::Command1
**
PROCEDURE Click
THISFORM.MYPILIH = " "
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan.scx::Command4
**
PROCEDURE Click
MKD = '02'
OLDSELECT = SELECT()
CSQL = "select jurnaltab from setsandi_tab where jenis='"+THISFORM.JENIS+"' and sandi='"+THISFORM.PRODUK+"' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MJURNALTAB = JURNALTAB
USE
SELECT (OLDSELECT)
CSQL = "DELETE from simpanan_mutasi where kantor='"+DEFAKANTOR+"' and norek='"+THISFORM.TEXT4.VALUE+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal hapus data mutasi simpanan")
ENDIF
MNOREK = THISFORM.TEXT4.VALUE
IF THISFORM.KAS="KAS"
CSQL = "delete from kasir where kantor='"+DEFAKANTOR+"' and csr='01' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus data kasir kas", 0, "")
ENDIF
ELSE
CSQL = "delete from kasir where kantor='"+DEFAKANTOR+"' and csr='01' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"' and kode='"+MKD+"' and "+"kodebank='"+STR(THISFORM.TEXT20.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus data kasir non kas", 0, "")
ENDIF
ENDIF
MNOPERKAS = IIF(THISFORM.KAS="KAS", DEFANOPERKAS, THISFORM.NOPERBANK)
MJUMLAH = IIF(THISFORM.TEXT10.VALUE="M", THISFORM.TEXT9.VALUE, 0-THISFORM.TEXT9.VALUE)
CSQL = "delete from jurnal where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(THISFORM.TEXT7.VALUE)+"' and bukti='"+THISFORM.TEXT8.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Hapus Jurnal")
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MJURNALTAB, THISFORM.TEXT7.VALUE)
IF DEFAKANTORASAL<>DEFAKANTOR
MNOPER = ALLTRIM(DEFANOPERAKA)+DEFAKANTORASAL
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKP)+DEFAKANTORASAL
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKA)+DEFAKANTOR
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
MNOPER = ALLTRIM(DEFANOPERAKP)+DEFAKANTOR
HITNERACA(DEFAKANTOR, MNOPER, THISFORM.TEXT7.VALUE)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  kas_simpanan.scx::Command5
**
PROCEDURE Click
OLDSELECT = SELECT()
CSQL = "select b.iddata,b.cif_lama,b.nama,b.alamat,b.rt,b.desa,b.kecamatan,b.kota,b.ibu,b.phone,a.* from simpanan as a, anggota as b "+"where a.tgltutup='0000-00-00' and a.cif=b.cif and a.norek='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "KAS01")
DO FORM .\form\simpanan_data WITH "TAMPIL"
SELECT KAS01
USE
SELECT (OLDSELECT)
ENDPROC
**
*
*  kas_simpanan.scx::Text17
**
PROCEDURE InteractiveChange
THISFORM.TEXT21.VALUE = THISFORM.TEXT9.VALUE+THISFORM.TEXT17.VALUE
ENDPROC
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF THISFORM.TEXT10.VALUE="M"
IF THIS.VALUE>=0
RETURN
ELSE
MESSAGEBOX("Tidak ada mutasi dng Nilai Negatif")
ENDIF
ELSE
IF THISFORM.JENIS='1'
IF THIS.VALUE>THISFORM.TEXT15.VALUE
MESSAGEBOX("Pengambilan Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ELSE
IF THIS.VALUE>THISFORM.TEXT15.VALUE
MESSAGEBOX("Pengambilan Jasa Simpanan Berjangka/Penyertaan, Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ENDIF
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan.scx::Text21
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF THISFORM.TEXT10.VALUE="M"
IF THIS.VALUE>=0
RETURN
ELSE
MESSAGEBOX("Tidak ada mutasi dng Nilai Negatif")
ENDIF
ELSE
IF THIS.VALUE>THISFORM.TEXT15.VALUE
MESSAGEBOX("Pengambilan Melebihi Ketentuan", 16, "")
ELSE
RETURN
ENDIF
ENDIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDFUNC
**
*
*  kas_simpanan.scx::Image1
**
PROCEDURE DblClick
DO FORM anggota_foto WITH SYS(2023)+"\tandatangan.jpg"
ENDPROC
**
*
*  kas_simpanan.scx::Image2
**
PROCEDURE DblClick
DO FORM anggota_foto WITH SYS(2023)+"\paraf.jpg"
ENDPROC
**
*
*  kas_simpanan.scx::Image3
**
PROCEDURE DblClick
DO FORM anggota_foto WITH SYS(2023)+"\foto.jpg"
ENDPROC
**
***
*** kas_simpanan.sct
***
*
***
*** proses_harian2.scx
***
*
*
*  proses_harian2.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
IF NKEYCODE=22
= INSMODE( .NOT. INSMODE())
THISFORM.COMMAND1.CLICK
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
IF PARAMETERS()=0
MMODE = 1
ENDIF
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.MODE = MMODE
IF MMODE=1
THISFORM.LABEL3.CAPTION = "PROSES"
THISFORM.TEXT2.VISIBLE = .F.
THISFORM.COMBO1.VISIBLE = .T.
THISFORM.SETALL("visible", .F., "checkbox")
THISFORM.SHAPE4.TOP = 80
THISFORM.COMMAND2.TOP = 90
THISFORM.COMMAND3.TOP = 90
THISFORM.CONTAINER2.TOP = 120
THISFORM.CONTAINER2.HEIGHT = 378
THISFORM.LABEL2.CAPTION = "PROSES PER BAGIAN"
THISFORM.COMBO1.VALUE = "PROSES LABA/RUGI"
THISFORM.SETALL("value", 0, "checkbox")
THISFORM.AKT1.VALUE = 1
ELSE
THISFORM.TEXT1.ENABLED = .F.
ENDIF
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
CSQL = "select MAX(tglproses) as tgl from log_proses"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT1.VALUE = IIF(EMPTY(TGL), TGLNOW, TGL)
IF ISNULL(TGL) .OR. EMPTY(TGL)
CSQL = "select MIN(tanggal) as tgl from jurnal"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF ISNULL(TGL) .OR. EMPTY(TGL)
THISFORM.TEXT1.VALUE = TGLNOW
ELSE
THISFORM.TEXT1.VALUE = TGL
ENDIF
ELSE
THISFORM.TEXT1.VALUE = TGL
ENDIF
THISFORM.TEXT2.VALUE = TGLNOW
IF MMODE=0 .AND. THISFORM.TEXT1.VALUE=TGLNOW
THISFORM.SETALL("value", 0, "checkbox")
THISFORM.AKT1.VALUE = 1
ENDIF
IF DEFASYSTEMAKT=1 .OR. EMPTY(DEFASYSTEMAKT)
THISFORM.SIMP1.VALUE = 0
THISFORM.PINJ1.VALUE = 0
THISFORM.PINJ2.VALUE = 0
THISFORM.PINJ3.VALUE = 0
THISFORM.AKT2.VALUE = 0
THISFORM.SIMP1.READONLY = .T.
THISFORM.PINJ1.READONLY = .T.
THISFORM.PINJ2.READONLY = .T.
THISFORM.PINJ3.READONLY = .T.
THISFORM.AKT2.READONLY = .T.
ELSE
THISFORM.SIMP1.VALUE = DEFAAKRUSIMPANAN
THISFORM.PINJ1.VALUE = DEFAAKRUPINJAMAN
THISFORM.PINJ2.VALUE = DEFAAKRUADM
THISFORM.PINJ3.VALUE = DEFAAKRUBIAYA
ENDIF
ENDPROC
**
*
*  proses_harian2.scx::Combo1
**
PROCEDURE LostFocus
THISFORM.SETALL("value", 0, "checkbox")
DO CASE
CASE THIS.VALUE="BUNGA SIMPANAN (AKRUAL)"
THISFORM.SIMP1.VALUE = 1
CASE THIS.VALUE="PERPANJANGAN ARO"
THISFORM.SIMP2.VALUE = 1
CASE THIS.VALUE="AUTODEBET SIMPANAN"
THISFORM.SIMP3.VALUE = 1
CASE THIS.VALUE="JASA SIMPANAN TAB/DEP"
THISFORM.SIMP4.VALUE = 1
CASE THIS.VALUE="BUNGA AKRUAL PINJAMAN"
THISFORM.PINJ1.VALUE = 1
CASE THIS.VALUE="AMORTISASI PROVISI (AKRUAL)"
THISFORM.PINJ2.VALUE = 1
CASE THIS.VALUE="AMORTISASI BIAYA (AKRUAL)"
THISFORM.PINJ3.VALUE = 1
CASE THIS.VALUE="PROSES LABA/RUGI"
THISFORM.AKT1.VALUE = 1
CASE THIS.VALUE="AMORTISASI BIAYA (AKRUAL)"
THISFORM.AKT2.VALUE = 1
CASE THIS.VALUE="PENYUSUTAN INVENTARIS"
THISFORM.AKT3.VALUE = 1
CASE THIS.VALUE="CEK CATATAN"
THISFORM.LAIN1.VALUE = 1
CASE THIS.VALUE="CEK VALIDASI"
THISFORM.LAIN2.VALUE = 1
CASE THIS.VALUE="ULANG TAHUN"
THISFORM.LAIN3.VALUE = 1
CASE THIS.VALUE="JATUH TEMPO ANGSURAN"
THISFORM.LAIN4.VALUE = 1
CASE THIS.VALUE="JATUH TEMPO PINJAMAN"
THISFORM.LAIN5.VALUE = 1
ENDCASE
ENDPROC
**
PROCEDURE Init
THIS.ADDITEM("BUNGA SIMPANAN (AKRUAL)")
THIS.ADDITEM("PERPANJANGAN ARO")
THIS.ADDITEM("AUTODEBET SIMPANAN")
THIS.ADDITEM("JASA SIMPANAN TAB/DEP")
THIS.ADDITEM("BUNGA AKRUAL PINJAMAN")
THIS.ADDITEM("AMORTISASI PROVISI (AKRUAL)")
THIS.ADDITEM("AMORTISASI BIAYA (AKRUAL)")
THIS.ADDITEM("PROSES LABA/RUGI")
THIS.ADDITEM("AMORTISASI BIAYA (AKRUAL)")
THIS.ADDITEM("PENYUSUTAN INVENTARIS")
THIS.ADDITEM("CEK CATATAN")
THIS.ADDITEM("CEK VALIDASI")
THIS.ADDITEM("ULANG TAHUN")
THIS.ADDITEM("JATUH TEMPO ANGSURAN")
THIS.ADDITEM("JATUH TEMPO PINJAMAN")
ENDPROC
**
*
*  proses_harian2.scx::Command3
**
PROCEDURE Click
IF THISFORM.CONTAINER2.SIMP1.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.SIMP2.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.SIMP3.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.PINJ1.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.PINJ2.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.PINJ3.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.AKT1.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.AKT2.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.LAIN1.VALUE=1
ENDIF
IF THISFORM.CONTAINER2.LAIN2.VALUE=1
ENDIF
ENDPROC
**
*
*  proses_harian2.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  proses_harian2.scx::Command3
**
PROCEDURE Click
LOCAL MTGLPROSES
MTGLPROSES = THISFORM.TEXT1.VALUE
MBUKTI = RIGHT(ALLTRIM(STR(YEAR(TGLNOW))), 2)+RIGHT("00"+ALLTRIM(STR(MONTH(TGLNOW))), 2)+RIGHT("00"+ALLTRIM(STR(DAY(TGLNOW))), 2)+LEFT(TIME(), 2)+SUBSTR(TIME(), 4, 2)
CSQL = "update acc_harian set tglacc='"+SQLDATE(TGLNOW)+"' where tanggal<'"+SQLDATE(TGLNOW)+"' and (kode='A01' or kode='V01' or kode='A02' or kode='P02' or kode='P03')"
LCEK = SQLEXEC(OODBC, CSQL)
MEDIT = ""
MJURBUNGA = 0
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "update acc_harian set tglacc='"+SQLDATE(TGLNOW)+"', optacc='SYS' where tglacc='0000-00-00' and tanggal<'"+SQLDATE(TGLNOW)+"' and kode='A01'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
IF THISFORM.SIMP4.VALUE=1
CSQL = "delete from simpanan_saldo where tanggal='"+SQLDATE(TGLNOW)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(TGLNOW)+"' and kode='S01'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S01'
MIDDATA = 0
MEDIT = MEDIT+CHR(13)+"PERHITUNGAN JASA SIMPANAN "+CHR(13)+"----------------------------------------"+CHR(13)
CREATE CURSOR daftbunga (NOREK C (17), BUNGA N (12), UTANG N (12), PAJAK N (12), JURTAB C (10), JURBG C (10), JURPJK C (10), JURUTANG C (10))
CREATE CURSOR coba (NOREK C (17), JUMLAH N (12))
FOR MPROSESKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MPROSESKE
THISFORM.CONTAINER2.LABEL3.CAPTION = "PERHITUNGAN JASA SIMPANAN : "+DTOC(MTGLPROSES)
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF MONTH(MTGLPROSES+1)<>MONTH(MTGLPROSES)
CSQL = "select a.norek,a.produk,b.nama from simpanan as a left join anggota as b on a.cif=b.cif  where a.kantor='"+DEFAKANTOR+"' and tgltutup='0000-00-00' and jenis='1'"
LCEK = SQLEXEC(OODBC, CSQL, "SIMPANAN")
PERTAMA = .T.
MHSL1 = 0
MR = 0
JUMREC = RECCOUNT()
IF JUMREC>0
GOTO TOP
DO WHILE  .NOT. EOF()
MREK = RECNO()
THISFORM.CONTAINER2.SHAPE5.WIDTH = (RECNO()/JUMREC)*705
MNOREK = NOREK
MNAMA = NAMA
MPRODUK = PRODUK
HASIL = LISTBUNGA(MNOREK, MTGLPROSES)
HSL1 = VAL(LEFT(HASIL, AT('|', HASIL)-1))
HSL2 = VAL(SUBSTR(HASIL, AT('|', HASIL)+1))
IF HSL1<>0
MHSL1 = HSL1
IF PERTAMA
PERTAMA = .F.
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S01','PERHITUNGAN JASA SIMPANAN SUKARELA (TABUNGAN)')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S01'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
MIDDATA = IDDATA
USE
ENDIF
MTGLPROS = SQLDATE(MTGLPROSES)
MHSL1 = STR(HSL1)
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi "+"where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLPROS)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = SALDO
USE
CSQL = "insert into acc_harian_bungasimpanan ("+"kel_id,kantor,tanggal,norek,nama,produk,saldo,jasa,pajak) "+"value (?mIddata,?DefaKantor,?tglnow,?mnorek,?mNama,?mproduk,'"+TRANSFORM(MSALDO, '999999999999999')+"',?hsl1,?hsl2)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert ke acc_harian_bungasimpanan", 0, "")
RETURN
ENDIF
ENDIF
SELECT SIMPANAN
SKIP
ENDDO
IF  .NOT. PERTAMA
CSQL = "select distinct produk from acc_harian_bungasimpanan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca produk")
ENDIF
DO WHILE  .NOT. EOF()
MPRODUK = PRODUK
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='1' and sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX("Gagal baca sandi")
ENDIF
MKET = KETERANGAN
MJURTAB = IIF(ISNULL(JURNALTAB), '', JURNALTAB)
MJURBG = IIF(ISNULL(JURNALBUNGA), '', JURNALBUNGA)
MJURPJK = IIF(ISNULL(JURNALPAJAK), '', JURNALPAJAK)
CSQL = "update acc_harian_bungasimpanan set produk='"+MKET+"', jurtab='"+MJURTAB+"', jurbg='"+MJURBG+"', jurpjk='"+MJURPJK+"' "+"where kel_id='"+STR(MIDDATA)+"' and produk='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update")
ENDIF
SELECT SMT
SKIP
ENDDO
ENDIF
ENDIF
SELECT SIMPANAN
USE
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.SIMP4.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='S03'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S03'
CSQL = "select * from setsandi_tab where a_adm+a_adm1+a_adm2+a_adm3+a_adm4+a_adm5+p_adm+p_adm1+p_adm2+p_adm3+p_adm4+p_adm5>0"
LCEK = SQLEXEC(OODBC, CSQL, "SANDI")
IF  .NOT. EMPTY(SANDI)
MIDDATA = 0
MEDIT = MEDIT+CHR(13)+"PERHITUNGAN ADMINISTRASI SIMPANAN "+CHR(13)+"----------------------------------------"+CHR(13)
CREATE CURSOR daftbunga (NOREK C (17), BUNGA N (12), UTANG N (12), PAJAK N (12), JURTAB C (10), JURBG C (10), JURPJK C (10), JURUTANG C (10))
CREATE CURSOR coba (NOREK C (17), JUMLAH N (12))
FOR MPROSESKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MPROSESKE
THISFORM.CONTAINER2.LABEL3.CAPTION = "PERHITUNGAN ADM SIMPANAN : "+DTOC(MTGLPROSES)
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF MONTH(MTGLPROSES+1)<>MONTH(MTGLPROSES)
SELECT SANDI
DO WHILE  .NOT. EOF()
MPRODUK = SANDI
MOPTAKTIF = A_OPTADM
MOPTPASIF = P_OPTADM
CSQL = "select a.norek,a.produk,b.nama from simpanan as a left join anggota as b on a.cif=b.cif  where a.kantor='"+DEFAKANTOR+"' and tgltutup='0000-00-00' and jenis='1' and a.produk='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SIMPANAN")
PERTAMA = .T.
MHSL1 = 0
MR = 0
JUMREC = RECCOUNT()
IF JUMREC>0
GOTO TOP
DO WHILE  .NOT. EOF()
MREK = RECNO()
THISFORM.CONTAINER2.SHAPE5.WIDTH = (RECNO()/JUMREC)*705
MNOREK = NOREK
MNAMA = NAMA
MPRODUK = PRODUK
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from "+"simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"' group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MSALDO = SALDO
CSQL = "select tanggal from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi where "+"norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"' and "+"(kode='"+DEFATABSTOR+"' or kode='"+DEFATABAMB+"' or kode='"+DEFATABPBK+"' ) group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
VTGLMUTASI = TANGGAL
SELECT SANDI
VAKTIF = "Y"
DO CASE
CASE OPTPASIF=1
IF HARIPASIF<MTGLPROSES-VTGLMUTASI
VAKTIF = "T"
ENDIF
CASE OPTPASIF=2
IF NOMIPASIF<VSALDO
VAKTIF = "T"
ENDIF
CASE OPTPASIF=3
IF HARIPASIF<MTGLPROSES-VTGLMUTASI .AND. NOMIPASIF<VSALDO
VAKTIF = "T"
ENDIF
ENDCASE
IF VAKTIF="T"
DO CASE
CASE MSALDO<P_NOMI_ADM1 .OR. P_NOMI_ADM1=0
MADM = P_ADM
CASE MSALDO>=P_NOMI_ADM1 .AND. MSALDO<P_NOMI_ADM2
MADM = P_ADM1
CASE MSALDO>=P_NOMI_ADM2 .AND. MSALDO<P_NOMI_ADM3
MADM = P_ADM2
CASE MSALDO>=P_NOMI_ADM3 .AND. MSALDO<P_NOMI_ADM4
MADM = P_ADM3
CASE MSALDO>=P_NOMI_ADM4 .AND. MSALDO<P_NOMI_ADM5
MADM = P_ADM4
CASE MSALDO>=P_NOMI_ADM5
MADM = P_ADM5
ENDCASE
ELSE
DO CASE
CASE MSALDO<A_NOMI_ADM1 .OR. A_NOMI_ADM1=0
MADM = A_ADM
CASE MSALDO>=A_NOMI_ADM1 .AND. MSALDO<A_NOMI_ADM2
MADM = A_ADM1
CASE MSALDO>=A_NOMI_ADM2 .AND. MSALDO<A_NOMI_ADM3
MADM = A_ADM2
CASE MSALDO>=A_NOMI_ADM3 .AND. MSALDO<A_NOMI_ADM4
MADM = A_ADM3
CASE MSALDO>=A_NOMI_ADM4 .AND. MSALDO<A_NOMI_ADM5
MADM = A_ADM4
CASE MSALDO>=A_NOMI_ADM5
MADM = A_ADM5
ENDCASE
ENDIF
MJURNALTAB = JURNALTAB
MJURNALADM = JURNALADM
MADM = MIN(MADM, MSALDO)
IF MADM<>0
IF PERTAMA
PERTAMA = .F.
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S03','PERHITUNGAN ADMINISTRASI SIMPANAN SUKARELA (TABUNGAN)')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S03'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
MIDDATA = IDDATA
USE
ENDIF
CSQL = "insert into acc_harian_admsimpanan ("+"kel_id,kantor,tanggal,norek,nama,produk,saldo,adm,jurtab,juradm) "+"value ('"+ALLTRIM(STR(MIDDATA))+"','"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MNOREK+"','"+MNAMA+"','"+MPRODUK+"','"+TRANSFORM(MSALDO, "999999999999999")+"','"+STR(MADM)+"','"+MJURALTAB+"','"+MJURNALADM+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert ke acc_harian_admsimpanan", 0, "")
RETURN
ENDIF
ENDIF
SELECT SIMPANAN
SKIP
ENDDO
ENDIF
SELECT SIMPANAN
USE
SELECT SANDI
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
ENDIF
IF THISFORM.SIMP4.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='S04'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MYT = 6
IF KODE='S04'
MYT = MESSAGEBOX("Tanggal Proses Jasa Tabungan / Deposito Sudah Ada"+CHR(13)+"Proses Dilanjutkan", 36)
ENDIF
IF KODE<>'S04' .OR. MYT=7
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
MIDDATA = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "PERHITUNGAN BUNGA SIMPANAN BERJANGKA"
MEDIT = MEDIT+CHR(13)+"PERHITUNGAN JASA SIMPANAN BERJANGKA"+CHR(13)+"----------------------------------------"+CHR(13)
NUSER = 0
ADA = .F.
FOR A = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+A
CSQL = "select a.tanggal,a.norek,produk,cif,b.pokok,bunga_ke,bunga_rek,bunga_nama,ke,b.rate,lama,b.carahitung,aro,tglawal,tgljtempo from simpanan as a left join simpanan_bilyet as b on a.norek=b.norek where a.jenis='2' and "+"tgltutup='0000-00-00' and tglawal<'"+SQLDATE(MTGLPROSES)+"' and tgljtempo>='"+SQLDATE(MTGLPROSES)+"' and ke="+"(select MAX(ke) from simpanan_bilyet where norek=a.norek group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "DEP")
PERTAMA = .T.
JUMREC = RECCOUNT()
GOTO TOP
IF JUMREC>0
DO WHILE  .NOT. EOF()
THISFORM.CONTAINER2.SHAPE5.WIDTH = (RECNO()/JUMREC)*705
MJTDEP = 'T'
MTGLHITJT = TGLAWAL
FOR AA = 0 TO LAMA
MTGLHITJT = MAJU1BLN(MTGLHITJT, TGLAWAL)
IF MTGLHITJT=MTGLPROSES
MJTDEP = 'Y'
ENDIF
ENDFOR
IF MJTDEP='Y'
MNOREK = NOREK
MTANGGAL = TANGGAL
MKE = KE
CSQL = "select SUM(kredit)-SUM(debet) as pokok from simpanan_mutasi where norek='"+MNOREK+"' and (kode='"+ALLTRIM(DEFADEPSTOR)+"' or kode='"+ALLTRIM(DEFADEPAMBPK)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "PKDEP")
MPOKOK = POKOK
USE
SELECT DEP
MRATE = RATE
MCARAHITUNG = CARAHITUNG
MLAMA = LAMA
MARO = ARO
MTGLAWAL = TGLAWAL
MTGLJTEMPO = TGLJTEMPO
MTGLHIT = MTGLAWAL
MCIF = CIF
MPRODUK = PRODUK
CSQL = "select nama from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNAMA = NAMA
CSQL = "select b.* from simpanan as a left join setsandi_tab as b on b.jenis=a.jenis and b.sandi=a.produk where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca setsandi")
ENDIF
MJURTAB = JURNALTAB
MJURBUNGA = JURNALBUNGA
MJURPAJAK = JURNALPAJAK
MPEMBULATAN = PEMBULATAN
MBUNGA = 0
MPAJAK = 0
MBATASPJK = BATASPAJAK
MBGPAJAK = PAJAK
NUSER = NUSER+1
MHARI = DAY(AWALBLN(MTGLPROSES)-1)
IF MCARAHITUNG='E' .OR. EMPTY(MCARAHITUNG)
MBUNGA = (MHARI/365)*(MRATE/100)*MPOKOK
MBUNGA = PEMBULATAN(MBUNGA, MPEMBULATAN)
IF MPOKOK>MBATASPJK
MPAJAK = MBUNGA*(MBGPAJAK/100)
ENDIF
ENDIF
IF MCARAHITUNG='R'
MBUNGA = ((MRATE/100)*MPOKOK)/12
MBUNGA = PEMBULATAN(MBUNGA, MPEMBULATAN)
IF MPOKOK>MBATASPJK
MPAJAK = MBUNGA*(MBGPAJAK/100)
ENDIF
ENDIF
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S04'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S04','PERHITUNGAN JASA SIMPANAN BERJANGKA (DEPOSITO)')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S04'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT DEP
DO CASE
CASE BUNGA_KE="DEPOSITO"
MKET = "DEPOSITO / Perpanjangan Otomatis"
CASE BUNGA_KE="TUNAI"
MKET = "Jasa diambil tunai"
CASE BUNGA_KE="TABUNGAN"
MKET = "Jasa Ditransfer ke rek. Tabungan no."+ALLTRIM(BUNGA_REK)+" ("+ALLTRIM(BUNGA_NAMA)+")"
OTHERWISE
MKET = ""
ENDCASE
CSQL = "insert into acc_harian_bungadeposito (kel_id,kantor,tanggal,norek,nama,produk,rate,"+"hari,carahit,saldo,jasa,pajak, aro,keterangan,bungake,norektujuan,atasnama,jurtab,jurbg, jurpjk) value "+"('"+ALLTRIM(STR(MIDDATA))+"','"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MNOREK+"','"+MNAMA+"','"+MPRODUK+"','"+TRANSFORM(MRATE, '99.99')+"','"+STR(MHARI)+"','"+MCARAHITUNG+"','"+TRANSFORM(MPOKOK, '999999999999999')+"','"+STR(MBUNGA)+"','"+STR(MPAJAK)+"','"+MARO+"','"+MKET+"','"+BUNGA_KE+"','"+BUNGA_REK+"','"+BUNGA_NAMA+"','"+MJURTAB+"','"+MJURBUNGA+"','"+MJURPAJAK+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert ke acc_harian_bungadeposito", 0, "")
RETURN
ENDIF
ENDIF
SELECT DEP
SKIP
ENDDO
SELECT DEP
USE
CSQL = "select distinct produk from acc_harian_bungadeposito where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca produk")
ENDIF
DO WHILE  .NOT. EOF()
MPRODUK = PRODUK
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='2' and sandi='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
IF LCEK<1
MESSAGEBOX("Gagal baca sandi")
ENDIF
MKET = KETERANGAN
MJURTAB = IIF(ISNULL(JURNALTAB), '', JURNALTAB)
MJURBG = IIF(ISNULL(JURNALBUNGA), '', JURNALBUNGA)
MJURPJK = IIF(ISNULL(JURNALPAJAK), '', JURNALPAJAK)
CSQL = "update acc_harian_bungadeposito set produk='"+MKET+"', jurtab='"+MJURTAB+"', jurbg='"+MJURBG+"', jurpjk='"+MJURPJK+"' "+"where kel_id='"+STR(MIDDATA)+"' and produk='"+MPRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update")
ENDIF
SELECT SMT
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
IF NUSER>0
MEDIT = MEDIT+"Perhitungan Jasa Simpanan Berjangka sebanyak "+ALLTRIM(STR(NUSER))+" Simpanan Berjangka"
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDIF
ENDIF
ENDIF
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
IF THISFORM.SIMP2.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='S05'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S05'
THISFORM.CONTAINER2.LABEL3.CAPTION = "PERPENJANGAN OTOMATIS SIMPANAN BERJANGKA"
MEDIT = MEDIT+CHR(13)+"PERPANJANGAN OTOMATIS SIMPANAN BERJANGKA"+CHR(13)+"----------------------------------------"+CHR(13)
PERTAMA = .T.
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "select a.*,b.* from simpanan as a left join simpanan_bilyet as b on a.norek=b.norek "+"where a.jenis='2' and b.tgljtempo='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and tgltutup='0000-00-00'"
IF DAY(MTGLPROSES)>28
MDAY = "day(b.tanggal)>'28'"
ELSE
MDAY = "day(b.tanggal)='"+STR(DAY(MTGLPROSES))+"'"
ENDIF
CSQL = "select a.tanggal as tglbuka,a.norek as norek,b.tanggal as tanggal,ke,b.pokok as pokok,b.rate as rate,b.carahitung,lama,tglawal,tgljtempo,aro,a.nobuku from simpanan as a left join simpanan_bilyet as b on a.norek=b.norek where b.tanggal="+"(select MAX(tanggal) from simpanan_bilyet where norek=a.norek) and b.tgljtempo='"+SQLDATE(MTGLPROSES)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "DEP")
JUMREC = RECCOUNT()
IF JUMREC>0
NUSER = 0
DO WHILE  .NOT. EOF()
NUSER = NUSER+1
MNOREK = NOREK
MNOBILYET = NOBUKU
MTANGGAL = TANGGAL
MTGLBUKA = TGLBUKA
MKE = KE
MPOKOK = POKOK
MRATE = RATE
MCARAHITUNG = CARAHITUNG
MLAMA = LAMA
MARO = ARO
MTGLAWAL = TGLAWAL
MTGLJTEMPO = TGLJTEMPO
MTGLJT = MTGLJTEMPO
FOR A = 1 TO MLAMA
MTGLJT = MAJU1BLN(MTGLJT, MTGLBUKA)
ENDFOR
CSQL = "select nama,alamat from simpanan as a left join anggota as b on a.cif=b.cif where a.norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
MNAMA = NAMA
MALAMAT = ALAMAT
USE
SELECT DEP
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S05'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S05','PERPANJANGAN OTOMATIS (ARO) SIMPANAN BERJANGKA (DEPOSITO)' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S05'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_dep_aro where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
CSQL = "insert into acc_harian_dep_aro (kel_id,kantor,tanggal,norek,nama,alamat,"+"nobilyet,rate_lama,ke,pokok,rate,carahitung,lama,aro,tglawal,tgljtempo,opt) "+" value ('"+STR(MIDDATA)+"','"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+MNOREK+"','"+MNAMA+"','"+MALAMAT+"','"+MNOBILYET+"','"+TRANSFORM(MRATE, '999.99')+"','"+STR(MKE+1)+"','"+STR(MPOKOK)+"','"+STR(MRATE)+"','"+MCARAHITUNG+"','"+STR(MLAMA)+"','"+MARO+"','"+SQLDATE(MTGLJTEMPO)+"','"+SQLDATE(MTGLJT)+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal baca")
ENDIF
SELECT DEP
SKIP
ENDDO
SELECT DEP
USE
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.SIMP3.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='S05'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'S05'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "PROSES AUTODEBET"
MEDIT = MEDIT+CHR(13)+"PROSES AUTODEBET"+CHR(13)+"----------------------------------------"+CHR(13)+"Dalam Perbaikan"+CHR(13)
MPERTAMA = .T.
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "select * from simpanan_autodebet where tglcabut='000-00-00' and tglauto='"+STR(DAY(MTGLPROSES))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
DO WHILE  .NOT. EOF()
MIDAUTODEBET = IDAUTODEBET
MNOREK = NOREK
CSQL = "select saldo from simpanan_mutasi where iddata="+"(select MAX(iddata) from simpanan_mutasi where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(TGLNOW)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "simp")
MSALDO = SALDO
USE
CSQL = "select nama from simpanan as a left join anggota as b on a.cif=b.cif where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
MNAMA = NAMA
USE
SELECT SMT
MKET = KET
MJUMLAH = JUMLAH
MNOREK_TUJUAN = NOREK_TUJUAN
MPIL = OPT_REK
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','S02','DAFTAR AUTO DEBET SIMPANAN' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='S02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_autodebet where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT SMT
CSQL = "insert into acc_harian_autodebet (kel_id,KANTOR,idautodebet,tanggal,norek,nama,saldo,ket,"+"jumlah,opt_rek,norek_tujuan,tglauto,tglakhir) values ('"+STR(MIDDATA)+"','"+DEFAKANTOR+"','"+STR(IDAUTODEBET)+"','"+SQLDATE(TANGGAL)+"','"+NOREK+"','"+MNAMA+"','"+TRANSFORM(MSALDO, '999999999999999')+"','"+KET+"','"+TRANSFORM(JUMLAH, '999999999999999')+"','"+STR(OPT_REK)+"','"+NOREK_TUJUAN+"','"+STR(TGLAUTO)+"','"+SQLDATE(TGLAKHIR)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan autodebet")
ENDIF
SKIP
ENDDO
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
IF THISFORM.AKT1.VALUE=1
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "PROSES POSTING NERACA / LABA - RUGI"
MEDIT = MEDIT+CHR(13)+"PROSES POSTING NERACA"+CHR(13)+"----------------------------------------"+CHR(13)
CSQL = "select * from jurnal where tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and tanggal<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
DO WHILE  .NOT. EOF()
MNOPER = NOPER
CSQL = "select noper,detail from perkiraan where noper='"+MNOPER+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek1")
IF EMPTY(MNOPER)
MEDIT = MEDIT+"Tanggal : "+DTOC(CEK.TANGGAL)+" Bukti : "+CEK.BUKTI+" Nomor Perkiraan Kosong, Cek Setting"+CHR(13)
ENDIF
IF NOPER<>MNOPER
MEDIT = MEDIT+"Tanggal : "+DTOC(CEK.TANGGAL)+" Bukti : "+CEK.BUKTI+" Nomor Perkiraan tidak terdapat di Daftar Perkiraan"+CHR(13)
ENDIF
IF DETAIL='T'
MEDIT = MEDIT+"Tanggal : "+DTOC(CEK.TANGGAL)+" Bukti : "+CEK.BUKTI+" Nomor Tidak dapat digunakan untuk transaksi"+CHR(13)
ENDIF
USE
SELECT CEK
SKIP
ENDDO
SELECT CEK
USE
MTGLPROSES = THISFORM.TEXT1.VALUE
DO WHILE .T.
IF MTGLPROSES>THISFORM.TEXT2.VALUE
EXIT
ENDIF
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "delete from neraca where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(MTGLPROSES)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "select noper from perkiraan where detail='Y'"
LCEK = SQLEXEC(OODBC, CSQL, "AKT")
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
JUMREC = RECCOUNT()
GOTO TOP
DO WHILE  .NOT. EOF()
THISFORM.CONTAINER2.SHAPE5.WIDTH = (RECNO()/JUMREC)*705
HITNERACA(DEFAKANTOR, ALLTRIM(NOPER), MTGLPROSES)
SELECT AKT
SKIP
ENDDO
HITLABA(MTGLPROSES)
SELECT AKT
USE
MTGLPROSES = MTGLPROSES+1
ENDDO
MTGLPROSES = TGLNOW
CSQL = "select noper,saldo from perkiraan where LEFT(kel,1)='N' order by kel,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
MSLD = 0
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
CSQL = "select saldo from neraca where noper='"+MNOPER+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MNOPER+"' and tanggal<='"+SQLDATE(TGLNOW)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "aa1")
MSLD = MSLD+SALDO
USE
SELECT AA
SKIP
ENDDO
IF MSLD<>0
MEDIT = MEDIT+"Neraca Tidak Balance."+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDIF
IF THISFORM.AKT3.VALUE=1
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='GL1'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'GL1'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "PROSES PENYUSUTAN INVENTARIS"
MEDIT = MEDIT+CHR(13)+"PROSES PENYUSUTAN INVENTARIS"+CHR(13)+"----------------------------------------------"+CHR(13)
CSQL = "select * from gl_inventaris where nilaibuku>0 and gol<>'0'"
LCEK = SQLEXEC(OODBC, CSQL, "INV")
PERTAMA = .T.
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF MTGLPROSES=AKHIRBLN(MTGLPROSES) .AND. THISFORM.AKT3.VALUE=1
MR = 0
SELECT INV
GOTO TOP
DO WHILE  .NOT. EOF()
MBUKT = MBUKTI
MNOMORID = NOMORID
MTANGGAL = TANGGAL
MHARGA = HARGA
MLAMA = LAMA
MPERBLN = PENYUSUTAN
MJURBIAYA = JUR_BIAYA
MJURAKUM = JUR_AKUM
MNAMA = NAMA
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='GL1'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','GL1','PENYUSUTAN INVENTARIS' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='GL1'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_inventaris where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
CSQL = "select SUM(kredit) as jkredit,SUM(debet) as jdebet from gl_inventaris_mutasi where nomorid='"+STR(MNOMORID)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "MTS")
MJMLMTS = IIF(ISNULL(JKREDIT), 0, JKREDIT)-IIF(ISNULL(JDEBET), 0, JDEBET)
IF MJMLMTS<MHARGA
IF .T.
MBLN = (YEAR(MTGLPROSES)-YEAR(MTANGGAL))*12+(MONTH(MTGLPROSES)-MONTH(MTANGGAL))+1
MBLN = MIN(MBLN, MLAMA)
MHARUS = MBLN*MPERBLN
MSELISIH = MHARUS-MJMLMTS
MDEBET = IIF(MSELISIH>0, MSELISIH, 0)
MKREDIT = IIF(MSELISIH<0, 0-MSELISIH, 0)
IF MSELISIH<>0
CSQL = "insert into acc_harian_inventaris (kel_id,kantor,tanggal,idinvent,keterangan,debet,kredit,opt,nama,jur_biaya,jur_akum) value "+"(?mIdData,?DefaKantor,?mtglproses,?mNomorId,'"+"PENYUSUTAN BLN "+ALLTRIM(STR(MONTH(MTGLPROSES)))+"',?mdebet,?mkredit,?DefaUserId,?mNama,?mJurbiaya,?mjurakum)"
LCEK = SQLEXEC(OODBC, CSQL, 'SMT')
ENDIF
ELSE
ENDIF
ENDIF
SELECT INV
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN4.VALUE=1
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
HARISEBELUM = VAL(CARIPUBLIC("HARIJTANGS"))
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='P02'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'P02'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "JATUH TEMPO ANGSURAN"
MEDIT = MEDIT+CHR(13)+"JATUH TEMPO ANGSURAN"+CHR(13)+"----------------------------------------------"+CHR(13)
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
MAKHBLN = .F.
IF MTGLPROSES=AKHIRBLN(MTGLPROSES)
MAKHBLN = .T.
ENDIF
IF .T.
IF MAKHBLN
CSQL = "select a.tanggal,a.norek,a.pokok,a.rate,a.lama,a.tgljtempo,b.nama,b.alamat,b.phone from pinjaman as a, anggota as b where "+"a.cif=b.cif and tgllunas='000-00-00' and tgljtempo>'"+SQLDATE(MTGLPROSES-HARISEBELUM)+"' and DAY(a.tanggal)>='"+STR(DAY(MTGLPROSES-HARISEBELUM))+"'"
ELSE
CSQL = "select a.tanggal,a.norek,a.pokok,a.rate,a.lama,a.tgljtempo,b.nama,b.alamat,b.phone from pinjaman as a, anggota as b where "+"a.cif=b.cif and tgllunas='000-00-00' and tgljtempo>'"+SQLDATE(MTGLPROSES-HARISEBELUM)+"' and DAY(a.tanggal)='"+STR(DAY(MTGLPROSES-HARISEBELUM))+"'"
ENDIF
PERTAMA = .T.
LCEK = SQLEXEC(OODBC, CSQL, "KRD")
MR = 0
GOTO TOP
DO WHILE  .NOT. EOF()
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='P02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','P02','PINJAMAN JATUH TEMPO ANGSURAN' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='P02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_angsuranjt where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT KRD
MNAMA = NAMA
MALAMAT = ALAMAT
MNOREK = NOREK
MPHONE = PHONE
MCUR = SALDOKRD(MNOREK, MTGLPROSES)
SELECT (MCUR)
MTUNGPK = ODPK
MTUNGBG = ODBG
MDENDA = DENDA
MANGSPK = NJDWPK
MANGSBG = NJDWBG
USE
SELECT KRD
CSQL = "insert into acc_harian_angsuranjt (kel_id,kantor,tanggal,norek,nama,alamat,phone,tungpk,tungbg,tungdenda,angspokok,angsbunga) value "+"(?mIdData,?DefaKantor,?tglnow,?mnorek,?mNama,?mAlamat,?mPhone,?mtungpk,?mtungbg,?mdenda,?mAngspk,?mAngsbg)"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT KRD
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN5.VALUE=1
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
HARISEBELUM = VAL(CARIPUBLIC("HARIJTPINJ"))
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='P03'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'P03'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "JATUH TEMPO PINJAMAN"
MEDIT = MEDIT+CHR(13)+"JATUH TEMPO PINJAMAN"+CHR(13)+"----------------------------------------------"+CHR(13)
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF .T.
CSQL = "select a.tanggal,a.norek,a.pokok,a.rate,a.lama,a.tgljtempo,b.nama,b.alamat,b.phone from pinjaman as a, anggota as b where "+"a.cif=b.cif and tgllunas='000-00-00' and tgljtempo='"+SQLDATE(MTGLPROSES-HARISEBELUM)+"'"
LCEK = SQLEXEC(OODBC, CSQL, "KRD")
PERTAMA = .T.
MR = 0
GOTO TOP
DO WHILE  .NOT. EOF()
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='P03'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','P03','PINJAMAN JATUH TEMPO PERJANJIAN' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='P02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_pinjamanjt where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT KRD
MNAMA = NAMA
MALAMAT = ALAMAT
MNOREK = NOREK
MPHONE = PHONE
MCUR = SALDOKRD(MNOREK, MTGLPROSES)
SELECT (MCUR)
MTUNGPK = ODPK
MTUNGBG = ODBG
MDENDA = DENDA
MANGSPK = NJDWPK
MANGSBG = NJDWBG
USE
SELECT KRD
CSQL = "insert into acc_harian_pinjamanjt (kel_id,kantor,tanggal,norek,nama,alamat,phone,tungpk,tungbg,tungdenda,angspokok,angsbunga) value "+"(?mIdData,?DefaKantor,?tglnow,?mnorek,?mNama,?mAlamat,?mPhone,?mtungpk,?mtungbg,?mdenda,?mAngspk,?mAngsbg)"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT KRD
SKIP
ENDDO
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN3.VALUE=1
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
HARISEBELUM = VAL(CARIPUBLIC("HARIULTAH"))
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='A02'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'A02'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "ULANG TAHUN NASABAH"
MEDIT = MEDIT+CHR(13)+"ULANG TAHUN NASABAH"+CHR(13)+"----------------------------------------------"+CHR(13)
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
IF .T.
CSQL = "select * from anggota where DAY(tanggallhr)='"+STR(DAY(MTGLPROSES-HARISEBELUM))+"' and MONTH(tanggallhr)='"+STR(MONTH(MTGLPROSES-HARISEBELUM))+"'"
LCEK = SQLEXEC(OODBC, CSQL, "ULTAH")
MR = 0
PERTAMA = .T.
GOTO TOP
DO WHILE  .NOT. EOF()
IF PERTAMA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='A02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','A02','ULANG TAHUN ANGGOTA / NASABAH' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='A02'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_ulangtahun where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT ULTAH
MNAMA = NAMA
MALAMAT = ALAMAT
MNOANGG = CIF
MPHONE = PHONE
MTGLLAHIR = TANGGALLHR
MUMUR = YEAR(TGLNOW)-YEAR(TANGGALLHR)
CSQL = "insert into acc_harian_ulangtahun (kel_id,kantor,tanggal,noangg,nama,alamat,phone,tgllahir,umur) value "+"(?mIdData,?DefaKantor,?tglnow,?mnoangg,?mNama,?mAlamat,?mPhone,?mtgllahir,?mumur)"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT ULTAH
SKIP
ENDDO
ENDIF
SELECT ULTAH
USE
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF THISFORM.LAIN1.VALUE=1
CSQL = "select ket2,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
HARISEBELUM = VAL(CARIPUBLIC("HARICTT"))
CSQL = "select kode from acc_harian where tanggal='"+SQLDATE(MTGLPROSES)+"' and kode='A01'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF KODE<>'A01'
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "CEK CATATAN"
MEDIT = MEDIT+CHR(13)+"CATATAN"+CHR(13)+"----------------------------------------"+CHR(13)
CSQL = "select * from catatan where tglselesai='0000-00-00' and vld<>'1'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
PERTAMA = .T.
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
GOTO TOP
DO WHILE  .NOT. EOF()
ADA = .F.
DO CASE
CASE VLD2="1"
IF TGLVALID>=MTGLPROSES-HARISEBELUM
ADA = .T.
MCATATAN = CATATAN
ENDIF
CASE VLD2="2"
IF TGLVALID=MTGLPROSES-HARISEBELUM
ADA = .T.
MCATATAN = CATATAN
ENDIF
CASE VLD2="3"
IF DAY(TGLVALID)=DAY(MTGLPROSES-HARISEBELUM)
ADA = .T.
MCATATAN = CATATAN
ENDIF
ENDCASE
IF PERTAMA .AND. ADA
PERTAMA = .F.
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='A01'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF ISNULL(IDDATA) .OR. EMPTY(IDDATA)
CSQL = "insert into acc_harian (kantor,tanggal,jenis,kode,keterangan) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','','A01','TERDAPAT CATATAN' )"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("insert acc_harian, gagal", 0, "")
RETURN
ENDIF
CSQL = "select iddata from acc_harian where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(TGLNOW)+"' and kode='A01'"
LCEK = SQLEXEC(OODBC, CSQL, "ACC")
IF LCEK<1
MESSAGEBOX("baca acc_harian, gagal", 0, "")
RETURN
ENDIF
ELSE
MIDDATA = IDDATA
CSQL = "delete from acc_harian_catatan where kel_id='"+STR(MIDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
MIDDATA = IDDATA
USE
ENDIF
SELECT SMT
IF ADA
CSQL = "insert into acc_harian_catatan (kel_id,kantor,DEPT,norek,idcatatan,tanggal,catatan) value ("+"'"+STR(MIDDATA)+"','"+DEFAKANTOR+"','"+DEPT+"','"+NOREK+"','"+STR(IDCATATAN)+"','"+SQLDATE(TANGGAL)+"','"+CATATAN+"')"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SKIP
ENDDO
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
ENDIF
ENDIF
IF .T.
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
THISFORM.CONTAINER2.LABEL3.CAPTION = "CEK VALIDASI"
MEDIT = MEDIT+CHR(13)+"VALIDASI DATA"+CHR(13)+"----------------------------------------"+CHR(13)
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and ket2='NRC_AKT'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOPER1 = ALLTRIM(KETERANGAN)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='SYS' and sandi='PUB' and ket2='NRC_PSV'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
MNOPER2 = ALLTRIM(KETERANGAN)
USE
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
SELECT 0
CREATE CURSOR cekpinj (PRODUK C (4), KET C (30), JURNAL C (10), KREDIT N (12), AKT N (12))
SELECT 0
CSQL = "select sandi,keterangan,jurnal_pokok from setsandi_pinj where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "snd")
DO WHILE  .NOT. EOF()
MSANDI = SANDI
MKET = KETERANGAN
MJURNAL = JURNAL_POKOK
SELECT CEKPINJ
APPEND BLANK
REPLACE PRODUK WITH MSANDI
REPLACE KET WITH MKET
REPLACE JURNAL WITH MJURNAL
SELECT SND
SKIP
ENDDO
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
SELECT CEKPINJ
REPLACE KREDIT WITH 0 FOR .T.
REPLACE AKT WITH 0 FOR .T.
CSQL = "select jurnal_pokok from setsandi_pinj where kantor='"+DEFAKANTOR+"' group by jurnal_pokok"
LCEK = SQLEXEC(OODBC, CSQL, "snd")
DO WHILE  .NOT. EOF()
MJURNAL = ALLTRIM(JURNAL_POKOK)
CSQL = "select saldo from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MJURNAL+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MJURNAL+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "nrc")
MSALDO = IIF(ISNULL(SALDO), 0, SALDO)
SELECT CEKPINJ
LOCATE FOR JURNAL=MJURNAL
IF FOUND()
REPLACE AKT WITH MSALDO
ENDIF
SELECT SND
SKIP
ENDDO
SELECT SND
USE
SELECT NRC
USE
SELECT CEKPINJ
SELECT SUM(AKT) AS AKT, SUM(KREDIT) AS KREDIT, SUM(AKT)-SUM(KREDIT) AS SELISIH FROM cekpinj GROUP BY JURNAL INTO CURSOR HASIL
MSELISIH = SELISIH
SELECT HASIL
USE
IF MSELISIH<>0
MEDIT = MEDIT+"  Terdapat selisih antara neraca dengan kredit yg diberikan sebesar :"+TRANSFORM(MSELISIH, "999,999,999,999")+CHR(13)
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
SELECT CEKPINJ
USE
SELECT 0
CREATE CURSOR cek (PRODUK C (4), KET C (30), JURNAL C (10), SIMPANAN N (12), AKT N (12))
CSQL = "select sandi,keterangan,jurnaltab from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='1'"
LCEK = SQLEXEC(OODBC, CSQL, "snd")
DO WHILE  .NOT. EOF()
MSANDI = SANDI
MKET = KETERANGAN
MJURNAL = JURNALTAB
SELECT CEK
APPEND BLANK
REPLACE PRODUK WITH MSANDI
REPLACE KET WITH MKET
REPLACE JURNAL WITH MJURNAL
SELECT SND
SKIP
ENDDO
SELECT SND
USE
FOR MKE = 0 TO THISFORM.TEXT2.VALUE-THISFORM.TEXT1.VALUE
MTGLPROSES = THISFORM.TEXT1.VALUE
MTGLPROSES = MTGLPROSES+MKE
MEDIT = MEDIT+"Tanggal : "+DTOC(MTGLPROSES)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
SELECT CEK
REPLACE SIMPANAN WITH 0 FOR .T.
REPLACE AKT WITH 0 FOR .T.
CSQL = "select jurnaltab from setsandi_tab where kantor='"+DEFAKANTOR+"'  and jenis='1' group by jurnaltab"
LCEK = SQLEXEC(OODBC, CSQL, "snd")
DO WHILE  .NOT. EOF()
MJURNAL = ALLTRIM(JURNALTAB)
CSQL = "select saldo from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MJURNAL+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MJURNAL+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "nrc")
MSALDO = IIF(ISNULL(SALDO), 0, 0-SALDO)
SELECT CEK
LOCATE FOR JURNAL=MJURNAL
IF FOUND()
REPLACE AKT WITH MSALDO
ENDIF
SELECT SND
SKIP
ENDDO
SELECT SND
USE
SELECT NRC
USE
CSQL = "select norek,pokok,produk from simpanan where kantor='"+ALLTRIM(DEFAKANTOR)+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"' and jenis='1' and (tgltutup='0000-00-00' or tgltutup>'"+SQLDATE(MTGLPROSES)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "hit")
GOTO TOP
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MPOKOK = IIF(ISNULL(POKOK), 0, POKOK)
MJENIS = ALLTRIM(PRODUK)
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi "+"where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "tab")
MSALDO = SALDO
USE
SELECT CEK
LOCATE FOR PRODUK=MJENIS
IF FOUND()
REPLACE SIMPANAN WITH SIMPANAN+MSALDO
ELSE
MEDIT = MEDIT+"Terdapat tabungan yang tidak masuk dalam daftar prosuk pada setting produk simpanan"+CHR(13)
MEDIT = MEDIT+"        "+MJENIS+" No.Rekening : "+MNOREK+" Jumlah : "+TRANSFORM(MSALDO, "999,999,999,999,999")+CHR(13)
ENDIF
SELECT HIT
SKIP
ENDDO
SELECT CEK
SELECT SUM(AKT) AS AKT, SUM(SIMPANAN) AS SIMP, SUM(AKT)-SUM(SIMPANAN) AS SELISIH FROM cek GROUP BY JURNAL INTO CURSOR HASIL
MSELISIH = SELISIH
SELECT HASIL
USE
IF MSELISIH<>0
MEDIT = MEDIT+"  Terdapat selisih antara neraca dengan tabungan sebesar :"+TRANSFORM(MSELISIH, "999,999,999,999")+CHR(13)
ENDIF
MEDIT = MEDIT+"  .......................... Selesai"+CHR(13)
THISFORM.CONTAINER2.EDIT1.VALUE = MEDIT
ENDFOR
SELECT CEK
USE
ENDIF
CSQL = "insert into log_proses (kantor,tanggal,tglproses,keterangan,opt) value "+"('"+DEFAKANTOR+"','"+SQLDATE(TGLNOW)+"','"+SQLDATE(THISFORM.TEXT2.VALUE)+"','"+MEDIT+"','"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
THISFORM.CONTAINER2.EDIT1.VALUE = CSQL
ENDIF
CSQL = "update batastanggal set tglawal='"+SQLDATE(THISFORM.TEXT2.VALUE)+"', tglakhir='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.CONTAINER2.SHAPE5.WIDTH = 0
MESSAGEBOX("PROSES HARIAN, SELESAI", 0, "")
THISFORM.COMMAND2.SETFOCUS
ENDPROC
**
*
*  proses_harian2.scx::Command12
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  proses_harian2.scx::Text1
**
PROCEDURE LostFocus
IF THISFORM.MODE=1
THISFORM.TEXT2.VALUE = THIS.VALUE
ENDIF
ENDPROC
**
*
*  proses_harian2.scx::Text2
**
PROCEDURE LostFocus
IF LASTKEY()=5
RETURN
ENDIF
IF THIS.VALUE<THISFORM.TEXT1.VALUE
MESSAGEBOX("Tanggal proses Harap dicek lagi")
NODEFAULT
RETURN
ENDIF
IF THIS.VALUE-THISFORM.TEXT1.VALUE>60
MESSAGEBOX("Proses Terlalu lama, harap diproses bertahap")
NODEFAULT
RETURN
ENDIF
ENDPROC
**
***
*** proses_harian2.sct
***
*
***
*** acc_harian_simpanan_detail.scx
***
*
*
*  acc_harian_simpanan_detail.scx::FORM1
**
PROCEDURE Unload
SELECT (THISFORM.OLDDBF)
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
IF VARTYPE(MMODE)<>"C"
MMODE = ' '
ENDIF
THISFORM.MODE = MMODE
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.IDDATA = IDDATA
THISFORM.OLDDBF = SELECT()
THISFORM.DATA1 = "SIMP_DETAIL"
THISFORM.LABEL13.CAPTION = "JASA SIMPANAN"
THISFORM.LABEL14.CAPTION = THISFORM.LABEL13.CAPTION
IF MMODE=' '
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT4.VALUE = PRODUK
THISFORM.TEXT5.VALUE = RATE
THISFORM.TEXT6.VALUE = SALDO
THISFORM.TEXT7.VALUE = JASA
THISFORM.TEXT8.VALUE = PAJAK
ENDIF
IF MMODE='INPUT'
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .T.
THISFORM.TEXT8.ENABLED = .T.
THISFORM.COMMAND5.VISIBLE = .F.
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  acc_harian_simpanan_detail.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
IF EMPTY(THIS.VALUE)
DO FORM simpanan TO MNOREK WITH "CARI"
THIS.VALUE = MNOREK
ENDIF
MNOREK = THIS.VALUE
CSQL = "select a.norek,a.produk,b.nama,b.alamat from simpanan as a, anggota as b where a.cif=b.cif and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT4.VALUE = PRODUK
ENDFUNC
**
*
*  acc_harian_simpanan_detail.scx::Command1
**
PROCEDURE Click
THISFORM.COMMAND1.VISIBLE = .F.
THISFORM.COMMAND5.VISIBLE = .F.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
THISFORM.TEXT7.ENABLED = .T.
THISFORM.TEXT8.ENABLED = .T.
THISFORM.TEXT1.SETFOCUS
ENDPROC
**
*
*  acc_harian_simpanan_detail.scx::Command2
**
PROCEDURE Click
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
THISFORM.TEXT1.ENABLED = .F.
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.TEXT9.ENABLED = .F.
ENDPROC
**
*
*  acc_harian_simpanan_detail.scx::Command3
**
PROCEDURE Click
SELECT (THISFORM.OLDDBF)
IF THISFORM.MODE="INPUT"
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='1' and sandi='"+THISFORM.TEXT4.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt0")
MRATE = A_RATE
MJURTAB = JURNALTAB
MJURBG = JURNALBUNGA
MJURPJK = JURNALPAJAK
ELSE
THISFORM.COMMAND1.VISIBLE = .T.
THISFORM.COMMAND2.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
REPLACE JASA WITH THISFORM.TEXT7.VALUE
REPLACE PAJAK WITH THISFORM.TEXT8.VALUE
CSQL = "update acc_harian_bungasimpanan set jasa='"+STR(THISFORM.TEXT7.VALUE)+"', pajak='"+STR(THISFORM.TEXT8.VALUE)+"' where iddata='"+STR(IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_simpanan_detail.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  acc_harian_simpanan_detail.scx::Command5
**
PROCEDURE Click
CSQL = "delete from acc_harian_bungasimpanan where iddata='"+STR(THISFORM.IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT (THISFORM.OLDDBF)
THISFORM.RELEASE
ENDPROC
**
***
*** acc_harian_simpanan_detail.sct
***
*
***
*** a_perbaikan_simpanan.scx
***
*
*
*  a_perbaikan_simpanan.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
RETURN
ENDIF
ENDPROC
**
PROCEDURE Init
THISFORM.SHAPE1.WIDTH = 0
CSQL = "select * from simpanan_mutasi order by tanggal,iddata"
LCEK = SQLEXEC(OODBC, CSQL, "simpanan")
MREK = RECCOUNT()
CSQL = "TRUNCATE TABLE simpanan_mutasi"
LCEK = SQLEXEC(OODBC, CSQL)
SELECT SIMPANAN
GOTO TOP
A = 0
DO WHILE  .NOT. EOF()
A = A+1
THISFORM.SHAPE1.WIDTH = INT((A/MREK)*400)
CSQL = "insert into simpanan_mutasi ("+"kantor,norek,JAM,BUKTI,TANGGAL,kode,KETERANGAN,DEBET,KREDIT,SALDO,PENYETOR,PENERIMA,SUMBERDANA,BERITA,tgljawal,CETAKKARTU,CETAKBUKU,opt,logreff) value "+"(?kantor,?norek,?JAM,?BUKTI,?TANGGAL,?kode,?KETERANGAN,?DEBET,?KREDIT,?SALDO,?PENYETOR,?PENERIMA,?SUMBERDANA,?BERITA,?tgljawal,?CETAKKARTU,?CETAKBUKU,?opt,?logreff)"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
SELECT SIMPANAN
SKIP
ENDDO
ENDPROC
**
***
*** a_perbaikan_simpanan.sct
***
*
***
*** a_kantor baru.scx
***
*
*
*  a_kantor baru.scx::Kosongkan
**
PROCEDURE Click
LCCON = "DRIVER={MySQL ODBC 5.1 Driver};DESC=;DATABASE=SABARA"+";SERVER=localhost;UID=root"+";PASSWORD=123;PORT=3306;OPTION=;STMT=;"
DEFACONNECT = LCCON
OODBC = SQLSTRINGCONNECT(DEFACONNECT)
CSQL = "select table_name from information_schema.tables where table_schema='SABARA'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
GOTO TOP
DO WHILE  .NOT. EOF()
IF (UPPER(TABLE_NAME)="PERKIRAAN" .OR. UPPER(TABLE_NAME)="SETSANDI" .OR. UPPER(TABLE_NAME)="SETSANDI_TAB" .OR. UPPER(TABLE_NAME)="SETSANDI_PINJ" .OR. UPPER(TABLE_NAME)="USER" .OR. UPPER(TABLE_NAME)="USER_GROUP" .OR. UPPER(TABLE_NAME)="BATASTANGGAL")
ELSE
CSQL = "TRUNCATE TABLE "+TABLE_NAME
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(TABLE_NAME+" Tidak dapat dihapus")
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
CSQL = "update setsandi set kantor='0001' where kantor<>'0001' and kantor<>'ID'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_pinj set kantor='0001' where kantor<>'0001'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update setsandi_tab set kantor='0001' where kantor<>'0001'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDPROC
**
***
*** a_kantor baru.sct
***
*
***
*** a4.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
LOCAL OFORM
OFORM = CREATEOBJECT("Tform")
OFORM.SHOW(1)
ENDPROC
**
DEFINE CLASS Tform AS Form
WIDTH = 340
HEIGHT = 310
AUTOCENTER = .T.
CAPTION = "Using Video Capture"
MINBUTTON = .F.
MAXBUTTON = .F.
HWINDOW = 0
HCAPTURE = 0
CAPWIDTH = 0
CAPHEIGHT = 0
CAPOVERLAY = 0
ADD OBJECT CMDGETFRAME AS COMMANDBUTTON WITH DEFAULT = .T., LEFT = 15, TOP = 264, HEIGHT = 27, WIDTH = 90, CAPTION = "Get Frame", ENABLED = .F.
ADD OBJECT CMDPREVIEW AS COMMANDBUTTON WITH DEFAULT = .T., LEFT = 106, TOP = 264, HEIGHT = 27, WIDTH = 100, CAPTION = "Preview Video", ENABLED = .F.
ADD OBJECT CMDCLOSE AS COMMANDBUTTON WITH CANCEL = .T., LEFT = 250, TOP = 264, HEIGHT = 27, WIDTH = 70, CAPTION = "Close"
**
PROCEDURE Activate
IF THIS.HWINDOW=0
DECLARE INTEGER GetFocus IN user32
THIS.HWINDOW = GETFOCUS()
THIS.CREATECAPTUREWINDOW
THIS.DRIVERCONNECT
ENDIF
ENDPROC
**
PROCEDURE Destroy
THIS.RELEASECAPTUREWINDOW
ENDPROC
**
PROCEDURE cmdClose.Click
THISFORM.RELEASE
ENDPROC
**
PROCEDURE cmdGetFrame.Click
THISFORM.GETFRAME
ENDPROC
**
PROCEDURE cmdPreview.Click
THISFORM.STARTPREVIEW
ENDPROC
**
PROCEDURE GetFrame
THIS.MSG(001084, 0, 0)
ENDPROC
**
PROCEDURE CreateCaptureWindow
DECLARE INTEGER capCreateCaptureWindow IN avicap32 STRING, LONG, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER
THIS.HCAPTURE = CAPCREATECAPTUREWINDOW("", 1342177280, 10, 8, 320, 240, THIS.HWINDOW, 1)
ENDPROC
**
PROCEDURE DriverConnect
THIS.MSG(001034, 0, 0)
IF THIS.ISCAPTURECONNECTED()
THIS.GETCAPTUREDIMENSIONS
STORE .T. TO THIS.CMDGETFRAME.ENABLED, THIS.CMDPREVIEW.ENABLED
THIS.CAPTION = THIS.CAPTION+": connected, "+LTRIM(STR(THIS.CAPWIDTH))+"x"+LTRIM(STR(THIS.CAPHEIGHT))
ELSE
THIS.CAPTION = THIS.CAPTION+": failed to connect"
ENDIF
ENDPROC
**
PROCEDURE DriverDisconnect
THIS.MSG(001035, 0, 0)
ENDPROC
**
PROCEDURE ReleaseCaptureWindow
IF THIS.HCAPTURE<>0
THIS.DRIVERDISCONNECT
DECLARE INTEGER DestroyWindow IN user32 INTEGER
= DESTROYWINDOW(THIS.HCAPTURE)
THIS.HCAPTURE = 0
ENDIF
ENDPROC
**
PROCEDURE msg
LPARAMETERS MSG, WPARAM, LPARAM, NMODE
IF THIS.HCAPTURE=0
RETURN
ENDIF
IF VARTYPE(NMODE)<>"N" .OR. NMODE=0
DECLARE INTEGER SendMessage IN user32 INTEGER, INTEGER, INTEGER, INTEGER
= SENDMESSAGE(THIS.HCAPTURE, MSG, WPARAM, LPARAM)
ELSE
DECLARE INTEGER SendMessage IN user32 INTEGER, INTEGER, INTEGER, STRING @
= SENDMESSAGE(THIS.HCAPTURE, MSG, WPARAM, @LPARAM)
ENDIF
ENDPROC
**
FUNCTION IsCaptureConnected
LOCAL CBUFFER, NRESULT
CBUFFER = REPLICATE(CHR(0), 44)
THIS.MSG(001038, LEN(CBUFFER), @CBUFFER, 1)
THIS.CAPOVERLAY = BUF2DWORD(SUBSTR(CBUFFER, 5, 4))
NRESULT = ASC(SUBSTR(CBUFFER, 21, 1))
RETURN (NRESULT<>0)
ENDFUNC
**
PROCEDURE GetCaptureDimensions
LOCAL CBUFFER
CBUFFER = REPLICATE(CHR(0), 76)
THIS.MSG(001078, LEN(CBUFFER), @CBUFFER, 1)
THIS.CAPWIDTH = BUF2DWORD(SUBSTR(CBUFFER, 1, 4))
THIS.CAPHEIGHT = BUF2DWORD(SUBSTR(CBUFFER, 5, 4))
ENDPROC
**
PROCEDURE StartPreview
THIS.MSG(001076, 30, 0)
THIS.MSG(001074, 1, 0)
IF THIS.CAPOVERLAY<>0
THIS.MSG(001075, 1, 0)
ENDIF
ENDPROC
**
PROCEDURE StopPreview
THIS.MSG(001074, 0, 0)
ENDPROC
**
ENDDEFINE
**
FUNCTION buf2dword
LPARAMETERS LCBUFFER
RETURN ASC(SUBSTR(LCBUFFER, 1, 1))+BITLSHIFT(ASC(SUBSTR(LCBUFFER, 2, 1)), 8)+BITLSHIFT(ASC(SUBSTR(LCBUFFER, 3, 1)), 16)+BITLSHIFT(ASC(SUBSTR(LCBUFFER, 4, 1)), 24)
ENDFUNC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** simpanan_lainnya_smsgateway.scx
***
*
*
*  simpanan_lainnya_smsgateway.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK
THISFORM.IDDATA = MNOREK
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.TEXT2.VALUE = PHONE
THISFORM.CHECK1.VALUE = SMS_STOR
THISFORM.CHECK2.VALUE = SMS_AMBIL
ENDPROC
**
*
*  simpanan_lainnya_smsgateway.scx::Command1
**
PROCEDURE Click
CSQL = "update simpanan set sms_stor='"+ALLTRIM(STR(THISFORM.CHECK1.VALUE))+"', sms_ambil='"+ALLTRIM(STR(THISFORM.CHECK2.VALUE))+"' where norek='"+THISFORM.IDDATA+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_lainnya_smsgateway.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_lainnya_smsgateway.sct
***
*
***
*** simpanan_tutuprekening.scx
***
*
*
*  simpanan_tutuprekening.scx::FORM1
**
PROCEDURE Init
THISFORM.OLDSELECT = SELECT()
THISFORM.TEXT5.VALUE = TGLNOW
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = SALDO
THISFORM.TEXT6.VALUE = URUTBUKTI("NONKAS")
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_tutuprekening.scx::Command1
**
PROCEDURE Click
IF EMPTY(THISFORM.TEXT6.VALUE) .OR. EMPTY(THISFORM.TEXT5.VALUE)
MESSAGEBOX("Tanggal dan Bukti tidak boleh kosong")
THISFORM.TEXT5.SETFOCUS
NODEFAULT
ENDIF
CSQL = "select tanggal from jurnal where tanggal=?thisform.text5.value and bukti=?thisform.text6.value"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal Baca Jurnal")
ENDIF
IF RECCOUNT()>0
MESSAGEBOX("Bukti sudah pernah masuk di jurnal")
THISFORM.TEXT5.SETFOCUS
NODEFAULT
ENDIF
IF  .NOT. EMPTY(THISFORM.TEXT1.VALUE)
CSQL = "select a.norek,b.* from simpanan as a left join setsandi_tab as b on a.kantor=b.kantor and a.jenis=b.jenis and a.produk=b.sandi where a.norek='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX("Gagal baca ")
ENDIF
MADM = IIF(ISNULL(A_ADM), 0, A_ADM)
MRATE = IIF(ISNULL(A_RATE), 0, A_RATE)
MSLDMIN = IIF(ISNULL(SALDOMINIMAL), 0, SALDOMINIMAL)
MJURTAB = IIF(ISNULL(JURNALTAB), '', JURNALTAB)
MJURADMTUTUP = IIF(ISNULL(JURNALADMTUTUP), '', JURNALADMTUTUP)
CSQL = "select saldo from simpanan_mutasi where norek='"+THISFORM.TEXT1.VALUE+"' and iddata=(select MAX(iddata) from simpanan_mutasi where norek='"+THISFORM.TEXT1.VALUE+"' and tanggal<='"+SQLDATE(THISFORM.TEXT5.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("gagal baca saldo")
RETURN
ENDIF
MSALDO = SALDO
CSQL = "insert into simpanan_mutasi (kantor,norek,tanggal,bukti,kode,keterangan,debet,kredit,saldo,opt) value "+"('"+DEFAKANTOR+"',"+"'"+THISFORM.TEXT1.VALUE+"',"+"'"+SQLDATE(THISFORM.TEXT5.VALUE)+"',"+"'"+THISFORM.TEXT6.VALUE+"',"+"'"+DEFATABADM+"',"+"'"+"TUTUP REKENING"+"',"+"'"+STR(MSALDO)+"',"+"'"+STR(0)+"',"+"'"+TRANSFORM(0, '999999999999999')+"',"+"'"+DEFAUSERID+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal simpan data mutasi")
RETURN
ENDIF
CSQL = "update simpanan set tgltutup=?thisform.text5.value where norek=?thisform.text1.value"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update tutup rekening")
ENDIF
CSQL = "insert into jurnal (kantor,tanggal,bukti,noper,keterangan,jumlah) value "
IF MSALDO<>0
CSQL = CSQL+"('"+DEFAKANTOR+"',"+"'"+SQLDATE(THISFORM.TEXT5.VALUE)+"',"+"'"+THISFORM.TEXT6.VALUE+"',"+"'"+MJURTAB+"',"+"'"+"TUTUP REK "+ALLTRIM(THISFORM.TEXT1.VALUE)+"',"+"'"+STR(MSALDO)+"'),"
CSQL = CSQL+"('"+IIF(EMPTY(DEFAKANTORASAL), DEFAKANTOR, DEFAKANTORASAL)+"',"+"'"+SQLDATE(THISFORM.TEXT5.VALUE)+"',"+"'"+THISFORM.TEXT6.VALUE+"',"+"'"+MJURADMTUTUP+"',"+"'"+"TUTUP REK "+ALLTRIM(THISFORM.TEXT1.VALUE)+"',"+"'"+STR(0-MSALDO)+"'),"
CSQL = LEFT(CSQL, LEN(CSQL)-1)
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Simpan Jurnal")
ENDIF
HITNERACA(DEFAKANTOR, MNOPERKAS, THISFORM.TEXT7.VALUE)
HITNERACA(DEFAKANTORASAL, MJURNALTAB, THISFORM.TEXT7.VALUE)
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_tutuprekening.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_tutuprekening.sct
***
*
***
*** anggota_pindah.scx
***
*
*
*  anggota_pindah.scx::FORM1
**
PROCEDURE baca1
CSQL = "select * from anggota_relasi where cif=?thisform.text1.value"
LCEK = SQLEXEC(OODBC, CSQL, "KIRI")
WITH THISFORM.GRID1
.RECORDSOURCE = "KIRI"
.COLUMNCOUNT = 1
THISFORM.GRID1.SCROLLBARS = 2
THISFORM.GRID1.GRIDLINECOLOR = RGB(243, 243, 243)
.COLUMN1.WIDTH = 200
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = ""
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
ENDWITH
THISFORM.GRID1.SETFOCUS
THISFORM.NOREK1 = NOREK
ENDPROC
**
PROCEDURE baca2
CSQL = "select * from anggota_relasi where cif=?thisform.text7.value"
LCEK = SQLEXEC(OODBC, CSQL, "KANAN")
WITH THISFORM.GRID2
.RECORDSOURCE = "KANAN"
.COLUMNCOUNT = 1
THISFORM.GRID2.SCROLLBARS = 2
THISFORM.GRID2.GRIDLINECOLOR = RGB(243, 243, 243)
.COLUMN1.WIDTH = 200
.COLUMN1.CONTROLSOURCE = "NOREK"
.COLUMN1.HEADER1.CAPTION = ""
.COLUMN1.HEADER1.FONTBOLD = .T.
.COLUMN1.HEADER1.FONTSIZE = 9
ENDWITH
THISFORM.GRID2.SETFOCUS
THISFORM.NOREK2 = NOREK
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MCIF
THISFORM.OLDSELECT = SELECT()
MDATA = SYS(2015)
CSQL = "select * from anggota where cif=?mcif"
LCEK = SQLEXEC(OODBC, CSQL, MDATA)
THISFORM.BORDERSTYLE = 1
THISFORM.TEXT1.VALUE = CIF
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
USE
THISFORM.BACA1()
THISFORM.BACA2()
ENDPROC
**
PROCEDURE Unload
SELECT KIRI
USE
SELECT KANAN
USE
SELECT (THISFORM.OLDSELECT)
ENDPROC
**
*
*  anggota_pindah.scx::Text4
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
MNOREK = TRIM(THIS.VALUE)
CSQL = "select * from anggota_relasi where norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF NOREK=MNOREK
THISFORM.TEXT7.VALUE = CIF
THISFORM.TEXT7.SETFOCUS
KEYBOARD '{ENTER}'
ENDIF
ENDFUNC
**
*
*  anggota_pindah.scx::Text5
**
PROCEDURE Click
DO FORM anggota TO MCIF WITH "CARI"
THISFORM.TEXT4.VALUE = MCIF
ENDPROC
**
*
*  anggota_pindah.scx::Command1
**
PROCEDURE Click
MCIF = THISFORM.TEXT1.VALUE
MNOREK = THISFORM.NOREK1
CSQL = "update anggota_relasi set cif='"+ALLTRIM(THISFORM.TEXT7.VALUE)+"' where cif='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman set cif='"+ALLTRIM(THISFORM.TEXT7.VALUE)+"' where cif='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan set cif='"+ALLTRIM(THISFORM.TEXT7.VALUE)+"' where cif='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BACA1()
THISFORM.BACA2()
ENDPROC
**
*
*  anggota_pindah.scx::Command2
**
PROCEDURE Click
MCIF = THISFORM.TEXT7.VALUE
MNOREK = THISFORM.NOREK2
CSQL = "update anggota_relasi set cif='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where cif='"+ALLTRIM(THISFORM.TEXT7.VALUE)+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update pinjaman set cif='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where cif='"+ALLTRIM(THISFORM.TEXT7.VALUE)+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
CSQL = "update simpanan set cif='"+ALLTRIM(THISFORM.TEXT1.VALUE)+"' where cif='"+ALLTRIM(THISFORM.TEXT7.VALUE)+"' and norek='"+MNOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.BACA1()
THISFORM.BACA2()
ENDPROC
**
*
*  anggota_pindah.scx::Command3
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_pindah.scx::Grid1
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.NOREK1 = NOREK
ENDPROC
**
*
*  anggota_pindah.scx::Grid2
**
PROCEDURE AfterRowColChange
LPARAMETERS NCOLINDEX
THISFORM.NOREK2 = NOREK
ENDPROC
**
*
*  anggota_pindah.scx::Text7
**
FUNCTION LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN .T.
ENDIF
IF EMPTY(THIS.VALUE)
DO FORM anggota TO MCIF WITH "CARI"
THIS.VALUE = MCIF
ENDIF
MCIF = TRIM(THIS.VALUE)
CSQL = "select * from anggota where cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF CIF<>MCIF
NODEFAULT
THIS.SETFOCUS
RETURN
ENDIF
THISFORM.TEXT5.VALUE = NAMA
THISFORM.TEXT6.VALUE = ALAMAT
THISFORM.BACA2()
ENDFUNC
**
***
*** anggota_pindah.sct
***
*
***
*** krd_npl_ao.frx
***
*
***
*** krd_npl_ao.frt
***
*
***
*** krd_npl_produk.frx
***
*
***
*** krd_npl_produk.frt
***
*
***
*** krd_npl_sektor.frx
***
*
***
*** krd_npl_sektor.frt
***
*
***
*** krd_npl_wil.frx
***
*
***
*** krd_npl_wil.frt
***
*
***
*** cek_transaksi.scx
***
*
*
*  cek_transaksi.scx::FORM1
**
PROCEDURE proses_cek
MTGLPROSES = TGLNOW
CSQL = "select noper,saldo from perkiraan where LEFT(kel,1)='N' order by kel,noper"
LCEK = SQLEXEC(OODBC, CSQL, "AA")
MSLD = 0
GOTO TOP
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
CSQL = "select saldo from neraca where noper='"+MNOPER+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MNOPER+"' and tanggal<='"+SQLDATE(TGLNOW)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "aa1")
MSLD = MSLD+SALDO
USE
SELECT AA
SKIP
ENDDO
IF MSLD<>0
MBEDA = .F.
DO WHILE .T.
THISFORM.CONTAINER1.LABEL1.CAPTION = "Neraca Tgl "+DTOC(MTGLPROSES)
SELECT AA
GOTO TOP
MSLD = 0
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
CSQL = "select saldo from neraca where noper='"+MNOPER+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MNOPER+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "aa1")
MSLD = MSLD+SALDO
USE
SELECT AA
SKIP
ENDDO
IF MSLD=0
MBEDA = .T.
ENDIF
IF MBEDA=.T.
MTGLPROSES = MTGLPROSES+1
EXIT
ENDIF
MTGLPROSES = MTGLPROSES-1
ENDDO
THISFORM.EDIT1.VALUE = "Neraca ..........."+DTOC(MTGLPROSES)+CHR(13)
ENDIF
MTGLPROSES = TGLNOW
MBEDA = .F.
DO WHILE .T.
THISFORM.CONTAINER1.LABEL1.CAPTION = "Tab : Akt Tgl "+DTOC(MTGLPROSES)
CSQL = "select jurnaltab from setsandi_tab where kantor='"+DEFAKANTOR+"'  and jenis='1' group by jurnaltab"
LCEK = SQLEXEC(OODBC, CSQL, "snd")
DO WHILE  .NOT. EOF()
MJURNAL = ALLTRIM(JURNALTAB)
CSQL = "select saldo from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MJURNAL+"' and tanggal=(select MAX(tanggal) from neraca where kantor='"+DEFAKANTOR+"' and noper='"+MJURNAL+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "nrc")
MSALDO = IIF(ISNULL(SALDO), 0, 0-SALDO)
CSQL = "select sandi from setsandi_tab where jenis='1' and jurnaltab='"+MJURNAL+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
MTEXT = ""
DO WHILE  .NOT. EOF()
MTEXT = MTEXT+" produk='"+ALLTRIM(SANDI)+"' or "
SKIP
ENDDO
MTEXT = "("+LEFT(MTEXT, LEN(MTEXT)-4)+")"
CSQL = "select norek,pokok,produk from simpanan where kantor='"+ALLTRIM(DEFAKANTOR)+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"' and jenis='1' and (tgltutup='0000-00-00' or tgltutup>'"+SQLDATE(MTGLPROSES)+"') and "+MTEXT
LCEK = SQLEXEC(OODBC, CSQL, "hit")
MNOMI = 0
MJUMREC = RECCOUNT()
MREC = 0
THISFORM.CONTAINER1.SHAPE1.WIDTH = 0
GOTO TOP
DO WHILE  .NOT. EOF()
MREC = MREC+1
THISFORM.CONTAINER1.SHAPE1.WIDTH = (MREC/MJUMREC)*360
MNOREK = NOREK
MPOKOK = IIF(ISNULL(POKOK), 0, POKOK)
MJENIS = ALLTRIM(PRODUK)
CSQL = "select saldo from simpanan_mutasi where iddata=(select MAX(iddata) from simpanan_mutasi "+"where norek='"+MNOREK+"' and tanggal<='"+SQLDATE(MTGLPROSES)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "tab")
MNOMI = MNOMI+SALDO
SELECT HIT
SKIP
ENDDO
SELECT SND
SKIP
ENDDO
IF MNOMI=MSALDO
EXIT
ELSE
MBEDA = .T.
ENDIF
MTGLPROSES = MTGLPROSES-1
ENDDO
MTGLPROSES = MTGLPROSES+1
IF MBEDA=.T.
THISFORM.EDIT1.VALUE = "Simpanan >< Akuntansi ..........."+DTOC(MTGLPROSES)+CHR(13)
SELECT SND
GOTO TOP
DO WHILE  .NOT. EOF()
CSQL = "select * from jurnal where noper='"+ALLTRIM(JURNALTAB)+"' and tanggal='"+SQLDATE(MTGLPROSES)+"' and keterangan not like 'JASA%'"
LCEK = SQLEXEC(OODBC, CSQL, "cek1")
MJUMREC = RECCOUNT()
MREC = 0
THISFORM.CONTAINER1.SHAPE1.WIDTH = 0
DO WHILE  .NOT. EOF()
MREC = MREC+1
THISFORM.CONTAINER1.SHAPE1.WIDTH = (MREC/MJUMREC)*360
MTANGGAL = TANGGAL
MBUKTI = BUKTI
MDEBET = IIF(JUMLAH>0, JUMLAH, 0)
MKREDIT = IIF(JUMLAH>0, 0, JUMLAH)
CSQL = "select * from simpanan_mutasi where tanggal='"+SQLDATE(MTANGGAL)+"' and bukti='"+MBUKTI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek2")
IF RECCOUNT()=1 .AND. MDEBET=DEBET .AND. MKREDIT=KREDIT
ELSE
THISFORM.EDIT1.VALUE = THISFORM.EDIT1.VALUE+"  No.Bukti: "+MBUKTI+" ->"
IF RECCOUNT()=0
MKET = " Tidak terdapat di mutasi tabungan"
ENDIF
IF RECCOUNT()>1
MKET = " terdapat di mutasi lebih dari 1 transaksi"
ENDIF
IF MDEBET<>DEBET
MKET = " Jumlah Mutasi Debet tidak sama"
ENDIF
IF MKREDIT<>KREDIT
MKET = " Jumlah Mutasi Kredit tidak sama"
ENDIF
THISFORM.EDIT1.VALUE = THISFORM.EDIT1.VALUE+MKET+CHR(13)
ENDIF
SELECT CEK1
SKIP
ENDDO
SELECT SND
SKIP
ENDDO
ENDIF
ENDPROC
**
PROCEDURE tampil
THISFORM.HEIGHT = 230
THISFORM.SHAPE1.VISIBLE = .T.
THISFORM.EDIT1.VISIBLE = .T.
THISFORM.LABEL1.VISIBLE = .T.
THISFORM.CONTAINER1.VISIBLE = .F.
ENDPROC
**
PROCEDURE Activate
THISFORM.PROSES_CEK()
THISFORM.TAMPIL()
ENDPROC
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.TOP = 20
THISFORM.LEFT = _SCREEN.WIDTH-THISFORM.WIDTH-20
THISFORM.CONTAINER1.SHAPE1.WIDTH = 0
ENDPROC
**
***
*** cek_transaksi.sct
***
*
***
*** pinjaman_angsuran_data.scx
***
*
*
*  pinjaman_angsuran_data.scx::FORM1
**
PROCEDURE Init
PARAMETER MMODE, MNOREK
THISFORM.MODE = MMODE
THISFORM.TEXT1.VALUE = MNOREK
MNOREK = NOREK
THISFORM.DBF = SELECT()
THISFORM.BORDERSTYLE = 2
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
IF MMODE="EDIT"
THISFORM.TEXT1.VALUE = MNOREK
THISFORM.TEXT2.VALUE = TANGGAL
THISFORM.TEXT3.VALUE = BUKTI
THISFORM.TEXT4.VALUE = KODE
THISFORM.TEXT5.VALUE = POKOK
THISFORM.TEXT6.VALUE = JASA
THISFORM.TEXT7.VALUE = DENDA
THISFORM.TEXT8.VALUE = OPT
ELSE
THISFORM.TEXT2.VALUE = TGLNOW
THISFORM.TEXT8.VALUE = DEFAUSERID
ENDIF
THISFORM.TEXT2.ENABLED = .T.
THISFORM.TEXT3.ENABLED = .T.
THISFORM.TEXT4.ENABLED = .T.
THISFORM.TEXT5.ENABLED = .T.
THISFORM.TEXT6.ENABLED = .T.
THISFORM.TEXT7.ENABLED = .T.
THISFORM.COMMAND2.VISIBLE = .T.
THISFORM.COMMAND3.VISIBLE = .T.
THISFORM.COMMAND4.VISIBLE = .F.
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  pinjaman_angsuran_data.scx::Command2
**
PROCEDURE Click
THISFORM.TEXT7.ENABLED = .F.
THISFORM.TEXT8.ENABLED = .F.
THISFORM.COMBO1.ENABLED = .F.
THISFORM.TEXT16.ENABLED = .F.
THISFORM.TEXT10.ENABLED = .F.
THISFORM.COMMAND1.VISIBLE = .T.
THIS.VISIBLE = .F.
THISFORM.COMMAND3.VISIBLE = .F.
THISFORM.COMMAND4.VISIBLE = .T.
ENDPROC
**
*
*  pinjaman_angsuran_data.scx::Command3
**
PROCEDURE Click
SELECT (THISFORM.DBF)
IF THISFORM.MODE="EDIT"
CSQL = "update pinjaman_mutasi set "+"tanggal='"+SQLDATE(THISFORM.TEXT2.VALUE)+"', "+"bukti='"+THISFORM.TEXT3.VALUE+"', "+"kode='"+THISFORM.TEXT4.VALUE+"', "+"pokok='"+STR(THISFORM.TEXT5.VALUE)+"', "+"jasa='"+STR(THISFORM.TEXT6.VALUE)+"', "+"denda='"+STR(THISFORM.TEXT7.VALUE)+"' "+"where iddata='"+STR(IDDATA)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
IF THISFORM.MODE="INPUT"
CSQL = "insert into pinjaman_mutasi (kantor,norek,tanggal,tglmutasi,"+"bukti,kode,pokok,jasa,denda,opt) value  "+"('"+DEFAKANTOR+"','"+THISFORM.TEXT1.VALUE+"','"+SQLDATE(THISFORM.TEXT2.VALUE)+"', '"+SQLDATE(THISFORM.TEXT2.VALUE)+"', "+"'"+THISFORM.TEXT3.VALUE+"', "+"'"+THISFORM.TEXT4.VALUE+"', "+"'"+STR(THISFORM.TEXT5.VALUE)+"', "+"'"+STR(THISFORM.TEXT6.VALUE)+"', "+"'"+STR(THISFORM.TEXT7.VALUE)+"',"+"'"+THISFORM.TEXT8.VALUE+"') "
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal input data")
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_angsuran_data.scx::Command4
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** pinjaman_angsuran_data.sct
***
*
***
*** form_resetproses.scx
***
*
*
*  form_resetproses.scx::FORM1
**
PROCEDURE Init
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.BORDERSTYLE = 1
ENDPROC
**
*
*  form_resetproses.scx::Command1
**
PROCEDURE Click
MTGL = THISFORM.TEXT1.VALUE
CSQL = "update log_proses set tglproses=?mtgl where tglproses>?mtgl"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
***
*** form_resetproses.sct
***
*
***
*** proses_tutupbuku.scx
***
*
*
*  proses_tutupbuku.scx::FORM1
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TGLNOW
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  proses_tutupbuku.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  proses_tutupbuku.scx::Command2
**
PROCEDURE Click
MTGL = THISFORM.TEXT1.VALUE
IF  .NOT. (MONTH(MTGL)=12 .AND. DAY(MTGL)=31)
MESSAGEBOX("Proses tutup buku hanya dapat dilakukan di akhir tahun"+CHR(13)+"Cek lagi tanggal prosesnya", 16, "")
RETURN
NODEFAULT
ENDIF
CSQL = "select * from neraca where  kantor='"+ALLTRIM(DEFAKANTOR)+"' and tanggal='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and tb='Y'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF RECCOUNT()>0
MESSAGEBOX("Sudah Dilakukan proses tutup buku")
RETURN
NODEFAULT
ENDIF
CSQL = "select * from perkiraan  order by noper"
LCEK = SQLEXEC(OODBC, CSQL, "daftper")
GOTO TOP
A = 0
DO WHILE  .NOT. EOF()
MNOPER = ALLTRIM(NOPER)
MKEL = ALLTRIM(KEL)
CSQL = "select saldo from neraca where noper='"+MNOPER+"' and tanggal="+"(select MAX(tanggal) from neraca where noper='"+MNOPER+"' and tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "hit")
MSALDO = SALDO
MDEBET = IIF(MSALDO<0, 0-MSALDO, 0)
MKREDIT = IIF(MSALDO<0, 0, 0-MSALDO)
IF (MKEL='NA' .OR. MKEL='NP' .OR. MKEL='AD')
DO CASE
CASE MNOPER=ALLTRIM(DEFANOPERPHULALU)
CSQL = "select saldo from neraca where noper='"+ALLTRIM(DEFANOPERPHUNOW)+"' and tb<>'Y' and tanggal="+"(select MAX(tanggal) from neraca where noper='"+ALLTRIM(DEFANOPERPHUNOW)+"' and tanggal<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "smt1")
MSALDOLABA = SALDO
USE
MDEBET = IIF(MSALDOLABA<0, 0-MSALDOLABA, 0)
MKREDIT = IIF(MSALDOLABA<0, 0, 0-MSALDOLABA)
CSQL = "insert into neraca (kantor,noper,tanggal,saldoawal,debet,kredit,saldo,tb) value "+"('"+ALLTRIM(DEFAKANTOR)+"','"+MNOPER+"','"+SQLDATE(THISFORM.TEXT1.VALUE)+"','"+TRANSFORM(MSALDO, '999999999999999')+"','"+TRANSFORM(MSALDO+MDEBET, '999999999999999')+"','"+TRANSFORM(MSALDO+MKREDIT, '999999999999999')+"','"+TRANSFORM(MSALDO+MSALDOLABA, '999999999999999')+"','Y')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal simpan laba rugi tahun lalu")
ENDIF
CASE MNOPER=ALLTRIM(DEFANOPERPHUNOW)
CSQL = "insert into neraca (kantor,noper,tanggal,saldoawal,debet,kredit,saldo,tb) value "+"('"+ALLTRIM(DEFAKANTOR)+"','"+MNOPER+"','"+SQLDATE(THISFORM.TEXT1.VALUE)+"','"+TRANSFORM(MSALDO, '999999999999999')+"','"+TRANSFORM(MDEBET, '999999999999999')+"','"+TRANSFORM(MKREDIT, '999999999999999')+"','0','Y')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal simpan laba rugi berjalan")
ENDIF
OTHERWISE
ENDCASE
ELSE
CSQL = "insert into neraca (kantor,noper,tanggal,saldoawal,debet,kredit,saldo,tb) value "+"('"+ALLTRIM(DEFAKANTOR)+"','"+MNOPER+"','"+SQLDATE(THISFORM.TEXT1.VALUE)+"','"+TRANSFORM(MSALDO, '999999999999999')+"','"+TRANSFORM(MDEBET, '999999999999999')+"','"+TRANSFORM(MKREDIT, '999999999999999')+"','0','Y')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("gagal simpan mutasi tutup buku")
ENDIF
ENDIF
SELECT DAFTPER
SKIP
ENDDO
MESSAGEBOX("Proses tutup Buku sudah selesai", 64, "")
THISFORM.RELEASE
ENDPROC
**
***
*** proses_tutupbuku.sct
***
*
***
*** proses_bataltutup.scx
***
*
*
*  proses_bataltutup.scx::Form1
**
PROCEDURE Init
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = TGLNOW
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  proses_bataltutup.scx::Command1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  proses_bataltutup.scx::Command2
**
PROCEDURE Click
CSQL = "delete from neraca where kantor='"+DEFAKANTOR+"' and tanggal='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and tb='Y'"
LCEK = SQLEXEC(OODBC, CSQL)
MESSAGEBOX("Proses Batal Tutup buku sudah selesai")
THISFORM.RELEASE
ENDPROC
**
***
*** proses_bataltutup.sct
***
*
***
*** form_autolunas.scx
***
*
*
*  form_autolunas.scx::FORM1
**
PROCEDURE Init
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.BORDERSTYLE = 1
ENDPROC
**
*
*  form_autolunas.scx::Command1
**
PROCEDURE Click
MTGL = THISFORM.TEXT1.VALUE
CSQL = "select * from pinjaman where tgllunas='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO WHILE  .NOT. EOF()
MNOREK = NOREK
MPOKOK = POKOK
CSQL = "select MAX(tanggal) as tglbyr,SUM(pokok) as angpk from pinjaman_mutasi where norek=?mnorek group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "ANGS")
MANGPK = ANGPK
MTGLLUNAS = TGLBYR
SELECT SMT
IF MPOKOK<=MANGPK
CSQL = "update pinjaman set tgllunas=?mtgllunas where norek=?mnorek"
LCEK = SQLEXEC(OODBC, CSQL)
ENDIF
SKIP
ENDDO
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
***
*** form_autolunas.sct
***
*
***
*** a5.scx
***
*
*
*  a5.scx::FORM1
**
PROCEDURE Init
THISFORM.COMBO1.ADDITEM("aaaaa", 1)
THISFORM.COMBO1.ADDITEM("2,bbbbbb", 1)
THISFORM.COMBO1.ADDITEM("3,ccc", 2)
ENDPROC
**
***
*** a5.sct
***
*
***
*** a1.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
PUBLIC OFRMLISTEXAMPLES
OFRMLISTEXAMPLES = NEWOBJECT("frmListExamples")
OFRMLISTEXAMPLES.SHOW
RETURN
ENDPROC
**
DEFINE CLASS frmListExamples AS form
DATASESSION = 2
TOP = 0
LEFT = 0
HEIGHT = 262
WIDTH = 325
CAPTION = "List and ListItem Array Example"
NAME = "frmListExamples"
ADD OBJECT SHAPE1 AS SHAPE WITH TOP = 43, LEFT = 32, HEIGHT = 76, WIDTH = 261, SPECIALEFFECT = 0, NAME = "Shape1"
ADD OBJECT CBOLISTBAD AS COMBOBOX WITH COLUMNCOUNT = 3, COLUMNWIDTHS = "100,100,50", HEIGHT = 22, LEFT = 111, SORTED = .T., STYLE = 2, TABINDEX = 1, TOP = 53, WIDTH = 147, NAME = "cboListBad"
ADD OBJECT CBOLISTITEM AS COMBOBOX WITH COLUMNCOUNT = 3, COLUMNWIDTHS = "100,100,50", LEFT = 34, SORTED = .T., STYLE = 2, TABINDEX = 3, TOP = 154, NAME = "cboListItem"
ADD OBJECT LABEL1 AS LABEL WITH FONTBOLD = .T., CAPTION = "Using the List Array:", HEIGHT = 17, LEFT = 34, TOP = 24, WIDTH = 176, TABINDEX = 7, NAME = "Label1"
ADD OBJECT LABEL2 AS LABEL WITH FONTBOLD = .T., CAPTION = "Using the ListItem Array:", HEIGHT = 17, LEFT = 34, TOP = 135, WIDTH = 173, TABINDEX = 8, NAME = "Label2"
ADD OBJECT CBOLISTGOOD AS COMBOBOX WITH COLUMNCOUNT = 3, COLUMNWIDTHS = "100,100,50", HEIGHT = 22, LEFT = 111, SORTED = .T., STYLE = 2, TABINDEX = 2, TOP = 86, WIDTH = 147, NAME = "cboListGood"
ADD OBJECT LABEL3 AS LABEL WITH ALIGNMENT = 1, CAPTION = "Wrong!", HEIGHT = 17, LEFT = 51, TOP = 56, WIDTH = 47, TABINDEX = 9, NAME = "Label3"
ADD OBJECT LABEL4 AS LABEL WITH ALIGNMENT = 1, CAPTION = "Right!", HEIGHT = 17, LEFT = 58, TOP = 89, WIDTH = 40, TABINDEX = 10, NAME = "Label4"
**
PROCEDURE cbolistbad.Init
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE cbolistgood.Init
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
PROCEDURE cbolistitem.Init
WITH THIS
.ADDLISTITEM('Cleveland')
.ADDLISTITEM('Ohio', .NEWITEMID, 2)
.ADDLISTITEM('44122', .NEWITEMID, 3)
.ADDLISTITEM('Caversham')
.ADDLISTITEM('England', .NEWITEMID, 2)
.ADDLISTITEM('RG4 8BX', .NEWITEMID, 3)
.ADDLISTITEM('Buffalo')
.ADDLISTITEM('New York', .NEWITEMID, 2)
.ADDLISTITEM('14228', .NEWITEMID, 3)
.ADDLISTITEM('Milwaukee')
.ADDLISTITEM('Wisconsin', .NEWITEMID, 2)
.ADDLISTITEM('43225', .NEWITEMID, 3)
.ADDLISTITEM('International Falls')
.ADDLISTITEM('Minnesota', .NEWITEMID, 2)
.ADDLISTITEM('42666', .NEWITEMID, 3)
ENDWITH
ENDPROC
**
ENDDEFINE
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** form_autotutup.scx
***
*
*
*  form_autotutup.scx::FORM1
**
PROCEDURE Init
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.BORDERSTYLE = 1
ENDPROC
**
*
*  form_autotutup.scx::Command1
**
PROCEDURE Click
MTGL = THISFORM.TEXT1.VALUE
CSQL = "select * from simpanan where tgltutup='0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
DO WHILE  .NOT. EOF()
MNOREK = NOREK
CSQL = "select MAX(tanggal) as tglbyr,SUM(debet) as jumdebet, SUM(kredit) as jumkredit from simpanan_mutasi where norek=?mnorek group by norek"
LCEK = SQLEXEC(OODBC, CSQL, "MTS")
MJUMDEBET = IIF(ISNULL(JUMDEBET), 0, JUMDEBET)
MJUMKREDIT = IIF(ISNULL(JUMKREDIT), 0, JUMKREDIT)
IF RECCOUNT()=0
MSALDO = 0
ELSE
MSALDO = MJUMKREDIT-MJUMDEBET
ENDIF
MTGLLUNAS = IIF(ISNULL(TGLBYR) .OR. TGLBYR=CTOD('0000-00-00'), CTOD('31-12-2015'), TGLBYR)
SELECT SMT
IF MSALDO<=0
CSQL = "update simpanan set tgltutup=?mtgllunas where norek=?mnorek"
LCEK = SQLEXEC(OODBC, CSQL)
IF MNOREK='01.404.01406.1'
MESSAGEBOX(LCEK)
ENDIF
ENDIF
SKIP
ENDDO
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
***
*** form_autotutup.sct
***
*
***
*** a6.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
CSQL = "select a.*,b.* from simpanan as a left join simpanan_bilyet as b on a.norek=b.norek where a.jenis='2' and "+"tgltutup='0000-00-00' and tglawal<'2016-05-11' and tgljtempo>='2016-05-11' and ke="+"(select MAX(ke) from simpanan_bilyet where norek=a.norek group by norek)"
LCEK = SQLEXEC(OODBC, CSQL, "zz")
BROWSE
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** col_cek_simpanan.scx
***
*
*
*  col_cek_simpanan.scx::Command1
**
PROCEDURE Click
**
** ReFox - este procedimiento es vacío **
**
ENDPROC
**
*
*  col_cek_simpanan.scx::Text14
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE<>0
THIS.ADA = 1
ENDIF
ENDPROC
**
PROCEDURE Init
THIS.ADDPROPERTY("ada", 0)
ENDPROC
**
*
*  col_cek_simpanan.scx::text4
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT14.VALUE = BB
ENDPROC
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "SELECT * from setsandi_tab where jenis='1' and kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
***
*** col_cek_simpanan.sct
***
*
***
*** anggota_tutup.scx
***
*
*
*  anggota_tutup.scx::FORM1
**
FUNCTION Unload
RETURN THISFORM.NILAI
ENDFUNC
**
PROCEDURE Init
PARAMETER MCIF
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.CIF = MCIF
THISFORM.BORDERSTYLE = 2
THISFORM.MINBUTTON = .F.
THISFORM.MAXBUTTON = .F.
THISFORM.NILAI = ''
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  anggota_tutup.scx::Command1
**
PROCEDURE Click
CSQL = "update anggota set tglkeluar='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' where cif='"+ALLTRIM(THISFORM.CIF)+"'"
LCEK = SQLEXEC(OODBC, CSQL)
THISFORM.RELEASE
ENDPROC
**
*
*  anggota_tutup.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** anggota_tutup.sct
***
*
***
*** simpanan_batal_tutup.scx
***
*
*
*  simpanan_batal_tutup.scx::FORM1
**
PROCEDURE Init
THISFORM.OLDSELECT = SELECT()
THISFORM.TEXT5.VALUE = TGLNOW
THISFORM.BORDERSTYLE = 2
THISFORM.TEXT1.VALUE = NOREK
THISFORM.TEXT2.VALUE = NAMA
THISFORM.TEXT3.VALUE = ALAMAT
THISFORM.TEXT4.VALUE = SALDO
THISFORM.TEXT5.VALUE = TGLTUTUP
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  simpanan_batal_tutup.scx::Command1
**
PROCEDURE Click
CSQL = "update simpanan set tgltutup='0000-00-00' where norek=?thisform.text1.value"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update tutup rekening")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_batal_tutup.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** simpanan_batal_tutup.sct
***
*
***
*** pinj_lap.scx
***
*
*
*  pinj_lap.scx::FORM1
**
PROCEDURE bacasql
IF THISFORM.CHECK2.VALUE=0 .AND. THISFORM.CHECK3.VALUE=0 .AND. THISFORM.CHECK4.VALUE=0 .AND. THISFORM.CHECK5.VALUE=0 .AND. THISFORM.CHECK6.VALUE=0
MESSAGEBOX("Tidak ada data tercetak", 0, "")
RETURN
NODEFAULT
ENDIF
MSYARAT = ""
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT21.VALUE), "", "a.kantor='"+THISFORM.TEXT21.VALUE+"' and ")
DO CASE
CASE THISFORM.NOMORLAP=1
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "a.tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "a.tanggal<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and ")
CASE THISFORM.NOMORLAP=2
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT1.VALUE), "", "c.tanggal>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT2.VALUE), "", "c.tanggal<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and ")
ENDCASE
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT3.VALUE), "", "b.desa='"+ALLTRIM(THISFORM.TEXT3.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT4.VALUE), "", "b.kecamatan='"+ALLTRIM(THISFORM.TEXT4.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT5.VALUE), "", "b.kota='"+ALLTRIM(THISFORM.TEXT5.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT6.VALUE), "", "b.kelkerja='"+ALLTRIM(THISFORM.TEXT6.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT7.VALUE), "", "a.kdhit='"+ALLTRIM(THISFORM.TEXT7.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT8.VALUE), "", "a.marketing='"+ALLTRIM(THISFORM.TEXT8.VALUE)+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT11.VALUE), "", "a.kelompok='"+THISFORM.TEXT11.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT12.VALUE), "", "a.wilayah='"+THISFORM.TEXT12.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT13.VALUE), "", "a.penggunaan='"+THISFORM.TEXT13.VALUE+"' and ")
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT14.VALUE), "", "a.sektor='"+THISFORM.TEXT14.VALUE+"' and ")
MSYARATKOL = ""
IF THISFORM.CHECK2.VALUE+THISFORM.CHECK3.VALUE+THISFORM.CHECK4.VALUE+THISFORM.CHECK5.VALUE+THISFORM.CHECK6.VALUE<5
MSYARAT = MSYARAT+IIF(EMPTY(THISFORM.TEXT14.VALUE), "", "a.sektor='"+THISFORM.TEXT14.VALUE+"' and ")
IF THISFORM.CHECK2.VALUE=1 .AND. THISFORM.CHECK3.VALUE=1
MSYARATKOL = "kol='1' or "
ELSE
IF THISFORM.CHECK2.VALUE=1
MSYARATKOL = "(kol='1' and dpk='T') or "
ENDIF
IF THISFORM.CHECK3.VALUE=1
MSYARATKOL = "(kol='1' and dpk='Y') or "
ENDIF
ENDIF
IF THISFORM.CHECK4.VALUE=1
MSYARATKOL = MSYARATKOL+"kol='2' or "
ENDIF
IF THISFORM.CHECK5.VALUE=1
MSYARATKOL = MSYARATKOL+"kol='3' or "
ENDIF
IF THISFORM.CHECK6.VALUE=1
MSYARATKOL = MSYARATKOL+"kol='4' or "
ENDIF
MSYARATKOL = LEFT(MSYARATKOL, LEN(MSYARATKOL)-4)
MSYARATKOL = "("+MSYARATKOL+") and "
ENDIF
MSYARAT = MSYARAT
IF EMPTY(MSYARAT)
MSYARAT = '1'
ELSE
MSYARAT = LEFT(MSYARAT, LEN(MSYARAT)-5)
ENDIF
DO CASE
CASE THISFORM.NOMORLAP=1
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT1.VALUE)+" s/d. "+DTOC(THISFORM.TEXT2.VALUE)
CSQL = "select a.*,b.nama,b.alamat from pinjaman as a left join anggota as b on a.cif=b.cif where  tglvaluta>'0000-00-00' and "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca Realisasi")
ENDIF
CASE THISFORM.NOMORLAP=2
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT1.VALUE)+" s/d. "+DTOC(THISFORM.TEXT2.VALUE)
CSQL = "select c.*,b.nama,b.alamat,a.kdhit,a.marketing,a.rate,a.lama,a.kelompok,a.penggunaan,a.wilayah,a.sektor from pinjaman_mutasi as c, pinjaman as a, anggota as b "+"where  c.norek=a.norek and a.cif=b.cif and c.kode<>'00' and c.pokok+c.jasa+c.denda+c.kredit>0 and "+MSYARAT+" order by tanggal"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Ggal baca angsuran")
RETURN
ENDIF
CASE THISFORM.NOMORLAP=3
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT1.VALUE)
MSYARAT2 = ''
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT9.VALUE), "", "rate='"+STR(THISFORM.TEXT9.VALUE)+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT10.VALUE), "", "lama='"+ALLTRIM(STR(THISFORM.TEXT10.VALUE))+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT11.VALUE), "", "kelompok='"+ALLTRIM((THISFORM.TEXT11.VALUE))+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT12.VALUE), "", "wilayah='"+ALLTRIM((THISFORM.TEXT12.VALUE))+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT13.VALUE), "", "penggunaan='"+ALLTRIM((THISFORM.TEXT13.VALUE))+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT14.VALUE), "", "ekonomi='"+ALLTRIM((THISFORM.TEXT14.VALUE))+"' and ")
MSYARAT2 = LEFT(MSYARAT2, LEN(MSYARAT2)-5)
IF MSYARAT='1'
MSYARAT = IIF(EMPTY(MSYARAT2), '1', MSYARAT2)
ELSE
MSYARAT = IIF(EMPTY(MSYARAT2), MSYARAT, MSYARAT+' and '+MSYARAT2)
ENDIF
THISFORM.BAR.WIDTH = 0
CREATE CURSOR KREDIT (KANTOR C (4), TANGGAL DATE, BUKTI C (10), NOREK C (25), NOPK C (25), KDHIT C (1), MARKETING C (5), CIF C (10), NAMA C (30), ALAMAT C (50), DESA C (50), KECAMATAN C (50), KOTA C (50), AGAMA C (50), PHONE C (30), POKOK N (15), RATE N (5, 2), JASA N (15), LAMA N (3), TGLMULAI DATE, TGLJTEMPO DATE, ADM N (10), PROVISI N (10), MATERAI N (10), NOTARIS N (10), KD_NOTARIS C (4), ASURANSI N (10), KD_ASURANSI C (4), LAINLAIN N (10), BIAYA N (10), JENIS C (4), KELOMPOK C (4), WILAYAH C (4), PENGGUNAAN C (4), SEKTOR C (4), SUMBER C (4), TGLLUNAS DATE, KOL C (1), PLAFON N (15), PKAWAL N (15), BGAWAL N (15), SISAPK N (15), SISABG N (15), HRSPK N (15), HRSBG N (15), SISAJDWPK N (15), SISAJDWBG N (15), KALIPK N (5, 1), KALIBG N (5, 1), JUMJDWPK N (3), JUMJDWBG N (3), ODPK N (15), ODBG N (15), TGLODPK DATE, TGLODBG DATE, WJBPK INT (15), WJBBG INT (15), JDWKE INT (3), ANGSKE INT (3), HARUSPKKE INT (3), HARUSBGKE INT (3), NJDWPK INT (15), NJDWBG INT (15), MTGLKHBYR DATE, BYRPK INT (15), BYRBG INT (15), DENDA INT (10), KALIBYRPK N (3), KALIBYRBG N (3), JAMINAN C (100), TAKSASI N (15), PPAP N (15), PPAP1 N (15), BGAKRUAL N (15), KONTIJENSI N (15), SLDADM N (15), SLDPROVISI N (15), SLDBIAYA N (15), DPK C (1))
CSQL = "select b.nama,b.alamat,b.desa,b.kecamatan,b.kota,b.agama,b.phone,a.* from pinjaman as a left join anggota as b on a.cif=b.cif where tglvaluta>'0000-00-00' AND tglvaluta<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and (tgllunas='0000-00-00' or tgllunas>'"+SQLDATE(THISFORM.TEXT1.VALUE)+"') and "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "DATAKRD")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MSYARATKOL = LEFT(MSYARATKOL, LEN(MSYARATKOL)-4)
REKNO = 1
JUMREC = RECCOUNT()
DO WHILE  .NOT. EOF()
SALDOKRD(NOREK, THISFORM.TEXT1.VALUE)
SELECT SALDOKRD
DPK = IIF(KOL='1' .AND. (ODPK>0 .OR. ODBG>0), 'Y', 'T')
MSYARATKOL = IIF(EMPTY(MSYARATKOL), '1=1', MSYARATKOL)
IF &MSYARATKOL 
SELECT KREDIT
APPEND BLANK
FOR A = 1 TO 034
MFIELD = FIELD(A)
MDATA = "DATAKRD."+MFIELD
MISI=&MDATA
MISI = IIF(ISNULL(MISI), "", MISI)
MISI = IIF(VARTYPE(MISI)='C', '"'+MISI+'"', MISI)
MISI = IIF(VARTYPE(MISI)='N', "val('"+ALLTRIM(STR(MISI))+"')", MISI)
MISI = IIF(VARTYPE(MISI)='D', "ctod('"+DTOC(MISI)+"')", MISI)
SELECT KREDIT
AA = "REPLACE "+MFIELD+" with "+MISI
&AA
ENDFOR
THISFORM.BAR.WIDTH = (REKNO/JUMREC)*400
SELECT SALDOKRD
FOR A = 2 TO 40
MFIELD = FIELD(A)
MDATA = "saldokrd."+MFIELD
MISI=&MDATA
MISI = IIF(VARTYPE(MISI)='C', "'"+MISI+"'", MISI)
MISI = IIF(VARTYPE(MISI)='N', "val('"+ALLTRIM(STR(MISI))+"')", MISI)
MISI = IIF(VARTYPE(MISI)='D', "ctod('"+DTOC(MISI)+"')", MISI)
SELECT KREDIT
AA = "REPLACE "+MFIELD+" with "+MISI
&AA
SELECT SALDOKRD
ENDFOR
SELECT KREDIT
REPLACE SLDADM WITH SALDOKRD.ADM
REPLACE SLDPROVISI WITH SALDOKRD.PROVISI
REPLACE SLDBIAYA WITH SALDOKRD.BIAYA
REPLACE DPK WITH IIF(SALDOKRD.KOL='1' .AND. (SALDOKRD.ODPK>0 .OR. SALDOKRD.ODBG>0), 'Y', 'T')
ENDIF
SELECT DATAKRD
REKNO = REKNO+1
SKIP
ENDDO
SELECT KREDIT
CASE THISFORM.NOMORLAP=4
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT1.VALUE)+" s/d. "+DTOC(THISFORM.TEXT2.VALUE)
CSQL = "select a.norek,a.marketing,a.kelompok,a.tgllunas,a.pokok,b.nama,b.alamat,c.pokok as nomi,c.kol from pinjaman as a left join anggota as b on a.cif=b.cif left join pinjaman_mutasi as c on a.norek=c.norek where a.tgllunas>='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' and tgllunas<='"+SQLDATE(THISFORM.TEXT2.VALUE)+"' and c.tanggal=(select MAX(tanggal) from pinjaman_mutasi where norek=a.norek and c.tanggal<'"+SQLDATE(THISFORM.TEXT2.VALUE)+"') and "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL)
CASE THISFORM.NOMORLAP=5
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT1.VALUE)
CREATE CURSOR NPL (KOL C (1), JUSER INT (6), KECAMATAN C (20), KDHIT C (1), MARKETING C (10), JW INT (2), KEL C (4), WIL C (4), JENIS C (4), PLAFON B (15), BAKI B (15))
CSQL = "select norek,pokok,kecamatan,kdhit,marketing,lama,kelompok,a.wilayah,penggunaan,sektor "+"from pinjaman as a left join anggota as b on a.cif=b.cif where "+"a.kantor='"+THISFORM.TEXT21.VALUE+"' and (tgllunas>'"+SQLDATE(THISFORM.TEXT1.VALUE)+"' or tgllunas='0000-00-00') and "+"(tglvaluta>'0000-00-00' AND tglvaluta<='"+SQLDATE(THISFORM.TEXT1.VALUE)+"')"
LCEK = SQLEXEC(OODBC, CSQL, "KRD")
IF LCEK<1
MESSAGEBOX(CSQL)
THISFORM.RELEASE
ENDIF
JUMREC = RECCOUNT()
REKNO = 0
DO WHILE  .NOT. EOF()
REKNO = REKNO+1
THISFORM.BAR.WIDTH = (REKNO/JUMREC)*400
MPLAFON = POKOK
MCUR = SALDOKRD(NOREK, THISFORM.TEXT1.VALUE)
SELECT (MCUR)
MKOL = KOL
MBAKI = SISAPK
USE
SELECT NPL
LOCATE FOR KOL=MKOL
IF  .NOT. FOUND()
APPEND BLANK
REPLACE KOL WITH MKOL
REPLACE KECAMATAN WITH KRD.KECAMATAN
REPLACE KDHIT WITH KRD.KDHIT
ENDIF
REPLACE JUSER WITH JUSER+1
REPLACE PLAFON WITH PLAFON+MPLAFON
REPLACE BAKI WITH BAKI+MBAKI
SELECT KRD
SKIP
ENDDO
SELECT KRD
USE
SELECT NPL
INDEX ON KOL TO NPL1
CASE THISFORM.NOMORLAP=6
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT1.VALUE)
CSQL = "select cif,nama,alamat,desa,kecamatan,kota,concat(kelkerja,' ',b.keterangan) as kelkerja from anggota as a left join setsandi as b on a.kantor=b.kantor and b.kode='P003' and a.kelkerja=b.sandi group by cif"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
CSQL = "select a.*,b.*,b.sisapokok as sld, if(b.kol='1',0,b.sisapokok) as npl from pinjaman as a left join pinjaman_saldo as b on a.norek=b.norek and b.tanggal='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' "+"where b.sisapokok>0"
LCEK = SQLEXEC(OODBC, CSQL, "SMT2")
AA = "SELECT kelkerja,COUNT(a.norek) as juser, SUM(a.sisapokok) as baki, SUM(npl) as npl FROM smt2 as a LEFT JOIN smt1 as b ON a.cif=b.cif WHERE "+MSYARAT+" group by kelkerja into cursor smt "
&AA
CASE THISFORM.NOMORLAP=7
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT1.VALUE)
MSYARAT2 = ''
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT9.VALUE), "", "rate='"+STR(THISFORM.TEXT9.VALUE)+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT10.VALUE), "", "lama='"+ALLTRIM(STR(THISFORM.TEXT10.VALUE))+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT11.VALUE), "", "kelompok='"+ALLTRIM((THISFORM.TEXT11.VALUE))+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT12.VALUE), "", "wilayah='"+ALLTRIM((THISFORM.TEXT12.VALUE))+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT13.VALUE), "", "penggunaan='"+ALLTRIM((THISFORM.TEXT13.VALUE))+"' and ")
MSYARAT2 = MSYARAT2+IIF(EMPTY(THISFORM.TEXT14.VALUE), "", "ekonomi='"+ALLTRIM((THISFORM.TEXT14.VALUE))+"' and ")
MSYARAT2 = LEFT(MSYARAT2, LEN(MSYARAT2)-5)
IF MSYARAT='1'
MSYARAT = IIF(EMPTY(MSYARAT2), '1', MSYARAT2)
ELSE
MSYARAT = IIF(EMPTY(MSYARAT2), MSYARAT, MSYARAT+' and '+MSYARAT2)
ENDIF
THISFORM.BAR.WIDTH = 0
CREATE CURSOR KREDIT (KANTOR C (4), TANGGAL DATE, NOREK C (25), NOPK C (25), TGLJTEMPO DATE, NAMA C (30), ALAMAT C (50), DESA C (50), KECAMATAN C (50), KOTA C (50), AGAMA C (50), PHONE C (30), PKAWAL N (15), KOL C (1), KDHIT C (1), KALIPK N (5, 1), KALIBG N (5, 1), ODPK INT (15), ODBG INT (15), DENDA INT (10), JAMINAN C (100), DPK C (1))
CSQL = "select b.nama,b.alamat,b.desa,b.kecamatan,b.kota,b.agama,b.phone,"+"a.tanggal,a.tglvaluta,a.bukti,a.norek,nopk,kdhit,a.marketing,a.cif,tujuan,pokok,rate,jasa,lama,tglmulai,tgljtempo,jenis,kelompok,a.wilayah, penggunaan, sektor, sumber, kpr, tgllunas, sisapokok, sisabunga "+" from pinjaman as a left join anggota as b on a.cif=b.cif where  tglvaluta>'0000-00-00' and (tgllunas='0000-00-00' or tgllunas>'"+SQLDATE(THISFORM.TEXT1.VALUE)+"') and "+MSYARAT
LCEK = SQLEXEC(OODBC, CSQL, "DATAKRD")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
MSYARATKOL = LEFT(MSYARATKOL, LEN(MSYARATKOL)-4)
REKNO = 1
JUMREC = RECCOUNT()
DO WHILE  .NOT. EOF()
SALDOKRD(NOREK, TGLNOW)
THISFORM.BAR.WIDTH = (REKNO/JUMREC)*400
SELECT SALDOKRD
MDPK = IIF(KOL='1' .AND. (ODPK>0 .OR. ODBG>0), 'Y', 'T')
MSYARATKOL = IIF(EMPTY(MSYARATKOL), '1=1', MSYARATKOL)
MKOL = KOL
MKALIPK = KALIPK
MKALIBG = KALIBG
MODPK = ODPK
MODBG = ODBG
MDENDA = DENDA
MJAMINAN = JAMINAN
IF &MSYARATKOL 
SELECT KREDIT
APPEND BLANK
REPLACE TANGGAL WITH IIF(ISNULL(DATAKRD.TANGGAL), CTOD("  -  -    "), DATAKRD.TANGGAL)
REPLACE NOREK WITH IIF(ISNULL(DATAKRD.NOREK), "", DATAKRD.NOREK)
REPLACE NOPK WITH IIF(ISNULL(DATAKRD.NOPK), "", DATAKRD.NOPK)
REPLACE TGLJTEMPO WITH IIF(ISNULL(DATAKRD.TGLJTEMPO), CTOD("  -  -    "), DATAKRD.TGLJTEMPO)
REPLACE NAMA WITH IIF(ISNULL(DATAKRD.NAMA), "", DATAKRD.NAMA)
REPLACE ALAMAT WITH IIF(ISNULL(DATAKRD.ALAMAT), "", DATAKRD.ALAMAT)
REPLACE DESA WITH IIF(ISNULL(DATAKRD.DESA), "", DATAKRD.DESA)
REPLACE KECAMATAN WITH IIF(ISNULL(DATAKRD.KECAMATAN), "", DATAKRD.KECAMATAN)
REPLACE KOTA WITH IIF(ISNULL(DATAKRD.KOTA), "", DATAKRD.KOTA)
REPLACE AGAMA WITH IIF(ISNULL(DATAKRD.AGAMA), "", DATAKRD.AGAMA)
REPLACE PHONE WITH IIF(ISNULL(DATAKRD.PHONE), "", DATAKRD.PHONE)
REPLACE PKAWAL WITH IIF(ISNULL(DATAKRD.POKOK), "", DATAKRD.POKOK)
REPLACE KOL WITH IIF(ISNULL(MKOL), "", MKOL)
REPLACE KDHIT WITH IIF(ISNULL(DATAKRD.KDHIT), "", DATAKRD.KDHIT)
REPLACE KALIPK WITH IIF(ISNULL(MKALIPK), 0, MKALIPK)
REPLACE KALIBG WITH IIF(ISNULL(MKALIBG), 0, MKALIBG)
REPLACE ODPK WITH IIF(ISNULL(MODPK), 0, MODPK)
REPLACE ODBG WITH IIF(ISNULL(MODBG), 0, MODBG)
REPLACE DENDA WITH IIF(ISNULL(MDENDA), 0, MDENDA)
REPLACE JAMINAN WITH IIF(ISNULL(MJAMINAN), "", MJAMINAN)
REPLACE DPK WITH IIF(ISNULL(MDPK), 0, MDPK)
ENDIF
SELECT DATAKRD
REKNO = REKNO+1
SKIP
ENDDO
SELECT KREDIT
CASE THISFORM.NOMORLAP=8
DEFAKETERANGAN = "Tanggal : "+DTOC(THISFORM.TEXT1.VALUE)+" s/d. "+DTOC(THISFORM.TEXT2.VALUE)
CSQL = "select c.norek,c.tanggal,c.bukti,c.kode,if(c.kode<>'"+DEFAPINJASA+"',c.debet,c.pokok) as debet,if(c.kode='"+DEFAPINJASA+"',c.debet,c.pokok) as jasa,c.kredit,b.nama,b.alamat,a.kdhit,a.marketing,a.rate,a.lama,a.kelompok,a.penggunaan,a.wilayah,a.sektor from pinjaman_mutasi as c, pinjaman as a, anggota as b "+"where  c.norek=a.norek and a.cif=b.cif and c.kode<>'00'  and a.kdhit='H' and "+MSYARAT+" order by tanggal"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Ggal baca angsuran")
RETURN
ENDIF
ENDCASE
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MKE
THISFORM.BAR.WIDTH = 0
THISFORM.NOMORLAP = MKE
CSQL = "select sandi,keterangan from setsandi where kantor='ID' and kode='KNT'"
LCEK = SQLEXEC(OODBC, CSQL, "KANTOR")
IF RECCOUNT()>1
APPEND BLANK
REPLACE SANDI WITH '0000', KETERANGAN WITH "KONSOLIDASI"
IF DEFAKANTOR='0001'
THISFORM.TEXT21.ENABLED = .T.
ENDIF
ENDIF
THISFORM.TEXT21.VALUE = DEFAKANTOR
THISFORM.TEXT22.VALUE = NAMAKANTOR(DEFAKANTOR)
THISFORM.BORDERSTYLE = 2
DO CASE
CASE MKE=1
THISFORM.JUDUL.CAPTION = "PENCAIRAN PINJAMAN"
THISFORM.FRXNAME = "krd_realisasi.frx"
THISFORM.LABEL15.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
THISFORM.CHECK3.VISIBLE = .F.
THISFORM.CHECK4.VISIBLE = .F.
THISFORM.CHECK5.VISIBLE = .F.
THISFORM.CHECK6.VISIBLE = .F.
THISFORM.SHAPE6.VISIBLE = .F.
THISFORM.HEIGHT = 450
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=2
THISFORM.JUDUL.CAPTION = "PENERIMAAN ANGSURAN"
THISFORM.FRXNAME = "krd_penerimaan_angs.frx"
THISFORM.LABEL15.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
THISFORM.CHECK3.VISIBLE = .F.
THISFORM.CHECK4.VISIBLE = .F.
THISFORM.CHECK5.VISIBLE = .F.
THISFORM.CHECK6.VISIBLE = .F.
THISFORM.SHAPE6.VISIBLE = .F.
THISFORM.HEIGHT = 450
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=3
THISFORM.JUDUL.CAPTION = "DAFTAR NOMINATIF"
THISFORM.FRXNAME = "krd_nominatif.frx"
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.TEXT2.VISIBLE = .F.
THISFORM.TEXT1.VALUE = TGLNOW
CASE MKE=4
THISFORM.JUDUL.CAPTION = "PELUNASAN PINJAMAN"
THISFORM.FRXNAME = "krd_pelunasan.frx"
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT2.VALUE = TGLNOW
CASE MKE=5
THISFORM.JUDUL.CAPTION = "REKAPITULASI NPL"
THISFORM.FRXNAME = "krd_rekap_npl.frx"
THISFORM.SETALL("visible", .F., "textbox")
THISFORM.SETALL("visible", .F., "label")
THISFORM.SETALL("visible", .F., "checkbox")
THISFORM.SETALL("visible", .F., "combobox")
THISFORM.JUDUL.VISIBLE = .T.
THISFORM.JUDUL2.VISIBLE = .T.
THISFORM.LABEL1.VISIBLE = .T.
THISFORM.LABEL16.VISIBLE = .T.
THISFORM.TEXT21.VISIBLE = .T.
THISFORM.TEXT1.VISIBLE = .T.
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.HEIGHT = 150
CASE MKE=6
THISFORM.JUDUL.CAPTION = "NPL PER KELOMPOK/INSTANSI"
THISFORM.FRXNAME = "krd_npl_kel.frx"
THISFORM.SETALL("visible", .F., "textbox")
THISFORM.SETALL("visible", .F., "label")
THISFORM.SETALL("visible", .F., "checkbox")
THISFORM.SETALL("visible", .F., "combobox")
THISFORM.JUDUL.VISIBLE = .T.
THISFORM.JUDUL2.VISIBLE = .T.
THISFORM.LABEL1.VISIBLE = .T.
THISFORM.LABEL16.VISIBLE = .T.
THISFORM.TEXT21.VISIBLE = .T.
THISFORM.TEXT1.VISIBLE = .T.
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.HEIGHT = 150
CASE MKE=7
THISFORM.JUDUL.CAPTION = "NASABAH BELUM BAYAR"
THISFORM.FRXNAME = "krd_blmbayar.frx"
THISFORM.SETALL("visible", .F., "textbox")
THISFORM.SETALL("visible", .F., "label")
THISFORM.SETALL("visible", .F., "checkbox")
THISFORM.SETALL("visible", .F., "combobox")
THISFORM.JUDUL.VISIBLE = .T.
THISFORM.JUDUL2.VISIBLE = .T.
THISFORM.LABEL1.VISIBLE = .T.
THISFORM.LABEL16.VISIBLE = .T.
THISFORM.TEXT21.VISIBLE = .T.
THISFORM.TEXT1.VISIBLE = .T.
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.HEIGHT = 150
CASE MKE=8
THISFORM.JUDUL.CAPTION = "MUTASI REKENING KORAN"
THISFORM.FRXNAME = "krd_mutasi_rk.frx"
THISFORM.LABEL15.VISIBLE = .F.
THISFORM.CHECK2.VISIBLE = .F.
THISFORM.CHECK3.VISIBLE = .F.
THISFORM.CHECK4.VISIBLE = .F.
THISFORM.CHECK5.VISIBLE = .F.
THISFORM.CHECK6.VISIBLE = .F.
THISFORM.SHAPE6.VISIBLE = .F.
THISFORM.HEIGHT = 450
THISFORM.TEXT1.VALUE = AWALBLN(TGLNOW)
THISFORM.TEXT2.VALUE = TGLNOW
ENDCASE
THISFORM.JUDUL2.CAPTION = THISFORM.JUDUL.CAPTION
ENDPROC
**
PROCEDURE Unload
SELECT KANTOR
ENDPROC
**
*
*  pinj_lap.scx::Cmdoke1
**
PROCEDURE Click
THISFORM.BACASQL()
MTANGGAL1 = THISFORM.TEXT1.VALUE
MTANGGAL2 = THISFORM.TEXT2.VALUE
DO FORM print_setup WITH THISFORM.FRXNAME
ENDPROC
**
*
*  pinj_lap.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  pinj_lap.scx::Cmdoke2
**
PROCEDURE Click
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
REPORT FORM (THISFORM.FRXNAME) PREVIEW
IF WEXIST("Report")
MOVE WINDOW "Report" CENTER
ZOOM WINDOW "Report" MAX
ENDIF
ENDPROC
**
*
*  pinj_lap.scx::Cmdoke3
**
PROCEDURE Click
DO FORM print_export TO MRET
IF  .NOT. EMPTY(MRET)
MTYPE = ALLTRIM(LEFT(MRET, 5))
MFILE = SUBSTR(MRET, 5)
THISFORM.BACASQL()
TGLCETAK = THISFORM.TEXT1.VALUE
DO CASE
CASE MTYPE="PDF"
CASE MTYPE="XLS"
COPY TO (MFILE) XLS
CASE MTYPE="TXT"
REPORT FORM (THISFORM.FRXNAME) ASCII TO FILE (MFILE) NODIALOG
CASE MTYPE="DOC"
CASE MTYPE="DBF"
COPY TO (MFILE)
CASE MTYPE="CSV"
COPY TO (MFILE) CSV
ENDCASE
THISFORM.BAR.WIDTH = 0
MESSAGEBOX("Laporan Sudah Selesai ditransfer")
ENDIF
ENDPROC
**
*
*  pinj_lap.scx::text21
**
PROCEDURE InteractiveChange
THISFORM.TEXT22.VALUE = KANTOR.KETERANGAN
ENDPROC
**
*
*  pinj_lap.scx::text7
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P002'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT16.VALUE = BB
ENDPROC
**
*
*  pinj_lap.scx::text6
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT15.VALUE = BB
ENDPROC
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P003'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  pinj_lap.scx::text11
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P003'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
KE = 1
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT17.VALUE = BB
ENDPROC
**
*
*  pinj_lap.scx::text12
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT18.VALUE = BB
ENDPROC
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='A003'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  pinj_lap.scx::Text13
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P005'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT19.VALUE = BB
ENDPROC
**
*
*  pinj_lap.scx::text14
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+2)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT20.VALUE = BB
ENDPROC
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi where kantor='"+DEFAKANTOR+"' and KODE='P006'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
*
*  pinj_lap.scx::Combo5
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi_pinj where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+","+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
ENDPROC
**
PROCEDURE LostFocus
OLDSELE = SELECT()
CSQL = "select keterangan from setsandi_pinj where kantor='"+DEFAKANTOR+"' and sandi='"+THIS.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL, "cek")
THISFORM.TEXT23.VALUE = KETERANGAN
USE
SELECT (OLDSELE)
ENDPROC
**
***
*** pinj_lap.sct
***
*
***
*** kas_rekapharian.frx
***
*
***
*** kas_rekapharian.frt
***
*
***
*** akt_rekapharian.frx
***
*
***
*** akt_rekapharian.frt
***
*
***
*** simpanan_setproduk_dep.scx
***
*
*
*  simpanan_setproduk_dep.scx::FORM1
**
PROCEDURE myenable
PARAMETER MKONDISI
WITH THISFORM
.TEXT8.ENABLED = MKONDISI
.TEXT9.ENABLED = MKONDISI
.COMBO1.ENABLED = MKONDISI
.TEXT4.ENABLED = MKONDISI
.TEXT1.ENABLED = MKONDISI
.TEXT2.ENABLED = MKONDISI
.TEXT3.ENABLED = MKONDISI
.TEXT6.ENABLED = MKONDISI
.COMMAND1.ENABLED = MKONDISI
.COMMAND2.ENABLED = MKONDISI
.COMMAND3.ENABLED = MKONDISI
.COMMAND6.ENABLED = MKONDISI
.CMDSIMPAN1.VISIBLE = MKONDISI
.CMDBATAL1.VISIBLE = MKONDISI
.CMDKELUAR1.VISIBLE =  .NOT. MKONDISI
ENDWITH
ENDPROC
**
PROCEDURE tampil
LOCAL OLDSELECT
OLDSELECT = SELECT()
MSANDI = THISFORM.MYSANDI
CSQL = "select * from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='2' and sandi=?msandi"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
WITH THISFORM
.TEXT8.VALUE = SANDI
.TEXT9.VALUE = KETERANGAN
.COMBO1.VALUE = VER
.TEXT10.VALUE = IIF(VER=1, "Deposito Umum", "Deposito SMB (Simpanan Berjangka)")
.TEXT4.VALUE = PEMBULATAN
.TEXT1.VALUE = JURNALTAB
.TEXT2.VALUE = JURNALUTANGBG
.TEXT3.VALUE = JURNALBUNGA
.TEXT6.VALUE = JURNALPAJAK
.COMBO1.VALUE = VER
IF ALLTRIM(STR(VER))='1'
.TEXT10.VALUE = "Deposito Umum"
ELSE
.TEXT10.VALUE = "Deposito SMB (Simpanan Berjangka)"
ENDIF
ENDWITH
USE
SELECT (OLDSELECT)
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE
THISFORM.AUTOCENTER = .T.
THISFORM.DEPT = ''
THISFORM.MYSANDI = SANDI
THISFORM.MYMODE = MMODE
THISFORM.DBFDATA = SYS(2015)
THISFORM.ADDOBJECT("mkop", "label")
THISFORM.MKOP.TOP = 5
THISFORM.MKOP.LEFT = 20
THISFORM.MKOP.WIDTH = THISFORM.WIDTH-50
THISFORM.MKOP.ALIGNMENT = 2
THISFORM.MKOP.HEIGHT = 23
THISFORM.MKOP.FONTSIZE = 14
THISFORM.MKOP.FONTBOLD = .T.
THISFORM.MKOP.CAPTION = "DETAIL SETTING"
THISFORM.MKOP.VISIBLE = .T.
THISFORM.MKOP.BACKSTYLE = 0
THISFORM.MKOP.FORECOLOR = RGB(255, 255, 255)
WITH THISFORM
.TEXT8.INPUTMASK = "!!!!"
.TEXT9.INPUTMASK = REPLICATE('!', 20)
.TEXT1.INPUTMASK = DEFAFMTAKT
.TEXT2.INPUTMASK = DEFAFMTAKT
.TEXT3.INPUTMASK = DEFAFMTAKT
.TEXT6.INPUTMASK = DEFAFMTAKT
ENDWITH
IF THISFORM.MYMODE="EDIT"
THISFORM.MYENABLE(.T.)
THISFORM.TAMPIL()
ENDIF
IF THISFORM.MYMODE="INPUT"
THISFORM.TEXT8.ENABLED = .T.
THISFORM.TEXT9.ENABLED = .T.
THISFORM.COMBO1.ENABLED = .T.
THISFORM.TEXT1.ENABLED = .T.
THISFORM.TEXT2.ENABLED = .T.
THISFORM.TEXT3.ENABLED = .T.
THISFORM.TEXT6.ENABLED = .T.
ENDIF
IF THISFORM.MYMODE="TAMPIL"
THISFORM.MYENABLE(.F.)
THISFORM.TAMPIL()
ENDIF
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
FUNCTION Unload
RETURN THISFORM.MYPILIH
ENDFUNC
**
*
*  simpanan_setproduk_dep.scx::Cmdkeluar1
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk_dep.scx::Cmdsimpan1
**
PROCEDURE Click
THISFORM.MYENABLE(.F.)
MSANDILAMA = THISFORM.MYSANDI
IF THISFORM.MYMODE="INPUT"
CSQL = "insert into setsandi_tab ( `kantor`, `jenis`, `SANDI`, `KETERANGAN`, `VER`, "+"PEMBULATAN,`JURNALTAB`, `JURNALUTANGBG`, `JURNALBUNGA`, `JURNALPAJAK`) value "+"(?defakantor,'2',?thisform.text8.value,?thisform.text9.value,?thisform.combo1.value,"+"?thisform.text4.value,"+"?thisform.text1.value,"+"?thisform.text2.value,"+"?thisform.text3.value,"+"JURNALPAJAK=?thisform.text6.value)"
ENDIF
IF THISFORM.MYMODE="EDIT"
WITH THISFORM
CSQL = "UPDATE setsandi_tab set "+"SANDI=?thisform.text8.value,"+"KETERANGAN=?thisform.text9.value,"+"VER=?thisform.combo1.value,"+"PEMBULATAN=?thisform.text4.value,"+"JURNALTAB=?thisform.text1.value,"+"JURNALUTANGBG=?thisform.text2.value,"+"JURNALBUNGA=?thisform.text3.value,"+"JURNALPAJAK=?thisform.text6.value "+"where kantor=?defakantor and jenis='2' and sandi='"+MSANDILAMA+"'"
ENDWITH
ENDIF
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal update data")
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk_dep.scx::Cmdbatal1
**
PROCEDURE Click
THISFORM.MYENABLE(.F.)
THISFORM.RELEASE
ENDPROC
**
*
*  simpanan_setproduk_dep.scx::Combo1
**
PROCEDURE LostFocus
IF THIS.VALUE='1'
THISFORM.TEXT10.VALUE = "Deposito Umum"
ELSE
THISFORM.TEXT10.VALUE = "Deposito SMB (Simpanan Berjangka)"
ENDIF
ENDPROC
**
PROCEDURE Init
WITH THIS
.ADDLISTITEM('1')
.ADDLISTITEM('Deposito Umum', .NEWITEMID, 2)
.ADDLISTITEM('2')
.ADDLISTITEM('Deposito SMB (Simpanan Berjangka)', .NEWITEMID, 2)
ENDWITH
ENDPROC
**
*
*  simpanan_setproduk_dep.scx::Command6
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT6.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk_dep.scx::Command3
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT3.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk_dep.scx::Command2
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT2.VALUE = MNOPER
ENDPROC
**
*
*  simpanan_setproduk_dep.scx::Command1
**
PROCEDURE Click
DO FORM .\form\gl_cari_noper TO MNOPER
THISFORM.TEXT1.VALUE = MNOPER
ENDPROC
**
***
*** simpanan_setproduk_dep.sct
***
*
***
*** symbol refresh 4.bmp
***
*
***
*** a_cek_instansi.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
CREATE CURSOR cek (PERIODE C (6), KODE C (2), NOANGG C (10), NAMA C (30), KET C (20), NOMI1 N (12), NOMI2 N (12), SELISIH N (12))
TEXT TO STR1 NOSHOW
  select a.kode,a.bln,a.tahun,a.noangg,a.nama,simpokok, simwajib,lain,a.simpanan,sum(c.jumlah) as simpanan1, 
     a.angpokok,sum(b.angpokok) as angpokok1,a.angbunga,sum(b.angbunga) as angbunga1,a.angdenda,sum(b.angdenda) as AngDenda1 
     from col_instansi as a left join col_instansi_pinj as b on a.instansi=b.instansi and a.kode=b.kode and a.tahun=b.tahun and a.bln=b.bln and a.noangg=b.noangg 
     left join col_instansi_simp as c on a.instansi=c.instansi and a.kode=c.kode and a.tahun=c.tahun and a.bln=c.bln and a.noangg=c.noangg 
     where a.kantor='0001' and a.tahun='2016' and a.bln<>'1' group by a.noangg 
ENDTEXT
LCEK = SQLEXEC(OODBC, STR1, "smt")
IF LCEK<1
MESSAGEBOX(STR1)
RETURN
ENDIF
GOTO TOP
MNOANGG = ''
MNAMA = ''
MKODE = ''
MPERIODE = ''
DO WHILE  .NOT. EOF()
IF SIMPANAN<>SIMPANAN1 .OR. ANGPOKOK<>ANGPOKOK1 .OR. ANGBUNGA<>ANGBUNGA1 .OR. ANGDENDA<>ANGDENDA1
MNOANGG = NOANGG
MNAMA = NAMA
MKODE = KODE
MPERIODE = ALLTRIM(STR(TAHUN))+ALLTRIM(STR(BLN))
DO CASE
CASE SIMPANAN<>SIMPANAN1
MKET = "SIMPANAN"
MNOMI1 = SIMPANAN
MNOMI2 = SIMPANAN1
CASE ANGPOKOK<>ANGPOKOK1
MKET = "ANGS. POKOK"
MNOMI1 = ANGPOKOK
MNOMI2 = ANGPOKOK1
CASE ANGBUNGA<>ANGBUNGA1
MKET = "ANGS. BUNGA"
MNOMI1 = ANGBUNGA
MNOMI2 = ANGBUNGA1
CASE ANGDENDA<>ANGDENDA1
MKET = "DENDA"
MNOMI1 = ANGDENDA
MNOMI2 = ANGDENDA1
ENDCASE
SELECT CEK
APPEND BLANK
REPLACE PERIODE WITH MPERIODE, KODE WITH MKODE, NOANGG WITH MNOANGG, NAMA WITH MNAMA, KET WITH MKET, NOMI1 WITH MNOMI1, NOMI2 WITH MNOMI2, SELISIH WITH MNOMI2-MNOMI1
SELECT SMT
ENDIF
SKIP
ENDDO
SELECT CEK
INDEX ON PERIODE+KODE TO kode1
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** col_cek_transfer.frx
***
*
***
*** col_cek_transfer.frt
***
*
***
*** akt_neraca1.frx
***
*
***
*** akt_neraca1.frt
***
*
***
*** akt_phu1.frx
***
*
***
*** akt_phu1.frt
***
*
***
*** akt_camel2.frx
***
*
***
*** akt_camel2.frt
***
*
***
*** a_perbaikan_table.scx
***
*
*
*  a_perbaikan_table.scx::FORM1
**
PROCEDURE Init
THIS.CAPTION = "PERBAIKAN DATA"
ENDPROC
**
PROCEDURE Activate
MDATA = ALLTRIM(THISFORM.READINI1._READ("CONECTION", "DATABASED"))
THISFORM.SHAPE1.WIDTH = 0
CSQL = "show tables"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
JUMLAH = RECCOUNT()
GOTO TOP
A = 0
DO WHILE  .NOT. EOF()
MKOLOM = "tables_in_"+ALLTRIM(MDATA)
MTABLE=&MKOLOM
A = A+1
THISFORM.SHAPE1.WIDTH = INT((A/JUMLAH)*400)
THISFORM.LABEL1.CAPTION = ALLTRIM(UPPER(MTABLE))
CSQL = "repair table "+MTABLE
LCEK = SQLEXEC(OODBC, CSQL)
SELECT SMT
SKIP
ENDDO
THISFORM.LABEL1.CAPTION = "PERBAIKAN DATA SUDAH SELESAI"
MESSAGEBOX("PERBAIKAN DATA, SELESAI", 0, "")
THISFORM.RELEASE
ENDPROC
**
***
*** a_perbaikan_table.sct
***
*
***
*** akt_camel_kop.frx
***
*
***
*** akt_camel_kop.frt
***
*
***
*** form_cek_pinj.scx
***
*
*
*  form_cek_pinj.scx::FORM1
**
PROCEDURE Init
THISFORM.TEXT1.VALUE = TGLNOW
THISFORM.MAXBUTTON = .F.
THISFORM.MINBUTTON = .F.
THISFORM.BORDERSTYLE = 1
ENDPROC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=13
THISFORM.RELEASE
ENDIF
ENDPROC
**
*
*  form_cek_pinj.scx::Command1
**
PROCEDURE Click
CSQL = "select norek,tanggal,tglvaluta,tgllunas,pokok from pinjaman where "+"tanggal<=?thisform.text1.value and tglvaluta>'0000-00-00'"
LCEK = SQLEXEC(OODBC, CSQL, "smt")
THISFORM.RELEASE
ENDPROC
**
***
*** form_cek_pinj.sct
***
*
***
*** col_instansi_data1.scx
***
*
*
*  col_instansi_data1.scx::FORM1
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MMODE, MKOLEKTOR, MBULAN, MTAHUN
THISFORM.MODE = MMODE
THISFORM.KOLEKTOR = MKOLEKTOR
THISFORM.TEXT41.VALUE = MBULAN
THISFORM.TEXT3.VALUE = MTAHUN
THISFORM.TEXT8.VALUE = DEFANOMIWAJIB
THISFORM.TEXT1.ENABLED = .T.
THISFORM.SHAPE5.WIDTH = 0
IF MMODE="HAPUS"
THISFORM.SHAPE8.BACKCOLOR = RGB(255, 125, 125)
THISFORM.LABEL17.CAPTION = "BATAL TAGIHAN KOLEKTIF"
THISFORM.SHAPE1.BACKCOLOR = RGB(128, 0, 0)
THISFORM.TEXT4.VISIBLE = .F.
THISFORM.TEXT5.VISIBLE = .F.
THISFORM.TEXT6.VISIBLE = .F.
THISFORM.TEXT7.VISIBLE = .F.
THISFORM.TEXT8.VISIBLE = .F.
THISFORM.TEXT9.VISIBLE = .F.
THISFORM.TEXT10.VISIBLE = .F.
THISFORM.TEXT11.VISIBLE = .F.
THISFORM.SHAPE6.VISIBLE = .F.
THISFORM.LABEL2.VISIBLE = .F.
THISFORM.LABEL3.VISIBLE = .F.
THISFORM.LABEL4.VISIBLE = .F.
THISFORM.LABEL5.VISIBLE = .F.
THISFORM.LABEL6.VISIBLE = .F.
THISFORM.HEIGHT = 160
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi_data1.scx::Command3
**
PROCEDURE Click
IF THISFORM.MODE="INSERT"
CSQL = "select * from anggota where kelkerja='"+THISFORM.TEXT1.VALUE+"' and tglkeluar='0000-00-00' group by cif"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX("Gagal baca data pinjaman", 0, "")
ENDIF
JUMREC = RECCOUNT()
DO WHILE  .NOT. EOF()
THISFORM.SHAPE5.WIDTH = (RECNO()/JUMREC)*442
MCIF = CIF
MNAMA = NAMA
MLAIN = LAIN
MKET = KETLAIN
MTOTSIMPAN = 0
IF THISFORM.TEXT4.VALUE="ALL"
CSQL = "select a.norek,a.pot_simpanan,produk,jenis from simpanan as a where a.tgltutup='0000-00-00' and a.cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
IF LCEK<1
MESSAGEBOX("Gagal Baca data simpanan 2", 0, "")
ENDIF
DO WHILE  .NOT. EOF()
MTOTSIMPAN = MTOTSIMPAN+POT_SIMPANAN
CSQL = "select sandi,keterangan from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='"+JENIS+"' and sandi='"+PRODUK+"'"
LCEK = SQLEXEC(OODBC, CSQL, "smt2")
MPRODUK = KETERANGAN
MSANDI = SANDI
SELECT SMT1
CSQL = "insert into col_instansi_simp (kantor,kode,instansi,bln,tahun,noangg,norek,sandi,produk,jumlah) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+MCIF+"','"+NOREK+"','"+MSANDI+"','"+MPRODUK+"','"+STR(POT_SIMPANAN)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert rincian simpanan 3")
RETURN
ENDIF
SELECT SMT1
SKIP
ENDDO
ENDIF
STORE 0 TO MTOTPOKOK, MTOTBUNGA, MTOTDENDA
IF THISFORM.CHECK2.VALUE=1
MTGLMULAI = CTOD('01-'+RIGHT("00"+ALLTRIM(TRANSFORM(THISFORM.TEXT41.VALUE, '99')), 2)+'-'+TRANSFORM(THISFORM.TEXT3.VALUE, '9999'))
CSQL = "select jenis,norek,pokok,rate,lama,pot_pokok,pot_bunga from pinjaman where tgllunas='0000-00-00' and tglvaluta<>'0000-00-00' and tglmulai<='"+SQLDATE(AKHIRBLN(MTGLMULAI))+"' and cif='"+MCIF+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT1")
IF LCEK<1
MESSAGEBOX("Gagal Baca data simpanan 4", 0, "")
RETURN
ENDIF
GOTO TOP
DO WHILE  .NOT. EOF()
SELECT SMT1
CSQL = "insert into col_instansi_pinj (kantor,kode,instansi,bln,tahun,noangg,norek,produk,"+"pokok,jw,rate,angs,angpokok,angbunga) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+MCIF+"','"+NOREK+"','"+JENIS+"','"+STR(POKOK)+"','"+TRANSFORM(LAMA, '9999')+"','"+TRANSFORM(RATE, '99.99')+"','"+"0"+"','"+STR(POT_POKOK)+"','"+STR(POT_BUNGA)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal insert rincian simpanan 5")
RETURN
ENDIF
MTOTPOKOK = MTOTPOKOK+POT_POKOK
MTOTBUNGA = MTOTBUNGA+POT_BUNGA
SELECT SMT1
SKIP
ENDDO
ENDIF
IF THISFORM.CHECK3.VALUE=0
IF DEFANOMIWAJIB+MTOTSIMPAN+MTOTPOKOK+MTOTBUNGA>0
CSQL = "insert into col_instansi (kantor,kode,instansi,bln,tahun,noangg,nama,"+"simpokok,simwajib,simpanan,lain,ket,angpokok,angbunga,angdenda) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+MCIF+"',"+'"'+MNAMA+'"'+",'"+STR(DEFANOMIPOKOK)+"','"+STR(DEFANOMIWAJIB)+"','"+STR(MTOTSIMPAN)+"','"+STR(MLAIN)+"','"+MKET+"','"+STR(MTOTPOKOK)+"','"+STR(MTOTBUNGA)+"','"+STR(0)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert bayar instansi 6")
RETURN
ENDIF
ENDIF
ELSE
CSQL = "insert into col_instansi (kantor,kode,instansi,bln,tahun,noangg,nama,"+"simpokok,simwajib,simpanan,lain,ket,angpokok,angbunga,angdenda) value "+"('"+DEFAKANTOR+"','"+THISFORM.KOLEKTOR+"','"+THISFORM.TEXT1.VALUE+"','"+STR(THISFORM.TEXT41.VALUE)+"','"+STR(THISFORM.TEXT3.VALUE)+"','"+MCIF+"',"+'"'+MNAMA+'"'+",'"+STR(DEFANOMIPOKOK)+"','"+STR(DEFANOMIWAJIB)+"','"+STR(MTOTSIMPAN)+"','"+STR(MLAIN)+"','"+MKET+"','"+STR(MTOTPOKOK)+"','"+STR(MTOTBUNGA)+"','"+STR(0)+"')"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("Gagal Insert bayar instansi 7")
RETURN
ENDIF
ENDIF
SELECT SMT
SKIP
ENDDO
ENDIF
IF THISFORM.MODE="HAPUS"
CSQL = "DELETE from col_instansi where kantor='"+DEFAKANTOR+"' and bln='"+STR(THISFORM.TEXT41.VALUE)+"'and tahun='"+STR(THISFORM.TEXT3.VALUE)+"' and "+"kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("PEMBATALAN TAGIHAN GAGAL DILAKUKAN", 0, "")
ENDIF
CSQL = "DELETE from col_instansi_simp where kantor='"+DEFAKANTOR+"' and bln='"+STR(THISFORM.TEXT41.VALUE)+"'and tahun='"+STR(THISFORM.TEXT3.VALUE)+"' and "+"kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("PEMBATALAN TAGIHAN SIMPANAN GAGAL DILAKUKAN 8", 0, "")
ENDIF
CSQL = "DELETE from col_instansi_pinj where kantor='"+DEFAKANTOR+"' and bln='"+STR(THISFORM.TEXT41.VALUE)+"'and tahun='"+STR(THISFORM.TEXT3.VALUE)+"' and "+"kode='"+THISFORM.KOLEKTOR+"' and instansi='"+THISFORM.TEXT1.VALUE+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX("PEMBATALAN TAGIHAN PINJAMAN GAGAL DILAKUKAN 9", 0, "")
ENDIF
ENDIF
THISFORM.RELEASE
ENDPROC
**
*
*  col_instansi_data1.scx::Text41
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text1
**
FUNCTION LostFocus
IF LASTKEY()=27
RETURN .T.
ENDIF
OLDSELECT = SELECT()
IF LASTKEY()=13 .AND. EMPTY(THIS.VALUE)
DO FORM cari_tabel TO MSANDI WITH "P003"
THIS.VALUE = MSANDI
ENDIF
MSANDI = TRIM(THIS.VALUE)
CSQL = "select keterangan from setsandi where kantor='"+DEFAKANTOR+"' and kode='P003' and sandi='"+MSANDI+"'"
LCEK = SQLEXEC(OODBC, CSQL, "SMT")
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
IF RECCOUNT()=0
MESSAGEBOX("Kode Instansi Tidak Tersedia")
NODEFAULT
RETURN
ENDIF
THISFORM.TEXT1.VALUE = MSANDI
THISFORM.TEXT2.VALUE = KETERANGAN
USE
SELECT (OLDSELECT)
ENDFUNC
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text2
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text3
**
PROCEDURE LostFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text5
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text7
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text8
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text9
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
PROCEDURE LostFocus
IF THIS.VALUE>0
THISFORM.TEXT10.ENABLED = .T.
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text10
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::Text11
**
PROCEDURE GotFocus
IF LASTKEY()=27 .OR. LASTKEY()=5
RETURN
ENDIF
ENDPROC
**
*
*  col_instansi_data1.scx::text4
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi_tab where kantor='"+DEFAKANTOR+"' and jenis='1'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
PILIH = PILIH+"ALL"+",SEMUA PRODUK,"
PILIH = PILIH+"TDK"+",TIDAK DITRANSAKSIKAN,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+" ,"+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
THIS.VALUE = "ALL"
ENDPROC
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+3)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT5.VALUE = BB
ENDPROC
**
*
*  col_instansi_data1.scx::text6
**
PROCEDURE Init
PILIH = ''
OLDSELE = SELECT()
CSQL = "select sandi,keterangan from setsandi_pinj where kantor='"+DEFAKANTOR+"'"
LCEK = SQLEXEC(OODBC, CSQL, "PILIH")
IF RECCOUNT()>0
PILIH = ""+",,"
PILIH = PILIH+"ALL"+",SEMUA PRODUK,"
PILIH = PILIH+"TDK"+",TIDAK DITRANSAKSIKAN,"
DO WHILE  .NOT. EOF()
PILIH = PILIH+SANDI+" ,"+KETERANGAN+","
SKIP
ENDDO
PILIH = LEFT(PILIH, LEN(PILIH)-1)
THIS.ROWSOURCETYPE = 1
THIS.ROWSOURCE = PILIH
ENDIF
USE
SELECT (OLDSELE)
THIS.VALUE = "ALL"
ENDPROC
**
PROCEDURE LostFocus
AA = THIS.ROWSOURCE
MKATA = THIS.VALUE+","
BB = SUBSTR(ALLTRIM(SUBSTR(AA, AT(MKATA, AA)+3)), 2)
IF AT(',', BB)>0
BB = SUBSTR(BB, 1, AT(',', BB))
BB = SUBSTR(BB, 1, AT(',', BB)-1)
ENDIF
THISFORM.TEXT7.VALUE = BB
ENDPROC
**
***
*** col_instansi_data1.sct
***
*
***
*** a_cek_tabungan.fxp
***
*
*** 
*** ReFox XI  #ES110215  Edelmiro González Martínez  Asesoria Informatica Gallega S.L [VFP90]
***
CSQL = "select * from kasir where kode='05' "
LCEK = SQLEXEC(OODBC, CSQL, "smt")
IF LCEK<1
MESSAGEBOX(STR1)
RETURN
ENDIF
GOTO TOP
DO WHILE  .NOT. EOF()
MKANTOR = KANTOR
MTANGGAL = TANGGAL
MBLN = MONTH(MTANGGAL)
MTHN = YEAR(MTANGGAL)
MBUKTI = BUKTI
MTOTAL = DEBET-KREDIT
MCOL = NOREK
CSQL = "select * from col_instansi_simp where kode=?mCol and instansi=?mcol and bln=?mbln and tahun=?mthn"
LCEK = SQLEXEC(OODBC, CSQL, "COL")
DO WHILE  .NOT. EOF()
MNOANGG = NOANGG
MNOREK = NOREK
MSANDI = SANDI
MJUMLAH = JUMLAH
CSQL = "select * from simpanan_mutasi where tanggal=?mtanggal and bukti=?mbukti and norek=?mnorek"
LCEK = SQLEXEC(OODBC, CSQL, "tab")
IF MJUMLAH-(KREDIT-DEBET)<>0
MESSAGEBOX("Jumlah Tidak sama "+CHR(13)+"Di Colektor :"+CHR(13)+"              Tanggal : "+DTOC(MTANGGAL)+CHR(13)+"              Bukti   : "+MBUKTI+CHR(13)+"              Norek   : "+MNOREK+CHR(13)+"              Jumlah  : "+TRANSFORM(MJUMLAH, '999,999,999,999')+CHR(13)+"Di Tabungan :"+CHR(13)+"              Tanggal : "+DTOC(TANGGAL)+CHR(13)+"              Bukti   : "+BUKTI+CHR(13)+"              Norek   : "+NOREK+CHR(13)+"              Jumlah  : "+TRANSFORM(KREDIT, '999,999,999,999')+CHR(13))
IF LASTKEY()=27
MESSAGEBOX("escape")
RETURN
ENDIF
ENDIF
SELECT COL
SKIP
ENDDO
SELECT SMT
SKIP
ENDDO
ENDPROC
**
*** 
*** ReFox - retrace your steps ... 
***
***
*** pinjaman_valuta.scx
***
*
*
*  pinjaman_valuta.scx::FORM1
**
FUNCTION Unload
RETURN THISFORM.VALUTA
ENDFUNC
**
PROCEDURE KeyPress
LPARAMETERS NKEYCODE, NSHIFTALTCTRL
IF NKEYCODE=27
THISFORM.RELEASE
ENDIF
ENDPROC
**
PROCEDURE Init
PARAMETER MNOREK, MVALUTA
THISFORM.NOREK = MNOREK
THISFORM.VALUTA = MVALUTA
THISFORM.TEXT1.VALUE = MVALUTA
ENDPROC
**
*
*  pinjaman_valuta.scx::Command1
**
PROCEDURE Click
CSQL = "update pinjaman set tglvaluta='"+SQLDATE(THISFORM.TEXT1.VALUE)+"' where norek='"+THISFORM.NOREK+"'"
LCEK = SQLEXEC(OODBC, CSQL)
IF LCEK<1
MESSAGEBOX(CSQL)
ENDIF
THISFORM.VALUTA = THISFORM.TEXT1.VALUE
THISFORM.RELEASE
ENDPROC
**
*
*  pinjaman_valuta.scx::Command2
**
PROCEDURE Click
THISFORM.RELEASE
ENDPROC
**
***
*** pinjaman_valuta.sct
***
*
